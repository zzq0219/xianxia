<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>增强版地图系统测试</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Noto Serif SC', serif;
            background: linear-gradient(to bottom, #0c0a09, #1c1917);
            touch-action: none;
        }
        
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-section {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-title {
            color: #fbbf24;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 999px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .status-pass {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }
        
        .status-pending {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }
        
        .test-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            margin: 8px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            color: #e5e7eb;
        }
        
        .test-check {
            width: 24px;
            height: 24px;
            border: 2px solid #fbbf24;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .test-check.checked {
            background: #22c55e;
            border-color: #22c55e;
        }
        
        .device-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .info-card {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.2);
            border-radius: 8px;
            padding: 15px;
        }
        
        .info-label {
            color: #fbbf24;
            font-size: 0.875rem;
            margin-bottom: 5px;
        }
        
        .info-value {
            color: #fff;
            font-size: 1.125rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-section">
            <div class="test-title">
                <i class="fa-solid fa-vial text-amber-400"></i>
                增强版地图系统测试套件
                <span class="test-status status-pending" id="overall-status">测试中...</span>
            </div>
            <p class="text-gray-400 text-sm mb-4">
                本页面用于测试新版地图系统的所有功能。请按照清单逐项测试。
            </p>
        </div>

        <!-- 设备信息 -->
        <div class="test-section">
            <div class="test-title">
                <i class="fa-solid fa-mobile-screen-button text-blue-400"></i>
                设备信息
            </div>
            <div class="device-info">
                <div class="info-card">
                    <div class="info-label">设备类型</div>
                    <div class="info-value" id="device-type">检测中...</div>
                </div>
                <div class="info-card">
                    <div class="info-label">屏幕尺寸</div>
                    <div class="info-value" id="screen-size">检测中...</div>
                </div>
                <div class="info-card">
                    <div class="info-label">触摸支持</div>
                    <div class="info-value" id="touch-support">检测中...</div>
                </div>
                <div class="info-card">
                    <div class="info-label">浏览器</div>
                    <div class="info-value" id="browser-info">检测中...</div>
                </div>
            </div>
        </div>

        <!-- 基础功能测试 -->
        <div class="test-section">
            <div class="test-title">
                <i class="fa-solid fa-check-circle text-green-400"></i>
                基础功能测试
            </div>
            <div id="basic-tests"></div>
        </div>

        <!-- 触摸手势测试 (移动端) -->
        <div class="test-section" id="touch-tests-section" style="display: none;">
            <div class="test-title">
                <i class="fa-solid fa-hand-pointer text-purple-400"></i>
                触摸手势测试
            </div>
            <div id="touch-tests"></div>
        </div>

        <!-- 桌面端测试 -->
        <div class="test-section" id="desktop-tests-section" style="display: none;">
            <div class="test-title">
                <i class="fa-solid fa-desktop text-cyan-400"></i>
                桌面端测试
            </div>
            <div id="desktop-tests"></div>
        </div>

        <!-- 性能测试 -->
        <div class="test-section">
            <div class="test-title">
                <i class="fa-solid fa-gauge-high text-red-400"></i>
                性能测试
            </div>
            <div id="performance-tests"></div>
        </div>

        <!-- 测试结果 -->
        <div class="test-section">
            <div class="test-title">
                <i class="fa-solid fa-chart-pie text-yellow-400"></i>
                测试统计
            </div>
            <div class="text-gray-300 text-lg mb-4">
                通过: <span id="pass-count" class="text-green-400 font-bold">0</span> / 
                总计: <span id="total-count" class="text-amber-400 font-bold">0</span>
            </div>
            <div class="w-full bg-gray-700 rounded-full h-4 overflow-hidden">
                <div id="progress-bar" class="h-full bg-gradient-to-r from-green-500 to-emerald-500 transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <script>
        // 测试项定义
        const testSuites = {
            basic: [
                { id: 'basic-1', text: '地图组件正常加载' },
                { id: 'basic-2', text: '地点标记正确显示' },
                { id: 'basic-3', text: '缩放控制按钮可见' },
                { id: 'basic-4', text: '搜索框正常工作' },
                { id: 'basic-5', text: '图例正确显示' }
            ],
            touch: [
                { id: 'touch-1', text: '双指缩放流畅' },
                { id: 'touch-2', text: '单指拖拽无卡顿' },
                { id: 'touch-3', text: '双击放大/缩小正常' },
                { id: 'touch-4', text: '底部抽屉滑动顺畅' },
                { id: 'touch-5', text: '地点点击响应快速' }
            ],
            desktop: [
                { id: 'desktop-1', text: '滚轮缩放正常' },
                { id: 'desktop-2', text: '鼠标拖拽流畅' },
                { id: 'desktop-3', text: '缩放滑块可用' },
                { id: 'desktop-4', text: '键盘快捷键工作' },
                { id: 'desktop-5', text: '侧边信息面板显示正确' }
            ],
            performance: [
                { id: 'perf-1', text: '首次渲染 < 300ms' },
                { id: 'perf-2', text: '缩放响应 < 50ms' },
                { id: 'perf-3', text: '拖拽帧率 > 30fps' },
                { id: 'perf-4', text: '无明显卡顿' },
                { id: 'perf-5', text: '内存占用正常 (< 50MB)' }
            ]
        };

        // 检测设备信息
        function detectDevice() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const isMobile = width < 768;
            const hasTouch = 'ontouchstart' in window;
            
            document.getElementById('device-type').textContent = isMobile ? '移动端' : '桌面端';
            document.getElementById('screen-size').textContent = `${width} x ${height}`;
            document.getElementById('touch-support').textContent = hasTouch ? '支持' : '不支持';
            document.getElementById('browser-info').textContent = navigator.userAgent.split(' ').slice(-1)[0].split('/')[0];

            // 显示相应的测试部分
            if (isMobile || hasTouch) {
                document.getElementById('touch-tests-section').style.display = 'block';
            } else {
                document.getElementById('desktop-tests-section').style.display = 'block';
            }
        }

        // 渲染测试项
        function renderTests() {
            renderTestGroup('basic-tests', testSuites.basic);
            renderTestGroup('touch-tests', testSuites.touch);
            renderTestGroup('desktop-tests', testSuites.desktop);
            renderTestGroup('performance-tests', testSuites.performance);
            updateStats();
        }

        function renderTestGroup(containerId, tests) {
            const container = document.getElementById(containerId);
            if (!container) return;

            tests.forEach(test => {
                const div = document.createElement('div');
                div.className = 'test-item';
                div.innerHTML = `
                    <div class="test-check" id="${test.id}" onclick="toggleTest('${test.id}')">
                        <i class="fa-solid fa-check text-white" style="display: none;"></i>
                    </div>
                    <span>${test.text}</span>
                `;
                container.appendChild(div);
            });
        }

        function toggleTest(testId) {
            const checkbox = document.getElementById(testId);
            const icon = checkbox.querySelector('i');
            
            if (checkbox.classList.contains('checked')) {
                checkbox.classList.remove('checked');
                icon.style.display = 'none';
            } else {
                checkbox.classList.add('checked');
                icon.style.display = 'block';
            }
            
            updateStats();
        }

        function updateStats() {
            const allTests = document.querySelectorAll('.test-check');
            const passedTests = document.querySelectorAll('.test-check.checked');
            
            const total = allTests.length;
            const passed = passedTests.length;
            const percentage = total > 0 ? (passed / total * 100).toFixed(0) : 0;
            
            document.getElementById('pass-count').textContent = passed;
            document.getElementById('total-count').textContent = total;
            document.getElementById('progress-bar').style.width = percentage + '%';
            
            const overallStatus = document.getElementById('overall-status');
            if (passed === total) {
                overallStatus.textContent = '全部通过 ✓';
                overallStatus.className = 'test-status status-pass';
            } else {
                overallStatus.textContent = `进度 ${percentage}%`;
                overallStatus.className = 'test-status status-pending';
            }
        }

        // 初始化
        detectDevice();
        renderTests();

        // 响应窗口大小变化
        window.addEventListener('resize', detectDevice);
    </script>
</body>
</html>