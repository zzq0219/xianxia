# ä»™ä¾ å¡ç‰ŒRPG - ä¸“ä¸šæœ¯è¯­è¯æ±‡è¡¨

> ğŸ“… ç”Ÿæˆæ—¥æœŸ: 2024-12-12
> ğŸ“… æ›´æ–°æ—¥æœŸ: 2024-12-13
> ğŸ”– ç‰ˆæœ¬: 1.1.0

---

## ç›®å½•

1. [æ¸¸æˆä¸–ç•Œè§‚æœ¯è¯­](#1-æ¸¸æˆä¸–ç•Œè§‚æœ¯è¯­)
2. [æ¸¸æˆç³»ç»Ÿæœ¯è¯­](#2-æ¸¸æˆç³»ç»Ÿæœ¯è¯­)
3. [æŠ€æœ¯æ¶æ„æœ¯è¯­](#3-æŠ€æœ¯æ¶æ„æœ¯è¯­)
4. [æ•°æ®ç±»å‹æœ¯è¯­](#4-æ•°æ®ç±»å‹æœ¯è¯­)
5. [APIä¸æœåŠ¡æœ¯è¯­](#5-apiä¸æœåŠ¡æœ¯è¯­)

---

## 1. æ¸¸æˆä¸–ç•Œè§‚æœ¯è¯­

### 1.1 ä¿®ç‚¼å¢ƒç•Œ (Realm)

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | æè¿° |
|------|----------|------|
| ç‚¼æ°”æœŸ | Qi Refining | ä¿®ç‚¼å…¥é—¨é˜¶æ®µï¼Œå¼€å§‹æ„ŸçŸ¥å¤©åœ°çµæ°” |
| ç­‘åŸºæœŸ | Foundation | ç­‘é€ ä¿®ç‚¼æ ¹åŸºï¼Œæ­£å¼è¸å…¥ä¿®ä»™ä¹‹è·¯ |
| é‡‘ä¸¹æœŸ | Golden Core | å‡ç»“é‡‘ä¸¹ï¼Œä¿®ä¸ºå¤§è¿› |
| å…ƒå©´æœŸ | Nascent Soul | å…ƒå©´å‡ºçªï¼Œå¯ç¥æ¸¸å¤©åœ° |
| åŒ–ç¥æœŸ | Spirit Severing | æ–©æ–­å‡¡å°˜ï¼Œç¥é€šå¹¿å¤§ |
| åˆä½“æœŸ | Body Integration | å¤©äººåˆä¸€ï¼Œæ¥è¿‘ä»™é“ |
| å¤§ä¹˜æœŸ | Mahayana | å¤§ä¹˜åœ†æ»¡ï¼Œæ¸¡åŠ«é£å‡åœ¨å³ |
| æ¸¡åŠ«æœŸ | Tribulation | æ¸¡è¿‡å¤©åŠ«ï¼Œå³å¯é£å‡ |

### 1.2 ç¨€æœ‰åº¦ (Rarity)

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | é¢œè‰²ä»£ç  | æè¿° |
|------|----------|----------|------|
| å‡¡å“ | Common | `#9CA3AF` (ç°è‰²) | æœ€æ™®é€šçš„å“è´¨ |
| è‰¯å“ | Uncommon | `#22C55E` (ç»¿è‰²) | ç•¥é«˜äºæ™®é€š |
| ä¼˜å“ | Rare | `#3B82F6` (è“è‰²) | è¾ƒä¸ºç¨€æœ‰ |
| çå“ | Epic | `#A855F7` (ç´«è‰²) | çè´µç¨€æœ‰ |
| ç»å“ | Legendary | `#F59E0B` (æ©™è‰²) | æå…¶ç¨€æœ‰ |
| ä»™å“ | Mythic | `#EC4899` (ç²‰è‰²) | ä»™çº§å“è´¨ |
| åœ£å“ | Sacred | `#EF4444` (çº¢è‰²) | åœ£çº§å“è´¨ |
| ç¥å“ | Divine | `#FFD700` (é‡‘è‰²) | æœ€é«˜å“è´¨ |

### 1.3 ä¸–ç•Œåœ°ç† (Locations)

| æœ¯è¯­ | ç±»å‹ | æ‰€å±ç•Œé¢ | æè¿° |
|------|------|----------|------|
| é’è›‡å®— | Sect | äººç•Œ | ç©å®¶èµ·å§‹å®—é—¨ï¼Œä¸­ç­‰è§„æ¨¡ä¿®ä»™å®—é—¨ |
| ç™¾èŠ±è°· | Sect | äººç•Œ | ä»¥åŒ»æœ¯å’Œä¸¹è¯é—»åçš„å¥³æ€§å®—é—¨ |
| å¤©æœºé˜ | City | äººç•Œ | ä¸­å·çš‡åŸï¼Œä¸–ç•Œçš„ä¸­å¿ƒ |
| æ˜†ä»‘å¢Ÿ | Mountain | å¤©ç•Œ | ä¼ è¯´ä¸­ä»™äººå±…ä½çš„åœ£å±± |
| å¤©å®« | Palace | å¤©ç•Œ | è¯¸å¤©ä»™ç¥çš„å±…æ‰€ |
| é•‡ç‹±å¤§ç‰¢ | Prison | å†¥ç•Œ | å…³æŠ¼ç½ªçŠ¯å’Œä¿˜è™çš„å·¨å‹ç›‘ç‹± |
| æ£®ç½—æ®¿ | Palace | å†¥ç•Œ | åœ°åºœé˜ç½—çš„è®®äº‹å¤§æ®¿ |
| è‚²çµè½© | Building | äººç•Œ | åŸ¹è‚²æ–°ç”Ÿå‘½çš„ç¥ç§˜åœºæ‰€ |
| ç¤¼ä»ªè®¾è®¡é¦† | Building | äººç•Œ | è®¾è®¡å’Œä¼ æˆç¤¼ä»ªè§„èŒƒçš„åœºæ‰€ |
| çº¢å°˜å½•é¦† | Building | äººç•Œ | æ‚¬èµä»»åŠ¡å‘å¸ƒå’Œè¿½è¸ªçš„åœºæ‰€ |

### 1.4 ç•Œé¢åˆ’åˆ† (Realm)

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | æè¿° |
|------|----------|------|
| å¤©ç•Œ | Celestial | ä»™äººå±…ä½ä¹‹åœ°ï¼Œçµæ°”æœ€ä¸ºæµ“éƒ |
| äººç•Œ | Mortal | å‡¡äººä¸ä¿®å£«æ··å±…çš„ä¸–ç•Œ |
| å†¥ç•Œ | Underworld | äº¡é­‚ä¸é­”é“ä¿®å£«çš„é¢†åŸŸ |

---

## 2. æ¸¸æˆç³»ç»Ÿæœ¯è¯­

### 2.1 æ ¸å¿ƒç³»ç»Ÿ

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | ä»£ç ä½ç½® | æè¿° |
|------|----------|----------|------|
| æ¢ç´¢ç³»ç»Ÿ | Exploration | `App.tsx` | ç©å®¶åœ¨ä¸–ç•Œä¸­æ¢ç´¢ã€è§¦å‘äº‹ä»¶çš„æ ¸å¿ƒç©æ³• |
| æˆ˜æ–—ç³»ç»Ÿ | Battle | `Battlefield.tsx` | å›åˆåˆ¶å¡ç‰Œæˆ˜æ–—ç³»ç»Ÿ |
| æŠ½å¡ç³»ç»Ÿ | Gacha | `Shop.tsx` | éšæœºè·å–è§’è‰²ã€è£…å¤‡ã€æŠ€èƒ½çš„ç³»ç»Ÿ |
| è®°å¿†ç³»ç»Ÿ | Memory | `MemoryModal.tsx` | è®°å½•æ¸¸æˆäº‹ä»¶ï¼Œæ”¯æŒAIä¸Šä¸‹æ–‡å¢å¼º |
| ç›‘ç‹±ç³»ç»Ÿ | Prison | `PrisonModal.tsx` | ç®¡ç†å›šçŠ¯ã€å®¡è®¯ã€åŠ³å½¹çš„ç³»ç»Ÿ |
| ç¤¼ä»ªç³»ç»Ÿ | Etiquette | `EtiquetteHallModal.tsx` | è®¾è®¡å’Œåˆ†å‘ç¤¼ä»ªè§„èŒƒçš„ç³»ç»Ÿ |
| åŸ¹è‚²ç³»ç»Ÿ | Cultivation | `CultivationModal.tsx` | èåˆä¸¤ä¸ªç”Ÿå‘½ä½“åˆ›é€ æ–°ç”Ÿå‘½ |
| åŒ»é¦†ç³»ç»Ÿ | Hospital | `HospitalModal.tsx` | è¯Šæ²»ç—…äººçš„ç³»ç»Ÿ |
| æ‚¬èµç³»ç»Ÿ | Bounty | `BountyBoardModal.tsx` | è¿½æ•æ‚¬èµç›®æ ‡çš„ç³»ç»Ÿ |
| ä¼ éŸ³ç³»ç»Ÿ | Telepathy | `TelepathyModal.tsx` | ä¸NPCè¿›è¡Œå¿ƒçµå¯¹è¯çš„ç³»ç»Ÿ |
| å…¬å‘Šç³»ç»Ÿ | Announcement | `AnnouncementModal.tsx` | å±•ç¤ºæ±Ÿæ¹–ä¼ é—»å’Œä¸–ç•Œäº‹ä»¶çš„ç³»ç»Ÿ |
| äººç‰©çŠ¶æ€ç³»ç»Ÿ | CharacterStatus | `CharacterStatusModal.tsx` | æŸ¥çœ‹æ‰€æœ‰è§’è‰²å½“å‰çŠ¶æ€å’Œå¿™ç¢Œæƒ…å†µ |
| æ—¥ç»“ç®—ç³»ç»Ÿ | DailySettlement | `App.tsx` | æ¯æ—¥äº§ä¸šæ”¶å…¥å’Œäº‹ä»¶ç»“ç®—çš„ç³»ç»Ÿ |
| å¿™ç¢Œè§’è‰²ç®¡ç† | BusyCharacterManagement | `App.tsx` | è¿½è¸ªå’Œç®¡ç†æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„è§’è‰² |

### 2.2 æˆ˜æ–—æœ¯è¯­

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | ç±»å‹å®šä¹‰ | æè¿° |
|------|----------|----------|------|
| æ°”è¡€ | HP | `Attributes.hp` | è§’è‰²ç”Ÿå‘½å€¼ |
| çœŸå…ƒ | MP | `Attributes.mp` | æŠ€èƒ½æ¶ˆè€—èµ„æº |
| æ”»å‡»åŠ› | Attack | `Attributes.attack` | åŸºç¡€ä¼¤å®³å€¼ |
| é˜²å¾¡åŠ› | Defense | `Attributes.defense` | ä¼¤å®³å‡å…å€¼ |
| é€Ÿåº¦ | Speed | `Attributes.speed` | è¡ŒåŠ¨é¡ºåºå†³å®šå› ç´  |
| æš´å‡»ç‡ | CritRate | `Attributes.critRate` | è§¦å‘æš´å‡»çš„æ¦‚ç‡ |
| æš´å‡»ä¼¤å®³ | CritDmg | `Attributes.critDmg` | æš´å‡»æ—¶çš„ä¼¤å®³å€ç‡ |
| çŠ¶æ€æ•ˆæœ | StatusEffect | `StatusEffect` | æŒç»­å½±å“è§’è‰²çš„buff/debuff |
| æˆ˜æ–—å‚ä¸è€… | BattleParticipant | `BattleParticipant` | æˆ˜æ–—ä¸­çš„è§’è‰²å®ä¾‹ |

### 2.3 å¡ç‰Œæœ¯è¯­

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | ç±»å‹å®šä¹‰ | æè¿° |
|------|----------|----------|------|
| è§’è‰²å¡ | CharacterCard | `CharacterCard` | å¯æˆ˜æ–—çš„è§’è‰²å•ä½ |
| æŠ€èƒ½å¡ | Skill | `Skill` | è§’è‰²å¯ä½¿ç”¨çš„æŠ€èƒ½ |
| è£…å¤‡å¡ | Equipment | `Equipment` | å¯è£…å¤‡çš„æ­¦å™¨/æŠ¤ç”²/é¥°å“ |
| å…½å® å¡ | PetCard | `PetCard` | å¯æºå¸¦çš„å® ç‰© |
| æ€§åˆ«é” | GenderLock | `GenderLock` | é™åˆ¶ä½¿ç”¨æ€§åˆ«çš„æ ‡è®° |

### 2.4 ç›‘ç‹±ç³»ç»Ÿæœ¯è¯­

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | ç±»å‹å®šä¹‰ | æè¿° |
|------|----------|----------|------|
| å›šçŠ¯ | Prisoner | `Prisoner` | è¢«å…³æŠ¼çš„è§’è‰² |
| ç›‘ç‹±åŒºåŸŸ | PrisonArea | `PrisonArea` | å±…ä½åŒº/å®¡è®¯åŒº/å¨±ä¹åŒº/åŠ³å½¹åŒº/ç®¡ç†åŒº/åŒ»ç–—åŒº |
| å±ˆæœåº¦ | SubmissionLevel | `Prisoner.submissionLevel` | å›šçŠ¯çš„æœä»ç¨‹åº¦ (0-100) |
| å½’é¡ºåº¦ | LoyaltyLevel | `Prisoner.loyaltyLevel` | å›šçŠ¯çš„å¿ è¯šç¨‹åº¦ (0-100)ï¼Œæ‹›å‹Ÿæ‰€éœ€ |
| å¥åº·åº¦ | Health | `Prisoner.health` | å›šçŠ¯çš„å¥åº·çŠ¶æ€ (0-100) |
| ç¥æ™º | Sanity | `Prisoner.sanity` | å›šçŠ¯çš„å¿ƒç†å¥åº· (0-100) |
| åŠ³å½¹ä½ | LaborSite | `LaborSite` | çŸ¿å±±/é‡‡è¯çš„åŠ³å½¹åœ°ç‚¹ |
| åŠ³å½¹å·¥äºº | LaborWorker | `LaborWorker` | åœ¨åŠ³å½¹ä½å·¥ä½œçš„å›šçŠ¯è®°å½• |
| å®¡è®¯ | Interrogation | `InterrogationModal` | å¯¹å›šçŠ¯è¿›è¡Œå®¡è®¯è·å–æƒ…æŠ¥ |
| å¯¹è¯ç±»å‹ | DialogueType | `DialogueType` | å¨èƒ/åŠè¯´/äº¤æ˜“/å¥—è¯/é—²èŠ/æ©æƒ /ç¾è¾± |
| å›šçŠ¯çŠ¶æ€ | PrisonerStatus | `PrisonerStatus` | å¥åº·/å—ä¼¤/ç”Ÿç—…/è™šå¼±/åŠ³å½¹ä¸­ç­‰ |
| ç‰¢æˆ¿ç±»å‹ | CellType | `CellType` | æ™®é€šç‰¢æˆ¿/é‡çŠ¯ç‰¢æˆ¿/å•ç‹¬å›šå®¤ |

### 2.5 ç¤¼ä»ªç³»ç»Ÿæœ¯è¯­

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | ç±»å‹å®šä¹‰ | æè¿° |
|------|----------|----------|------|
| è¯­è¨€é“å¾‹ | LanguageEtiquette | `LanguageEtiquette` | è¯­è¨€è§„èŒƒç¤¼ä»ª |
| è¡Œä¸ºç€è£…é“å¾‹ | BehaviorDressEtiquette | `BehaviorDressEtiquette` | è¡Œä¸ºå’Œç€è£…è§„èŒƒ |
| ç¤¼ä»ªåœºæ™¯ | EtiquetteScene | `EtiquetteScene` | é’æ¥¼/è§’æ–—åœº/ç‚¼ä¸¹æˆ¿ç­‰ |
| ç¤¼ä»ªè®¾è®¡å¸ˆ | EtiquetteDesigner | `EtiquetteDesigner` | è´Ÿè´£è®¾è®¡ç¤¼ä»ªçš„è§’è‰² |
| ä¸»é¢˜å‘¨ | WeeklyTheme | `WeeklyTheme` | ç‰¹å®šä¸»é¢˜çš„ç¤¼ä»ªæ´»åŠ¨å‘¨ |
| åˆ†å‘çŠ¶æ€ | DistributionStatus | `DistributionStatus` | æœªåˆ†å‘/å·²åˆ†å‘/å·²æ’¤å› |

---

## 3. æŠ€æœ¯æ¶æ„æœ¯è¯­

### 3.1 å‰ç«¯æ¶æ„

| æœ¯è¯­ | æè¿° | ç›¸å…³æ–‡ä»¶ |
|------|------|----------|
| ç»„ä»¶ (Component) | React å‡½æ•°ç»„ä»¶ï¼Œè´Ÿè´£UIæ¸²æŸ“ | `components/*.tsx` |
| é’©å­ (Hook) | React è‡ªå®šä¹‰Hookï¼Œå°è£…å¯å¤ç”¨é€»è¾‘ | `hooks/*.ts` |
| æœåŠ¡ (Service) | ä¸šåŠ¡é€»è¾‘å±‚ï¼Œå¤„ç†æ•°æ®å’ŒAPIè°ƒç”¨ | `services/*.ts` |
| ç±»å‹ (Type) | TypeScript ç±»å‹å®šä¹‰ | `types.ts`, `types/*.ts` |
| å¸¸é‡ (Constant) | é™æ€é…ç½®å’Œåˆå§‹æ•°æ® | `constants.ts` |

### 3.2 SillyTavern é›†æˆ

| æœ¯è¯­ | æè¿° | APIä½ç½® |
|------|------|---------|
| TavernHelper | SillyTavern æä¾›çš„è¾…åŠ©API | `window.TavernHelper` |
| ä¸–ç•Œä¹¦ (Worldbook) | SillyTavern çš„çŸ¥è¯†åº“ç³»ç»Ÿ | `TavernHelper.getWorldbookEntries()` |
| è§’è‰²å˜é‡ | ä¸è§’è‰²ç»‘å®šçš„æŒä¹…åŒ–å˜é‡ | `TavernHelper.getVariables({type: 'character'})` |
| ç”ŸæˆAPI | è°ƒç”¨AIç”Ÿæˆå†…å®¹çš„æ¥å£ | `TavernHelper.generate()` |
| iframeé€šä¿¡ | ä¸å®¿ä¸»é¡µé¢çš„æ¶ˆæ¯ä¼ é€’ | `postMessage` |

### 3.3 å­˜å‚¨ç³»ç»Ÿ

| æœ¯è¯­ | æè¿° | å®ç°ä½ç½® |
|------|------|----------|
| IndexedDB | æµè§ˆå™¨æœ¬åœ°æ•°æ®åº“ | `services/vectorStorageService.ts` |
| åŒé€‚é…å™¨æ¨¡å¼ | åŒæ—¶æ”¯æŒå¤šç§å­˜å‚¨åç«¯ | `services/storageService.ts` |
| å‘é‡å­˜å‚¨ | å­˜å‚¨æ–‡æœ¬çš„å‘é‡è¡¨ç¤º | `services/vectorStorageService.ts` |
| è®°å¿†å­˜å‚¨ | å­˜å‚¨æ¸¸æˆè®°å¿†æ¡ç›® | `services/memoryService.ts` |

### 3.4 AIç³»ç»Ÿ

| æœ¯è¯­ | æè¿° | å®ç°ä½ç½® |
|------|------|----------|
| ä¸Šä¸‹æ–‡æ„å»ºå™¨ | æ„å»ºAIç”Ÿæˆæ‰€éœ€çš„ä¸Šä¸‹æ–‡ | `services/aiContextBuilder.ts` |
| ä¸Šä¸‹æ–‡å¢å¼ºå™¨ | å¢å¼ºä¸Šä¸‹æ–‡ä»¥æé«˜ç”Ÿæˆè´¨é‡ | `services/aiContextEnhancer.ts` |
| å‘é‡åŒ–æœåŠ¡ | å°†æ–‡æœ¬è½¬æ¢ä¸ºå‘é‡ | `services/vectorService.ts` |
| è¯­ä¹‰æœç´¢ | åŸºäºå‘é‡ç›¸ä¼¼åº¦çš„æœç´¢ | `services/semanticSearchService.ts` |
| é‡æ’åºæœåŠ¡ | å¯¹æœç´¢ç»“æœè¿›è¡Œé‡æ’åº | `services/rerankerService.ts` |
| AIæ¶ˆæ¯æ•è· | è‡ªåŠ¨æ•è·å¹¶ä¿å­˜AIç”Ÿæˆçš„æ¶ˆæ¯åˆ°è®°å¿†ç³»ç»Ÿ | `services/aiMessageCapture.ts` |
| Embedding API | æ–‡æœ¬å‘é‡åŒ–çš„å¤–éƒ¨API | OpenAI/Ollama |
| Reranker API | ç»“æœé‡æ’åºçš„å¤–éƒ¨API | Jina/Cohere |

### 3.5 UIäº¤äº’ç³»ç»Ÿ

| æœ¯è¯­ | æè¿° | å®ç°ä½ç½® |
|------|------|----------|
| åº•éƒ¨å¯¼èˆªæ  | æ¸¸æˆä¸»è¦åŠŸèƒ½å…¥å£ï¼Œåˆ†ä¸ºä¸€çº§å’ŒäºŒçº§åŠŸèƒ½ | `components/BottomBar.tsx` |
| ä¸€çº§åŠŸèƒ½ | å§‹ç»ˆå¯è§çš„æ ¸å¿ƒåŠŸèƒ½æŒ‰é’®ï¼ˆæ¢ç´¢/é˜Ÿä¼/èƒŒåŒ…/æ´»åŠ¨/æ›´å¤šï¼‰ | `BottomBar.primaryActions` |
| äºŒçº§åŠŸèƒ½ | ç‚¹å‡»"æ›´å¤š"å±•å¼€çš„æ‰©å±•åŠŸèƒ½èœå• | `BottomBar.secondaryActions` |
| å“åº”å¼å¸ƒå±€ | æ ¹æ®å±å¹•å°ºå¯¸è‡ªåŠ¨è°ƒæ•´çš„ç•Œé¢å¸ƒå±€ | `hooks/useResponsiveLayout.ts` |
| æ¨¡æ€æ¡† | æµ®å±‚å¼¹çª—ï¼Œç”¨äºå±•ç¤ºåŠŸèƒ½ç•Œé¢ | `components/ResponsiveModal.tsx` |
| é¡¶éƒ¨çŠ¶æ€æ  | æ˜¾ç¤ºç©å®¶æ ¸å¿ƒä¿¡æ¯çš„é¡¶éƒ¨åŒºåŸŸ | `components/TopStatusBar.tsx` |

---

## 4. æ•°æ®ç±»å‹æœ¯è¯­

### 4.1 æ ¸å¿ƒç±»å‹

| ç±»å‹å | æ–‡ä»¶ä½ç½® | æè¿° |
|--------|----------|------|
| `GameState` | `types.ts:L1200+` | æ¸¸æˆå…¨å±€çŠ¶æ€ |
| `PlayerProfile` | `types.ts:L800+` | ç©å®¶æ¡£æ¡ˆä¿¡æ¯ |
| `CharacterCard` | `types.ts:L200+` | è§’è‰²å¡ç‰Œæ•°æ® |
| `Skill` | `types.ts:L100+` | æŠ€èƒ½æ•°æ® |
| `Equipment` | `types.ts:L150+` | è£…å¤‡æ•°æ® |
| `PetCard` | `types.ts:L250+` | å® ç‰©æ•°æ® |
| `BattleState` | `types.ts:L900+` | æˆ˜æ–—çŠ¶æ€ |
| `MemoryEntry` | `types.ts:L1000+` | è®°å¿†æ¡ç›® |

### 4.2 æšä¸¾ç±»å‹

| ç±»å‹å | å¯é€‰å€¼ | æè¿° |
|--------|--------|------|
| `Rarity` | å‡¡å“/è‰¯å“/ä¼˜å“/çå“/ç»å“/ä»™å“/åœ£å“/ç¥å“ | ç¨€æœ‰åº¦ç­‰çº§ |
| `GenderLock` | Male/Female/Universal | æ€§åˆ«é™åˆ¶ |
| `EquipmentType` | Weapon/Armor/Accessory | è£…å¤‡ç±»å‹ |
| `MemoryCategory` | æ¢ç´¢/æˆ˜æ–—/å•†åŸ/åŒ»é¦†/æ‚¬èµ/åŸ¹è‚²/å•†ä¸š/å£°æœ›/å…¬å‘Š/å¤§ç‰¢/å…¶ä»– | è®°å¿†åˆ†ç±» |
| `PrisonArea` | å±…ä½åŒº/å®¡è®¯åŒº/å¨±ä¹åŒº/åŠ³å½¹åŒº/ç®¡ç†åŒº/åŒ»ç–—åŒº | ç›‘ç‹±åŒºåŸŸ |
| `DialogueType` | å¨èƒ/åŠè¯´/äº¤æ˜“/å¥—è¯/é—²èŠ/æ©æƒ /ç¾è¾± | å¯¹è¯ç±»å‹ |
| `LaborSiteType` | çŸ¿å±±/é‡‡è¯ | åŠ³å½¹åœ°ç‚¹ç±»å‹ |
| `PrisonerStatus` | å¥åº·/å—ä¼¤/ç”Ÿç—…/è™šå¼±/åŠ³å½¹ä¸­/å®¡è®¯ä¸­ | å›šçŠ¯çŠ¶æ€ |
| `CellType` | æ™®é€šç‰¢æˆ¿/é‡çŠ¯ç‰¢æˆ¿/å•ç‹¬å›šå®¤ | ç‰¢æˆ¿ç±»å‹ |

### 4.3 æ¥å£ç±»å‹

| æ¥å£å | ä¸»è¦å­—æ®µ | æè¿° |
|--------|----------|------|
| `Attributes` | hp, mp, attack, defense, speed, critRate, critDmg | è§’è‰²å±æ€§ |
| `StatusEffect` | name, description, mechanicsDescription, duration | çŠ¶æ€æ•ˆæœ |
| `BattleParticipant` | card, currentHp, currentMp, statusEffects, calculatedStats | æˆ˜æ–—å‚ä¸è€… |
| `VectorConfig` | enabled, apiUrl, apiKey, model, similarityThreshold | å‘é‡é…ç½® |
| `EtiquetteSystem` | designer, languageEtiquettes, behaviorDressEtiquettes, settings | ç¤¼ä»ªç³»ç»Ÿ |

---

## 5. APIä¸æœåŠ¡æœ¯è¯­

### 5.1 TavernHelper API

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | æè¿° |
|------|------|--------|------|
| `getVariables` | `{type: 'character'\|'chat'}` | `object` | è·å–å˜é‡ |
| `updateVariablesWith` | `(updater, options)` | `Promise<void>` | æ›´æ–°å˜é‡ |
| `generate` | `(prompt, options)` | `Promise<string>` | AIç”Ÿæˆ |
| `getWorldbookEntries` | `(worldbookName)` | `WorldbookEntry[]` | è·å–ä¸–ç•Œä¹¦æ¡ç›® |
| `createWorldbook` | `(name, entries)` | `Promise<void>` | åˆ›å»ºä¸–ç•Œä¹¦ |
| `getWorldbookNames` | - | `string[]` | è·å–ä¸–ç•Œä¹¦åˆ—è¡¨ |

### 5.2 å‘é‡æœåŠ¡API

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | æè¿° |
|------|------|--------|------|
| `vectorize` | `text: string` | `Promise<number[]>` | å•æ–‡æœ¬å‘é‡åŒ– |
| `batchVectorize` | `texts: string[]` | `Promise<number[][]>` | æ‰¹é‡å‘é‡åŒ– |
| `cosineSimilarity` | `vecA, vecB` | `number` | è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦ |
| `testConnection` | - | `Promise<{success, error?}>` | æµ‹è¯•APIè¿æ¥ |
| `fetchAvailableModels` | - | `Promise<{models?}>` | è·å–å¯ç”¨æ¨¡å‹ |

### 5.3 æ¸¸æˆæœåŠ¡API

| æ–¹æ³• | æ–‡ä»¶ | æè¿° |
|------|------|------|
| `generateExplorationStep` | `tavernService.ts` | ç”Ÿæˆæ¢ç´¢æ­¥éª¤ |
| `processCombatTurn` | `tavernService.ts` | å¤„ç†æˆ˜æ–—å›åˆ |
| `generateRandomCharacter` | `tavernService.ts` | ç”Ÿæˆéšæœºè§’è‰² |
| `generatePatient` | `tavernService.ts` | ç”ŸæˆåŒ»é¦†ç—…äºº |
| `generateBountyTarget` | `tavernService.ts` | ç”Ÿæˆæ‚¬èµç›®æ ‡ |
| `generateLaborResult` | `tavernService.ts` | ç”ŸæˆåŠ³å½¹ç»“æœ |
| `saveGameToSlot` | `tavernService.ts` | ä¿å­˜æ¸¸æˆ |
| `loadGameFromSlot` | `tavernService.ts` | åŠ è½½æ¸¸æˆ |

---

## é™„å½•ï¼šæœ¯è¯­å¯¹ç…§è¡¨

### ä¸­è‹±æ–‡å¯¹ç…§

| ä¸­æ–‡ | è‹±æ–‡ | ä»£ç æ ‡è¯† |
|------|------|----------|
| æ°”è¡€ | Health Points | `hp` |
| çœŸå…ƒ | Mana Points | `mp` |
| æ”»å‡»åŠ› | Attack | `attack` |
| é˜²å¾¡åŠ› | Defense | `defense` |
| é€Ÿåº¦ | Speed | `speed` |
| æš´å‡»ç‡ | Critical Rate | `critRate` |
| æš´å‡»ä¼¤å®³ | Critical Damage | `critDmg` |
| é­…åŠ› | Charm | `charm` |
| æŠ€å·§ | Skillfulness | `skillfulness` |
| æ‚Ÿæ€§ | Perception | `perception` |
| çµçŸ³ | Spirit Stones | `spiritStones` |
| å£°æœ› | Reputation | `reputation` |
| å¢ƒç•Œ | Realm | `realm` |
| ç¨€æœ‰åº¦ | Rarity | `rarity` |
| ç§°å· | Title | `title` |
| ç§æ— | Race | `race` |
| æ¥å† | Origin | `origin` |
| å¤–è§‚ | Appearance | `appearance` |

### ç¼©å†™å¯¹ç…§

| ç¼©å†™ | å…¨ç§° | æè¿° |
|------|------|------|
| HP | Health Points | ç”Ÿå‘½å€¼ |
| MP | Mana Points | é­”æ³•å€¼/çœŸå…ƒ |
| ATK | Attack | æ”»å‡»åŠ› |
| DEF | Defense | é˜²å¾¡åŠ› |
| SPD | Speed | é€Ÿåº¦ |
| CRIT | Critical | æš´å‡» |
| DMG | Damage | ä¼¤å®³ |
| AI | Artificial Intelligence | äººå·¥æ™ºèƒ½ |
| API | Application Programming Interface | åº”ç”¨ç¨‹åºæ¥å£ |
| DB | Database | æ•°æ®åº“ |
| UI | User Interface | ç”¨æˆ·ç•Œé¢ |
| NPC | Non-Player Character | éç©å®¶è§’è‰² |
| PVP | Player vs Player | ç©å®¶å¯¹æˆ˜ |

---

## 6. åŠŸèƒ½æ¨¡å—æœ¯è¯­

### 6.1 äºŒçº§åŠŸèƒ½æ¨¡å—

ä»¥ä¸‹æ˜¯é€šè¿‡"æ›´å¤š"èœå•è®¿é—®çš„äºŒçº§åŠŸèƒ½æ¨¡å—æœ¯è¯­ï¼š

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | å›¾æ ‡ | æè¿° |
|------|----------|------|------|
| ä¼ éŸ³ | Telepathy | `fa-om` | ä¸NPCè¿›è¡Œå¿ƒçµå¯¹è¯ï¼Œè·å–ä¿¡æ¯æˆ–å»ºç«‹å…³ç³» |
| è‚²çµè½© | Cultivation Pavilion | `fa-dna` | é€‰æ‹©ä¸¤ä¸ªç”Ÿå‘½ä½“è¿›è¡ŒåŸ¹è‚²ï¼Œåˆ›é€ æ–°ç”Ÿå‘½ |
| çº¢å°˜å½• | Bounty Board | `fa-book-skull` | æ‚¬èµä»»åŠ¡ç³»ç»Ÿï¼Œè¿½æ•ç›®æ ‡è·å–å¥–åŠ± |
| ç¤¼ä»ªè®¾è®¡é¦† | Etiquette Hall | `fa-ribbon` | è®¾è®¡å’Œç®¡ç†è§’è‰²ç¤¼ä»ªè§„èŒƒçš„åœºæ‰€ |
| æ±Ÿæ¹–ä¼ é—» | Announcements | `fa-bullhorn` | æŸ¥çœ‹å®—é—¨ã€å¥‡é‡ã€ä¸–ç•Œä¸‰ç±»å…¬å‘Š |
| äººç‰©çŠ¶æ€ | Character Status | `fa-users-viewfinder` | æŸ¥çœ‹æ‰€æœ‰è§’è‰²çš„å½“å‰çŠ¶æ€å’Œä»»åŠ¡åˆ†é… |
| äº§ä¸š | Business District | `fa-building` | ç®¡ç†å•†ä¸šåŒºã€åº—é“ºå’Œå‘˜å·¥ |
| åŒ»é¦† | Hospital | `fa-hospital` | ä¸ºç—…æ‚£è¯Šæ–­æ²»ç–—ï¼Œè·å–æŠ¥é…¬å’Œå£°æœ› |
| é•‡ç‹±å¤§ç‰¢ | Prison | `fa-dungeon` | ç®¡ç†å›šçŠ¯ã€å®¡è®¯ã€åŠ³å½¹å’Œæ‹›å‹Ÿ |

### 6.2 è§’è‰²çŠ¶æ€æ ‡è®°

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | æè¿° |
|------|----------|------|
| å¿™ç¢Œè§’è‰² | BusyCharacter | æ­£åœ¨æ‰§è¡Œä»»åŠ¡æ— æ³•è¢«åˆ†é…çš„è§’è‰² |
| è¿½è¸ªä¸­ | Tracking | è§’è‰²æ­£åœ¨è¿½è¸ªæ‚¬èµç›®æ ‡ |
| åŸ¹è‚²ä¸­ | Breeding | è§’è‰²æ­£åœ¨è‚²çµè½©è¿›è¡ŒåŸ¹è‚² |
| å·¥ä½œä¸­ | Working | è§’è‰²æ­£åœ¨å•†ä¸šåŒºåº—é“ºå·¥ä½œ |
| è®¾è®¡ä¸­ | Designing | è§’è‰²æ­£åœ¨ç¤¼ä»ªè®¾è®¡é¦†æ‹…ä»»è®¾è®¡å¸ˆ |
| ç©ºé—² | Idle | è§’è‰²å¯è¢«åˆ†é…æ–°ä»»åŠ¡ |

### 6.3 æ‚¬èµç³»ç»Ÿæµç¨‹æœ¯è¯­

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | æè¿° |
|------|----------|------|
| æ‚¬èµä¸­ | Active | æ‚¬èµä»»åŠ¡å¯è¢«æ¥å– |
| è¿½è¸ªä¸­ | Tracking | å·²æ´¾é£è§’è‰²è¿½è¸ªç›®æ ‡ |
| å·²å®Œæˆ | Completed | ç›®æ ‡å·²è¢«æ•è·ï¼Œå¯é¢†å–ç»“æœ |
| å·²ç»“æŸ | Finished | æ‚¬èµå·²å¤„ç†å®Œæ¯•ï¼ˆå‡»æ€æˆ–æŠ¼å…¥å¤§ç‰¢ï¼‰ |
| è¿½è¸ªæ—¥å¿— | TrackingLog | AIç”Ÿæˆçš„è¿½æ•è¿‡ç¨‹æè¿° |

### 6.4 åŸ¹è‚²ç³»ç»Ÿæµç¨‹æœ¯è¯­

| æœ¯è¯­ | è‹±æ–‡æ ‡è¯† | æè¿° |
|------|----------|------|
| ç©ºé—² | Empty | åŸ¹è‚²ä»“å¯ç”¨ |
| åŸ¹è‚²ä¸­ | Breeding | æ­£åœ¨è¿›è¡ŒåŸ¹è‚² |
| å·²å®Œæˆ | Ready | åŸ¹è‚²å®Œæˆï¼Œå¯é¢†å–ç»“æœ |
| çˆ¶æ¯ | Parents | å‚ä¸åŸ¹è‚²çš„ä¸¤ä¸ªç”Ÿå‘½ä½“ |
| çµèƒ | Offspring | åŸ¹è‚²äº§ç”Ÿçš„æ–°ç”Ÿå‘½ |
| ç›‘è§†æ—¥å¿— | MonitoringLog | åŸ¹è‚²è¿‡ç¨‹çš„å®æ—¶çŠ¶æ€è®°å½• |

---

> ğŸ“ **æ–‡æ¡£è¯´æ˜**: æœ¬è¯æ±‡è¡¨æ¶µç›–äº†ä»™ä¾ å¡ç‰ŒRPGé¡¹ç›®ä¸­çš„æ ¸å¿ƒæœ¯è¯­ï¼ŒåŒ…æ‹¬æ¸¸æˆä¸–ç•Œè§‚ã€ç³»ç»Ÿæœºåˆ¶ã€æŠ€æœ¯æ¶æ„å’Œæ•°æ®ç±»å‹ã€‚å»ºè®®åœ¨å¼€å‘å’Œç»´æŠ¤è¿‡ç¨‹ä¸­å‚è€ƒæ­¤æ–‡æ¡£ä»¥ä¿æŒæœ¯è¯­ä¸€è‡´æ€§ã€‚