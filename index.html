<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>仙侠卡牌RPG</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+XiaoWei&family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
    /* ================================
       阴阳师风格 CSS 变量系统
       ================================ */
    :root {
        /* 主色调 - 深紫墨色背景 */
        --onmyoji-bg-primary: #0a0612;
        --onmyoji-bg-secondary: #120c1a;
        --onmyoji-bg-tertiary: #1a1225;
        
        /* 金色系 - 主要装饰色 */
        --onmyoji-gold-light: #ffd700;
        --onmyoji-gold: #d4a84b;
        --onmyoji-gold-dark: #a07830;
        --onmyoji-gold-glow: rgba(212, 168, 75, 0.6);
        
        /* 朱红色系 - 强调色 */
        --onmyoji-red: #c73333;
        --onmyoji-red-light: #e85a5a;
        --onmyoji-red-dark: #8b2323;
        --onmyoji-red-glow: rgba(199, 51, 51, 0.5);
        
        /* 神秘紫色系 */
        --onmyoji-purple: #7b5ea7;
        --onmyoji-purple-light: #a68cd9;
        --onmyoji-purple-dark: #4a3875;
        --onmyoji-purple-glow: rgba(123, 94, 167, 0.5);
        
        /* 灵气蓝色系 */
        --onmyoji-blue: #4a9eff;
        --onmyoji-blue-light: #7bb8ff;
        --onmyoji-blue-dark: #2a6ecc;
        --onmyoji-blue-glow: rgba(74, 158, 255, 0.5);
        
        /* 鬼火绿色系 */
        --onmyoji-ghost: #3dd9a0;
        --onmyoji-ghost-glow: rgba(61, 217, 160, 0.5);
        
        /* 边框和分隔线 */
        --onmyoji-border-gold: linear-gradient(135deg, #d4a84b 0%, #ffd700 50%, #d4a84b 100%);
        --onmyoji-border-subtle: rgba(212, 168, 75, 0.2);
        
        /* 文字颜色 */
        --onmyoji-text-primary: #e8e0d0;
        --onmyoji-text-secondary: #a89880;
        --onmyoji-text-gold: #d4a84b;
    }

    /* 固定尺寸布局 - 540px × 960px */
    html {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
        background-color: var(--onmyoji-bg-primary);
        overflow-y: auto;
    }
    
    body {
        margin: 0;
        padding: 0;
        width: 540px;
        height: 960px;
        background-image: url('https://github.com/zzq0219/sillytavern/blob/main/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E4%BA%91%E9%9B%BE-%E4%BB%99%E4%BE%A0.png?raw=true');
        background-size: cover;
        background-position: center;
        background-attachment: scroll;
        background-color: var(--onmyoji-bg-primary);
        overflow: hidden;
        position: relative;
        box-shadow: 0 0 60px rgba(212, 168, 75, 0.15), 0 0 100px rgba(0, 0, 0, 0.8);
    }

    /* 固定尺寸根容器 */
    #root {
        width: 540px;
        height: 960px;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    /* 优化触控体验 */
    * {
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
    }

    button, a {
        -webkit-user-select: none;
        -moz-user-select: none;
             user-select: none;
    }

    /* 优化文本排版 */
    .prose {
        --tw-prose-body: var(--onmyoji-text-primary);
        --tw-prose-headings: var(--onmyoji-gold);
        --tw-prose-invert-body: var(--onmyoji-text-primary);
        --tw-prose-invert-headings: var(--onmyoji-gold);
        line-height: 1.8;
        letter-spacing: 0.02em;
    }

    /* ================================
       阴阳师风格滚动条
       ================================ */
    ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }
    ::-webkit-scrollbar-track {
        background: rgba(26, 18, 37, 0.8);
        border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, var(--onmyoji-gold) 0%, var(--onmyoji-gold-dark) 100%);
        border-radius: 3px;
        box-shadow: 0 0 6px var(--onmyoji-gold-glow);
    }
    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, var(--onmyoji-gold-light) 0%, var(--onmyoji-gold) 100%);
        box-shadow: 0 0 10px var(--onmyoji-gold-glow);
    }

    /* 仙侠风格滚动条 */
    .scrollbar-xianxia::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }
    .scrollbar-xianxia::-webkit-scrollbar-track {
        background: rgba(26, 18, 37, 0.6);
        border-radius: 4px;
        margin: 4px;
    }
    .scrollbar-xianxia::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, var(--onmyoji-gold) 0%, var(--onmyoji-gold-dark) 100%);
        border-radius: 4px;
        border: 2px solid rgba(26, 18, 37, 0.5);
        box-shadow: 0 0 8px var(--onmyoji-gold-glow);
    }
    .scrollbar-xianxia::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, var(--onmyoji-gold-light) 0%, var(--onmyoji-gold) 100%);
        box-shadow: 0 0 12px var(--onmyoji-gold-glow);
    }

    /* ================================
       阴阳师风格文字效果
       ================================ */
    .text-shadow-glow {
        text-shadow: 0 0 10px var(--onmyoji-gold-glow), 0 0 20px rgba(212, 168, 75, 0.3), 0 0 30px rgba(212, 168, 75, 0.1);
    }
    .text-shadow-sm {
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
    }
    .text-shadow-red {
        text-shadow: 0 0 10px var(--onmyoji-red-glow), 0 0 20px rgba(199, 51, 51, 0.3);
    }
    .text-shadow-purple {
        text-shadow: 0 0 10px var(--onmyoji-purple-glow), 0 0 20px rgba(123, 94, 167, 0.3);
    }
    .text-shadow-ghost {
        text-shadow: 0 0 10px var(--onmyoji-ghost-glow), 0 0 20px rgba(61, 217, 160, 0.3);
    }

    /* 阴阳师金色渐变文字 */
    .text-gradient-gold {
        background: linear-gradient(180deg, #ffd700 0%, var(--onmyoji-gold) 50%, var(--onmyoji-gold-dark) 100%);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        -webkit-text-fill-color: transparent;
        display: inline-block;
        filter: drop-shadow(0 0 8px var(--onmyoji-gold-glow));
    }

    /* 阴阳师朱红渐变文字 */
    .text-gradient-red {
        background: linear-gradient(180deg, var(--onmyoji-red-light) 0%, var(--onmyoji-red) 50%, var(--onmyoji-red-dark) 100%);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        -webkit-text-fill-color: transparent;
        display: inline-block;
    }

    /* ================================
       阴阳师风格动画
       ================================ */
    
    /* 鬼火飘动动画 */
    @keyframes ghost-fire {
        0%, 100% {
            opacity: 0.6;
            transform: translateY(0) scale(1);
            filter: blur(0px);
        }
        25% {
            opacity: 0.9;
            transform: translateY(-5px) scale(1.1);
            filter: blur(1px);
        }
        50% {
            opacity: 0.7;
            transform: translateY(-10px) scale(0.95);
            filter: blur(0.5px);
        }
        75% {
            opacity: 1;
            transform: translateY(-3px) scale(1.05);
            filter: blur(0px);
        }
    }

    /* 樱花飘落动画 */
    @keyframes sakura-fall {
        0% {
            transform: translateY(-10px) rotate(0deg) translateX(0);
            opacity: 0;
        }
        10% {
            opacity: 1;
        }
        90% {
            opacity: 1;
        }
        100% {
            transform: translateY(100vh) rotate(720deg) translateX(50px);
            opacity: 0;
        }
    }

    /* 勾玉旋转动画 */
    @keyframes magatama-spin {
        0% {
            transform: rotate(0deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }

    /* 神秘光晕脉动 */
    @keyframes mystic-pulse {
        0%, 100% {
            box-shadow: 0 0 15px var(--onmyoji-gold-glow), 
                        0 0 30px rgba(212, 168, 75, 0.2),
                        inset 0 0 10px rgba(212, 168, 75, 0.1);
        }
        50% {
            box-shadow: 0 0 25px var(--onmyoji-gold-glow), 
                        0 0 50px rgba(212, 168, 75, 0.3),
                        inset 0 0 20px rgba(212, 168, 75, 0.15);
        }
    }

    /* 式神召唤光效 */
    @keyframes summon-glow {
        0% {
            opacity: 0;
            transform: scale(0.5);
            filter: blur(10px);
        }
        50% {
            opacity: 1;
            filter: blur(5px);
        }
        100% {
            opacity: 0;
            transform: scale(2);
            filter: blur(15px);
        }
    }

    /* 墨水晕染效果 */
    @keyframes ink-spread {
        0% {
            clip-path: circle(0% at 50% 50%);
            opacity: 0;
        }
        50% {
            opacity: 1;
        }
        100% {
            clip-path: circle(100% at 50% 50%);
            opacity: 1;
        }
    }

    /* 浮动动画 */
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    /* 滑入动画 */
    @keyframes slide-up {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* 淡入动画 */
    @keyframes fade-in {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    /* 按钮反馈 */
    @keyframes button-press {
        0% { transform: scale(1); }
        50% { transform: scale(0.95); }
        100% { transform: scale(1); }
    }

    /* 动画类 */
    .animate-ghost-fire {
        animation: ghost-fire 3s ease-in-out infinite;
    }
    .animate-mystic-pulse {
        animation: mystic-pulse 2s ease-in-out infinite;
    }
    .animate-float {
        animation: float 3s ease-in-out infinite;
    }
    .animate-slide-up {
        animation: slide-up 0.5s ease-out forwards;
    }
    .animate-fade-in {
        animation: fade-in 0.5s ease-out forwards;
    }
    .animate-pulse-glow {
        animation: pulse-glow 2s ease-in-out infinite;
    }

    /* 焦点优化 */
    :focus-visible {
        outline: 2px solid var(--onmyoji-gold);
        outline-offset: 2px;
        border-radius: 4px;
        box-shadow: 0 0 15px var(--onmyoji-gold-glow);
    }

    /* ================================
       阴阳师风格边框装饰
       ================================ */
    
    /* 和风卷轴边框 */
    .ornate-border {
        border: 10px solid;
        border-image-slice: 40 42;
        border-image-width: 15px;
        border-image-outset: 0;
        border-image-repeat: stretch;
        border-image-source: url('https://i.imgur.com/z4b2r4j.png');
        position: relative;
    }

    /* 阴阳师金色边框 */
    .onmyoji-border {
        border: 1px solid transparent;
        background-image: linear-gradient(var(--onmyoji-bg-secondary), var(--onmyoji-bg-secondary)), 
                          linear-gradient(135deg, var(--onmyoji-gold-dark) 0%, var(--onmyoji-gold-light) 50%, var(--onmyoji-gold-dark) 100%);
        background-origin: border-box;
        background-clip: padding-box, border-box;
        box-shadow: 0 0 15px rgba(212, 168, 75, 0.2), inset 0 0 10px rgba(0, 0, 0, 0.5);
    }

    /* 阴阳师角落装饰 */
    .onmyoji-corners {
        position: relative;
    }
    .onmyoji-corners::before,
    .onmyoji-corners::after {
        content: '';
        position: absolute;
        width: 20px;
        height: 20px;
        border: 2px solid var(--onmyoji-gold);
        pointer-events: none;
    }
    .onmyoji-corners::before {
        top: -1px;
        left: -1px;
        border-right: none;
        border-bottom: none;
    }
    .onmyoji-corners::after {
        bottom: -1px;
        right: -1px;
        border-left: none;
        border-top: none;
    }

    /* 和纸卷轴容器 */
    .scroll-container {
        background-image: url('https://www.transparenttextures.com/patterns/old-paper-2.png'), 
                          linear-gradient(to bottom, #f5eadd, #d8c9b3);
        background-color: #e4d8c5;
        color: #402e1a;
        border: 2px solid var(--onmyoji-gold-dark);
        box-shadow: 0 5px 20px rgba(0,0,0,0.6), 0 0 30px rgba(212, 168, 75, 0.1);
        padding: 1rem 2rem;
        border-radius: 2px;
    }
    .scroll-container .prose {
        --tw-prose-body: #5c452b;
        --tw-prose-headings: #8c6a48;
    }

    /* 彩虹文字 */
    .text-rainbow {
        background-image: linear-gradient(to right, #f87171, #fb923c, #facc15, #4ade80, #38bdf8, #a78bfa, #f472b6);
        background-size: 200% auto;
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        animation: rainbow-flow 3s linear infinite;
    }
    @keyframes rainbow-flow {
        to {
            background-position: 200% center;
        }
    }

    /* ================================
       阴阳师风格毛玻璃效果
       ================================ */
    .backdrop-blur-sm {
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
    }
    .backdrop-blur-md {
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
    }
    .backdrop-blur-onmyoji {
        backdrop-filter: blur(16px) saturate(180%);
        -webkit-backdrop-filter: blur(16px) saturate(180%);
        background: linear-gradient(135deg, rgba(26, 18, 37, 0.9) 0%, rgba(10, 6, 18, 0.95) 100%);
    }

    /* ================================
       阴阳师风格阴影
       ================================ */
    .shadow-card {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .shadow-card-hover {
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25), 0 4px 8px rgba(0, 0, 0, 0.15);
    }
    .shadow-onmyoji {
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5), 
                    0 0 40px rgba(212, 168, 75, 0.1),
                    inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    .shadow-onmyoji-glow {
        box-shadow: 0 0 20px var(--onmyoji-gold-glow), 
                    0 0 40px rgba(212, 168, 75, 0.2),
                    0 4px 20px rgba(0, 0, 0, 0.5);
    }

    /* 加载动画优化 */
    @keyframes pulse-glow {
        0%, 100% {
            opacity: 1;
            box-shadow: 0 0 0 0 var(--onmyoji-gold-glow);
        }
        50% {
            opacity: 0.8;
            box-shadow: 0 0 0 15px rgba(212, 168, 75, 0);
        }
    }

    /* ================================
       阴阳师风格按钮
       ================================ */
    .btn-onmyoji {
        background: linear-gradient(135deg, var(--onmyoji-bg-tertiary) 0%, var(--onmyoji-bg-secondary) 100%);
        border: 1px solid var(--onmyoji-gold-dark);
        color: var(--onmyoji-text-gold);
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    .btn-onmyoji::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(212, 168, 75, 0.2), transparent);
        transition: left 0.5s ease;
    }
    .btn-onmyoji:hover::before {
        left: 100%;
    }
    .btn-onmyoji:hover {
        border-color: var(--onmyoji-gold);
        box-shadow: 0 0 20px var(--onmyoji-gold-glow);
        transform: translateY(-2px);
    }
    .btn-onmyoji:active {
        transform: translateY(0) scale(0.98);
    }

    /* 阴阳师主按钮（金色） */
    .btn-onmyoji-primary {
        background: linear-gradient(135deg, var(--onmyoji-gold-dark) 0%, var(--onmyoji-gold) 50%, var(--onmyoji-gold-dark) 100%);
        border: 1px solid var(--onmyoji-gold-light);
        color: #1a1225;
        font-weight: bold;
        text-shadow: 0 1px 0 rgba(255, 255, 255, 0.3);
    }
    .btn-onmyoji-primary:hover {
        background: linear-gradient(135deg, var(--onmyoji-gold) 0%, var(--onmyoji-gold-light) 50%, var(--onmyoji-gold) 100%);
        box-shadow: 0 0 30px var(--onmyoji-gold-glow), 0 0 60px rgba(212, 168, 75, 0.3);
    }

    /* 阴阳师危险按钮（朱红） */
    .btn-onmyoji-danger {
        background: linear-gradient(135deg, var(--onmyoji-red-dark) 0%, var(--onmyoji-red) 50%, var(--onmyoji-red-dark) 100%);
        border: 1px solid var(--onmyoji-red-light);
        color: #fff;
    }
    .btn-onmyoji-danger:hover {
        box-shadow: 0 0 20px var(--onmyoji-red-glow);
    }

    /* ================================
       阴阳师风格卡片
       ================================ */
    .card-onmyoji {
        background: linear-gradient(180deg, rgba(26, 18, 37, 0.95) 0%, rgba(10, 6, 18, 0.98) 100%);
        border: 1px solid var(--onmyoji-border-subtle);
        border-radius: 8px;
        position: relative;
        overflow: hidden;
    }
    .card-onmyoji::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--onmyoji-gold), transparent);
        opacity: 0.5;
    }

    /* ================================
       阴阳师风格图标容器
       ================================ */
    .icon-onmyoji {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(circle at center, rgba(26, 18, 37, 0.8) 0%, rgba(10, 6, 18, 0.95) 100%);
        border: 1px solid var(--onmyoji-border-subtle);
        border-radius: 12px;
        transition: all 0.3s ease;
    }
    .icon-onmyoji::after {
        content: '';
        position: absolute;
        inset: -2px;
        border-radius: 14px;
        background: linear-gradient(135deg, var(--onmyoji-gold-dark), transparent, var(--onmyoji-gold-dark));
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }
    .icon-onmyoji:hover::after {
        opacity: 1;
    }
    .icon-onmyoji:hover {
        box-shadow: 0 0 20px var(--onmyoji-gold-glow);
        transform: translateY(-2px);
    }

    /* ================================
       阴阳师装饰元素
       ================================ */
    
    /* 云纹装饰 */
    .deco-cloud {
        position: absolute;
        opacity: 0.1;
        pointer-events: none;
    }
    
    /* 勾玉装饰 */
    .deco-magatama {
        width: 20px;
        height: 20px;
        border-radius: 50% 50% 50% 0;
        background: var(--onmyoji-gold);
        transform: rotate(-45deg);
        position: relative;
    }
    .deco-magatama::after {
        content: '';
        position: absolute;
        width: 6px;
        height: 6px;
        background: var(--onmyoji-bg-primary);
        border-radius: 50%;
        top: 4px;
        left: 4px;
    }

    /* 分隔线装饰 */
    .divider-onmyoji {
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--onmyoji-gold), transparent);
        position: relative;
    }
    .divider-onmyoji::before,
    .divider-onmyoji::after {
        content: '◆';
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        color: var(--onmyoji-gold);
        font-size: 8px;
    }
    .divider-onmyoji::before { left: 20%; }
    .divider-onmyoji::after { right: 20%; }

    /* 响应式字体大小 */
    @media (max-width: 640px) {
        html {
            font-size: 14px;
        }
    }

    @media (max-width: 480px) {
        html {
            font-size: 12px;
        }
    }

    /* 触摸目标最小尺寸 */
    @media (max-width: 768px) {
        button, a, .interactive {
            min-width: 44px;
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
    }

    /* 隐藏滚动条但保持可滚动 */
    .scrollbar-none {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
    .scrollbar-none::-webkit-scrollbar {
        display: none;
    }
</style>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.28.0"
  }
}
</script>
  <script type="module" crossorigin>(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function r(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(c){if(c.ep)return;c.ep=!0;const d=r(c);fetch(c.href,d)}})();function hh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Od={exports:{}},Pl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx;function ug(){if(Kx)return Pl;Kx=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function r(o,c,d){var m=null;if(d!==void 0&&(m=""+d),c.key!==void 0&&(m=""+c.key),"key"in c){d={};for(var f in c)f!=="key"&&(d[f]=c[f])}else d=c;return c=d.ref,{$$typeof:n,type:o,key:m,ref:c!==void 0?c:null,props:d}}return Pl.Fragment=a,Pl.jsx=r,Pl.jsxs=r,Pl}var Wx;function mg(){return Wx||(Wx=1,Od.exports=ug()),Od.exports}var e=mg(),Rd={exports:{}},_e={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ef;function xg(){if(ef)return _e;ef=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),m=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),w=Symbol.iterator;function N(B){return B===null||typeof B!="object"?null:(B=w&&B[w]||B["@@iterator"],typeof B=="function"?B:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function C(B,W,ne){this.props=B,this.context=W,this.refs=_,this.updater=ne||j}C.prototype.isReactComponent={},C.prototype.setState=function(B,W){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,W,"setState")},C.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function S(){}S.prototype=C.prototype;function D(B,W,ne){this.props=B,this.context=W,this.refs=_,this.updater=ne||j}var E=D.prototype=new S;E.constructor=D,k(E,C.prototype),E.isPureReactComponent=!0;var A=Array.isArray;function z(){}var I={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function T(B,W,ne){var X=ne.ref;return{$$typeof:n,type:B,key:W,ref:X!==void 0?X:null,props:ne}}function P(B,W){return T(B.type,W,B.props)}function M(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function R(B){var W={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ne){return W[ne]})}var Q=/\/+/g;function Z(B,W){return typeof B=="object"&&B!==null&&B.key!=null?R(""+B.key):W.toString(36)}function G(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(z,z):(B.status="pending",B.then(function(W){B.status==="pending"&&(B.status="fulfilled",B.value=W)},function(W){B.status==="pending"&&(B.status="rejected",B.reason=W)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function H(B,W,ne,X,J){var re=typeof B;(re==="undefined"||re==="boolean")&&(B=null);var pe=!1;if(B===null)pe=!0;else switch(re){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(B.$$typeof){case n:case a:pe=!0;break;case b:return pe=B._init,H(pe(B._payload),W,ne,X,J)}}if(pe)return J=J(B),pe=X===""?"."+Z(B,0):X,A(J)?(ne="",pe!=null&&(ne=pe.replace(Q,"$&/")+"/"),H(J,W,ne,"",function(xe){return xe})):J!=null&&(M(J)&&(J=P(J,ne+(J.key==null||B&&B.key===J.key?"":(""+J.key).replace(Q,"$&/")+"/")+pe)),W.push(J)),1;pe=0;var me=X===""?".":X+":";if(A(B))for(var ae=0;ae<B.length;ae++)X=B[ae],re=me+Z(X,ae),pe+=H(X,W,ne,re,J);else if(ae=N(B),typeof ae=="function")for(B=ae.call(B),ae=0;!(X=B.next()).done;)X=X.value,re=me+Z(X,ae++),pe+=H(X,W,ne,re,J);else if(re==="object"){if(typeof B.then=="function")return H(G(B),W,ne,X,J);throw W=String(B),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return pe}function O(B,W,ne){if(B==null)return B;var X=[],J=0;return H(B,X,"","",function(re){return W.call(ne,re,J++)}),X}function U(B){if(B._status===-1){var W=B._result;W=W(),W.then(function(ne){(B._status===0||B._status===-1)&&(B._status=1,B._result=ne)},function(ne){(B._status===0||B._status===-1)&&(B._status=2,B._result=ne)}),B._status===-1&&(B._status=0,B._result=W)}if(B._status===1)return B._result.default;throw B._result}var te=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},ie={map:O,forEach:function(B,W,ne){O(B,function(){W.apply(this,arguments)},ne)},count:function(B){var W=0;return O(B,function(){W++}),W},toArray:function(B){return O(B,function(W){return W})||[]},only:function(B){if(!M(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return _e.Activity=g,_e.Children=ie,_e.Component=C,_e.Fragment=r,_e.Profiler=c,_e.PureComponent=D,_e.StrictMode=o,_e.Suspense=h,_e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,_e.__COMPILER_RUNTIME={__proto__:null,c:function(B){return I.H.useMemoCache(B)}},_e.cache=function(B){return function(){return B.apply(null,arguments)}},_e.cacheSignal=function(){return null},_e.cloneElement=function(B,W,ne){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var X=k({},B.props),J=B.key;if(W!=null)for(re in W.key!==void 0&&(J=""+W.key),W)!L.call(W,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&W.ref===void 0||(X[re]=W[re]);var re=arguments.length-2;if(re===1)X.children=ne;else if(1<re){for(var pe=Array(re),me=0;me<re;me++)pe[me]=arguments[me+2];X.children=pe}return T(B.type,J,X)},_e.createContext=function(B){return B={$$typeof:m,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:d,_context:B},B},_e.createElement=function(B,W,ne){var X,J={},re=null;if(W!=null)for(X in W.key!==void 0&&(re=""+W.key),W)L.call(W,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(J[X]=W[X]);var pe=arguments.length-2;if(pe===1)J.children=ne;else if(1<pe){for(var me=Array(pe),ae=0;ae<pe;ae++)me[ae]=arguments[ae+2];J.children=me}if(B&&B.defaultProps)for(X in pe=B.defaultProps,pe)J[X]===void 0&&(J[X]=pe[X]);return T(B,re,J)},_e.createRef=function(){return{current:null}},_e.forwardRef=function(B){return{$$typeof:f,render:B}},_e.isValidElement=M,_e.lazy=function(B){return{$$typeof:b,_payload:{_status:-1,_result:B},_init:U}},_e.memo=function(B,W){return{$$typeof:p,type:B,compare:W===void 0?null:W}},_e.startTransition=function(B){var W=I.T,ne={};I.T=ne;try{var X=B(),J=I.S;J!==null&&J(ne,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(z,te)}catch(re){te(re)}finally{W!==null&&ne.types!==null&&(W.types=ne.types),I.T=W}},_e.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},_e.use=function(B){return I.H.use(B)},_e.useActionState=function(B,W,ne){return I.H.useActionState(B,W,ne)},_e.useCallback=function(B,W){return I.H.useCallback(B,W)},_e.useContext=function(B){return I.H.useContext(B)},_e.useDebugValue=function(){},_e.useDeferredValue=function(B,W){return I.H.useDeferredValue(B,W)},_e.useEffect=function(B,W){return I.H.useEffect(B,W)},_e.useEffectEvent=function(B){return I.H.useEffectEvent(B)},_e.useId=function(){return I.H.useId()},_e.useImperativeHandle=function(B,W,ne){return I.H.useImperativeHandle(B,W,ne)},_e.useInsertionEffect=function(B,W){return I.H.useInsertionEffect(B,W)},_e.useLayoutEffect=function(B,W){return I.H.useLayoutEffect(B,W)},_e.useMemo=function(B,W){return I.H.useMemo(B,W)},_e.useOptimistic=function(B,W){return I.H.useOptimistic(B,W)},_e.useReducer=function(B,W,ne){return I.H.useReducer(B,W,ne)},_e.useRef=function(B){return I.H.useRef(B)},_e.useState=function(B){return I.H.useState(B)},_e.useSyncExternalStore=function(B,W,ne){return I.H.useSyncExternalStore(B,W,ne)},_e.useTransition=function(){return I.H.useTransition()},_e.version="19.2.0",_e}var tf;function du(){return tf||(tf=1,Rd.exports=xg()),Rd.exports}var v=du();const La=hh(v);var Id={exports:{}},ql={},Ld={exports:{}},Bd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sf;function fg(){return sf||(sf=1,(function(n){function a(H,O){var U=H.length;H.push(O);e:for(;0<U;){var te=U-1>>>1,ie=H[te];if(0<c(ie,O))H[te]=O,H[U]=ie,U=te;else break e}}function r(H){return H.length===0?null:H[0]}function o(H){if(H.length===0)return null;var O=H[0],U=H.pop();if(U!==O){H[0]=U;e:for(var te=0,ie=H.length,B=ie>>>1;te<B;){var W=2*(te+1)-1,ne=H[W],X=W+1,J=H[X];if(0>c(ne,U))X<ie&&0>c(J,ne)?(H[te]=J,H[X]=U,te=X):(H[te]=ne,H[W]=U,te=W);else if(X<ie&&0>c(J,U))H[te]=J,H[X]=U,te=X;else break e}}return O}function c(H,O){var U=H.sortIndex-O.sortIndex;return U!==0?U:H.id-O.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;n.unstable_now=function(){return d.now()}}else{var m=Date,f=m.now();n.unstable_now=function(){return m.now()-f}}var h=[],p=[],b=1,g=null,w=3,N=!1,j=!1,k=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function E(H){for(var O=r(p);O!==null;){if(O.callback===null)o(p);else if(O.startTime<=H)o(p),O.sortIndex=O.expirationTime,a(h,O);else break;O=r(p)}}function A(H){if(k=!1,E(H),!j)if(r(h)!==null)j=!0,z||(z=!0,R());else{var O=r(p);O!==null&&G(A,O.startTime-H)}}var z=!1,I=-1,L=5,T=-1;function P(){return _?!0:!(n.unstable_now()-T<L)}function M(){if(_=!1,z){var H=n.unstable_now();T=H;var O=!0;try{e:{j=!1,k&&(k=!1,S(I),I=-1),N=!0;var U=w;try{t:{for(E(H),g=r(h);g!==null&&!(g.expirationTime>H&&P());){var te=g.callback;if(typeof te=="function"){g.callback=null,w=g.priorityLevel;var ie=te(g.expirationTime<=H);if(H=n.unstable_now(),typeof ie=="function"){g.callback=ie,E(H),O=!0;break t}g===r(h)&&o(h),E(H)}else o(h);g=r(h)}if(g!==null)O=!0;else{var B=r(p);B!==null&&G(A,B.startTime-H),O=!1}}break e}finally{g=null,w=U,N=!1}O=void 0}}finally{O?R():z=!1}}}var R;if(typeof D=="function")R=function(){D(M)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,Z=Q.port2;Q.port1.onmessage=M,R=function(){Z.postMessage(null)}}else R=function(){C(M,0)};function G(H,O){I=C(function(){H(n.unstable_now())},O)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_next=function(H){switch(w){case 1:case 2:case 3:var O=3;break;default:O=w}var U=w;w=O;try{return H()}finally{w=U}},n.unstable_requestPaint=function(){_=!0},n.unstable_runWithPriority=function(H,O){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var U=w;w=H;try{return O()}finally{w=U}},n.unstable_scheduleCallback=function(H,O,U){var te=n.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?te+U:te):U=te,H){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=U+ie,H={id:b++,callback:O,priorityLevel:H,startTime:U,expirationTime:ie,sortIndex:-1},U>te?(H.sortIndex=U,a(p,H),r(h)===null&&H===r(p)&&(k?(S(I),I=-1):k=!0,G(A,U-te))):(H.sortIndex=ie,a(h,H),j||N||(j=!0,z||(z=!0,R()))),H},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(H){var O=w;return function(){var U=w;w=O;try{return H.apply(this,arguments)}finally{w=U}}}})(Bd)),Bd}var nf;function hg(){return nf||(nf=1,Ld.exports=fg()),Ld.exports}var Ud={exports:{}},zt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var af;function pg(){if(af)return zt;af=1;var n=du();function a(h){var p="https://react.dev/errors/"+h;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var o={d:{f:r,r:function(){throw Error(a(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},c=Symbol.for("react.portal");function d(h,p,b){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:g==null?null:""+g,children:h,containerInfo:p,implementation:b}}var m=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(h,p){if(h==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return zt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,zt.createPortal=function(h,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(a(299));return d(h,p,null,b)},zt.flushSync=function(h){var p=m.T,b=o.p;try{if(m.T=null,o.p=2,h)return h()}finally{m.T=p,o.p=b,o.d.f()}},zt.preconnect=function(h,p){typeof h=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,o.d.C(h,p))},zt.prefetchDNS=function(h){typeof h=="string"&&o.d.D(h)},zt.preinit=function(h,p){if(typeof h=="string"&&p&&typeof p.as=="string"){var b=p.as,g=f(b,p.crossOrigin),w=typeof p.integrity=="string"?p.integrity:void 0,N=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;b==="style"?o.d.S(h,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:g,integrity:w,fetchPriority:N}):b==="script"&&o.d.X(h,{crossOrigin:g,integrity:w,fetchPriority:N,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},zt.preinitModule=function(h,p){if(typeof h=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var b=f(p.as,p.crossOrigin);o.d.M(h,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&o.d.M(h)},zt.preload=function(h,p){if(typeof h=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var b=p.as,g=f(b,p.crossOrigin);o.d.L(h,b,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},zt.preloadModule=function(h,p){if(typeof h=="string")if(p){var b=f(p.as,p.crossOrigin);o.d.m(h,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else o.d.m(h)},zt.requestFormReset=function(h){o.d.r(h)},zt.unstable_batchedUpdates=function(h,p){return h(p)},zt.useFormState=function(h,p,b){return m.H.useFormState(h,p,b)},zt.useFormStatus=function(){return m.H.useHostTransitionStatus()},zt.version="19.2.0",zt}var rf;function ph(){if(rf)return Ud.exports;rf=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),Ud.exports=pg(),Ud.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lf;function bg(){if(lf)return ql;lf=1;var n=hg(),a=du(),r=ph();function o(t){var s="https://react.dev/errors/"+t;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function d(t){var s=t,l=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,(s.flags&4098)!==0&&(l=s.return),t=s.return;while(t)}return s.tag===3?l:null}function m(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function f(t){if(t.tag===31){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function h(t){if(d(t)!==t)throw Error(o(188))}function p(t){var s=t.alternate;if(!s){if(s=d(t),s===null)throw Error(o(188));return s!==t?null:t}for(var l=t,i=s;;){var u=l.return;if(u===null)break;var x=u.alternate;if(x===null){if(i=u.return,i!==null){l=i;continue}break}if(u.child===x.child){for(x=u.child;x;){if(x===l)return h(u),t;if(x===i)return h(u),s;x=x.sibling}throw Error(o(188))}if(l.return!==i.return)l=u,i=x;else{for(var y=!1,$=u.child;$;){if($===l){y=!0,l=u,i=x;break}if($===i){y=!0,i=u,l=x;break}$=$.sibling}if(!y){for($=x.child;$;){if($===l){y=!0,l=x,i=u;break}if($===i){y=!0,i=x,l=u;break}$=$.sibling}if(!y)throw Error(o(189))}}if(l.alternate!==i)throw Error(o(190))}if(l.tag!==3)throw Error(o(188));return l.stateNode.current===l?t:s}function b(t){var s=t.tag;if(s===5||s===26||s===27||s===6)return t;for(t=t.child;t!==null;){if(s=b(t),s!==null)return s;t=t.sibling}return null}var g=Object.assign,w=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),D=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),T=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function R(t){return t===null||typeof t!="object"?null:(t=M&&t[M]||t["@@iterator"],typeof t=="function"?t:null)}var Q=Symbol.for("react.client.reference");function Z(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Q?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case k:return"Fragment";case C:return"Profiler";case _:return"StrictMode";case A:return"Suspense";case z:return"SuspenseList";case T:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case j:return"Portal";case D:return t.displayName||"Context";case S:return(t._context.displayName||"Context")+".Consumer";case E:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case I:return s=t.displayName||null,s!==null?s:Z(t.type)||"Memo";case L:s=t._payload,t=t._init;try{return Z(t(s))}catch{}}return null}var G=Array.isArray,H=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},te=[],ie=-1;function B(t){return{current:t}}function W(t){0>ie||(t.current=te[ie],te[ie]=null,ie--)}function ne(t,s){ie++,te[ie]=t.current,t.current=s}var X=B(null),J=B(null),re=B(null),pe=B(null);function me(t,s){switch(ne(re,s),ne(J,t),ne(X,null),s.nodeType){case 9:case 11:t=(t=s.documentElement)&&(t=t.namespaceURI)?jx(t):0;break;default:if(t=s.tagName,s=s.namespaceURI)s=jx(s),t=Nx(s,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}W(X),ne(X,t)}function ae(){W(X),W(J),W(re)}function xe(t){t.memoizedState!==null&&ne(pe,t);var s=X.current,l=Nx(s,t.type);s!==l&&(ne(J,t),ne(X,l))}function he(t){J.current===t&&(W(X),W(J)),pe.current===t&&(W(pe),Ll._currentValue=U)}var Se,et;function Re(t){if(Se===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Se=s&&s[1]||"",et=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Se+t+et}var kt=!1;function Dt(t,s){if(!t||kt)return"";kt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(s){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(se){var ee=se}Reflect.construct(t,[],ce)}else{try{ce.call()}catch(se){ee=se}t.call(ce.prototype)}}else{try{throw Error()}catch(se){ee=se}(ce=t())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(se){if(se&&ee&&typeof se.stack=="string")return[se.stack,ee.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var u=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");u&&u.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=i.DetermineComponentFrameRoot(),y=x[0],$=x[1];if(y&&$){var q=y.split(`
`),K=$.split(`
`);for(u=i=0;i<q.length&&!q[i].includes("DetermineComponentFrameRoot");)i++;for(;u<K.length&&!K[u].includes("DetermineComponentFrameRoot");)u++;if(i===q.length||u===K.length)for(i=q.length-1,u=K.length-1;1<=i&&0<=u&&q[i]!==K[u];)u--;for(;1<=i&&0<=u;i--,u--)if(q[i]!==K[u]){if(i!==1||u!==1)do if(i--,u--,0>u||q[i]!==K[u]){var le=`
`+q[i].replace(" at new "," at ");return t.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",t.displayName)),le}while(1<=i&&0<=u);break}}}finally{kt=!1,Error.prepareStackTrace=l}return(l=t?t.displayName||t.name:"")?Re(l):""}function hs(t,s){switch(t.tag){case 26:case 27:case 5:return Re(t.type);case 16:return Re("Lazy");case 13:return t.child!==s&&s!==null?Re("Suspense Fallback"):Re("Suspense");case 19:return Re("SuspenseList");case 0:case 15:return Dt(t.type,!1);case 11:return Dt(t.type.render,!1);case 1:return Dt(t.type,!0);case 31:return Re("Activity");default:return""}}function ut(t){try{var s="",l=null;do s+=hs(t,l),l=t,t=t.return;while(t);return s}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var ns=Object.prototype.hasOwnProperty,Qs=n.unstable_scheduleCallback,ps=n.unstable_cancelCallback,qa=n.unstable_shouldYield,la=n.unstable_requestPaint,vt=n.unstable_now,Za=n.unstable_getCurrentPriorityLevel,oa=n.unstable_ImmediatePriority,ia=n.unstable_UserBlockingPriority,Ys=n.unstable_NormalPriority,_s=n.unstable_LowPriority,Ga=n.unstable_IdlePriority,Yr=n.log,Jr=n.unstable_setDisableYieldValue,Js=null,St=null;function as(t){if(typeof Yr=="function"&&Jr(t),St&&typeof St.setStrictMode=="function")try{St.setStrictMode(Js,t)}catch{}}var Ye=Math.clz32?Math.clz32:Kr,Fr=Math.log,Xr=Math.LN2;function Kr(t){return t>>>=0,t===0?32:31-(Fr(t)/Xr|0)|0}var yn=256,vn=262144,jn=4194304;function bs(t){var s=t&42;if(s!==0)return s;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Nn(t,s,l){var i=t.pendingLanes;if(i===0)return 0;var u=0,x=t.suspendedLanes,y=t.pingedLanes;t=t.warmLanes;var $=i&134217727;return $!==0?(i=$&~x,i!==0?u=bs(i):(y&=$,y!==0?u=bs(y):l||(l=$&~t,l!==0&&(u=bs(l))))):($=i&~x,$!==0?u=bs($):y!==0?u=bs(y):l||(l=i&~t,l!==0&&(u=bs(l)))),u===0?0:s!==0&&s!==u&&(s&x)===0&&(x=u&-u,l=s&-s,x>=l||x===32&&(l&4194048)!==0)?s:u}function $s(t,s){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&s)===0}function Fs(t,s){switch(t){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Es(){var t=jn;return jn<<=1,(jn&62914560)===0&&(jn=4194304),t}function ca(t){for(var s=[],l=0;31>l;l++)s.push(t);return s}function As(t,s){t.pendingLanes|=s,s!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Wr(t,s,l,i,u,x){var y=t.pendingLanes;t.pendingLanes=l,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=l,t.entangledLanes&=l,t.errorRecoveryDisabledLanes&=l,t.shellSuspendCounter=0;var $=t.entanglements,q=t.expirationTimes,K=t.hiddenUpdates;for(l=y&~l;0<l;){var le=31-Ye(l),ce=1<<le;$[le]=0,q[le]=-1;var ee=K[le];if(ee!==null)for(K[le]=null,le=0;le<ee.length;le++){var se=ee[le];se!==null&&(se.lane&=-536870913)}l&=~ce}i!==0&&Va(t,i,0),x!==0&&u===0&&t.tag!==0&&(t.suspendedLanes|=x&~(y&~s))}function Va(t,s,l){t.pendingLanes|=s,t.suspendedLanes&=~s;var i=31-Ye(s);t.entangledLanes|=s,t.entanglements[i]=t.entanglements[i]|1073741824|l&261930}function da(t,s){var l=t.entangledLanes|=s;for(t=t.entanglements;l;){var i=31-Ye(l),u=1<<i;u&s|t[i]&s&&(t[i]|=s),l&=~u}}function Qa(t,s){var l=s&-s;return l=(l&42)!==0?1:ua(l),(l&(t.suspendedLanes|s))!==0?0:l}function ua(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function ma(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Ya(){var t=O.p;return t!==0?t:(t=window.event,t===void 0?32:Gx(t.type))}function Ja(t,s){var l=O.p;try{return O.p=t,s()}finally{O.p=l}}var Jt=Math.random().toString(36).slice(2),ot="__reactFiber$"+Jt,jt="__reactProps$"+Jt,Ts="__reactContainer$"+Jt,xa="__reactEvents$"+Jt,el="__reactListeners$"+Jt,fa="__reactHandles$"+Jt,Fa="__reactResources$"+Jt,Xs="__reactMarker$"+Jt;function Ks(t){delete t[ot],delete t[jt],delete t[xa],delete t[el],delete t[fa]}function Ms(t){var s=t[ot];if(s)return s;for(var l=t.parentNode;l;){if(s=l[Ts]||l[ot]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(t=Ex(t);t!==null;){if(l=t[ot])return l;t=Ex(t)}return s}t=l,l=t.parentNode}return null}function zs(t){if(t=t[ot]||t[Ts]){var s=t.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return t}return null}function Ws(t){var s=t.tag;if(s===5||s===26||s===27||s===6)return t.stateNode;throw Error(o(33))}function Ds(t){var s=t[Fa];return s||(s=t[Fa]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function at(t){t[Xs]=!0}var Xa=new Set,Ka={};function gs(t,s){Os(t,s),Os(t+"Capture",s)}function Os(t,s){for(Ka[t]=s,t=0;t<s.length;t++)Xa.add(s[t])}var tl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wa={},er={};function sl(t){return ns.call(er,t)?!0:ns.call(Wa,t)?!1:tl.test(t)?er[t]=!0:(Wa[t]=!0,!1)}function wn(t,s,l){if(sl(s))if(l===null)t.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":t.removeAttribute(s);return;case"boolean":var i=s.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(s);return}}t.setAttribute(s,""+l)}}function kn(t,s,l){if(l===null)t.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(s);return}t.setAttribute(s,""+l)}}function Ce(t,s,l,i){if(i===null)t.removeAttribute(l);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(l);return}t.setAttributeNS(s,l,""+i)}}function Bt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Wl(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Oi(t,s,l){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,s);if(!t.hasOwnProperty(s)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var u=i.get,x=i.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return u.call(this)},set:function(y){l=""+y,x.call(this,y)}}),Object.defineProperty(t,s,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(y){l=""+y},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function nl(t){if(!t._valueTracker){var s=Wl(t)?"checked":"value";t._valueTracker=Oi(t,s,""+t[s])}}function eo(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var l=s.getValue(),i="";return t&&(i=Wl(t)?t.checked?"true":"false":t.value),t=i,t!==l?(s.setValue(t),!0):!1}function tr(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Ri=/[\n"\\]/g;function Ut(t){return t.replace(Ri,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function sr(t,s,l,i,u,x,y,$){t.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?t.type=y:t.removeAttribute("type"),s!=null?y==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+Bt(s)):t.value!==""+Bt(s)&&(t.value=""+Bt(s)):y!=="submit"&&y!=="reset"||t.removeAttribute("value"),s!=null?Sn(t,y,Bt(s)):l!=null?Sn(t,y,Bt(l)):i!=null&&t.removeAttribute("value"),u==null&&x!=null&&(t.defaultChecked=!!x),u!=null&&(t.checked=u&&typeof u!="function"&&typeof u!="symbol"),$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?t.name=""+Bt($):t.removeAttribute("name")}function al(t,s,l,i,u,x,y,$){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(t.type=x),s!=null||l!=null){if(!(x!=="submit"&&x!=="reset"||s!=null)){nl(t);return}l=l!=null?""+Bt(l):"",s=s!=null?""+Bt(s):l,$||s===t.value||(t.value=s),t.defaultValue=s}i=i??u,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=$?t.checked:!!i,t.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(t.name=y),nl(t)}function Sn(t,s,l){s==="number"&&tr(t.ownerDocument)===t||t.defaultValue===""+l||(t.defaultValue=""+l)}function Cn(t,s,l,i){if(t=t.options,s){s={};for(var u=0;u<l.length;u++)s["$"+l[u]]=!0;for(l=0;l<t.length;l++)u=s.hasOwnProperty("$"+t[l].value),t[l].selected!==u&&(t[l].selected=u),u&&i&&(t[l].defaultSelected=!0)}else{for(l=""+Bt(l),s=null,u=0;u<t.length;u++){if(t[u].value===l){t[u].selected=!0,i&&(t[u].defaultSelected=!0);return}s!==null||t[u].disabled||(s=t[u])}s!==null&&(s.selected=!0)}}function to(t,s,l){if(s!=null&&(s=""+Bt(s),s!==t.value&&(t.value=s),l==null)){t.defaultValue!==s&&(t.defaultValue=s);return}t.defaultValue=l!=null?""+Bt(l):""}function so(t,s,l,i){if(s==null){if(i!=null){if(l!=null)throw Error(o(92));if(G(i)){if(1<i.length)throw Error(o(93));i=i[0]}l=i}l==null&&(l=""),s=l}l=Bt(s),t.defaultValue=l,i=t.textContent,i===l&&i!==""&&i!==null&&(t.value=i),nl(t)}function _n(t,s){if(s){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=s;return}}t.textContent=s}var Ii=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function no(t,s,l){var i=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?i?t.setProperty(s,""):s==="float"?t.cssFloat="":t[s]="":i?t.setProperty(s,l):typeof l!="number"||l===0||Ii.has(s)?s==="float"?t.cssFloat=l:t[s]=(""+l).trim():t[s]=l+"px"}function ao(t,s,l){if(s!=null&&typeof s!="object")throw Error(o(62));if(t=t.style,l!=null){for(var i in l)!l.hasOwnProperty(i)||s!=null&&s.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var u in s)i=s[u],s.hasOwnProperty(u)&&l[u]!==i&&no(t,u,i)}else for(var x in s)s.hasOwnProperty(x)&&no(t,x,s[x])}function nr(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ar=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ro=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ha(t){return ro.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Ot(){}var rr=null;function lr(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $n=null,Rs=null;function pa(t){var s=zs(t);if(s&&(t=s.stateNode)){var l=t[jt]||null;e:switch(t=s.stateNode,s.type){case"input":if(sr(t,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ut(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var i=l[s];if(i!==t&&i.form===t.form){var u=i[jt]||null;if(!u)throw Error(o(90));sr(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name)}}for(s=0;s<l.length;s++)i=l[s],i.form===t.form&&eo(i)}break e;case"textarea":to(t,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&Cn(t,!!l.multiple,s,!1)}}}var Is=!1;function or(t,s,l){if(Is)return t(s,l);Is=!0;try{var i=t(s);return i}finally{if(Is=!1,($n!==null||Rs!==null)&&(Zo(),$n&&(s=$n,t=Rs,Rs=$n=null,pa(s),t)))for(s=0;s<t.length;s++)pa(t[s])}}function ba(t,s){var l=t.stateNode;if(l===null)return null;var i=l[jt]||null;if(i===null)return null;l=i[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(o(231,s,typeof l));return l}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ir=!1;if(ys)try{var ga={};Object.defineProperty(ga,"passive",{get:function(){ir=!0}}),window.addEventListener("test",ga,ga),window.removeEventListener("test",ga,ga)}catch{ir=!1}var Ls=null,En=null,cr=null;function lo(){if(cr)return cr;var t,s=En,l=s.length,i,u="value"in Ls?Ls.value:Ls.textContent,x=u.length;for(t=0;t<l&&s[t]===u[t];t++);var y=l-t;for(i=1;i<=y&&s[l-i]===u[x-i];i++);return cr=u.slice(t,1<i?1-i:void 0)}function dr(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function ur(){return!0}function oo(){return!1}function Mt(t){function s(l,i,u,x,y){this._reactName=l,this._targetInst=u,this.type=i,this.nativeEvent=x,this.target=y,this.currentTarget=null;for(var $ in t)t.hasOwnProperty($)&&(l=t[$],this[$]=l?l(x):x[$]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ur:oo,this.isPropagationStopped=oo,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ur)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ur)},persist:function(){},isPersistent:ur}),s}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},en=Mt(vs),ya=g({},vs,{view:0,detail:0}),Li=Mt(ya),mr,ue,fe,ge=g({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ui,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fe&&(fe&&t.type==="mousemove"?(mr=t.screenX-fe.screenX,ue=t.screenY-fe.screenY):ue=mr=0,fe=t),mr)},movementY:function(t){return"movementY"in t?t.movementY:ue}}),$e=Mt(ge),Ct=g({},ge,{dataTransfer:0}),tn=Mt(Ct),Bs=g({},ya,{relatedTarget:0}),js=Mt(Bs),_t=g({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),Bi=Mt(_t),hp=g({},vs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),pp=Mt(hp),bp=g({},vs,{data:0}),Su=Mt(bp),gp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jp(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=vp[t])?!!s[t]:!1}function Ui(){return jp}var Np=g({},ya,{key:function(t){if(t.key){var s=gp[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=dr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yp[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ui,charCode:function(t){return t.type==="keypress"?dr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?dr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wp=Mt(Np),kp=g({},ge,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cu=Mt(kp),Sp=g({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ui}),Cp=Mt(Sp),_p=g({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),$p=Mt(_p),Ep=g({},ge,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ap=Mt(Ep),Tp=g({},vs,{newState:0,oldState:0}),Mp=Mt(Tp),zp=[9,13,27,32],Hi=ys&&"CompositionEvent"in window,rl=null;ys&&"documentMode"in document&&(rl=document.documentMode);var Dp=ys&&"TextEvent"in window&&!rl,_u=ys&&(!Hi||rl&&8<rl&&11>=rl),$u=" ",Eu=!1;function Au(t,s){switch(t){case"keyup":return zp.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tu(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xr=!1;function Op(t,s){switch(t){case"compositionend":return Tu(s);case"keypress":return s.which!==32?null:(Eu=!0,$u);case"textInput":return t=s.data,t===$u&&Eu?null:t;default:return null}}function Rp(t,s){if(xr)return t==="compositionend"||!Hi&&Au(t,s)?(t=lo(),cr=En=Ls=null,xr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return _u&&s.locale!=="ko"?null:s.data;default:return null}}var Ip={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mu(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!Ip[t.type]:s==="textarea"}function zu(t,s,l,i){$n?Rs?Rs.push(i):Rs=[i]:$n=i,s=Xo(s,"onChange"),0<s.length&&(l=new en("onChange","change",null,l,i),t.push({event:l,listeners:s}))}var ll=null,ol=null;function Lp(t){hx(t,0)}function io(t){var s=Ws(t);if(eo(s))return t}function Du(t,s){if(t==="change")return s}var Ou=!1;if(ys){var Pi;if(ys){var qi="oninput"in document;if(!qi){var Ru=document.createElement("div");Ru.setAttribute("oninput","return;"),qi=typeof Ru.oninput=="function"}Pi=qi}else Pi=!1;Ou=Pi&&(!document.documentMode||9<document.documentMode)}function Iu(){ll&&(ll.detachEvent("onpropertychange",Lu),ol=ll=null)}function Lu(t){if(t.propertyName==="value"&&io(ol)){var s=[];zu(s,ol,t,lr(t)),or(Lp,s)}}function Bp(t,s,l){t==="focusin"?(Iu(),ll=s,ol=l,ll.attachEvent("onpropertychange",Lu)):t==="focusout"&&Iu()}function Up(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return io(ol)}function Hp(t,s){if(t==="click")return io(s)}function Pp(t,s){if(t==="input"||t==="change")return io(s)}function qp(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Ft=typeof Object.is=="function"?Object.is:qp;function il(t,s){if(Ft(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var l=Object.keys(t),i=Object.keys(s);if(l.length!==i.length)return!1;for(i=0;i<l.length;i++){var u=l[i];if(!ns.call(s,u)||!Ft(t[u],s[u]))return!1}return!0}function Bu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Uu(t,s){var l=Bu(t);t=0;for(var i;l;){if(l.nodeType===3){if(i=t+l.textContent.length,t<=s&&i>=s)return{node:l,offset:s-t};t=i}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Bu(l)}}function Hu(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?Hu(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function Pu(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var s=tr(t.document);s instanceof t.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)t=s.contentWindow;else break;s=tr(t.document)}return s}function Zi(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}var Zp=ys&&"documentMode"in document&&11>=document.documentMode,fr=null,Gi=null,cl=null,Vi=!1;function qu(t,s,l){var i=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Vi||fr==null||fr!==tr(i)||(i=fr,"selectionStart"in i&&Zi(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),cl&&il(cl,i)||(cl=i,i=Xo(Gi,"onSelect"),0<i.length&&(s=new en("onSelect","select",null,s,l),t.push({event:s,listeners:i}),s.target=fr)))}function va(t,s){var l={};return l[t.toLowerCase()]=s.toLowerCase(),l["Webkit"+t]="webkit"+s,l["Moz"+t]="moz"+s,l}var hr={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionrun:va("Transition","TransitionRun"),transitionstart:va("Transition","TransitionStart"),transitioncancel:va("Transition","TransitionCancel"),transitionend:va("Transition","TransitionEnd")},Qi={},Zu={};ys&&(Zu=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);function ja(t){if(Qi[t])return Qi[t];if(!hr[t])return t;var s=hr[t],l;for(l in s)if(s.hasOwnProperty(l)&&l in Zu)return Qi[t]=s[l];return t}var Gu=ja("animationend"),Vu=ja("animationiteration"),Qu=ja("animationstart"),Gp=ja("transitionrun"),Vp=ja("transitionstart"),Qp=ja("transitioncancel"),Yu=ja("transitionend"),Ju=new Map,Yi="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Yi.push("scrollEnd");function Ns(t,s){Ju.set(t,s),gs(s,[t])}var co=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},rs=[],pr=0,Ji=0;function uo(){for(var t=pr,s=Ji=pr=0;s<t;){var l=rs[s];rs[s++]=null;var i=rs[s];rs[s++]=null;var u=rs[s];rs[s++]=null;var x=rs[s];if(rs[s++]=null,i!==null&&u!==null){var y=i.pending;y===null?u.next=u:(u.next=y.next,y.next=u),i.pending=u}x!==0&&Fu(l,u,x)}}function mo(t,s,l,i){rs[pr++]=t,rs[pr++]=s,rs[pr++]=l,rs[pr++]=i,Ji|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function Fi(t,s,l,i){return mo(t,s,l,i),xo(t)}function Na(t,s){return mo(t,null,null,s),xo(t)}function Fu(t,s,l){t.lanes|=l;var i=t.alternate;i!==null&&(i.lanes|=l);for(var u=!1,x=t.return;x!==null;)x.childLanes|=l,i=x.alternate,i!==null&&(i.childLanes|=l),x.tag===22&&(t=x.stateNode,t===null||t._visibility&1||(u=!0)),t=x,x=x.return;return t.tag===3?(x=t.stateNode,u&&s!==null&&(u=31-Ye(l),t=x.hiddenUpdates,i=t[u],i===null?t[u]=[s]:i.push(s),s.lane=l|536870912),x):null}function xo(t){if(50<Tl)throw Tl=0,rd=null,Error(o(185));for(var s=t.return;s!==null;)t=s,s=t.return;return t.tag===3?t.stateNode:null}var br={};function Yp(t,s,l,i){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,s,l,i){return new Yp(t,s,l,i)}function Xi(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sn(t,s){var l=t.alternate;return l===null?(l=Xt(t.tag,s,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=s,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&65011712,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,s=t.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l.refCleanup=t.refCleanup,l}function Xu(t,s){t.flags&=65011714;var l=t.alternate;return l===null?(t.childLanes=0,t.lanes=s,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=l.childLanes,t.lanes=l.lanes,t.child=l.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=l.memoizedProps,t.memoizedState=l.memoizedState,t.updateQueue=l.updateQueue,t.type=l.type,s=l.dependencies,t.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),t}function fo(t,s,l,i,u,x){var y=0;if(i=t,typeof t=="function")Xi(t)&&(y=1);else if(typeof t=="string")y=Wb(t,l,X.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case T:return t=Xt(31,l,s,u),t.elementType=T,t.lanes=x,t;case k:return wa(l.children,u,x,s);case _:y=8,u|=24;break;case C:return t=Xt(12,l,s,u|2),t.elementType=C,t.lanes=x,t;case A:return t=Xt(13,l,s,u),t.elementType=A,t.lanes=x,t;case z:return t=Xt(19,l,s,u),t.elementType=z,t.lanes=x,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case D:y=10;break e;case S:y=9;break e;case E:y=11;break e;case I:y=14;break e;case L:y=16,i=null;break e}y=29,l=Error(o(130,t===null?"null":typeof t,"")),i=null}return s=Xt(y,l,s,u),s.elementType=t,s.type=i,s.lanes=x,s}function wa(t,s,l,i){return t=Xt(7,t,i,s),t.lanes=l,t}function Ki(t,s,l){return t=Xt(6,t,null,s),t.lanes=l,t}function Ku(t){var s=Xt(18,null,null,0);return s.stateNode=t,s}function Wi(t,s,l){return s=Xt(4,t.children!==null?t.children:[],t.key,s),s.lanes=l,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}var Wu=new WeakMap;function ls(t,s){if(typeof t=="object"&&t!==null){var l=Wu.get(t);return l!==void 0?l:(s={value:t,source:s,stack:ut(s)},Wu.set(t,s),s)}return{value:t,source:s,stack:ut(s)}}var gr=[],yr=0,ho=null,dl=0,os=[],is=0,An=null,Us=1,Hs="";function nn(t,s){gr[yr++]=dl,gr[yr++]=ho,ho=t,dl=s}function e0(t,s,l){os[is++]=Us,os[is++]=Hs,os[is++]=An,An=t;var i=Us;t=Hs;var u=32-Ye(i)-1;i&=~(1<<u),l+=1;var x=32-Ye(s)+u;if(30<x){var y=u-u%5;x=(i&(1<<y)-1).toString(32),i>>=y,u-=y,Us=1<<32-Ye(s)+u|l<<u|i,Hs=x+t}else Us=1<<x|l<<u|i,Hs=t}function ec(t){t.return!==null&&(nn(t,1),e0(t,1,0))}function tc(t){for(;t===ho;)ho=gr[--yr],gr[yr]=null,dl=gr[--yr],gr[yr]=null;for(;t===An;)An=os[--is],os[is]=null,Hs=os[--is],os[is]=null,Us=os[--is],os[is]=null}function t0(t,s){os[is++]=Us,os[is++]=Hs,os[is++]=An,Us=s.id,Hs=s.overflow,An=t}var $t=null,Je=null,Oe=!1,Tn=null,cs=!1,sc=Error(o(519));function Mn(t){var s=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ul(ls(s,t)),sc}function s0(t){var s=t.stateNode,l=t.type,i=t.memoizedProps;switch(s[ot]=t,s[jt]=i,l){case"dialog":Me("cancel",s),Me("close",s);break;case"iframe":case"object":case"embed":Me("load",s);break;case"video":case"audio":for(l=0;l<zl.length;l++)Me(zl[l],s);break;case"source":Me("error",s);break;case"img":case"image":case"link":Me("error",s),Me("load",s);break;case"details":Me("toggle",s);break;case"input":Me("invalid",s),al(s,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Me("invalid",s);break;case"textarea":Me("invalid",s),so(s,i.value,i.defaultValue,i.children)}l=i.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||i.suppressHydrationWarning===!0||yx(s.textContent,l)?(i.popover!=null&&(Me("beforetoggle",s),Me("toggle",s)),i.onScroll!=null&&Me("scroll",s),i.onScrollEnd!=null&&Me("scrollend",s),i.onClick!=null&&(s.onclick=Ot),s=!0):s=!1,s||Mn(t,!0)}function n0(t){for($t=t.return;$t;)switch($t.tag){case 5:case 31:case 13:cs=!1;return;case 27:case 3:cs=!0;return;default:$t=$t.return}}function vr(t){if(t!==$t)return!1;if(!Oe)return n0(t),Oe=!0,!1;var s=t.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=t.type,l=!(l!=="form"&&l!=="button")||vd(t.type,t.memoizedProps)),l=!l),l&&Je&&Mn(t),n0(t),s===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Je=$x(t)}else if(s===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Je=$x(t)}else s===27?(s=Je,Vn(t.type)?(t=Sd,Sd=null,Je=t):Je=s):Je=$t?us(t.stateNode.nextSibling):null;return!0}function ka(){Je=$t=null,Oe=!1}function nc(){var t=Tn;return t!==null&&(Zt===null?Zt=t:Zt.push.apply(Zt,t),Tn=null),t}function ul(t){Tn===null?Tn=[t]:Tn.push(t)}var ac=B(null),Sa=null,an=null;function zn(t,s,l){ne(ac,s._currentValue),s._currentValue=l}function rn(t){t._currentValue=ac.current,W(ac)}function rc(t,s,l){for(;t!==null;){var i=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,i!==null&&(i.childLanes|=s)):i!==null&&(i.childLanes&s)!==s&&(i.childLanes|=s),t===l)break;t=t.return}}function lc(t,s,l,i){var u=t.child;for(u!==null&&(u.return=t);u!==null;){var x=u.dependencies;if(x!==null){var y=u.child;x=x.firstContext;e:for(;x!==null;){var $=x;x=u;for(var q=0;q<s.length;q++)if($.context===s[q]){x.lanes|=l,$=x.alternate,$!==null&&($.lanes|=l),rc(x.return,l,t),i||(y=null);break e}x=$.next}}else if(u.tag===18){if(y=u.return,y===null)throw Error(o(341));y.lanes|=l,x=y.alternate,x!==null&&(x.lanes|=l),rc(y,l,t),y=null}else y=u.child;if(y!==null)y.return=u;else for(y=u;y!==null;){if(y===t){y=null;break}if(u=y.sibling,u!==null){u.return=y.return,y=u;break}y=y.return}u=y}}function jr(t,s,l,i){t=null;for(var u=s,x=!1;u!==null;){if(!x){if((u.flags&524288)!==0)x=!0;else if((u.flags&262144)!==0)break}if(u.tag===10){var y=u.alternate;if(y===null)throw Error(o(387));if(y=y.memoizedProps,y!==null){var $=u.type;Ft(u.pendingProps.value,y.value)||(t!==null?t.push($):t=[$])}}else if(u===pe.current){if(y=u.alternate,y===null)throw Error(o(387));y.memoizedState.memoizedState!==u.memoizedState.memoizedState&&(t!==null?t.push(Ll):t=[Ll])}u=u.return}t!==null&&lc(s,t,l,i),s.flags|=262144}function po(t){for(t=t.firstContext;t!==null;){if(!Ft(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Ca(t){Sa=t,an=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Et(t){return a0(Sa,t)}function bo(t,s){return Sa===null&&Ca(t),a0(t,s)}function a0(t,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},an===null){if(t===null)throw Error(o(308));an=s,t.dependencies={lanes:0,firstContext:s},t.flags|=524288}else an=an.next=s;return l}var Jp=typeof AbortController<"u"?AbortController:function(){var t=[],s=this.signal={aborted:!1,addEventListener:function(l,i){t.push(i)}};this.abort=function(){s.aborted=!0,t.forEach(function(l){return l()})}},Fp=n.unstable_scheduleCallback,Xp=n.unstable_NormalPriority,mt={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function oc(){return{controller:new Jp,data:new Map,refCount:0}}function ml(t){t.refCount--,t.refCount===0&&Fp(Xp,function(){t.controller.abort()})}var xl=null,ic=0,Nr=0,wr=null;function Kp(t,s){if(xl===null){var l=xl=[];ic=0,Nr=ud(),wr={status:"pending",value:void 0,then:function(i){l.push(i)}}}return ic++,s.then(r0,r0),s}function r0(){if(--ic===0&&xl!==null){wr!==null&&(wr.status="fulfilled");var t=xl;xl=null,Nr=0,wr=null;for(var s=0;s<t.length;s++)(0,t[s])()}}function Wp(t,s){var l=[],i={status:"pending",value:null,reason:null,then:function(u){l.push(u)}};return t.then(function(){i.status="fulfilled",i.value=s;for(var u=0;u<l.length;u++)(0,l[u])(s)},function(u){for(i.status="rejected",i.reason=u,u=0;u<l.length;u++)(0,l[u])(void 0)}),i}var l0=H.S;H.S=function(t,s){qm=vt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Kp(t,s),l0!==null&&l0(t,s)};var _a=B(null);function cc(){var t=_a.current;return t!==null?t:Ge.pooledCache}function go(t,s){s===null?ne(_a,_a.current):ne(_a,s.pool)}function o0(){var t=cc();return t===null?null:{parent:mt._currentValue,pool:t}}var kr=Error(o(460)),dc=Error(o(474)),yo=Error(o(542)),vo={then:function(){}};function i0(t){return t=t.status,t==="fulfilled"||t==="rejected"}function c0(t,s,l){switch(l=t[l],l===void 0?t.push(s):l!==s&&(s.then(Ot,Ot),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw t=s.reason,u0(t),t;default:if(typeof s.status=="string")s.then(Ot,Ot);else{if(t=Ge,t!==null&&100<t.shellSuspendCounter)throw Error(o(482));t=s,t.status="pending",t.then(function(i){if(s.status==="pending"){var u=s;u.status="fulfilled",u.value=i}},function(i){if(s.status==="pending"){var u=s;u.status="rejected",u.reason=i}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw t=s.reason,u0(t),t}throw Ea=s,kr}}function $a(t){try{var s=t._init;return s(t._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Ea=l,kr):l}}var Ea=null;function d0(){if(Ea===null)throw Error(o(459));var t=Ea;return Ea=null,t}function u0(t){if(t===kr||t===yo)throw Error(o(483))}var Sr=null,fl=0;function jo(t){var s=fl;return fl+=1,Sr===null&&(Sr=[]),c0(Sr,t,s)}function hl(t,s){s=s.props.ref,t.ref=s!==void 0?s:null}function No(t,s){throw s.$$typeof===w?Error(o(525)):(t=Object.prototype.toString.call(s),Error(o(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t)))}function m0(t){function s(Y,V){if(t){var F=Y.deletions;F===null?(Y.deletions=[V],Y.flags|=16):F.push(V)}}function l(Y,V){if(!t)return null;for(;V!==null;)s(Y,V),V=V.sibling;return null}function i(Y){for(var V=new Map;Y!==null;)Y.key!==null?V.set(Y.key,Y):V.set(Y.index,Y),Y=Y.sibling;return V}function u(Y,V){return Y=sn(Y,V),Y.index=0,Y.sibling=null,Y}function x(Y,V,F){return Y.index=F,t?(F=Y.alternate,F!==null?(F=F.index,F<V?(Y.flags|=67108866,V):F):(Y.flags|=67108866,V)):(Y.flags|=1048576,V)}function y(Y){return t&&Y.alternate===null&&(Y.flags|=67108866),Y}function $(Y,V,F,oe){return V===null||V.tag!==6?(V=Ki(F,Y.mode,oe),V.return=Y,V):(V=u(V,F),V.return=Y,V)}function q(Y,V,F,oe){var je=F.type;return je===k?le(Y,V,F.props.children,oe,F.key):V!==null&&(V.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===L&&$a(je)===V.type)?(V=u(V,F.props),hl(V,F),V.return=Y,V):(V=fo(F.type,F.key,F.props,null,Y.mode,oe),hl(V,F),V.return=Y,V)}function K(Y,V,F,oe){return V===null||V.tag!==4||V.stateNode.containerInfo!==F.containerInfo||V.stateNode.implementation!==F.implementation?(V=Wi(F,Y.mode,oe),V.return=Y,V):(V=u(V,F.children||[]),V.return=Y,V)}function le(Y,V,F,oe,je){return V===null||V.tag!==7?(V=wa(F,Y.mode,oe,je),V.return=Y,V):(V=u(V,F),V.return=Y,V)}function ce(Y,V,F){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Ki(""+V,Y.mode,F),V.return=Y,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case N:return F=fo(V.type,V.key,V.props,null,Y.mode,F),hl(F,V),F.return=Y,F;case j:return V=Wi(V,Y.mode,F),V.return=Y,V;case L:return V=$a(V),ce(Y,V,F)}if(G(V)||R(V))return V=wa(V,Y.mode,F,null),V.return=Y,V;if(typeof V.then=="function")return ce(Y,jo(V),F);if(V.$$typeof===D)return ce(Y,bo(Y,V),F);No(Y,V)}return null}function ee(Y,V,F,oe){var je=V!==null?V.key:null;if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return je!==null?null:$(Y,V,""+F,oe);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case N:return F.key===je?q(Y,V,F,oe):null;case j:return F.key===je?K(Y,V,F,oe):null;case L:return F=$a(F),ee(Y,V,F,oe)}if(G(F)||R(F))return je!==null?null:le(Y,V,F,oe,null);if(typeof F.then=="function")return ee(Y,V,jo(F),oe);if(F.$$typeof===D)return ee(Y,V,bo(Y,F),oe);No(Y,F)}return null}function se(Y,V,F,oe,je){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Y=Y.get(F)||null,$(V,Y,""+oe,je);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case N:return Y=Y.get(oe.key===null?F:oe.key)||null,q(V,Y,oe,je);case j:return Y=Y.get(oe.key===null?F:oe.key)||null,K(V,Y,oe,je);case L:return oe=$a(oe),se(Y,V,F,oe,je)}if(G(oe)||R(oe))return Y=Y.get(F)||null,le(V,Y,oe,je,null);if(typeof oe.then=="function")return se(Y,V,F,jo(oe),je);if(oe.$$typeof===D)return se(Y,V,F,bo(V,oe),je);No(V,oe)}return null}function be(Y,V,F,oe){for(var je=null,Ie=null,ve=V,Ae=V=0,De=null;ve!==null&&Ae<F.length;Ae++){ve.index>Ae?(De=ve,ve=null):De=ve.sibling;var Le=ee(Y,ve,F[Ae],oe);if(Le===null){ve===null&&(ve=De);break}t&&ve&&Le.alternate===null&&s(Y,ve),V=x(Le,V,Ae),Ie===null?je=Le:Ie.sibling=Le,Ie=Le,ve=De}if(Ae===F.length)return l(Y,ve),Oe&&nn(Y,Ae),je;if(ve===null){for(;Ae<F.length;Ae++)ve=ce(Y,F[Ae],oe),ve!==null&&(V=x(ve,V,Ae),Ie===null?je=ve:Ie.sibling=ve,Ie=ve);return Oe&&nn(Y,Ae),je}for(ve=i(ve);Ae<F.length;Ae++)De=se(ve,Y,Ae,F[Ae],oe),De!==null&&(t&&De.alternate!==null&&ve.delete(De.key===null?Ae:De.key),V=x(De,V,Ae),Ie===null?je=De:Ie.sibling=De,Ie=De);return t&&ve.forEach(function(Xn){return s(Y,Xn)}),Oe&&nn(Y,Ae),je}function we(Y,V,F,oe){if(F==null)throw Error(o(151));for(var je=null,Ie=null,ve=V,Ae=V=0,De=null,Le=F.next();ve!==null&&!Le.done;Ae++,Le=F.next()){ve.index>Ae?(De=ve,ve=null):De=ve.sibling;var Xn=ee(Y,ve,Le.value,oe);if(Xn===null){ve===null&&(ve=De);break}t&&ve&&Xn.alternate===null&&s(Y,ve),V=x(Xn,V,Ae),Ie===null?je=Xn:Ie.sibling=Xn,Ie=Xn,ve=De}if(Le.done)return l(Y,ve),Oe&&nn(Y,Ae),je;if(ve===null){for(;!Le.done;Ae++,Le=F.next())Le=ce(Y,Le.value,oe),Le!==null&&(V=x(Le,V,Ae),Ie===null?je=Le:Ie.sibling=Le,Ie=Le);return Oe&&nn(Y,Ae),je}for(ve=i(ve);!Le.done;Ae++,Le=F.next())Le=se(ve,Y,Ae,Le.value,oe),Le!==null&&(t&&Le.alternate!==null&&ve.delete(Le.key===null?Ae:Le.key),V=x(Le,V,Ae),Ie===null?je=Le:Ie.sibling=Le,Ie=Le);return t&&ve.forEach(function(dg){return s(Y,dg)}),Oe&&nn(Y,Ae),je}function Ze(Y,V,F,oe){if(typeof F=="object"&&F!==null&&F.type===k&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case N:e:{for(var je=F.key;V!==null;){if(V.key===je){if(je=F.type,je===k){if(V.tag===7){l(Y,V.sibling),oe=u(V,F.props.children),oe.return=Y,Y=oe;break e}}else if(V.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===L&&$a(je)===V.type){l(Y,V.sibling),oe=u(V,F.props),hl(oe,F),oe.return=Y,Y=oe;break e}l(Y,V);break}else s(Y,V);V=V.sibling}F.type===k?(oe=wa(F.props.children,Y.mode,oe,F.key),oe.return=Y,Y=oe):(oe=fo(F.type,F.key,F.props,null,Y.mode,oe),hl(oe,F),oe.return=Y,Y=oe)}return y(Y);case j:e:{for(je=F.key;V!==null;){if(V.key===je)if(V.tag===4&&V.stateNode.containerInfo===F.containerInfo&&V.stateNode.implementation===F.implementation){l(Y,V.sibling),oe=u(V,F.children||[]),oe.return=Y,Y=oe;break e}else{l(Y,V);break}else s(Y,V);V=V.sibling}oe=Wi(F,Y.mode,oe),oe.return=Y,Y=oe}return y(Y);case L:return F=$a(F),Ze(Y,V,F,oe)}if(G(F))return be(Y,V,F,oe);if(R(F)){if(je=R(F),typeof je!="function")throw Error(o(150));return F=je.call(F),we(Y,V,F,oe)}if(typeof F.then=="function")return Ze(Y,V,jo(F),oe);if(F.$$typeof===D)return Ze(Y,V,bo(Y,F),oe);No(Y,F)}return typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint"?(F=""+F,V!==null&&V.tag===6?(l(Y,V.sibling),oe=u(V,F),oe.return=Y,Y=oe):(l(Y,V),oe=Ki(F,Y.mode,oe),oe.return=Y,Y=oe),y(Y)):l(Y,V)}return function(Y,V,F,oe){try{fl=0;var je=Ze(Y,V,F,oe);return Sr=null,je}catch(ve){if(ve===kr||ve===yo)throw ve;var Ie=Xt(29,ve,null,Y.mode);return Ie.lanes=oe,Ie.return=Y,Ie}finally{}}}var Aa=m0(!0),x0=m0(!1),Dn=!1;function uc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mc(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function On(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Rn(t,s,l){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,(Be&2)!==0){var u=i.pending;return u===null?s.next=s:(s.next=u.next,u.next=s),i.pending=s,s=xo(t),Fu(t,null,l),s}return mo(t,i,s,l),xo(t)}function pl(t,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var i=s.lanes;i&=t.pendingLanes,l|=i,s.lanes=l,da(t,l)}}function xc(t,s){var l=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,l===i)){var u=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var y={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};x===null?u=x=y:x=x.next=y,l=l.next}while(l!==null);x===null?u=x=s:x=x.next=s}else u=x=s;l={baseState:i.baseState,firstBaseUpdate:u,lastBaseUpdate:x,shared:i.shared,callbacks:i.callbacks},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=s:t.next=s,l.lastBaseUpdate=s}var fc=!1;function bl(){if(fc){var t=wr;if(t!==null)throw t}}function gl(t,s,l,i){fc=!1;var u=t.updateQueue;Dn=!1;var x=u.firstBaseUpdate,y=u.lastBaseUpdate,$=u.shared.pending;if($!==null){u.shared.pending=null;var q=$,K=q.next;q.next=null,y===null?x=K:y.next=K,y=q;var le=t.alternate;le!==null&&(le=le.updateQueue,$=le.lastBaseUpdate,$!==y&&($===null?le.firstBaseUpdate=K:$.next=K,le.lastBaseUpdate=q))}if(x!==null){var ce=u.baseState;y=0,le=K=q=null,$=x;do{var ee=$.lane&-536870913,se=ee!==$.lane;if(se?(ze&ee)===ee:(i&ee)===ee){ee!==0&&ee===Nr&&(fc=!0),le!==null&&(le=le.next={lane:0,tag:$.tag,payload:$.payload,callback:null,next:null});e:{var be=t,we=$;ee=s;var Ze=l;switch(we.tag){case 1:if(be=we.payload,typeof be=="function"){ce=be.call(Ze,ce,ee);break e}ce=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=we.payload,ee=typeof be=="function"?be.call(Ze,ce,ee):be,ee==null)break e;ce=g({},ce,ee);break e;case 2:Dn=!0}}ee=$.callback,ee!==null&&(t.flags|=64,se&&(t.flags|=8192),se=u.callbacks,se===null?u.callbacks=[ee]:se.push(ee))}else se={lane:ee,tag:$.tag,payload:$.payload,callback:$.callback,next:null},le===null?(K=le=se,q=ce):le=le.next=se,y|=ee;if($=$.next,$===null){if($=u.shared.pending,$===null)break;se=$,$=se.next,se.next=null,u.lastBaseUpdate=se,u.shared.pending=null}}while(!0);le===null&&(q=ce),u.baseState=q,u.firstBaseUpdate=K,u.lastBaseUpdate=le,x===null&&(u.shared.lanes=0),Hn|=y,t.lanes=y,t.memoizedState=ce}}function f0(t,s){if(typeof t!="function")throw Error(o(191,t));t.call(s)}function h0(t,s){var l=t.callbacks;if(l!==null)for(t.callbacks=null,t=0;t<l.length;t++)f0(l[t],s)}var Cr=B(null),wo=B(0);function p0(t,s){t=hn,ne(wo,t),ne(Cr,s),hn=t|s.baseLanes}function hc(){ne(wo,hn),ne(Cr,Cr.current)}function pc(){hn=wo.current,W(Cr),W(wo)}var Kt=B(null),ds=null;function In(t){var s=t.alternate;ne(it,it.current&1),ne(Kt,t),ds===null&&(s===null||Cr.current!==null||s.memoizedState!==null)&&(ds=t)}function bc(t){ne(it,it.current),ne(Kt,t),ds===null&&(ds=t)}function b0(t){t.tag===22?(ne(it,it.current),ne(Kt,t),ds===null&&(ds=t)):Ln()}function Ln(){ne(it,it.current),ne(Kt,Kt.current)}function Wt(t){W(Kt),ds===t&&(ds=null),W(it)}var it=B(0);function ko(t){for(var s=t;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||wd(l)||kd(l)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ln=0,Ee=null,Pe=null,xt=null,So=!1,_r=!1,Ta=!1,Co=0,yl=0,$r=null,eb=0;function rt(){throw Error(o(321))}function gc(t,s){if(s===null)return!1;for(var l=0;l<s.length&&l<t.length;l++)if(!Ft(t[l],s[l]))return!1;return!0}function yc(t,s,l,i,u,x){return ln=x,Ee=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,H.H=t===null||t.memoizedState===null?em:Dc,Ta=!1,x=l(i,u),Ta=!1,_r&&(x=y0(s,l,i,u)),g0(t),x}function g0(t){H.H=Nl;var s=Pe!==null&&Pe.next!==null;if(ln=0,xt=Pe=Ee=null,So=!1,yl=0,$r=null,s)throw Error(o(300));t===null||ft||(t=t.dependencies,t!==null&&po(t)&&(ft=!0))}function y0(t,s,l,i){Ee=t;var u=0;do{if(_r&&($r=null),yl=0,_r=!1,25<=u)throw Error(o(301));if(u+=1,xt=Pe=null,t.updateQueue!=null){var x=t.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}H.H=tm,x=s(l,i)}while(_r);return x}function tb(){var t=H.H,s=t.useState()[0];return s=typeof s.then=="function"?vl(s):s,t=t.useState()[0],(Pe!==null?Pe.memoizedState:null)!==t&&(Ee.flags|=1024),s}function vc(){var t=Co!==0;return Co=0,t}function jc(t,s,l){s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~l}function Nc(t){if(So){for(t=t.memoizedState;t!==null;){var s=t.queue;s!==null&&(s.pending=null),t=t.next}So=!1}ln=0,xt=Pe=Ee=null,_r=!1,yl=Co=0,$r=null}function Rt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?Ee.memoizedState=xt=t:xt=xt.next=t,xt}function ct(){if(Pe===null){var t=Ee.alternate;t=t!==null?t.memoizedState:null}else t=Pe.next;var s=xt===null?Ee.memoizedState:xt.next;if(s!==null)xt=s,Pe=t;else{if(t===null)throw Ee.alternate===null?Error(o(467)):Error(o(310));Pe=t,t={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},xt===null?Ee.memoizedState=xt=t:xt=xt.next=t}return xt}function _o(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vl(t){var s=yl;return yl+=1,$r===null&&($r=[]),t=c0($r,t,s),s=Ee,(xt===null?s.memoizedState:xt.next)===null&&(s=s.alternate,H.H=s===null||s.memoizedState===null?em:Dc),t}function $o(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return vl(t);if(t.$$typeof===D)return Et(t)}throw Error(o(438,String(t)))}function wc(t){var s=null,l=Ee.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var i=Ee.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(s={data:i.data.map(function(u){return u.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=_o(),Ee.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(t),i=0;i<t;i++)l[i]=P;return s.index++,l}function on(t,s){return typeof s=="function"?s(t):s}function Eo(t){var s=ct();return kc(s,Pe,t)}function kc(t,s,l){var i=t.queue;if(i===null)throw Error(o(311));i.lastRenderedReducer=l;var u=t.baseQueue,x=i.pending;if(x!==null){if(u!==null){var y=u.next;u.next=x.next,x.next=y}s.baseQueue=u=x,i.pending=null}if(x=t.baseState,u===null)t.memoizedState=x;else{s=u.next;var $=y=null,q=null,K=s,le=!1;do{var ce=K.lane&-536870913;if(ce!==K.lane?(ze&ce)===ce:(ln&ce)===ce){var ee=K.revertLane;if(ee===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),ce===Nr&&(le=!0);else if((ln&ee)===ee){K=K.next,ee===Nr&&(le=!0);continue}else ce={lane:0,revertLane:K.revertLane,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},q===null?($=q=ce,y=x):q=q.next=ce,Ee.lanes|=ee,Hn|=ee;ce=K.action,Ta&&l(x,ce),x=K.hasEagerState?K.eagerState:l(x,ce)}else ee={lane:ce,revertLane:K.revertLane,gesture:K.gesture,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},q===null?($=q=ee,y=x):q=q.next=ee,Ee.lanes|=ce,Hn|=ce;K=K.next}while(K!==null&&K!==s);if(q===null?y=x:q.next=$,!Ft(x,t.memoizedState)&&(ft=!0,le&&(l=wr,l!==null)))throw l;t.memoizedState=x,t.baseState=y,t.baseQueue=q,i.lastRenderedState=x}return u===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function Sc(t){var s=ct(),l=s.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=t;var i=l.dispatch,u=l.pending,x=s.memoizedState;if(u!==null){l.pending=null;var y=u=u.next;do x=t(x,y.action),y=y.next;while(y!==u);Ft(x,s.memoizedState)||(ft=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),l.lastRenderedState=x}return[x,i]}function v0(t,s,l){var i=Ee,u=ct(),x=Oe;if(x){if(l===void 0)throw Error(o(407));l=l()}else l=s();var y=!Ft((Pe||u).memoizedState,l);if(y&&(u.memoizedState=l,ft=!0),u=u.queue,$c(w0.bind(null,i,u,t),[t]),u.getSnapshot!==s||y||xt!==null&&xt.memoizedState.tag&1){if(i.flags|=2048,Er(9,{destroy:void 0},N0.bind(null,i,u,l,s),null),Ge===null)throw Error(o(349));x||(ln&127)!==0||j0(i,s,l)}return l}function j0(t,s,l){t.flags|=16384,t={getSnapshot:s,value:l},s=Ee.updateQueue,s===null?(s=_o(),Ee.updateQueue=s,s.stores=[t]):(l=s.stores,l===null?s.stores=[t]:l.push(t))}function N0(t,s,l,i){s.value=l,s.getSnapshot=i,k0(s)&&S0(t)}function w0(t,s,l){return l(function(){k0(s)&&S0(t)})}function k0(t){var s=t.getSnapshot;t=t.value;try{var l=s();return!Ft(t,l)}catch{return!0}}function S0(t){var s=Na(t,2);s!==null&&Gt(s,t,2)}function Cc(t){var s=Rt();if(typeof t=="function"){var l=t;if(t=l(),Ta){as(!0);try{l()}finally{as(!1)}}}return s.memoizedState=s.baseState=t,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:on,lastRenderedState:t},s}function C0(t,s,l,i){return t.baseState=l,kc(t,Pe,typeof i=="function"?i:on)}function sb(t,s,l,i,u){if(Mo(t))throw Error(o(485));if(t=s.action,t!==null){var x={payload:u,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){x.listeners.push(y)}};H.T!==null?l(!0):x.isTransition=!1,i(x),l=s.pending,l===null?(x.next=s.pending=x,_0(s,x)):(x.next=l.next,s.pending=l.next=x)}}function _0(t,s){var l=s.action,i=s.payload,u=t.state;if(s.isTransition){var x=H.T,y={};H.T=y;try{var $=l(u,i),q=H.S;q!==null&&q(y,$),$0(t,s,$)}catch(K){_c(t,s,K)}finally{x!==null&&y.types!==null&&(x.types=y.types),H.T=x}}else try{x=l(u,i),$0(t,s,x)}catch(K){_c(t,s,K)}}function $0(t,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(i){E0(t,s,i)},function(i){return _c(t,s,i)}):E0(t,s,l)}function E0(t,s,l){s.status="fulfilled",s.value=l,A0(s),t.state=l,s=t.pending,s!==null&&(l=s.next,l===s?t.pending=null:(l=l.next,s.next=l,_0(t,l)))}function _c(t,s,l){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do s.status="rejected",s.reason=l,A0(s),s=s.next;while(s!==i)}t.action=null}function A0(t){t=t.listeners;for(var s=0;s<t.length;s++)(0,t[s])()}function T0(t,s){return s}function M0(t,s){if(Oe){var l=Ge.formState;if(l!==null){e:{var i=Ee;if(Oe){if(Je){t:{for(var u=Je,x=cs;u.nodeType!==8;){if(!x){u=null;break t}if(u=us(u.nextSibling),u===null){u=null;break t}}x=u.data,u=x==="F!"||x==="F"?u:null}if(u){Je=us(u.nextSibling),i=u.data==="F!";break e}}Mn(i)}i=!1}i&&(s=l[0])}}return l=Rt(),l.memoizedState=l.baseState=s,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:T0,lastRenderedState:s},l.queue=i,l=X0.bind(null,Ee,i),i.dispatch=l,i=Cc(!1),x=zc.bind(null,Ee,!1,i.queue),i=Rt(),u={state:s,dispatch:null,action:t,pending:null},i.queue=u,l=sb.bind(null,Ee,u,x,l),u.dispatch=l,i.memoizedState=t,[s,l,!1]}function z0(t){var s=ct();return D0(s,Pe,t)}function D0(t,s,l){if(s=kc(t,s,T0)[0],t=Eo(on)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var i=vl(s)}catch(y){throw y===kr?yo:y}else i=s;s=ct();var u=s.queue,x=u.dispatch;return l!==s.memoizedState&&(Ee.flags|=2048,Er(9,{destroy:void 0},nb.bind(null,u,l),null)),[i,x,t]}function nb(t,s){t.action=s}function O0(t){var s=ct(),l=Pe;if(l!==null)return D0(s,l,t);ct(),s=s.memoizedState,l=ct();var i=l.queue.dispatch;return l.memoizedState=t,[s,i,!1]}function Er(t,s,l,i){return t={tag:t,create:l,deps:i,inst:s,next:null},s=Ee.updateQueue,s===null&&(s=_o(),Ee.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=t.next=t:(i=l.next,l.next=t,t.next=i,s.lastEffect=t),t}function R0(){return ct().memoizedState}function Ao(t,s,l,i){var u=Rt();Ee.flags|=t,u.memoizedState=Er(1|s,{destroy:void 0},l,i===void 0?null:i)}function To(t,s,l,i){var u=ct();i=i===void 0?null:i;var x=u.memoizedState.inst;Pe!==null&&i!==null&&gc(i,Pe.memoizedState.deps)?u.memoizedState=Er(s,x,l,i):(Ee.flags|=t,u.memoizedState=Er(1|s,x,l,i))}function I0(t,s){Ao(8390656,8,t,s)}function $c(t,s){To(2048,8,t,s)}function ab(t){Ee.flags|=4;var s=Ee.updateQueue;if(s===null)s=_o(),Ee.updateQueue=s,s.events=[t];else{var l=s.events;l===null?s.events=[t]:l.push(t)}}function L0(t){var s=ct().memoizedState;return ab({ref:s,nextImpl:t}),function(){if((Be&2)!==0)throw Error(o(440));return s.impl.apply(void 0,arguments)}}function B0(t,s){return To(4,2,t,s)}function U0(t,s){return To(4,4,t,s)}function H0(t,s){if(typeof s=="function"){t=t();var l=s(t);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function P0(t,s,l){l=l!=null?l.concat([t]):null,To(4,4,H0.bind(null,s,t),l)}function Ec(){}function q0(t,s){var l=ct();s=s===void 0?null:s;var i=l.memoizedState;return s!==null&&gc(s,i[1])?i[0]:(l.memoizedState=[t,s],t)}function Z0(t,s){var l=ct();s=s===void 0?null:s;var i=l.memoizedState;if(s!==null&&gc(s,i[1]))return i[0];if(i=t(),Ta){as(!0);try{t()}finally{as(!1)}}return l.memoizedState=[i,s],i}function Ac(t,s,l){return l===void 0||(ln&1073741824)!==0&&(ze&261930)===0?t.memoizedState=s:(t.memoizedState=l,t=Gm(),Ee.lanes|=t,Hn|=t,l)}function G0(t,s,l,i){return Ft(l,s)?l:Cr.current!==null?(t=Ac(t,l,i),Ft(t,s)||(ft=!0),t):(ln&42)===0||(ln&1073741824)!==0&&(ze&261930)===0?(ft=!0,t.memoizedState=l):(t=Gm(),Ee.lanes|=t,Hn|=t,s)}function V0(t,s,l,i,u){var x=O.p;O.p=x!==0&&8>x?x:8;var y=H.T,$={};H.T=$,zc(t,!1,s,l);try{var q=u(),K=H.S;if(K!==null&&K($,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var le=Wp(q,i);jl(t,s,le,ss(t))}else jl(t,s,i,ss(t))}catch(ce){jl(t,s,{then:function(){},status:"rejected",reason:ce},ss())}finally{O.p=x,y!==null&&$.types!==null&&(y.types=$.types),H.T=y}}function rb(){}function Tc(t,s,l,i){if(t.tag!==5)throw Error(o(476));var u=Q0(t).queue;V0(t,u,s,U,l===null?rb:function(){return Y0(t),l(i)})}function Q0(t){var s=t.memoizedState;if(s!==null)return s;s={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:on,lastRenderedState:U},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:on,lastRenderedState:l},next:null},t.memoizedState=s,t=t.alternate,t!==null&&(t.memoizedState=s),s}function Y0(t){var s=Q0(t);s.next===null&&(s=t.alternate.memoizedState),jl(t,s.next.queue,{},ss())}function Mc(){return Et(Ll)}function J0(){return ct().memoizedState}function F0(){return ct().memoizedState}function lb(t){for(var s=t.return;s!==null;){switch(s.tag){case 24:case 3:var l=ss();t=On(l);var i=Rn(s,t,l);i!==null&&(Gt(i,s,l),pl(i,s,l)),s={cache:oc()},t.payload=s;return}s=s.return}}function ob(t,s,l){var i=ss();l={lane:i,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Mo(t)?K0(s,l):(l=Fi(t,s,l,i),l!==null&&(Gt(l,t,i),W0(l,s,i)))}function X0(t,s,l){var i=ss();jl(t,s,l,i)}function jl(t,s,l,i){var u={lane:i,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Mo(t))K0(s,u);else{var x=t.alternate;if(t.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var y=s.lastRenderedState,$=x(y,l);if(u.hasEagerState=!0,u.eagerState=$,Ft($,y))return mo(t,s,u,0),Ge===null&&uo(),!1}catch{}finally{}if(l=Fi(t,s,u,i),l!==null)return Gt(l,t,i),W0(l,s,i),!0}return!1}function zc(t,s,l,i){if(i={lane:2,revertLane:ud(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Mo(t)){if(s)throw Error(o(479))}else s=Fi(t,l,i,2),s!==null&&Gt(s,t,2)}function Mo(t){var s=t.alternate;return t===Ee||s!==null&&s===Ee}function K0(t,s){_r=So=!0;var l=t.pending;l===null?s.next=s:(s.next=l.next,l.next=s),t.pending=s}function W0(t,s,l){if((l&4194048)!==0){var i=s.lanes;i&=t.pendingLanes,l|=i,s.lanes=l,da(t,l)}}var Nl={readContext:Et,use:$o,useCallback:rt,useContext:rt,useEffect:rt,useImperativeHandle:rt,useLayoutEffect:rt,useInsertionEffect:rt,useMemo:rt,useReducer:rt,useRef:rt,useState:rt,useDebugValue:rt,useDeferredValue:rt,useTransition:rt,useSyncExternalStore:rt,useId:rt,useHostTransitionStatus:rt,useFormState:rt,useActionState:rt,useOptimistic:rt,useMemoCache:rt,useCacheRefresh:rt};Nl.useEffectEvent=rt;var em={readContext:Et,use:$o,useCallback:function(t,s){return Rt().memoizedState=[t,s===void 0?null:s],t},useContext:Et,useEffect:I0,useImperativeHandle:function(t,s,l){l=l!=null?l.concat([t]):null,Ao(4194308,4,H0.bind(null,s,t),l)},useLayoutEffect:function(t,s){return Ao(4194308,4,t,s)},useInsertionEffect:function(t,s){Ao(4,2,t,s)},useMemo:function(t,s){var l=Rt();s=s===void 0?null:s;var i=t();if(Ta){as(!0);try{t()}finally{as(!1)}}return l.memoizedState=[i,s],i},useReducer:function(t,s,l){var i=Rt();if(l!==void 0){var u=l(s);if(Ta){as(!0);try{l(s)}finally{as(!1)}}}else u=s;return i.memoizedState=i.baseState=u,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:u},i.queue=t,t=t.dispatch=ob.bind(null,Ee,t),[i.memoizedState,t]},useRef:function(t){var s=Rt();return t={current:t},s.memoizedState=t},useState:function(t){t=Cc(t);var s=t.queue,l=X0.bind(null,Ee,s);return s.dispatch=l,[t.memoizedState,l]},useDebugValue:Ec,useDeferredValue:function(t,s){var l=Rt();return Ac(l,t,s)},useTransition:function(){var t=Cc(!1);return t=V0.bind(null,Ee,t.queue,!0,!1),Rt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,s,l){var i=Ee,u=Rt();if(Oe){if(l===void 0)throw Error(o(407));l=l()}else{if(l=s(),Ge===null)throw Error(o(349));(ze&127)!==0||j0(i,s,l)}u.memoizedState=l;var x={value:l,getSnapshot:s};return u.queue=x,I0(w0.bind(null,i,x,t),[t]),i.flags|=2048,Er(9,{destroy:void 0},N0.bind(null,i,x,l,s),null),l},useId:function(){var t=Rt(),s=Ge.identifierPrefix;if(Oe){var l=Hs,i=Us;l=(i&~(1<<32-Ye(i)-1)).toString(32)+l,s="_"+s+"R_"+l,l=Co++,0<l&&(s+="H"+l.toString(32)),s+="_"}else l=eb++,s="_"+s+"r_"+l.toString(32)+"_";return t.memoizedState=s},useHostTransitionStatus:Mc,useFormState:M0,useActionState:M0,useOptimistic:function(t){var s=Rt();s.memoizedState=s.baseState=t;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=zc.bind(null,Ee,!0,l),l.dispatch=s,[t,s]},useMemoCache:wc,useCacheRefresh:function(){return Rt().memoizedState=lb.bind(null,Ee)},useEffectEvent:function(t){var s=Rt(),l={impl:t};return s.memoizedState=l,function(){if((Be&2)!==0)throw Error(o(440));return l.impl.apply(void 0,arguments)}}},Dc={readContext:Et,use:$o,useCallback:q0,useContext:Et,useEffect:$c,useImperativeHandle:P0,useInsertionEffect:B0,useLayoutEffect:U0,useMemo:Z0,useReducer:Eo,useRef:R0,useState:function(){return Eo(on)},useDebugValue:Ec,useDeferredValue:function(t,s){var l=ct();return G0(l,Pe.memoizedState,t,s)},useTransition:function(){var t=Eo(on)[0],s=ct().memoizedState;return[typeof t=="boolean"?t:vl(t),s]},useSyncExternalStore:v0,useId:J0,useHostTransitionStatus:Mc,useFormState:z0,useActionState:z0,useOptimistic:function(t,s){var l=ct();return C0(l,Pe,t,s)},useMemoCache:wc,useCacheRefresh:F0};Dc.useEffectEvent=L0;var tm={readContext:Et,use:$o,useCallback:q0,useContext:Et,useEffect:$c,useImperativeHandle:P0,useInsertionEffect:B0,useLayoutEffect:U0,useMemo:Z0,useReducer:Sc,useRef:R0,useState:function(){return Sc(on)},useDebugValue:Ec,useDeferredValue:function(t,s){var l=ct();return Pe===null?Ac(l,t,s):G0(l,Pe.memoizedState,t,s)},useTransition:function(){var t=Sc(on)[0],s=ct().memoizedState;return[typeof t=="boolean"?t:vl(t),s]},useSyncExternalStore:v0,useId:J0,useHostTransitionStatus:Mc,useFormState:O0,useActionState:O0,useOptimistic:function(t,s){var l=ct();return Pe!==null?C0(l,Pe,t,s):(l.baseState=t,[t,l.queue.dispatch])},useMemoCache:wc,useCacheRefresh:F0};tm.useEffectEvent=L0;function Oc(t,s,l,i){s=t.memoizedState,l=l(i,s),l=l==null?s:g({},s,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var Rc={enqueueSetState:function(t,s,l){t=t._reactInternals;var i=ss(),u=On(i);u.payload=s,l!=null&&(u.callback=l),s=Rn(t,u,i),s!==null&&(Gt(s,t,i),pl(s,t,i))},enqueueReplaceState:function(t,s,l){t=t._reactInternals;var i=ss(),u=On(i);u.tag=1,u.payload=s,l!=null&&(u.callback=l),s=Rn(t,u,i),s!==null&&(Gt(s,t,i),pl(s,t,i))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var l=ss(),i=On(l);i.tag=2,s!=null&&(i.callback=s),s=Rn(t,i,l),s!==null&&(Gt(s,t,l),pl(s,t,l))}};function sm(t,s,l,i,u,x,y){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,x,y):s.prototype&&s.prototype.isPureReactComponent?!il(l,i)||!il(u,x):!0}function nm(t,s,l,i){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,i),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,i),s.state!==t&&Rc.enqueueReplaceState(s,s.state,null)}function Ma(t,s){var l=s;if("ref"in s){l={};for(var i in s)i!=="ref"&&(l[i]=s[i])}if(t=t.defaultProps){l===s&&(l=g({},l));for(var u in t)l[u]===void 0&&(l[u]=t[u])}return l}function am(t){co(t)}function rm(t){console.error(t)}function lm(t){co(t)}function zo(t,s){try{var l=t.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(i){setTimeout(function(){throw i})}}function om(t,s,l){try{var i=t.onCaughtError;i(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(u){setTimeout(function(){throw u})}}function Ic(t,s,l){return l=On(l),l.tag=3,l.payload={element:null},l.callback=function(){zo(t,s)},l}function im(t){return t=On(t),t.tag=3,t}function cm(t,s,l,i){var u=l.type.getDerivedStateFromError;if(typeof u=="function"){var x=i.value;t.payload=function(){return u(x)},t.callback=function(){om(s,l,i)}}var y=l.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(t.callback=function(){om(s,l,i),typeof u!="function"&&(Pn===null?Pn=new Set([this]):Pn.add(this));var $=i.stack;this.componentDidCatch(i.value,{componentStack:$!==null?$:""})})}function ib(t,s,l,i,u){if(l.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(s=l.alternate,s!==null&&jr(s,l,u,!0),l=Kt.current,l!==null){switch(l.tag){case 31:case 13:return ds===null?Go():l.alternate===null&&lt===0&&(lt=3),l.flags&=-257,l.flags|=65536,l.lanes=u,i===vo?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([i]):s.add(i),id(t,i,u)),!1;case 22:return l.flags|=65536,i===vo?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([i])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([i]):l.add(i)),id(t,i,u)),!1}throw Error(o(435,l.tag))}return id(t,i,u),Go(),!1}if(Oe)return s=Kt.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=u,i!==sc&&(t=Error(o(422),{cause:i}),ul(ls(t,l)))):(i!==sc&&(s=Error(o(423),{cause:i}),ul(ls(s,l))),t=t.current.alternate,t.flags|=65536,u&=-u,t.lanes|=u,i=ls(i,l),u=Ic(t.stateNode,i,u),xc(t,u),lt!==4&&(lt=2)),!1;var x=Error(o(520),{cause:i});if(x=ls(x,l),Al===null?Al=[x]:Al.push(x),lt!==4&&(lt=2),s===null)return!0;i=ls(i,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,t=u&-u,l.lanes|=t,t=Ic(l.stateNode,i,t),xc(l,t),!1;case 1:if(s=l.type,x=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Pn===null||!Pn.has(x))))return l.flags|=65536,u&=-u,l.lanes|=u,u=im(u),cm(u,t,l,i),xc(l,u),!1}l=l.return}while(l!==null);return!1}var Lc=Error(o(461)),ft=!1;function At(t,s,l,i){s.child=t===null?x0(s,null,l,i):Aa(s,t.child,l,i)}function dm(t,s,l,i,u){l=l.render;var x=s.ref;if("ref"in i){var y={};for(var $ in i)$!=="ref"&&(y[$]=i[$])}else y=i;return Ca(s),i=yc(t,s,l,y,x,u),$=vc(),t!==null&&!ft?(jc(t,s,u),cn(t,s,u)):(Oe&&$&&ec(s),s.flags|=1,At(t,s,i,u),s.child)}function um(t,s,l,i,u){if(t===null){var x=l.type;return typeof x=="function"&&!Xi(x)&&x.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=x,mm(t,s,x,i,u)):(t=fo(l.type,null,i,s,s.mode,u),t.ref=s.ref,t.return=s,s.child=t)}if(x=t.child,!Vc(t,u)){var y=x.memoizedProps;if(l=l.compare,l=l!==null?l:il,l(y,i)&&t.ref===s.ref)return cn(t,s,u)}return s.flags|=1,t=sn(x,i),t.ref=s.ref,t.return=s,s.child=t}function mm(t,s,l,i,u){if(t!==null){var x=t.memoizedProps;if(il(x,i)&&t.ref===s.ref)if(ft=!1,s.pendingProps=i=x,Vc(t,u))(t.flags&131072)!==0&&(ft=!0);else return s.lanes=t.lanes,cn(t,s,u)}return Bc(t,s,l,i,u)}function xm(t,s,l,i){var u=i.children,x=t!==null?t.memoizedState:null;if(t===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((s.flags&128)!==0){if(x=x!==null?x.baseLanes|l:l,t!==null){for(i=s.child=t.child,u=0;i!==null;)u=u|i.lanes|i.childLanes,i=i.sibling;i=u&~x}else i=0,s.child=null;return fm(t,s,x,l,i)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},t!==null&&go(s,x!==null?x.cachePool:null),x!==null?p0(s,x):hc(),b0(s);else return i=s.lanes=536870912,fm(t,s,x!==null?x.baseLanes|l:l,l,i)}else x!==null?(go(s,x.cachePool),p0(s,x),Ln(),s.memoizedState=null):(t!==null&&go(s,null),hc(),Ln());return At(t,s,u,l),s.child}function wl(t,s){return t!==null&&t.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function fm(t,s,l,i,u){var x=cc();return x=x===null?null:{parent:mt._currentValue,pool:x},s.memoizedState={baseLanes:l,cachePool:x},t!==null&&go(s,null),hc(),b0(s),t!==null&&jr(t,s,i,!0),s.childLanes=u,null}function Do(t,s){return s=Ro({mode:s.mode,children:s.children},t.mode),s.ref=t.ref,t.child=s,s.return=t,s}function hm(t,s,l){return Aa(s,t.child,null,l),t=Do(s,s.pendingProps),t.flags|=2,Wt(s),s.memoizedState=null,t}function cb(t,s,l){var i=s.pendingProps,u=(s.flags&128)!==0;if(s.flags&=-129,t===null){if(Oe){if(i.mode==="hidden")return t=Do(s,i),s.lanes=536870912,wl(null,t);if(bc(s),(t=Je)?(t=_x(t,cs),t=t!==null&&t.data==="&"?t:null,t!==null&&(s.memoizedState={dehydrated:t,treeContext:An!==null?{id:Us,overflow:Hs}:null,retryLane:536870912,hydrationErrors:null},l=Ku(t),l.return=s,s.child=l,$t=s,Je=null)):t=null,t===null)throw Mn(s);return s.lanes=536870912,null}return Do(s,i)}var x=t.memoizedState;if(x!==null){var y=x.dehydrated;if(bc(s),u)if(s.flags&256)s.flags&=-257,s=hm(t,s,l);else if(s.memoizedState!==null)s.child=t.child,s.flags|=128,s=null;else throw Error(o(558));else if(ft||jr(t,s,l,!1),u=(l&t.childLanes)!==0,ft||u){if(i=Ge,i!==null&&(y=Qa(i,l),y!==0&&y!==x.retryLane))throw x.retryLane=y,Na(t,y),Gt(i,t,y),Lc;Go(),s=hm(t,s,l)}else t=x.treeContext,Je=us(y.nextSibling),$t=s,Oe=!0,Tn=null,cs=!1,t!==null&&t0(s,t),s=Do(s,i),s.flags|=4096;return s}return t=sn(t.child,{mode:i.mode,children:i.children}),t.ref=s.ref,s.child=t,t.return=s,t}function Oo(t,s){var l=s.ref;if(l===null)t!==null&&t.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(o(284));(t===null||t.ref!==l)&&(s.flags|=4194816)}}function Bc(t,s,l,i,u){return Ca(s),l=yc(t,s,l,i,void 0,u),i=vc(),t!==null&&!ft?(jc(t,s,u),cn(t,s,u)):(Oe&&i&&ec(s),s.flags|=1,At(t,s,l,u),s.child)}function pm(t,s,l,i,u,x){return Ca(s),s.updateQueue=null,l=y0(s,i,l,u),g0(t),i=vc(),t!==null&&!ft?(jc(t,s,x),cn(t,s,x)):(Oe&&i&&ec(s),s.flags|=1,At(t,s,l,x),s.child)}function bm(t,s,l,i,u){if(Ca(s),s.stateNode===null){var x=br,y=l.contextType;typeof y=="object"&&y!==null&&(x=Et(y)),x=new l(i,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Rc,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=i,x.state=s.memoizedState,x.refs={},uc(s),y=l.contextType,x.context=typeof y=="object"&&y!==null?Et(y):br,x.state=s.memoizedState,y=l.getDerivedStateFromProps,typeof y=="function"&&(Oc(s,l,y,i),x.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(y=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),y!==x.state&&Rc.enqueueReplaceState(x,x.state,null),gl(s,i,x,u),bl(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),i=!0}else if(t===null){x=s.stateNode;var $=s.memoizedProps,q=Ma(l,$);x.props=q;var K=x.context,le=l.contextType;y=br,typeof le=="object"&&le!==null&&(y=Et(le));var ce=l.getDerivedStateFromProps;le=typeof ce=="function"||typeof x.getSnapshotBeforeUpdate=="function",$=s.pendingProps!==$,le||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||($||K!==y)&&nm(s,x,i,y),Dn=!1;var ee=s.memoizedState;x.state=ee,gl(s,i,x,u),bl(),K=s.memoizedState,$||ee!==K||Dn?(typeof ce=="function"&&(Oc(s,l,ce,i),K=s.memoizedState),(q=Dn||sm(s,l,q,i,ee,K,y))?(le||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=i,s.memoizedState=K),x.props=i,x.state=K,x.context=y,i=q):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),i=!1)}else{x=s.stateNode,mc(t,s),y=s.memoizedProps,le=Ma(l,y),x.props=le,ce=s.pendingProps,ee=x.context,K=l.contextType,q=br,typeof K=="object"&&K!==null&&(q=Et(K)),$=l.getDerivedStateFromProps,(K=typeof $=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(y!==ce||ee!==q)&&nm(s,x,i,q),Dn=!1,ee=s.memoizedState,x.state=ee,gl(s,i,x,u),bl();var se=s.memoizedState;y!==ce||ee!==se||Dn||t!==null&&t.dependencies!==null&&po(t.dependencies)?(typeof $=="function"&&(Oc(s,l,$,i),se=s.memoizedState),(le=Dn||sm(s,l,le,i,ee,se,q)||t!==null&&t.dependencies!==null&&po(t.dependencies))?(K||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(i,se,q),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(i,se,q)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||y===t.memoizedProps&&ee===t.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&ee===t.memoizedState||(s.flags|=1024),s.memoizedProps=i,s.memoizedState=se),x.props=i,x.state=se,x.context=q,i=le):(typeof x.componentDidUpdate!="function"||y===t.memoizedProps&&ee===t.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&ee===t.memoizedState||(s.flags|=1024),i=!1)}return x=i,Oo(t,s),i=(s.flags&128)!==0,x||i?(x=s.stateNode,l=i&&typeof l.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,t!==null&&i?(s.child=Aa(s,t.child,null,u),s.child=Aa(s,null,l,u)):At(t,s,l,u),s.memoizedState=x.state,t=s.child):t=cn(t,s,u),t}function gm(t,s,l,i){return ka(),s.flags|=256,At(t,s,l,i),s.child}var Uc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hc(t){return{baseLanes:t,cachePool:o0()}}function Pc(t,s,l){return t=t!==null?t.childLanes&~l:0,s&&(t|=ts),t}function ym(t,s,l){var i=s.pendingProps,u=!1,x=(s.flags&128)!==0,y;if((y=x)||(y=t!==null&&t.memoizedState===null?!1:(it.current&2)!==0),y&&(u=!0,s.flags&=-129),y=(s.flags&32)!==0,s.flags&=-33,t===null){if(Oe){if(u?In(s):Ln(),(t=Je)?(t=_x(t,cs),t=t!==null&&t.data!=="&"?t:null,t!==null&&(s.memoizedState={dehydrated:t,treeContext:An!==null?{id:Us,overflow:Hs}:null,retryLane:536870912,hydrationErrors:null},l=Ku(t),l.return=s,s.child=l,$t=s,Je=null)):t=null,t===null)throw Mn(s);return kd(t)?s.lanes=32:s.lanes=536870912,null}var $=i.children;return i=i.fallback,u?(Ln(),u=s.mode,$=Ro({mode:"hidden",children:$},u),i=wa(i,u,l,null),$.return=s,i.return=s,$.sibling=i,s.child=$,i=s.child,i.memoizedState=Hc(l),i.childLanes=Pc(t,y,l),s.memoizedState=Uc,wl(null,i)):(In(s),qc(s,$))}var q=t.memoizedState;if(q!==null&&($=q.dehydrated,$!==null)){if(x)s.flags&256?(In(s),s.flags&=-257,s=Zc(t,s,l)):s.memoizedState!==null?(Ln(),s.child=t.child,s.flags|=128,s=null):(Ln(),$=i.fallback,u=s.mode,i=Ro({mode:"visible",children:i.children},u),$=wa($,u,l,null),$.flags|=2,i.return=s,$.return=s,i.sibling=$,s.child=i,Aa(s,t.child,null,l),i=s.child,i.memoizedState=Hc(l),i.childLanes=Pc(t,y,l),s.memoizedState=Uc,s=wl(null,i));else if(In(s),kd($)){if(y=$.nextSibling&&$.nextSibling.dataset,y)var K=y.dgst;y=K,i=Error(o(419)),i.stack="",i.digest=y,ul({value:i,source:null,stack:null}),s=Zc(t,s,l)}else if(ft||jr(t,s,l,!1),y=(l&t.childLanes)!==0,ft||y){if(y=Ge,y!==null&&(i=Qa(y,l),i!==0&&i!==q.retryLane))throw q.retryLane=i,Na(t,i),Gt(y,t,i),Lc;wd($)||Go(),s=Zc(t,s,l)}else wd($)?(s.flags|=192,s.child=t.child,s=null):(t=q.treeContext,Je=us($.nextSibling),$t=s,Oe=!0,Tn=null,cs=!1,t!==null&&t0(s,t),s=qc(s,i.children),s.flags|=4096);return s}return u?(Ln(),$=i.fallback,u=s.mode,q=t.child,K=q.sibling,i=sn(q,{mode:"hidden",children:i.children}),i.subtreeFlags=q.subtreeFlags&65011712,K!==null?$=sn(K,$):($=wa($,u,l,null),$.flags|=2),$.return=s,i.return=s,i.sibling=$,s.child=i,wl(null,i),i=s.child,$=t.child.memoizedState,$===null?$=Hc(l):(u=$.cachePool,u!==null?(q=mt._currentValue,u=u.parent!==q?{parent:q,pool:q}:u):u=o0(),$={baseLanes:$.baseLanes|l,cachePool:u}),i.memoizedState=$,i.childLanes=Pc(t,y,l),s.memoizedState=Uc,wl(t.child,i)):(In(s),l=t.child,t=l.sibling,l=sn(l,{mode:"visible",children:i.children}),l.return=s,l.sibling=null,t!==null&&(y=s.deletions,y===null?(s.deletions=[t],s.flags|=16):y.push(t)),s.child=l,s.memoizedState=null,l)}function qc(t,s){return s=Ro({mode:"visible",children:s},t.mode),s.return=t,t.child=s}function Ro(t,s){return t=Xt(22,t,null,s),t.lanes=0,t}function Zc(t,s,l){return Aa(s,t.child,null,l),t=qc(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function vm(t,s,l){t.lanes|=s;var i=t.alternate;i!==null&&(i.lanes|=s),rc(t.return,s,l)}function Gc(t,s,l,i,u,x){var y=t.memoizedState;y===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:i,tail:l,tailMode:u,treeForkCount:x}:(y.isBackwards=s,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=l,y.tailMode=u,y.treeForkCount=x)}function jm(t,s,l){var i=s.pendingProps,u=i.revealOrder,x=i.tail;i=i.children;var y=it.current,$=(y&2)!==0;if($?(y=y&1|2,s.flags|=128):y&=1,ne(it,y),At(t,s,i,l),i=Oe?dl:0,!$&&t!==null&&(t.flags&128)!==0)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vm(t,l,s);else if(t.tag===19)vm(t,l,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(u){case"forwards":for(l=s.child,u=null;l!==null;)t=l.alternate,t!==null&&ko(t)===null&&(u=l),l=l.sibling;l=u,l===null?(u=s.child,s.child=null):(u=l.sibling,l.sibling=null),Gc(s,!1,u,l,x,i);break;case"backwards":case"unstable_legacy-backwards":for(l=null,u=s.child,s.child=null;u!==null;){if(t=u.alternate,t!==null&&ko(t)===null){s.child=u;break}t=u.sibling,u.sibling=l,l=u,u=t}Gc(s,!0,l,null,x,i);break;case"together":Gc(s,!1,null,null,void 0,i);break;default:s.memoizedState=null}return s.child}function cn(t,s,l){if(t!==null&&(s.dependencies=t.dependencies),Hn|=s.lanes,(l&s.childLanes)===0)if(t!==null){if(jr(t,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(t!==null&&s.child!==t.child)throw Error(o(153));if(s.child!==null){for(t=s.child,l=sn(t,t.pendingProps),s.child=l,l.return=s;t.sibling!==null;)t=t.sibling,l=l.sibling=sn(t,t.pendingProps),l.return=s;l.sibling=null}return s.child}function Vc(t,s){return(t.lanes&s)!==0?!0:(t=t.dependencies,!!(t!==null&&po(t)))}function db(t,s,l){switch(s.tag){case 3:me(s,s.stateNode.containerInfo),zn(s,mt,t.memoizedState.cache),ka();break;case 27:case 5:xe(s);break;case 4:me(s,s.stateNode.containerInfo);break;case 10:zn(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,bc(s),null;break;case 13:var i=s.memoizedState;if(i!==null)return i.dehydrated!==null?(In(s),s.flags|=128,null):(l&s.child.childLanes)!==0?ym(t,s,l):(In(s),t=cn(t,s,l),t!==null?t.sibling:null);In(s);break;case 19:var u=(t.flags&128)!==0;if(i=(l&s.childLanes)!==0,i||(jr(t,s,l,!1),i=(l&s.childLanes)!==0),u){if(i)return jm(t,s,l);s.flags|=128}if(u=s.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),ne(it,it.current),i)break;return null;case 22:return s.lanes=0,xm(t,s,l,s.pendingProps);case 24:zn(s,mt,t.memoizedState.cache)}return cn(t,s,l)}function Nm(t,s,l){if(t!==null)if(t.memoizedProps!==s.pendingProps)ft=!0;else{if(!Vc(t,l)&&(s.flags&128)===0)return ft=!1,db(t,s,l);ft=(t.flags&131072)!==0}else ft=!1,Oe&&(s.flags&1048576)!==0&&e0(s,dl,s.index);switch(s.lanes=0,s.tag){case 16:e:{var i=s.pendingProps;if(t=$a(s.elementType),s.type=t,typeof t=="function")Xi(t)?(i=Ma(t,i),s.tag=1,s=bm(null,s,t,i,l)):(s.tag=0,s=Bc(null,s,t,i,l));else{if(t!=null){var u=t.$$typeof;if(u===E){s.tag=11,s=dm(null,s,t,i,l);break e}else if(u===I){s.tag=14,s=um(null,s,t,i,l);break e}}throw s=Z(t)||t,Error(o(306,s,""))}}return s;case 0:return Bc(t,s,s.type,s.pendingProps,l);case 1:return i=s.type,u=Ma(i,s.pendingProps),bm(t,s,i,u,l);case 3:e:{if(me(s,s.stateNode.containerInfo),t===null)throw Error(o(387));i=s.pendingProps;var x=s.memoizedState;u=x.element,mc(t,s),gl(s,i,null,l);var y=s.memoizedState;if(i=y.cache,zn(s,mt,i),i!==x.cache&&lc(s,[mt],l,!0),bl(),i=y.element,x.isDehydrated)if(x={element:i,isDehydrated:!1,cache:y.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=gm(t,s,i,l);break e}else if(i!==u){u=ls(Error(o(424)),s),ul(u),s=gm(t,s,i,l);break e}else{switch(t=s.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Je=us(t.firstChild),$t=s,Oe=!0,Tn=null,cs=!0,l=x0(s,null,i,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(ka(),i===u){s=cn(t,s,l);break e}At(t,s,i,l)}s=s.child}return s;case 26:return Oo(t,s),t===null?(l=zx(s.type,null,s.pendingProps,null))?s.memoizedState=l:Oe||(l=s.type,t=s.pendingProps,i=Ko(re.current).createElement(l),i[ot]=s,i[jt]=t,Tt(i,l,t),at(i),s.stateNode=i):s.memoizedState=zx(s.type,t.memoizedProps,s.pendingProps,t.memoizedState),null;case 27:return xe(s),t===null&&Oe&&(i=s.stateNode=Ax(s.type,s.pendingProps,re.current),$t=s,cs=!0,u=Je,Vn(s.type)?(Sd=u,Je=us(i.firstChild)):Je=u),At(t,s,s.pendingProps.children,l),Oo(t,s),t===null&&(s.flags|=4194304),s.child;case 5:return t===null&&Oe&&((u=i=Je)&&(i=Ub(i,s.type,s.pendingProps,cs),i!==null?(s.stateNode=i,$t=s,Je=us(i.firstChild),cs=!1,u=!0):u=!1),u||Mn(s)),xe(s),u=s.type,x=s.pendingProps,y=t!==null?t.memoizedProps:null,i=x.children,vd(u,x)?i=null:y!==null&&vd(u,y)&&(s.flags|=32),s.memoizedState!==null&&(u=yc(t,s,tb,null,null,l),Ll._currentValue=u),Oo(t,s),At(t,s,i,l),s.child;case 6:return t===null&&Oe&&((t=l=Je)&&(l=Hb(l,s.pendingProps,cs),l!==null?(s.stateNode=l,$t=s,Je=null,t=!0):t=!1),t||Mn(s)),null;case 13:return ym(t,s,l);case 4:return me(s,s.stateNode.containerInfo),i=s.pendingProps,t===null?s.child=Aa(s,null,i,l):At(t,s,i,l),s.child;case 11:return dm(t,s,s.type,s.pendingProps,l);case 7:return At(t,s,s.pendingProps,l),s.child;case 8:return At(t,s,s.pendingProps.children,l),s.child;case 12:return At(t,s,s.pendingProps.children,l),s.child;case 10:return i=s.pendingProps,zn(s,s.type,i.value),At(t,s,i.children,l),s.child;case 9:return u=s.type._context,i=s.pendingProps.children,Ca(s),u=Et(u),i=i(u),s.flags|=1,At(t,s,i,l),s.child;case 14:return um(t,s,s.type,s.pendingProps,l);case 15:return mm(t,s,s.type,s.pendingProps,l);case 19:return jm(t,s,l);case 31:return cb(t,s,l);case 22:return xm(t,s,l,s.pendingProps);case 24:return Ca(s),i=Et(mt),t===null?(u=cc(),u===null&&(u=Ge,x=oc(),u.pooledCache=x,x.refCount++,x!==null&&(u.pooledCacheLanes|=l),u=x),s.memoizedState={parent:i,cache:u},uc(s),zn(s,mt,u)):((t.lanes&l)!==0&&(mc(t,s),gl(s,null,null,l),bl()),u=t.memoizedState,x=s.memoizedState,u.parent!==i?(u={parent:i,cache:i},s.memoizedState=u,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=u),zn(s,mt,i)):(i=x.cache,zn(s,mt,i),i!==u.cache&&lc(s,[mt],l,!0))),At(t,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(o(156,s.tag))}function dn(t){t.flags|=4}function Qc(t,s,l,i,u){if((s=(t.mode&32)!==0)&&(s=!1),s){if(t.flags|=16777216,(u&335544128)===u)if(t.stateNode.complete)t.flags|=8192;else if(Jm())t.flags|=8192;else throw Ea=vo,dc}else t.flags&=-16777217}function wm(t,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Lx(s))if(Jm())t.flags|=8192;else throw Ea=vo,dc}function Io(t,s){s!==null&&(t.flags|=4),t.flags&16384&&(s=t.tag!==22?Es():536870912,t.lanes|=s,zr|=s)}function kl(t,s){if(!Oe)switch(t.tailMode){case"hidden":s=t.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var i=null;l!==null;)l.alternate!==null&&(i=l),l=l.sibling;i===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Fe(t){var s=t.alternate!==null&&t.alternate.child===t.child,l=0,i=0;if(s)for(var u=t.child;u!==null;)l|=u.lanes|u.childLanes,i|=u.subtreeFlags&65011712,i|=u.flags&65011712,u.return=t,u=u.sibling;else for(u=t.child;u!==null;)l|=u.lanes|u.childLanes,i|=u.subtreeFlags,i|=u.flags,u.return=t,u=u.sibling;return t.subtreeFlags|=i,t.childLanes=l,s}function ub(t,s,l){var i=s.pendingProps;switch(tc(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fe(s),null;case 1:return Fe(s),null;case 3:return l=s.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),s.memoizedState.cache!==i&&(s.flags|=2048),rn(mt),ae(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(vr(s)?dn(s):t===null||t.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,nc())),Fe(s),null;case 26:var u=s.type,x=s.memoizedState;return t===null?(dn(s),x!==null?(Fe(s),wm(s,x)):(Fe(s),Qc(s,u,null,i,l))):x?x!==t.memoizedState?(dn(s),Fe(s),wm(s,x)):(Fe(s),s.flags&=-16777217):(t=t.memoizedProps,t!==i&&dn(s),Fe(s),Qc(s,u,t,i,l)),null;case 27:if(he(s),l=re.current,u=s.type,t!==null&&s.stateNode!=null)t.memoizedProps!==i&&dn(s);else{if(!i){if(s.stateNode===null)throw Error(o(166));return Fe(s),null}t=X.current,vr(s)?s0(s):(t=Ax(u,i,l),s.stateNode=t,dn(s))}return Fe(s),null;case 5:if(he(s),u=s.type,t!==null&&s.stateNode!=null)t.memoizedProps!==i&&dn(s);else{if(!i){if(s.stateNode===null)throw Error(o(166));return Fe(s),null}if(x=X.current,vr(s))s0(s);else{var y=Ko(re.current);switch(x){case 1:x=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:x=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":x=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":x=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":x=y.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?x.multiple=!0:i.size&&(x.size=i.size);break;default:x=typeof i.is=="string"?y.createElement(u,{is:i.is}):y.createElement(u)}}x[ot]=s,x[jt]=i;e:for(y=s.child;y!==null;){if(y.tag===5||y.tag===6)x.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===s)break e;for(;y.sibling===null;){if(y.return===null||y.return===s)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}s.stateNode=x;e:switch(Tt(x,u,i),u){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&dn(s)}}return Fe(s),Qc(s,s.type,t===null?null:t.memoizedProps,s.pendingProps,l),null;case 6:if(t&&s.stateNode!=null)t.memoizedProps!==i&&dn(s);else{if(typeof i!="string"&&s.stateNode===null)throw Error(o(166));if(t=re.current,vr(s)){if(t=s.stateNode,l=s.memoizedProps,i=null,u=$t,u!==null)switch(u.tag){case 27:case 5:i=u.memoizedProps}t[ot]=s,t=!!(t.nodeValue===l||i!==null&&i.suppressHydrationWarning===!0||yx(t.nodeValue,l)),t||Mn(s,!0)}else t=Ko(t).createTextNode(i),t[ot]=s,s.stateNode=t}return Fe(s),null;case 31:if(l=s.memoizedState,t===null||t.memoizedState!==null){if(i=vr(s),l!==null){if(t===null){if(!i)throw Error(o(318));if(t=s.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(557));t[ot]=s}else ka(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Fe(s),t=!1}else l=nc(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=l),t=!0;if(!t)return s.flags&256?(Wt(s),s):(Wt(s),null);if((s.flags&128)!==0)throw Error(o(558))}return Fe(s),null;case 13:if(i=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(u=vr(s),i!==null&&i.dehydrated!==null){if(t===null){if(!u)throw Error(o(318));if(u=s.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(o(317));u[ot]=s}else ka(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Fe(s),u=!1}else u=nc(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=u),u=!0;if(!u)return s.flags&256?(Wt(s),s):(Wt(s),null)}return Wt(s),(s.flags&128)!==0?(s.lanes=l,s):(l=i!==null,t=t!==null&&t.memoizedState!==null,l&&(i=s.child,u=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(u=i.alternate.memoizedState.cachePool.pool),x=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(x=i.memoizedState.cachePool.pool),x!==u&&(i.flags|=2048)),l!==t&&l&&(s.child.flags|=8192),Io(s,s.updateQueue),Fe(s),null);case 4:return ae(),t===null&&hd(s.stateNode.containerInfo),Fe(s),null;case 10:return rn(s.type),Fe(s),null;case 19:if(W(it),i=s.memoizedState,i===null)return Fe(s),null;if(u=(s.flags&128)!==0,x=i.rendering,x===null)if(u)kl(i,!1);else{if(lt!==0||t!==null&&(t.flags&128)!==0)for(t=s.child;t!==null;){if(x=ko(t),x!==null){for(s.flags|=128,kl(i,!1),t=x.updateQueue,s.updateQueue=t,Io(s,t),s.subtreeFlags=0,t=l,l=s.child;l!==null;)Xu(l,t),l=l.sibling;return ne(it,it.current&1|2),Oe&&nn(s,i.treeForkCount),s.child}t=t.sibling}i.tail!==null&&vt()>Po&&(s.flags|=128,u=!0,kl(i,!1),s.lanes=4194304)}else{if(!u)if(t=ko(x),t!==null){if(s.flags|=128,u=!0,t=t.updateQueue,s.updateQueue=t,Io(s,t),kl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!x.alternate&&!Oe)return Fe(s),null}else 2*vt()-i.renderingStartTime>Po&&l!==536870912&&(s.flags|=128,u=!0,kl(i,!1),s.lanes=4194304);i.isBackwards?(x.sibling=s.child,s.child=x):(t=i.last,t!==null?t.sibling=x:s.child=x,i.last=x)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=vt(),t.sibling=null,l=it.current,ne(it,u?l&1|2:l&1),Oe&&nn(s,i.treeForkCount),t):(Fe(s),null);case 22:case 23:return Wt(s),pc(),i=s.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(s.flags|=8192):i&&(s.flags|=8192),i?(l&536870912)!==0&&(s.flags&128)===0&&(Fe(s),s.subtreeFlags&6&&(s.flags|=8192)):Fe(s),l=s.updateQueue,l!==null&&Io(s,l.retryQueue),l=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==l&&(s.flags|=2048),t!==null&&W(_a),null;case 24:return l=null,t!==null&&(l=t.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),rn(mt),Fe(s),null;case 25:return null;case 30:return null}throw Error(o(156,s.tag))}function mb(t,s){switch(tc(s),s.tag){case 1:return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return rn(mt),ae(),t=s.flags,(t&65536)!==0&&(t&128)===0?(s.flags=t&-65537|128,s):null;case 26:case 27:case 5:return he(s),null;case 31:if(s.memoizedState!==null){if(Wt(s),s.alternate===null)throw Error(o(340));ka()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 13:if(Wt(s),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(o(340));ka()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return W(it),null;case 4:return ae(),null;case 10:return rn(s.type),null;case 22:case 23:return Wt(s),pc(),t!==null&&W(_a),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 24:return rn(mt),null;case 25:return null;default:return null}}function km(t,s){switch(tc(s),s.tag){case 3:rn(mt),ae();break;case 26:case 27:case 5:he(s);break;case 4:ae();break;case 31:s.memoizedState!==null&&Wt(s);break;case 13:Wt(s);break;case 19:W(it);break;case 10:rn(s.type);break;case 22:case 23:Wt(s),pc(),t!==null&&W(_a);break;case 24:rn(mt)}}function Sl(t,s){try{var l=s.updateQueue,i=l!==null?l.lastEffect:null;if(i!==null){var u=i.next;l=u;do{if((l.tag&t)===t){i=void 0;var x=l.create,y=l.inst;i=x(),y.destroy=i}l=l.next}while(l!==u)}}catch($){He(s,s.return,$)}}function Bn(t,s,l){try{var i=s.updateQueue,u=i!==null?i.lastEffect:null;if(u!==null){var x=u.next;i=x;do{if((i.tag&t)===t){var y=i.inst,$=y.destroy;if($!==void 0){y.destroy=void 0,u=s;var q=l,K=$;try{K()}catch(le){He(u,q,le)}}}i=i.next}while(i!==x)}}catch(le){He(s,s.return,le)}}function Sm(t){var s=t.updateQueue;if(s!==null){var l=t.stateNode;try{h0(s,l)}catch(i){He(t,t.return,i)}}}function Cm(t,s,l){l.props=Ma(t.type,t.memoizedProps),l.state=t.memoizedState;try{l.componentWillUnmount()}catch(i){He(t,s,i)}}function Cl(t,s){try{var l=t.ref;if(l!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof l=="function"?t.refCleanup=l(i):l.current=i}}catch(u){He(t,s,u)}}function Ps(t,s){var l=t.ref,i=t.refCleanup;if(l!==null)if(typeof i=="function")try{i()}catch(u){He(t,s,u)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(u){He(t,s,u)}else l.current=null}function _m(t){var s=t.type,l=t.memoizedProps,i=t.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break e;case"img":l.src?i.src=l.src:l.srcSet&&(i.srcset=l.srcSet)}}catch(u){He(t,t.return,u)}}function Yc(t,s,l){try{var i=t.stateNode;Db(i,t.type,l,s),i[jt]=s}catch(u){He(t,t.return,u)}}function $m(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Vn(t.type)||t.tag===4}function Jc(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$m(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Vn(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Fc(t,s,l){var i=t.tag;if(i===5||i===6)t=t.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(t,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(t),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Ot));else if(i!==4&&(i===27&&Vn(t.type)&&(l=t.stateNode,s=null),t=t.child,t!==null))for(Fc(t,s,l),t=t.sibling;t!==null;)Fc(t,s,l),t=t.sibling}function Lo(t,s,l){var i=t.tag;if(i===5||i===6)t=t.stateNode,s?l.insertBefore(t,s):l.appendChild(t);else if(i!==4&&(i===27&&Vn(t.type)&&(l=t.stateNode),t=t.child,t!==null))for(Lo(t,s,l),t=t.sibling;t!==null;)Lo(t,s,l),t=t.sibling}function Em(t){var s=t.stateNode,l=t.memoizedProps;try{for(var i=t.type,u=s.attributes;u.length;)s.removeAttributeNode(u[0]);Tt(s,i,l),s[ot]=t,s[jt]=l}catch(x){He(t,t.return,x)}}var un=!1,ht=!1,Xc=!1,Am=typeof WeakSet=="function"?WeakSet:Set,Nt=null;function xb(t,s){if(t=t.containerInfo,gd=ri,t=Pu(t),Zi(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var i=l.getSelection&&l.getSelection();if(i&&i.rangeCount!==0){l=i.anchorNode;var u=i.anchorOffset,x=i.focusNode;i=i.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var y=0,$=-1,q=-1,K=0,le=0,ce=t,ee=null;t:for(;;){for(var se;ce!==l||u!==0&&ce.nodeType!==3||($=y+u),ce!==x||i!==0&&ce.nodeType!==3||(q=y+i),ce.nodeType===3&&(y+=ce.nodeValue.length),(se=ce.firstChild)!==null;)ee=ce,ce=se;for(;;){if(ce===t)break t;if(ee===l&&++K===u&&($=y),ee===x&&++le===i&&(q=y),(se=ce.nextSibling)!==null)break;ce=ee,ee=ce.parentNode}ce=se}l=$===-1||q===-1?null:{start:$,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(yd={focusedElem:t,selectionRange:l},ri=!1,Nt=s;Nt!==null;)if(s=Nt,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,Nt=t;else for(;Nt!==null;){switch(s=Nt,x=s.alternate,t=s.flags,s.tag){case 0:if((t&4)!==0&&(t=s.updateQueue,t=t!==null?t.events:null,t!==null))for(l=0;l<t.length;l++)u=t[l],u.ref.impl=u.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&x!==null){t=void 0,l=s,u=x.memoizedProps,x=x.memoizedState,i=l.stateNode;try{var be=Ma(l.type,u);t=i.getSnapshotBeforeUpdate(be,x),i.__reactInternalSnapshotBeforeUpdate=t}catch(we){He(l,l.return,we)}}break;case 3:if((t&1024)!==0){if(t=s.stateNode.containerInfo,l=t.nodeType,l===9)Nd(t);else if(l===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Nd(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(o(163))}if(t=s.sibling,t!==null){t.return=s.return,Nt=t;break}Nt=s.return}}function Tm(t,s,l){var i=l.flags;switch(l.tag){case 0:case 11:case 15:xn(t,l),i&4&&Sl(5,l);break;case 1:if(xn(t,l),i&4)if(t=l.stateNode,s===null)try{t.componentDidMount()}catch(y){He(l,l.return,y)}else{var u=Ma(l.type,s.memoizedProps);s=s.memoizedState;try{t.componentDidUpdate(u,s,t.__reactInternalSnapshotBeforeUpdate)}catch(y){He(l,l.return,y)}}i&64&&Sm(l),i&512&&Cl(l,l.return);break;case 3:if(xn(t,l),i&64&&(t=l.updateQueue,t!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{h0(t,s)}catch(y){He(l,l.return,y)}}break;case 27:s===null&&i&4&&Em(l);case 26:case 5:xn(t,l),s===null&&i&4&&_m(l),i&512&&Cl(l,l.return);break;case 12:xn(t,l);break;case 31:xn(t,l),i&4&&Dm(t,l);break;case 13:xn(t,l),i&4&&Om(t,l),i&64&&(t=l.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(l=Nb.bind(null,l),Pb(t,l))));break;case 22:if(i=l.memoizedState!==null||un,!i){s=s!==null&&s.memoizedState!==null||ht,u=un;var x=ht;un=i,(ht=s)&&!x?fn(t,l,(l.subtreeFlags&8772)!==0):xn(t,l),un=u,ht=x}break;case 30:break;default:xn(t,l)}}function Mm(t){var s=t.alternate;s!==null&&(t.alternate=null,Mm(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&Ks(s)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Xe=null,Ht=!1;function mn(t,s,l){for(l=l.child;l!==null;)zm(t,s,l),l=l.sibling}function zm(t,s,l){if(St&&typeof St.onCommitFiberUnmount=="function")try{St.onCommitFiberUnmount(Js,l)}catch{}switch(l.tag){case 26:ht||Ps(l,s),mn(t,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ht||Ps(l,s);var i=Xe,u=Ht;Vn(l.type)&&(Xe=l.stateNode,Ht=!1),mn(t,s,l),Ol(l.stateNode),Xe=i,Ht=u;break;case 5:ht||Ps(l,s);case 6:if(i=Xe,u=Ht,Xe=null,mn(t,s,l),Xe=i,Ht=u,Xe!==null)if(Ht)try{(Xe.nodeType===9?Xe.body:Xe.nodeName==="HTML"?Xe.ownerDocument.body:Xe).removeChild(l.stateNode)}catch(x){He(l,s,x)}else try{Xe.removeChild(l.stateNode)}catch(x){He(l,s,x)}break;case 18:Xe!==null&&(Ht?(t=Xe,Sx(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,l.stateNode),Hr(t)):Sx(Xe,l.stateNode));break;case 4:i=Xe,u=Ht,Xe=l.stateNode.containerInfo,Ht=!0,mn(t,s,l),Xe=i,Ht=u;break;case 0:case 11:case 14:case 15:Bn(2,l,s),ht||Bn(4,l,s),mn(t,s,l);break;case 1:ht||(Ps(l,s),i=l.stateNode,typeof i.componentWillUnmount=="function"&&Cm(l,s,i)),mn(t,s,l);break;case 21:mn(t,s,l);break;case 22:ht=(i=ht)||l.memoizedState!==null,mn(t,s,l),ht=i;break;default:mn(t,s,l)}}function Dm(t,s){if(s.memoizedState===null&&(t=s.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Hr(t)}catch(l){He(s,s.return,l)}}}function Om(t,s){if(s.memoizedState===null&&(t=s.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Hr(t)}catch(l){He(s,s.return,l)}}function fb(t){switch(t.tag){case 31:case 13:case 19:var s=t.stateNode;return s===null&&(s=t.stateNode=new Am),s;case 22:return t=t.stateNode,s=t._retryCache,s===null&&(s=t._retryCache=new Am),s;default:throw Error(o(435,t.tag))}}function Bo(t,s){var l=fb(t);s.forEach(function(i){if(!l.has(i)){l.add(i);var u=wb.bind(null,t,i);i.then(u,u)}})}function Pt(t,s){var l=s.deletions;if(l!==null)for(var i=0;i<l.length;i++){var u=l[i],x=t,y=s,$=y;e:for(;$!==null;){switch($.tag){case 27:if(Vn($.type)){Xe=$.stateNode,Ht=!1;break e}break;case 5:Xe=$.stateNode,Ht=!1;break e;case 3:case 4:Xe=$.stateNode.containerInfo,Ht=!0;break e}$=$.return}if(Xe===null)throw Error(o(160));zm(x,y,u),Xe=null,Ht=!1,x=u.alternate,x!==null&&(x.return=null),u.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Rm(s,t),s=s.sibling}var ws=null;function Rm(t,s){var l=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Pt(s,t),qt(t),i&4&&(Bn(3,t,t.return),Sl(3,t),Bn(5,t,t.return));break;case 1:Pt(s,t),qt(t),i&512&&(ht||l===null||Ps(l,l.return)),i&64&&un&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(l=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=l===null?i:l.concat(i))));break;case 26:var u=ws;if(Pt(s,t),qt(t),i&512&&(ht||l===null||Ps(l,l.return)),i&4){var x=l!==null?l.memoizedState:null;if(i=t.memoizedState,l===null)if(i===null)if(t.stateNode===null){e:{i=t.type,l=t.memoizedProps,u=u.ownerDocument||u;t:switch(i){case"title":x=u.getElementsByTagName("title")[0],(!x||x[Xs]||x[ot]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=u.createElement(i),u.head.insertBefore(x,u.querySelector("head > title"))),Tt(x,i,l),x[ot]=t,at(x),i=x;break e;case"link":var y=Rx("link","href",u).get(i+(l.href||""));if(y){for(var $=0;$<y.length;$++)if(x=y[$],x.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&x.getAttribute("rel")===(l.rel==null?null:l.rel)&&x.getAttribute("title")===(l.title==null?null:l.title)&&x.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){y.splice($,1);break t}}x=u.createElement(i),Tt(x,i,l),u.head.appendChild(x);break;case"meta":if(y=Rx("meta","content",u).get(i+(l.content||""))){for($=0;$<y.length;$++)if(x=y[$],x.getAttribute("content")===(l.content==null?null:""+l.content)&&x.getAttribute("name")===(l.name==null?null:l.name)&&x.getAttribute("property")===(l.property==null?null:l.property)&&x.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&x.getAttribute("charset")===(l.charSet==null?null:l.charSet)){y.splice($,1);break t}}x=u.createElement(i),Tt(x,i,l),u.head.appendChild(x);break;default:throw Error(o(468,i))}x[ot]=t,at(x),i=x}t.stateNode=i}else Ix(u,t.type,t.stateNode);else t.stateNode=Ox(u,i,t.memoizedProps);else x!==i?(x===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):x.count--,i===null?Ix(u,t.type,t.stateNode):Ox(u,i,t.memoizedProps)):i===null&&t.stateNode!==null&&Yc(t,t.memoizedProps,l.memoizedProps)}break;case 27:Pt(s,t),qt(t),i&512&&(ht||l===null||Ps(l,l.return)),l!==null&&i&4&&Yc(t,t.memoizedProps,l.memoizedProps);break;case 5:if(Pt(s,t),qt(t),i&512&&(ht||l===null||Ps(l,l.return)),t.flags&32){u=t.stateNode;try{_n(u,"")}catch(be){He(t,t.return,be)}}i&4&&t.stateNode!=null&&(u=t.memoizedProps,Yc(t,u,l!==null?l.memoizedProps:u)),i&1024&&(Xc=!0);break;case 6:if(Pt(s,t),qt(t),i&4){if(t.stateNode===null)throw Error(o(162));i=t.memoizedProps,l=t.stateNode;try{l.nodeValue=i}catch(be){He(t,t.return,be)}}break;case 3:if(ti=null,u=ws,ws=Wo(s.containerInfo),Pt(s,t),ws=u,qt(t),i&4&&l!==null&&l.memoizedState.isDehydrated)try{Hr(s.containerInfo)}catch(be){He(t,t.return,be)}Xc&&(Xc=!1,Im(t));break;case 4:i=ws,ws=Wo(t.stateNode.containerInfo),Pt(s,t),qt(t),ws=i;break;case 12:Pt(s,t),qt(t);break;case 31:Pt(s,t),qt(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Bo(t,i)));break;case 13:Pt(s,t),qt(t),t.child.flags&8192&&t.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Ho=vt()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Bo(t,i)));break;case 22:u=t.memoizedState!==null;var q=l!==null&&l.memoizedState!==null,K=un,le=ht;if(un=K||u,ht=le||q,Pt(s,t),ht=le,un=K,qt(t),i&8192)e:for(s=t.stateNode,s._visibility=u?s._visibility&-2:s._visibility|1,u&&(l===null||q||un||ht||za(t)),l=null,s=t;;){if(s.tag===5||s.tag===26){if(l===null){q=l=s;try{if(x=q.stateNode,u)y=x.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{$=q.stateNode;var ce=q.memoizedProps.style,ee=ce!=null&&ce.hasOwnProperty("display")?ce.display:null;$.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(be){He(q,q.return,be)}}}else if(s.tag===6){if(l===null){q=s;try{q.stateNode.nodeValue=u?"":q.memoizedProps}catch(be){He(q,q.return,be)}}}else if(s.tag===18){if(l===null){q=s;try{var se=q.stateNode;u?Cx(se,!0):Cx(q.stateNode,!1)}catch(be){He(q,q.return,be)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===t)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}i&4&&(i=t.updateQueue,i!==null&&(l=i.retryQueue,l!==null&&(i.retryQueue=null,Bo(t,l))));break;case 19:Pt(s,t),qt(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Bo(t,i)));break;case 30:break;case 21:break;default:Pt(s,t),qt(t)}}function qt(t){var s=t.flags;if(s&2){try{for(var l,i=t.return;i!==null;){if($m(i)){l=i;break}i=i.return}if(l==null)throw Error(o(160));switch(l.tag){case 27:var u=l.stateNode,x=Jc(t);Lo(t,x,u);break;case 5:var y=l.stateNode;l.flags&32&&(_n(y,""),l.flags&=-33);var $=Jc(t);Lo(t,$,y);break;case 3:case 4:var q=l.stateNode.containerInfo,K=Jc(t);Fc(t,K,q);break;default:throw Error(o(161))}}catch(le){He(t,t.return,le)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function Im(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var s=t;Im(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),t=t.sibling}}function xn(t,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Tm(t,s.alternate,s),s=s.sibling}function za(t){for(t=t.child;t!==null;){var s=t;switch(s.tag){case 0:case 11:case 14:case 15:Bn(4,s,s.return),za(s);break;case 1:Ps(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&Cm(s,s.return,l),za(s);break;case 27:Ol(s.stateNode);case 26:case 5:Ps(s,s.return),za(s);break;case 22:s.memoizedState===null&&za(s);break;case 30:za(s);break;default:za(s)}t=t.sibling}}function fn(t,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var i=s.alternate,u=t,x=s,y=x.flags;switch(x.tag){case 0:case 11:case 15:fn(u,x,l),Sl(4,x);break;case 1:if(fn(u,x,l),i=x,u=i.stateNode,typeof u.componentDidMount=="function")try{u.componentDidMount()}catch(K){He(i,i.return,K)}if(i=x,u=i.updateQueue,u!==null){var $=i.stateNode;try{var q=u.shared.hiddenCallbacks;if(q!==null)for(u.shared.hiddenCallbacks=null,u=0;u<q.length;u++)f0(q[u],$)}catch(K){He(i,i.return,K)}}l&&y&64&&Sm(x),Cl(x,x.return);break;case 27:Em(x);case 26:case 5:fn(u,x,l),l&&i===null&&y&4&&_m(x),Cl(x,x.return);break;case 12:fn(u,x,l);break;case 31:fn(u,x,l),l&&y&4&&Dm(u,x);break;case 13:fn(u,x,l),l&&y&4&&Om(u,x);break;case 22:x.memoizedState===null&&fn(u,x,l),Cl(x,x.return);break;case 30:break;default:fn(u,x,l)}s=s.sibling}}function Kc(t,s){var l=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),t=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(t=s.memoizedState.cachePool.pool),t!==l&&(t!=null&&t.refCount++,l!=null&&ml(l))}function Wc(t,s){t=null,s.alternate!==null&&(t=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==t&&(s.refCount++,t!=null&&ml(t))}function ks(t,s,l,i){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Lm(t,s,l,i),s=s.sibling}function Lm(t,s,l,i){var u=s.flags;switch(s.tag){case 0:case 11:case 15:ks(t,s,l,i),u&2048&&Sl(9,s);break;case 1:ks(t,s,l,i);break;case 3:ks(t,s,l,i),u&2048&&(t=null,s.alternate!==null&&(t=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==t&&(s.refCount++,t!=null&&ml(t)));break;case 12:if(u&2048){ks(t,s,l,i),t=s.stateNode;try{var x=s.memoizedProps,y=x.id,$=x.onPostCommit;typeof $=="function"&&$(y,s.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(q){He(s,s.return,q)}}else ks(t,s,l,i);break;case 31:ks(t,s,l,i);break;case 13:ks(t,s,l,i);break;case 23:break;case 22:x=s.stateNode,y=s.alternate,s.memoizedState!==null?x._visibility&2?ks(t,s,l,i):_l(t,s):x._visibility&2?ks(t,s,l,i):(x._visibility|=2,Ar(t,s,l,i,(s.subtreeFlags&10256)!==0||!1)),u&2048&&Kc(y,s);break;case 24:ks(t,s,l,i),u&2048&&Wc(s.alternate,s);break;default:ks(t,s,l,i)}}function Ar(t,s,l,i,u){for(u=u&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var x=t,y=s,$=l,q=i,K=y.flags;switch(y.tag){case 0:case 11:case 15:Ar(x,y,$,q,u),Sl(8,y);break;case 23:break;case 22:var le=y.stateNode;y.memoizedState!==null?le._visibility&2?Ar(x,y,$,q,u):_l(x,y):(le._visibility|=2,Ar(x,y,$,q,u)),u&&K&2048&&Kc(y.alternate,y);break;case 24:Ar(x,y,$,q,u),u&&K&2048&&Wc(y.alternate,y);break;default:Ar(x,y,$,q,u)}s=s.sibling}}function _l(t,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=t,i=s,u=i.flags;switch(i.tag){case 22:_l(l,i),u&2048&&Kc(i.alternate,i);break;case 24:_l(l,i),u&2048&&Wc(i.alternate,i);break;default:_l(l,i)}s=s.sibling}}var $l=8192;function Tr(t,s,l){if(t.subtreeFlags&$l)for(t=t.child;t!==null;)Bm(t,s,l),t=t.sibling}function Bm(t,s,l){switch(t.tag){case 26:Tr(t,s,l),t.flags&$l&&t.memoizedState!==null&&eg(l,ws,t.memoizedState,t.memoizedProps);break;case 5:Tr(t,s,l);break;case 3:case 4:var i=ws;ws=Wo(t.stateNode.containerInfo),Tr(t,s,l),ws=i;break;case 22:t.memoizedState===null&&(i=t.alternate,i!==null&&i.memoizedState!==null?(i=$l,$l=16777216,Tr(t,s,l),$l=i):Tr(t,s,l));break;default:Tr(t,s,l)}}function Um(t){var s=t.alternate;if(s!==null&&(t=s.child,t!==null)){s.child=null;do s=t.sibling,t.sibling=null,t=s;while(t!==null)}}function El(t){var s=t.deletions;if((t.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var i=s[l];Nt=i,Pm(i,t)}Um(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Hm(t),t=t.sibling}function Hm(t){switch(t.tag){case 0:case 11:case 15:El(t),t.flags&2048&&Bn(9,t,t.return);break;case 3:El(t);break;case 12:El(t);break;case 22:var s=t.stateNode;t.memoizedState!==null&&s._visibility&2&&(t.return===null||t.return.tag!==13)?(s._visibility&=-3,Uo(t)):El(t);break;default:El(t)}}function Uo(t){var s=t.deletions;if((t.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var i=s[l];Nt=i,Pm(i,t)}Um(t)}for(t=t.child;t!==null;){switch(s=t,s.tag){case 0:case 11:case 15:Bn(8,s,s.return),Uo(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Uo(s));break;default:Uo(s)}t=t.sibling}}function Pm(t,s){for(;Nt!==null;){var l=Nt;switch(l.tag){case 0:case 11:case 15:Bn(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var i=l.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:ml(l.memoizedState.cache)}if(i=l.child,i!==null)i.return=l,Nt=i;else e:for(l=t;Nt!==null;){i=Nt;var u=i.sibling,x=i.return;if(Mm(i),i===l){Nt=null;break e}if(u!==null){u.return=x,Nt=u;break e}Nt=x}}}var hb={getCacheForType:function(t){var s=Et(mt),l=s.data.get(t);return l===void 0&&(l=t(),s.data.set(t,l)),l},cacheSignal:function(){return Et(mt).controller.signal}},pb=typeof WeakMap=="function"?WeakMap:Map,Be=0,Ge=null,Te=null,ze=0,Ue=0,es=null,Un=!1,Mr=!1,ed=!1,hn=0,lt=0,Hn=0,Da=0,td=0,ts=0,zr=0,Al=null,Zt=null,sd=!1,Ho=0,qm=0,Po=1/0,qo=null,Pn=null,yt=0,qn=null,Dr=null,pn=0,nd=0,ad=null,Zm=null,Tl=0,rd=null;function ss(){return(Be&2)!==0&&ze!==0?ze&-ze:H.T!==null?ud():Ya()}function Gm(){if(ts===0)if((ze&536870912)===0||Oe){var t=vn;vn<<=1,(vn&3932160)===0&&(vn=262144),ts=t}else ts=536870912;return t=Kt.current,t!==null&&(t.flags|=32),ts}function Gt(t,s,l){(t===Ge&&(Ue===2||Ue===9)||t.cancelPendingCommit!==null)&&(Or(t,0),Zn(t,ze,ts,!1)),As(t,l),((Be&2)===0||t!==Ge)&&(t===Ge&&((Be&2)===0&&(Da|=l),lt===4&&Zn(t,ze,ts,!1)),qs(t))}function Vm(t,s,l){if((Be&6)!==0)throw Error(o(327));var i=!l&&(s&127)===0&&(s&t.expiredLanes)===0||$s(t,s),u=i?yb(t,s):od(t,s,!0),x=i;do{if(u===0){Mr&&!i&&Zn(t,s,0,!1);break}else{if(l=t.current.alternate,x&&!bb(l)){u=od(t,s,!1),x=!1;continue}if(u===2){if(x=s,t.errorRecoveryDisabledLanes&x)var y=0;else y=t.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){s=y;e:{var $=t;u=Al;var q=$.current.memoizedState.isDehydrated;if(q&&(Or($,y).flags|=256),y=od($,y,!1),y!==2){if(ed&&!q){$.errorRecoveryDisabledLanes|=x,Da|=x,u=4;break e}x=Zt,Zt=u,x!==null&&(Zt===null?Zt=x:Zt.push.apply(Zt,x))}u=y}if(x=!1,u!==2)continue}}if(u===1){Or(t,0),Zn(t,s,0,!0);break}e:{switch(i=t,x=u,x){case 0:case 1:throw Error(o(345));case 4:if((s&4194048)!==s)break;case 6:Zn(i,s,ts,!Un);break e;case 2:Zt=null;break;case 3:case 5:break;default:throw Error(o(329))}if((s&62914560)===s&&(u=Ho+300-vt(),10<u)){if(Zn(i,s,ts,!Un),Nn(i,0,!0)!==0)break e;pn=s,i.timeoutHandle=wx(Qm.bind(null,i,l,Zt,qo,sd,s,ts,Da,zr,Un,x,"Throttled",-0,0),u);break e}Qm(i,l,Zt,qo,sd,s,ts,Da,zr,Un,x,null,-0,0)}}break}while(!0);qs(t)}function Qm(t,s,l,i,u,x,y,$,q,K,le,ce,ee,se){if(t.timeoutHandle=-1,ce=s.subtreeFlags,ce&8192||(ce&16785408)===16785408){ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ot},Bm(s,x,ce);var be=(x&62914560)===x?Ho-vt():(x&4194048)===x?qm-vt():0;if(be=tg(ce,be),be!==null){pn=x,t.cancelPendingCommit=be(tx.bind(null,t,s,x,l,i,u,y,$,q,le,ce,null,ee,se)),Zn(t,x,y,!K);return}}tx(t,s,x,l,i,u,y,$,q)}function bb(t){for(var s=t;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var i=0;i<l.length;i++){var u=l[i],x=u.getSnapshot;u=u.value;try{if(!Ft(x(),u))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Zn(t,s,l,i){s&=~td,s&=~Da,t.suspendedLanes|=s,t.pingedLanes&=~s,i&&(t.warmLanes|=s),i=t.expirationTimes;for(var u=s;0<u;){var x=31-Ye(u),y=1<<x;i[x]=-1,u&=~y}l!==0&&Va(t,l,s)}function Zo(){return(Be&6)===0?(Ml(0),!1):!0}function ld(){if(Te!==null){if(Ue===0)var t=Te.return;else t=Te,an=Sa=null,Nc(t),Sr=null,fl=0,t=Te;for(;t!==null;)km(t.alternate,t),t=t.return;Te=null}}function Or(t,s){var l=t.timeoutHandle;l!==-1&&(t.timeoutHandle=-1,Ib(l)),l=t.cancelPendingCommit,l!==null&&(t.cancelPendingCommit=null,l()),pn=0,ld(),Ge=t,Te=l=sn(t.current,null),ze=s,Ue=0,es=null,Un=!1,Mr=$s(t,s),ed=!1,zr=ts=td=Da=Hn=lt=0,Zt=Al=null,sd=!1,(s&8)!==0&&(s|=s&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=s;0<i;){var u=31-Ye(i),x=1<<u;s|=t[u],i&=~x}return hn=s,uo(),l}function Ym(t,s){Ee=null,H.H=Nl,s===kr||s===yo?(s=d0(),Ue=3):s===dc?(s=d0(),Ue=4):Ue=s===Lc?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,es=s,Te===null&&(lt=1,zo(t,ls(s,t.current)))}function Jm(){var t=Kt.current;return t===null?!0:(ze&4194048)===ze?ds===null:(ze&62914560)===ze||(ze&536870912)!==0?t===ds:!1}function Fm(){var t=H.H;return H.H=Nl,t===null?Nl:t}function Xm(){var t=H.A;return H.A=hb,t}function Go(){lt=4,Un||(ze&4194048)!==ze&&Kt.current!==null||(Mr=!0),(Hn&134217727)===0&&(Da&134217727)===0||Ge===null||Zn(Ge,ze,ts,!1)}function od(t,s,l){var i=Be;Be|=2;var u=Fm(),x=Xm();(Ge!==t||ze!==s)&&(qo=null,Or(t,s)),s=!1;var y=lt;e:do try{if(Ue!==0&&Te!==null){var $=Te,q=es;switch(Ue){case 8:ld(),y=6;break e;case 3:case 2:case 9:case 6:Kt.current===null&&(s=!0);var K=Ue;if(Ue=0,es=null,Rr(t,$,q,K),l&&Mr){y=0;break e}break;default:K=Ue,Ue=0,es=null,Rr(t,$,q,K)}}gb(),y=lt;break}catch(le){Ym(t,le)}while(!0);return s&&t.shellSuspendCounter++,an=Sa=null,Be=i,H.H=u,H.A=x,Te===null&&(Ge=null,ze=0,uo()),y}function gb(){for(;Te!==null;)Km(Te)}function yb(t,s){var l=Be;Be|=2;var i=Fm(),u=Xm();Ge!==t||ze!==s?(qo=null,Po=vt()+500,Or(t,s)):Mr=$s(t,s);e:do try{if(Ue!==0&&Te!==null){s=Te;var x=es;t:switch(Ue){case 1:Ue=0,es=null,Rr(t,s,x,1);break;case 2:case 9:if(i0(x)){Ue=0,es=null,Wm(s);break}s=function(){Ue!==2&&Ue!==9||Ge!==t||(Ue=7),qs(t)},x.then(s,s);break e;case 3:Ue=7;break e;case 4:Ue=5;break e;case 7:i0(x)?(Ue=0,es=null,Wm(s)):(Ue=0,es=null,Rr(t,s,x,7));break;case 5:var y=null;switch(Te.tag){case 26:y=Te.memoizedState;case 5:case 27:var $=Te;if(y?Lx(y):$.stateNode.complete){Ue=0,es=null;var q=$.sibling;if(q!==null)Te=q;else{var K=$.return;K!==null?(Te=K,Vo(K)):Te=null}break t}}Ue=0,es=null,Rr(t,s,x,5);break;case 6:Ue=0,es=null,Rr(t,s,x,6);break;case 8:ld(),lt=6;break e;default:throw Error(o(462))}}vb();break}catch(le){Ym(t,le)}while(!0);return an=Sa=null,H.H=i,H.A=u,Be=l,Te!==null?0:(Ge=null,ze=0,uo(),lt)}function vb(){for(;Te!==null&&!qa();)Km(Te)}function Km(t){var s=Nm(t.alternate,t,hn);t.memoizedProps=t.pendingProps,s===null?Vo(t):Te=s}function Wm(t){var s=t,l=s.alternate;switch(s.tag){case 15:case 0:s=pm(l,s,s.pendingProps,s.type,void 0,ze);break;case 11:s=pm(l,s,s.pendingProps,s.type.render,s.ref,ze);break;case 5:Nc(s);default:km(l,s),s=Te=Xu(s,hn),s=Nm(l,s,hn)}t.memoizedProps=t.pendingProps,s===null?Vo(t):Te=s}function Rr(t,s,l,i){an=Sa=null,Nc(s),Sr=null,fl=0;var u=s.return;try{if(ib(t,u,s,l,ze)){lt=1,zo(t,ls(l,t.current)),Te=null;return}}catch(x){if(u!==null)throw Te=u,x;lt=1,zo(t,ls(l,t.current)),Te=null;return}s.flags&32768?(Oe||i===1?t=!0:Mr||(ze&536870912)!==0?t=!1:(Un=t=!0,(i===2||i===9||i===3||i===6)&&(i=Kt.current,i!==null&&i.tag===13&&(i.flags|=16384))),ex(s,t)):Vo(s)}function Vo(t){var s=t;do{if((s.flags&32768)!==0){ex(s,Un);return}t=s.return;var l=ub(s.alternate,s,hn);if(l!==null){Te=l;return}if(s=s.sibling,s!==null){Te=s;return}Te=s=t}while(s!==null);lt===0&&(lt=5)}function ex(t,s){do{var l=mb(t.alternate,t);if(l!==null){l.flags&=32767,Te=l;return}if(l=t.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(t=t.sibling,t!==null)){Te=t;return}Te=t=l}while(t!==null);lt=6,Te=null}function tx(t,s,l,i,u,x,y,$,q){t.cancelPendingCommit=null;do Qo();while(yt!==0);if((Be&6)!==0)throw Error(o(327));if(s!==null){if(s===t.current)throw Error(o(177));if(x=s.lanes|s.childLanes,x|=Ji,Wr(t,l,x,y,$,q),t===Ge&&(Te=Ge=null,ze=0),Dr=s,qn=t,pn=l,nd=x,ad=u,Zm=i,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,kb(Ys,function(){return lx(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||i){i=H.T,H.T=null,u=O.p,O.p=2,y=Be,Be|=4;try{xb(t,s,l)}finally{Be=y,O.p=u,H.T=i}}yt=1,sx(),nx(),ax()}}function sx(){if(yt===1){yt=0;var t=qn,s=Dr,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=H.T,H.T=null;var i=O.p;O.p=2;var u=Be;Be|=4;try{Rm(s,t);var x=yd,y=Pu(t.containerInfo),$=x.focusedElem,q=x.selectionRange;if(y!==$&&$&&$.ownerDocument&&Hu($.ownerDocument.documentElement,$)){if(q!==null&&Zi($)){var K=q.start,le=q.end;if(le===void 0&&(le=K),"selectionStart"in $)$.selectionStart=K,$.selectionEnd=Math.min(le,$.value.length);else{var ce=$.ownerDocument||document,ee=ce&&ce.defaultView||window;if(ee.getSelection){var se=ee.getSelection(),be=$.textContent.length,we=Math.min(q.start,be),Ze=q.end===void 0?we:Math.min(q.end,be);!se.extend&&we>Ze&&(y=Ze,Ze=we,we=y);var Y=Uu($,we),V=Uu($,Ze);if(Y&&V&&(se.rangeCount!==1||se.anchorNode!==Y.node||se.anchorOffset!==Y.offset||se.focusNode!==V.node||se.focusOffset!==V.offset)){var F=ce.createRange();F.setStart(Y.node,Y.offset),se.removeAllRanges(),we>Ze?(se.addRange(F),se.extend(V.node,V.offset)):(F.setEnd(V.node,V.offset),se.addRange(F))}}}}for(ce=[],se=$;se=se.parentNode;)se.nodeType===1&&ce.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<ce.length;$++){var oe=ce[$];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}ri=!!gd,yd=gd=null}finally{Be=u,O.p=i,H.T=l}}t.current=s,yt=2}}function nx(){if(yt===2){yt=0;var t=qn,s=Dr,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=H.T,H.T=null;var i=O.p;O.p=2;var u=Be;Be|=4;try{Tm(t,s.alternate,s)}finally{Be=u,O.p=i,H.T=l}}yt=3}}function ax(){if(yt===4||yt===3){yt=0,la();var t=qn,s=Dr,l=pn,i=Zm;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?yt=5:(yt=0,Dr=qn=null,rx(t,t.pendingLanes));var u=t.pendingLanes;if(u===0&&(Pn=null),ma(l),s=s.stateNode,St&&typeof St.onCommitFiberRoot=="function")try{St.onCommitFiberRoot(Js,s,void 0,(s.current.flags&128)===128)}catch{}if(i!==null){s=H.T,u=O.p,O.p=2,H.T=null;try{for(var x=t.onRecoverableError,y=0;y<i.length;y++){var $=i[y];x($.value,{componentStack:$.stack})}}finally{H.T=s,O.p=u}}(pn&3)!==0&&Qo(),qs(t),u=t.pendingLanes,(l&261930)!==0&&(u&42)!==0?t===rd?Tl++:(Tl=0,rd=t):Tl=0,Ml(0)}}function rx(t,s){(t.pooledCacheLanes&=s)===0&&(s=t.pooledCache,s!=null&&(t.pooledCache=null,ml(s)))}function Qo(){return sx(),nx(),ax(),lx()}function lx(){if(yt!==5)return!1;var t=qn,s=nd;nd=0;var l=ma(pn),i=H.T,u=O.p;try{O.p=32>l?32:l,H.T=null,l=ad,ad=null;var x=qn,y=pn;if(yt=0,Dr=qn=null,pn=0,(Be&6)!==0)throw Error(o(331));var $=Be;if(Be|=4,Hm(x.current),Lm(x,x.current,y,l),Be=$,Ml(0,!1),St&&typeof St.onPostCommitFiberRoot=="function")try{St.onPostCommitFiberRoot(Js,x)}catch{}return!0}finally{O.p=u,H.T=i,rx(t,s)}}function ox(t,s,l){s=ls(l,s),s=Ic(t.stateNode,s,2),t=Rn(t,s,2),t!==null&&(As(t,2),qs(t))}function He(t,s,l){if(t.tag===3)ox(t,t,l);else for(;s!==null;){if(s.tag===3){ox(s,t,l);break}else if(s.tag===1){var i=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Pn===null||!Pn.has(i))){t=ls(l,t),l=im(2),i=Rn(s,l,2),i!==null&&(cm(l,i,s,t),As(i,2),qs(i));break}}s=s.return}}function id(t,s,l){var i=t.pingCache;if(i===null){i=t.pingCache=new pb;var u=new Set;i.set(s,u)}else u=i.get(s),u===void 0&&(u=new Set,i.set(s,u));u.has(l)||(ed=!0,u.add(l),t=jb.bind(null,t,s,l),s.then(t,t))}function jb(t,s,l){var i=t.pingCache;i!==null&&i.delete(s),t.pingedLanes|=t.suspendedLanes&l,t.warmLanes&=~l,Ge===t&&(ze&l)===l&&(lt===4||lt===3&&(ze&62914560)===ze&&300>vt()-Ho?(Be&2)===0&&Or(t,0):td|=l,zr===ze&&(zr=0)),qs(t)}function ix(t,s){s===0&&(s=Es()),t=Na(t,s),t!==null&&(As(t,s),qs(t))}function Nb(t){var s=t.memoizedState,l=0;s!==null&&(l=s.retryLane),ix(t,l)}function wb(t,s){var l=0;switch(t.tag){case 31:case 13:var i=t.stateNode,u=t.memoizedState;u!==null&&(l=u.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(o(314))}i!==null&&i.delete(s),ix(t,l)}function kb(t,s){return Qs(t,s)}var Yo=null,Ir=null,cd=!1,Jo=!1,dd=!1,Gn=0;function qs(t){t!==Ir&&t.next===null&&(Ir===null?Yo=Ir=t:Ir=Ir.next=t),Jo=!0,cd||(cd=!0,Cb())}function Ml(t,s){if(!dd&&Jo){dd=!0;do for(var l=!1,i=Yo;i!==null;){if(t!==0){var u=i.pendingLanes;if(u===0)var x=0;else{var y=i.suspendedLanes,$=i.pingedLanes;x=(1<<31-Ye(42|t)+1)-1,x&=u&~(y&~$),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(l=!0,mx(i,x))}else x=ze,x=Nn(i,i===Ge?x:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(x&3)===0||$s(i,x)||(l=!0,mx(i,x));i=i.next}while(l);dd=!1}}function Sb(){cx()}function cx(){Jo=cd=!1;var t=0;Gn!==0&&Rb()&&(t=Gn);for(var s=vt(),l=null,i=Yo;i!==null;){var u=i.next,x=dx(i,s);x===0?(i.next=null,l===null?Yo=u:l.next=u,u===null&&(Ir=l)):(l=i,(t!==0||(x&3)!==0)&&(Jo=!0)),i=u}yt!==0&&yt!==5||Ml(t),Gn!==0&&(Gn=0)}function dx(t,s){for(var l=t.suspendedLanes,i=t.pingedLanes,u=t.expirationTimes,x=t.pendingLanes&-62914561;0<x;){var y=31-Ye(x),$=1<<y,q=u[y];q===-1?(($&l)===0||($&i)!==0)&&(u[y]=Fs($,s)):q<=s&&(t.expiredLanes|=$),x&=~$}if(s=Ge,l=ze,l=Nn(t,t===s?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,l===0||t===s&&(Ue===2||Ue===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&ps(i),t.callbackNode=null,t.callbackPriority=0;if((l&3)===0||$s(t,l)){if(s=l&-l,s===t.callbackPriority)return s;switch(i!==null&&ps(i),ma(l)){case 2:case 8:l=ia;break;case 32:l=Ys;break;case 268435456:l=Ga;break;default:l=Ys}return i=ux.bind(null,t),l=Qs(l,i),t.callbackPriority=s,t.callbackNode=l,s}return i!==null&&i!==null&&ps(i),t.callbackPriority=2,t.callbackNode=null,2}function ux(t,s){if(yt!==0&&yt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var l=t.callbackNode;if(Qo()&&t.callbackNode!==l)return null;var i=ze;return i=Nn(t,t===Ge?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(Vm(t,i,s),dx(t,vt()),t.callbackNode!=null&&t.callbackNode===l?ux.bind(null,t):null)}function mx(t,s){if(Qo())return null;Vm(t,s,!0)}function Cb(){Lb(function(){(Be&6)!==0?Qs(oa,Sb):cx()})}function ud(){if(Gn===0){var t=Nr;t===0&&(t=yn,yn<<=1,(yn&261888)===0&&(yn=256)),Gn=t}return Gn}function xx(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:ha(""+t)}function fx(t,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,t.id&&l.setAttribute("form",t.id),s.parentNode.insertBefore(l,s),t=new FormData(t),l.parentNode.removeChild(l),t}function _b(t,s,l,i,u){if(s==="submit"&&l&&l.stateNode===u){var x=xx((u[jt]||null).action),y=i.submitter;y&&(s=(s=y[jt]||null)?xx(s.formAction):y.getAttribute("formAction"),s!==null&&(x=s,y=null));var $=new en("action","action",null,i,u);t.push({event:$,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Gn!==0){var q=y?fx(u,y):new FormData(u);Tc(l,{pending:!0,data:q,method:u.method,action:x},null,q)}}else typeof x=="function"&&($.preventDefault(),q=y?fx(u,y):new FormData(u),Tc(l,{pending:!0,data:q,method:u.method,action:x},x,q))},currentTarget:u}]})}}for(var md=0;md<Yi.length;md++){var xd=Yi[md],$b=xd.toLowerCase(),Eb=xd[0].toUpperCase()+xd.slice(1);Ns($b,"on"+Eb)}Ns(Gu,"onAnimationEnd"),Ns(Vu,"onAnimationIteration"),Ns(Qu,"onAnimationStart"),Ns("dblclick","onDoubleClick"),Ns("focusin","onFocus"),Ns("focusout","onBlur"),Ns(Gp,"onTransitionRun"),Ns(Vp,"onTransitionStart"),Ns(Qp,"onTransitionCancel"),Ns(Yu,"onTransitionEnd"),Os("onMouseEnter",["mouseout","mouseover"]),Os("onMouseLeave",["mouseout","mouseover"]),Os("onPointerEnter",["pointerout","pointerover"]),Os("onPointerLeave",["pointerout","pointerover"]),gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gs("onBeforeInput",["compositionend","keypress","textInput","paste"]),gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ab=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zl));function hx(t,s){s=(s&4)!==0;for(var l=0;l<t.length;l++){var i=t[l],u=i.event;i=i.listeners;e:{var x=void 0;if(s)for(var y=i.length-1;0<=y;y--){var $=i[y],q=$.instance,K=$.currentTarget;if($=$.listener,q!==x&&u.isPropagationStopped())break e;x=$,u.currentTarget=K;try{x(u)}catch(le){co(le)}u.currentTarget=null,x=q}else for(y=0;y<i.length;y++){if($=i[y],q=$.instance,K=$.currentTarget,$=$.listener,q!==x&&u.isPropagationStopped())break e;x=$,u.currentTarget=K;try{x(u)}catch(le){co(le)}u.currentTarget=null,x=q}}}}function Me(t,s){var l=s[xa];l===void 0&&(l=s[xa]=new Set);var i=t+"__bubble";l.has(i)||(px(s,t,2,!1),l.add(i))}function fd(t,s,l){var i=0;s&&(i|=4),px(l,t,i,s)}var Fo="_reactListening"+Math.random().toString(36).slice(2);function hd(t){if(!t[Fo]){t[Fo]=!0,Xa.forEach(function(l){l!=="selectionchange"&&(Ab.has(l)||fd(l,!1,t),fd(l,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[Fo]||(s[Fo]=!0,fd("selectionchange",!1,s))}}function px(t,s,l,i){switch(Gx(s)){case 2:var u=ag;break;case 8:u=rg;break;default:u=Ad}l=u.bind(null,s,l,t),u=void 0,!ir||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(u=!0),i?u!==void 0?t.addEventListener(s,l,{capture:!0,passive:u}):t.addEventListener(s,l,!0):u!==void 0?t.addEventListener(s,l,{passive:u}):t.addEventListener(s,l,!1)}function pd(t,s,l,i,u){var x=i;if((s&1)===0&&(s&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var $=i.stateNode.containerInfo;if($===u)break;if(y===4)for(y=i.return;y!==null;){var q=y.tag;if((q===3||q===4)&&y.stateNode.containerInfo===u)return;y=y.return}for(;$!==null;){if(y=Ms($),y===null)return;if(q=y.tag,q===5||q===6||q===26||q===27){i=x=y;continue e}$=$.parentNode}}i=i.return}or(function(){var K=x,le=lr(l),ce=[];e:{var ee=Ju.get(t);if(ee!==void 0){var se=en,be=t;switch(t){case"keypress":if(dr(l)===0)break e;case"keydown":case"keyup":se=wp;break;case"focusin":be="focus",se=js;break;case"focusout":be="blur",se=js;break;case"beforeblur":case"afterblur":se=js;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=$e;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=tn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=Cp;break;case Gu:case Vu:case Qu:se=Bi;break;case Yu:se=$p;break;case"scroll":case"scrollend":se=Li;break;case"wheel":se=Ap;break;case"copy":case"cut":case"paste":se=pp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=Cu;break;case"toggle":case"beforetoggle":se=Mp}var we=(s&4)!==0,Ze=!we&&(t==="scroll"||t==="scrollend"),Y=we?ee!==null?ee+"Capture":null:ee;we=[];for(var V=K,F;V!==null;){var oe=V;if(F=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||F===null||Y===null||(oe=ba(V,Y),oe!=null&&we.push(Dl(V,oe,F))),Ze)break;V=V.return}0<we.length&&(ee=new se(ee,be,null,l,le),ce.push({event:ee,listeners:we}))}}if((s&7)===0){e:{if(ee=t==="mouseover"||t==="pointerover",se=t==="mouseout"||t==="pointerout",ee&&l!==rr&&(be=l.relatedTarget||l.fromElement)&&(Ms(be)||be[Ts]))break e;if((se||ee)&&(ee=le.window===le?le:(ee=le.ownerDocument)?ee.defaultView||ee.parentWindow:window,se?(be=l.relatedTarget||l.toElement,se=K,be=be?Ms(be):null,be!==null&&(Ze=d(be),we=be.tag,be!==Ze||we!==5&&we!==27&&we!==6)&&(be=null)):(se=null,be=K),se!==be)){if(we=$e,oe="onMouseLeave",Y="onMouseEnter",V="mouse",(t==="pointerout"||t==="pointerover")&&(we=Cu,oe="onPointerLeave",Y="onPointerEnter",V="pointer"),Ze=se==null?ee:Ws(se),F=be==null?ee:Ws(be),ee=new we(oe,V+"leave",se,l,le),ee.target=Ze,ee.relatedTarget=F,oe=null,Ms(le)===K&&(we=new we(Y,V+"enter",be,l,le),we.target=F,we.relatedTarget=Ze,oe=we),Ze=oe,se&&be)t:{for(we=Tb,Y=se,V=be,F=0,oe=Y;oe;oe=we(oe))F++;oe=0;for(var je=V;je;je=we(je))oe++;for(;0<F-oe;)Y=we(Y),F--;for(;0<oe-F;)V=we(V),oe--;for(;F--;){if(Y===V||V!==null&&Y===V.alternate){we=Y;break t}Y=we(Y),V=we(V)}we=null}else we=null;se!==null&&bx(ce,ee,se,we,!1),be!==null&&Ze!==null&&bx(ce,Ze,be,we,!0)}}e:{if(ee=K?Ws(K):window,se=ee.nodeName&&ee.nodeName.toLowerCase(),se==="select"||se==="input"&&ee.type==="file")var Ie=Du;else if(Mu(ee))if(Ou)Ie=Pp;else{Ie=Up;var ve=Bp}else se=ee.nodeName,!se||se.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?K&&nr(K.elementType)&&(Ie=Du):Ie=Hp;if(Ie&&(Ie=Ie(t,K))){zu(ce,Ie,l,le);break e}ve&&ve(t,ee,K),t==="focusout"&&K&&ee.type==="number"&&K.memoizedProps.value!=null&&Sn(ee,"number",ee.value)}switch(ve=K?Ws(K):window,t){case"focusin":(Mu(ve)||ve.contentEditable==="true")&&(fr=ve,Gi=K,cl=null);break;case"focusout":cl=Gi=fr=null;break;case"mousedown":Vi=!0;break;case"contextmenu":case"mouseup":case"dragend":Vi=!1,qu(ce,l,le);break;case"selectionchange":if(Zp)break;case"keydown":case"keyup":qu(ce,l,le)}var Ae;if(Hi)e:{switch(t){case"compositionstart":var De="onCompositionStart";break e;case"compositionend":De="onCompositionEnd";break e;case"compositionupdate":De="onCompositionUpdate";break e}De=void 0}else xr?Au(t,l)&&(De="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(De="onCompositionStart");De&&(_u&&l.locale!=="ko"&&(xr||De!=="onCompositionStart"?De==="onCompositionEnd"&&xr&&(Ae=lo()):(Ls=le,En="value"in Ls?Ls.value:Ls.textContent,xr=!0)),ve=Xo(K,De),0<ve.length&&(De=new Su(De,t,null,l,le),ce.push({event:De,listeners:ve}),Ae?De.data=Ae:(Ae=Tu(l),Ae!==null&&(De.data=Ae)))),(Ae=Dp?Op(t,l):Rp(t,l))&&(De=Xo(K,"onBeforeInput"),0<De.length&&(ve=new Su("onBeforeInput","beforeinput",null,l,le),ce.push({event:ve,listeners:De}),ve.data=Ae)),_b(ce,t,K,l,le)}hx(ce,s)})}function Dl(t,s,l){return{instance:t,listener:s,currentTarget:l}}function Xo(t,s){for(var l=s+"Capture",i=[];t!==null;){var u=t,x=u.stateNode;if(u=u.tag,u!==5&&u!==26&&u!==27||x===null||(u=ba(t,l),u!=null&&i.unshift(Dl(t,u,x)),u=ba(t,s),u!=null&&i.push(Dl(t,u,x))),t.tag===3)return i;t=t.return}return[]}function Tb(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function bx(t,s,l,i,u){for(var x=s._reactName,y=[];l!==null&&l!==i;){var $=l,q=$.alternate,K=$.stateNode;if($=$.tag,q!==null&&q===i)break;$!==5&&$!==26&&$!==27||K===null||(q=K,u?(K=ba(l,x),K!=null&&y.unshift(Dl(l,K,q))):u||(K=ba(l,x),K!=null&&y.push(Dl(l,K,q)))),l=l.return}y.length!==0&&t.push({event:s,listeners:y})}var Mb=/\r\n?/g,zb=/\u0000|\uFFFD/g;function gx(t){return(typeof t=="string"?t:""+t).replace(Mb,`
`).replace(zb,"")}function yx(t,s){return s=gx(s),gx(t)===s}function qe(t,s,l,i,u,x){switch(l){case"children":typeof i=="string"?s==="body"||s==="textarea"&&i===""||_n(t,i):(typeof i=="number"||typeof i=="bigint")&&s!=="body"&&_n(t,""+i);break;case"className":kn(t,"class",i);break;case"tabIndex":kn(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":kn(t,l,i);break;case"style":ao(t,i,x);break;case"data":if(s!=="object"){kn(t,"data",i);break}case"src":case"href":if(i===""&&(s!=="a"||l!=="href")){t.removeAttribute(l);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(l);break}i=ha(""+i),t.setAttribute(l,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(l==="formAction"?(s!=="input"&&qe(t,s,"name",u.name,u,null),qe(t,s,"formEncType",u.formEncType,u,null),qe(t,s,"formMethod",u.formMethod,u,null),qe(t,s,"formTarget",u.formTarget,u,null)):(qe(t,s,"encType",u.encType,u,null),qe(t,s,"method",u.method,u,null),qe(t,s,"target",u.target,u,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(l);break}i=ha(""+i),t.setAttribute(l,i);break;case"onClick":i!=null&&(t.onclick=Ot);break;case"onScroll":i!=null&&Me("scroll",t);break;case"onScrollEnd":i!=null&&Me("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(l=i.__html,l!=null){if(u.children!=null)throw Error(o(60));t.innerHTML=l}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}l=ha(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(l,""+i):t.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(l,""):t.removeAttribute(l);break;case"capture":case"download":i===!0?t.setAttribute(l,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(l,i):t.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(l,i):t.removeAttribute(l);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(l):t.setAttribute(l,i);break;case"popover":Me("beforetoggle",t),Me("toggle",t),wn(t,"popover",i);break;case"xlinkActuate":Ce(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Ce(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Ce(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Ce(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Ce(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Ce(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Ce(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":wn(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=ar.get(l)||l,wn(t,l,i))}}function bd(t,s,l,i,u,x){switch(l){case"style":ao(t,i,x);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(l=i.__html,l!=null){if(u.children!=null)throw Error(o(60));t.innerHTML=l}}break;case"children":typeof i=="string"?_n(t,i):(typeof i=="number"||typeof i=="bigint")&&_n(t,""+i);break;case"onScroll":i!=null&&Me("scroll",t);break;case"onScrollEnd":i!=null&&Me("scrollend",t);break;case"onClick":i!=null&&(t.onclick=Ot);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ka.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(u=l.endsWith("Capture"),s=l.slice(2,u?l.length-7:void 0),x=t[jt]||null,x=x!=null?x[l]:null,typeof x=="function"&&t.removeEventListener(s,x,u),typeof i=="function")){typeof x!="function"&&x!==null&&(l in t?t[l]=null:t.hasAttribute(l)&&t.removeAttribute(l)),t.addEventListener(s,i,u);break e}l in t?t[l]=i:i===!0?t.setAttribute(l,""):wn(t,l,i)}}}function Tt(t,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Me("error",t),Me("load",t);var i=!1,u=!1,x;for(x in l)if(l.hasOwnProperty(x)){var y=l[x];if(y!=null)switch(x){case"src":i=!0;break;case"srcSet":u=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,s));default:qe(t,s,x,y,l,null)}}u&&qe(t,s,"srcSet",l.srcSet,l,null),i&&qe(t,s,"src",l.src,l,null);return;case"input":Me("invalid",t);var $=x=y=u=null,q=null,K=null;for(i in l)if(l.hasOwnProperty(i)){var le=l[i];if(le!=null)switch(i){case"name":u=le;break;case"type":y=le;break;case"checked":q=le;break;case"defaultChecked":K=le;break;case"value":x=le;break;case"defaultValue":$=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(o(137,s));break;default:qe(t,s,i,le,l,null)}}al(t,x,$,q,K,y,u,!1);return;case"select":Me("invalid",t),i=y=x=null;for(u in l)if(l.hasOwnProperty(u)&&($=l[u],$!=null))switch(u){case"value":x=$;break;case"defaultValue":y=$;break;case"multiple":i=$;default:qe(t,s,u,$,l,null)}s=x,l=y,t.multiple=!!i,s!=null?Cn(t,!!i,s,!1):l!=null&&Cn(t,!!i,l,!0);return;case"textarea":Me("invalid",t),x=u=i=null;for(y in l)if(l.hasOwnProperty(y)&&($=l[y],$!=null))switch(y){case"value":i=$;break;case"defaultValue":u=$;break;case"children":x=$;break;case"dangerouslySetInnerHTML":if($!=null)throw Error(o(91));break;default:qe(t,s,y,$,l,null)}so(t,i,u,x);return;case"option":for(q in l)if(l.hasOwnProperty(q)&&(i=l[q],i!=null))switch(q){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:qe(t,s,q,i,l,null)}return;case"dialog":Me("beforetoggle",t),Me("toggle",t),Me("cancel",t),Me("close",t);break;case"iframe":case"object":Me("load",t);break;case"video":case"audio":for(i=0;i<zl.length;i++)Me(zl[i],t);break;case"image":Me("error",t),Me("load",t);break;case"details":Me("toggle",t);break;case"embed":case"source":case"link":Me("error",t),Me("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in l)if(l.hasOwnProperty(K)&&(i=l[K],i!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,s));default:qe(t,s,K,i,l,null)}return;default:if(nr(s)){for(le in l)l.hasOwnProperty(le)&&(i=l[le],i!==void 0&&bd(t,s,le,i,l,void 0));return}}for($ in l)l.hasOwnProperty($)&&(i=l[$],i!=null&&qe(t,s,$,i,l,null))}function Db(t,s,l,i){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var u=null,x=null,y=null,$=null,q=null,K=null,le=null;for(se in l){var ce=l[se];if(l.hasOwnProperty(se)&&ce!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":q=ce;default:i.hasOwnProperty(se)||qe(t,s,se,null,i,ce)}}for(var ee in i){var se=i[ee];if(ce=l[ee],i.hasOwnProperty(ee)&&(se!=null||ce!=null))switch(ee){case"type":x=se;break;case"name":u=se;break;case"checked":K=se;break;case"defaultChecked":le=se;break;case"value":y=se;break;case"defaultValue":$=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(o(137,s));break;default:se!==ce&&qe(t,s,ee,se,i,ce)}}sr(t,y,$,q,K,le,x,u);return;case"select":se=y=$=ee=null;for(x in l)if(q=l[x],l.hasOwnProperty(x)&&q!=null)switch(x){case"value":break;case"multiple":se=q;default:i.hasOwnProperty(x)||qe(t,s,x,null,i,q)}for(u in i)if(x=i[u],q=l[u],i.hasOwnProperty(u)&&(x!=null||q!=null))switch(u){case"value":ee=x;break;case"defaultValue":$=x;break;case"multiple":y=x;default:x!==q&&qe(t,s,u,x,i,q)}s=$,l=y,i=se,ee!=null?Cn(t,!!l,ee,!1):!!i!=!!l&&(s!=null?Cn(t,!!l,s,!0):Cn(t,!!l,l?[]:"",!1));return;case"textarea":se=ee=null;for($ in l)if(u=l[$],l.hasOwnProperty($)&&u!=null&&!i.hasOwnProperty($))switch($){case"value":break;case"children":break;default:qe(t,s,$,null,i,u)}for(y in i)if(u=i[y],x=l[y],i.hasOwnProperty(y)&&(u!=null||x!=null))switch(y){case"value":ee=u;break;case"defaultValue":se=u;break;case"children":break;case"dangerouslySetInnerHTML":if(u!=null)throw Error(o(91));break;default:u!==x&&qe(t,s,y,u,i,x)}to(t,ee,se);return;case"option":for(var be in l)if(ee=l[be],l.hasOwnProperty(be)&&ee!=null&&!i.hasOwnProperty(be))switch(be){case"selected":t.selected=!1;break;default:qe(t,s,be,null,i,ee)}for(q in i)if(ee=i[q],se=l[q],i.hasOwnProperty(q)&&ee!==se&&(ee!=null||se!=null))switch(q){case"selected":t.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:qe(t,s,q,ee,i,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var we in l)ee=l[we],l.hasOwnProperty(we)&&ee!=null&&!i.hasOwnProperty(we)&&qe(t,s,we,null,i,ee);for(K in i)if(ee=i[K],se=l[K],i.hasOwnProperty(K)&&ee!==se&&(ee!=null||se!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(o(137,s));break;default:qe(t,s,K,ee,i,se)}return;default:if(nr(s)){for(var Ze in l)ee=l[Ze],l.hasOwnProperty(Ze)&&ee!==void 0&&!i.hasOwnProperty(Ze)&&bd(t,s,Ze,void 0,i,ee);for(le in i)ee=i[le],se=l[le],!i.hasOwnProperty(le)||ee===se||ee===void 0&&se===void 0||bd(t,s,le,ee,i,se);return}}for(var Y in l)ee=l[Y],l.hasOwnProperty(Y)&&ee!=null&&!i.hasOwnProperty(Y)&&qe(t,s,Y,null,i,ee);for(ce in i)ee=i[ce],se=l[ce],!i.hasOwnProperty(ce)||ee===se||ee==null&&se==null||qe(t,s,ce,ee,i,se)}function vx(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ob(){if(typeof performance.getEntriesByType=="function"){for(var t=0,s=0,l=performance.getEntriesByType("resource"),i=0;i<l.length;i++){var u=l[i],x=u.transferSize,y=u.initiatorType,$=u.duration;if(x&&$&&vx(y)){for(y=0,$=u.responseEnd,i+=1;i<l.length;i++){var q=l[i],K=q.startTime;if(K>$)break;var le=q.transferSize,ce=q.initiatorType;le&&vx(ce)&&(q=q.responseEnd,y+=le*(q<$?1:($-K)/(q-K)))}if(--i,s+=8*(x+y)/(u.duration/1e3),t++,10<t)break}}if(0<t)return s/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var gd=null,yd=null;function Ko(t){return t.nodeType===9?t:t.ownerDocument}function jx(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nx(t,s){if(t===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&s==="foreignObject"?0:t}function vd(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var jd=null;function Rb(){var t=window.event;return t&&t.type==="popstate"?t===jd?!1:(jd=t,!0):(jd=null,!1)}var wx=typeof setTimeout=="function"?setTimeout:void 0,Ib=typeof clearTimeout=="function"?clearTimeout:void 0,kx=typeof Promise=="function"?Promise:void 0,Lb=typeof queueMicrotask=="function"?queueMicrotask:typeof kx<"u"?function(t){return kx.resolve(null).then(t).catch(Bb)}:wx;function Bb(t){setTimeout(function(){throw t})}function Vn(t){return t==="head"}function Sx(t,s){var l=s,i=0;do{var u=l.nextSibling;if(t.removeChild(l),u&&u.nodeType===8)if(l=u.data,l==="/$"||l==="/&"){if(i===0){t.removeChild(u),Hr(s);return}i--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")i++;else if(l==="html")Ol(t.ownerDocument.documentElement);else if(l==="head"){l=t.ownerDocument.head,Ol(l);for(var x=l.firstChild;x;){var y=x.nextSibling,$=x.nodeName;x[Xs]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&x.rel.toLowerCase()==="stylesheet"||l.removeChild(x),x=y}}else l==="body"&&Ol(t.ownerDocument.body);l=u}while(l);Hr(s)}function Cx(t,s){var l=t;t=0;do{var i=l.nextSibling;if(l.nodeType===1?s?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(s?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),i&&i.nodeType===8)if(l=i.data,l==="/$"){if(t===0)break;t--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||t++;l=i}while(l)}function Nd(t){var s=t.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Nd(l),Ks(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}t.removeChild(l)}}function Ub(t,s,l,i){for(;t.nodeType===1;){var u=l;if(t.nodeName.toLowerCase()!==s.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[Xs])switch(s){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(x=t.getAttribute("rel"),x==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(x!==u.rel||t.getAttribute("href")!==(u.href==null||u.href===""?null:u.href)||t.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin)||t.getAttribute("title")!==(u.title==null?null:u.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(x=t.getAttribute("src"),(x!==(u.src==null?null:u.src)||t.getAttribute("type")!==(u.type==null?null:u.type)||t.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin))&&x&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(s==="input"&&t.type==="hidden"){var x=u.name==null?null:""+u.name;if(u.type==="hidden"&&t.getAttribute("name")===x)return t}else return t;if(t=us(t.nextSibling),t===null)break}return null}function Hb(t,s,l){if(s==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!l||(t=us(t.nextSibling),t===null))return null;return t}function _x(t,s){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!s||(t=us(t.nextSibling),t===null))return null;return t}function wd(t){return t.data==="$?"||t.data==="$~"}function kd(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function Pb(t,s){var l=t.ownerDocument;if(t.data==="$~")t._reactRetry=s;else if(t.data!=="$?"||l.readyState!=="loading")s();else{var i=function(){s(),l.removeEventListener("DOMContentLoaded",i)};l.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function us(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return t}var Sd=null;function $x(t){t=t.nextSibling;for(var s=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"||l==="/&"){if(s===0)return us(t.nextSibling);s--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||s++}t=t.nextSibling}return null}function Ex(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(s===0)return t;s--}else l!=="/$"&&l!=="/&"||s++}t=t.previousSibling}return null}function Ax(t,s,l){switch(s=Ko(l),t){case"html":if(t=s.documentElement,!t)throw Error(o(452));return t;case"head":if(t=s.head,!t)throw Error(o(453));return t;case"body":if(t=s.body,!t)throw Error(o(454));return t;default:throw Error(o(451))}}function Ol(t){for(var s=t.attributes;s.length;)t.removeAttributeNode(s[0]);Ks(t)}var ms=new Map,Tx=new Set;function Wo(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var bn=O.d;O.d={f:qb,r:Zb,D:Gb,C:Vb,L:Qb,m:Yb,X:Fb,S:Jb,M:Xb};function qb(){var t=bn.f(),s=Zo();return t||s}function Zb(t){var s=zs(t);s!==null&&s.tag===5&&s.type==="form"?Y0(s):bn.r(t)}var Lr=typeof document>"u"?null:document;function Mx(t,s,l){var i=Lr;if(i&&typeof s=="string"&&s){var u=Ut(s);u='link[rel="'+t+'"][href="'+u+'"]',typeof l=="string"&&(u+='[crossorigin="'+l+'"]'),Tx.has(u)||(Tx.add(u),t={rel:t,crossOrigin:l,href:s},i.querySelector(u)===null&&(s=i.createElement("link"),Tt(s,"link",t),at(s),i.head.appendChild(s)))}}function Gb(t){bn.D(t),Mx("dns-prefetch",t,null)}function Vb(t,s){bn.C(t,s),Mx("preconnect",t,s)}function Qb(t,s,l){bn.L(t,s,l);var i=Lr;if(i&&t&&s){var u='link[rel="preload"][as="'+Ut(s)+'"]';s==="image"&&l&&l.imageSrcSet?(u+='[imagesrcset="'+Ut(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(u+='[imagesizes="'+Ut(l.imageSizes)+'"]')):u+='[href="'+Ut(t)+'"]';var x=u;switch(s){case"style":x=Br(t);break;case"script":x=Ur(t)}ms.has(x)||(t=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:t,as:s},l),ms.set(x,t),i.querySelector(u)!==null||s==="style"&&i.querySelector(Rl(x))||s==="script"&&i.querySelector(Il(x))||(s=i.createElement("link"),Tt(s,"link",t),at(s),i.head.appendChild(s)))}}function Yb(t,s){bn.m(t,s);var l=Lr;if(l&&t){var i=s&&typeof s.as=="string"?s.as:"script",u='link[rel="modulepreload"][as="'+Ut(i)+'"][href="'+Ut(t)+'"]',x=u;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Ur(t)}if(!ms.has(x)&&(t=g({rel:"modulepreload",href:t},s),ms.set(x,t),l.querySelector(u)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Il(x)))return}i=l.createElement("link"),Tt(i,"link",t),at(i),l.head.appendChild(i)}}}function Jb(t,s,l){bn.S(t,s,l);var i=Lr;if(i&&t){var u=Ds(i).hoistableStyles,x=Br(t);s=s||"default";var y=u.get(x);if(!y){var $={loading:0,preload:null};if(y=i.querySelector(Rl(x)))$.loading=5;else{t=g({rel:"stylesheet",href:t,"data-precedence":s},l),(l=ms.get(x))&&Cd(t,l);var q=y=i.createElement("link");at(q),Tt(q,"link",t),q._p=new Promise(function(K,le){q.onload=K,q.onerror=le}),q.addEventListener("load",function(){$.loading|=1}),q.addEventListener("error",function(){$.loading|=2}),$.loading|=4,ei(y,s,i)}y={type:"stylesheet",instance:y,count:1,state:$},u.set(x,y)}}}function Fb(t,s){bn.X(t,s);var l=Lr;if(l&&t){var i=Ds(l).hoistableScripts,u=Ur(t),x=i.get(u);x||(x=l.querySelector(Il(u)),x||(t=g({src:t,async:!0},s),(s=ms.get(u))&&_d(t,s),x=l.createElement("script"),at(x),Tt(x,"link",t),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(u,x))}}function Xb(t,s){bn.M(t,s);var l=Lr;if(l&&t){var i=Ds(l).hoistableScripts,u=Ur(t),x=i.get(u);x||(x=l.querySelector(Il(u)),x||(t=g({src:t,async:!0,type:"module"},s),(s=ms.get(u))&&_d(t,s),x=l.createElement("script"),at(x),Tt(x,"link",t),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},i.set(u,x))}}function zx(t,s,l,i){var u=(u=re.current)?Wo(u):null;if(!u)throw Error(o(446));switch(t){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=Br(l.href),l=Ds(u).hoistableStyles,i=l.get(s),i||(i={type:"style",instance:null,count:0,state:null},l.set(s,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){t=Br(l.href);var x=Ds(u).hoistableStyles,y=x.get(t);if(y||(u=u.ownerDocument||u,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(t,y),(x=u.querySelector(Rl(t)))&&!x._p&&(y.instance=x,y.state.loading=5),ms.has(t)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ms.set(t,l),x||Kb(u,t,l,y.state))),s&&i===null)throw Error(o(528,""));return y}if(s&&i!==null)throw Error(o(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Ur(l),l=Ds(u).hoistableScripts,i=l.get(s),i||(i={type:"script",instance:null,count:0,state:null},l.set(s,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,t))}}function Br(t){return'href="'+Ut(t)+'"'}function Rl(t){return'link[rel="stylesheet"]['+t+"]"}function Dx(t){return g({},t,{"data-precedence":t.precedence,precedence:null})}function Kb(t,s,l,i){t.querySelector('link[rel="preload"][as="style"]['+s+"]")?i.loading=1:(s=t.createElement("link"),i.preload=s,s.addEventListener("load",function(){return i.loading|=1}),s.addEventListener("error",function(){return i.loading|=2}),Tt(s,"link",l),at(s),t.head.appendChild(s))}function Ur(t){return'[src="'+Ut(t)+'"]'}function Il(t){return"script[async]"+t}function Ox(t,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var i=t.querySelector('style[data-href~="'+Ut(l.href)+'"]');if(i)return s.instance=i,at(i),i;var u=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),at(i),Tt(i,"style",u),ei(i,l.precedence,t),s.instance=i;case"stylesheet":u=Br(l.href);var x=t.querySelector(Rl(u));if(x)return s.state.loading|=4,s.instance=x,at(x),x;i=Dx(l),(u=ms.get(u))&&Cd(i,u),x=(t.ownerDocument||t).createElement("link"),at(x);var y=x;return y._p=new Promise(function($,q){y.onload=$,y.onerror=q}),Tt(x,"link",i),s.state.loading|=4,ei(x,l.precedence,t),s.instance=x;case"script":return x=Ur(l.src),(u=t.querySelector(Il(x)))?(s.instance=u,at(u),u):(i=l,(u=ms.get(x))&&(i=g({},l),_d(i,u)),t=t.ownerDocument||t,u=t.createElement("script"),at(u),Tt(u,"link",i),t.head.appendChild(u),s.instance=u);case"void":return null;default:throw Error(o(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(i=s.instance,s.state.loading|=4,ei(i,l.precedence,t));return s.instance}function ei(t,s,l){for(var i=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),u=i.length?i[i.length-1]:null,x=u,y=0;y<i.length;y++){var $=i[y];if($.dataset.precedence===s)x=$;else if(x!==u)break}x?x.parentNode.insertBefore(t,x.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(t,s.firstChild))}function Cd(t,s){t.crossOrigin==null&&(t.crossOrigin=s.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=s.referrerPolicy),t.title==null&&(t.title=s.title)}function _d(t,s){t.crossOrigin==null&&(t.crossOrigin=s.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=s.referrerPolicy),t.integrity==null&&(t.integrity=s.integrity)}var ti=null;function Rx(t,s,l){if(ti===null){var i=new Map,u=ti=new Map;u.set(l,i)}else u=ti,i=u.get(l),i||(i=new Map,u.set(l,i));if(i.has(t))return i;for(i.set(t,null),l=l.getElementsByTagName(t),u=0;u<l.length;u++){var x=l[u];if(!(x[Xs]||x[ot]||t==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var y=x.getAttribute(s)||"";y=t+y;var $=i.get(y);$?$.push(x):i.set(y,[x])}}return i}function Ix(t,s,l){t=t.ownerDocument||t,t.head.insertBefore(l,s==="title"?t.querySelector("head > title"):null)}function Wb(t,s,l){if(l===1||s.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return t=s.disabled,typeof s.precedence=="string"&&t==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Lx(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function eg(t,s,l,i){if(l.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var u=Br(i.href),x=s.querySelector(Rl(u));if(x){s=x._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(t.count++,t=si.bind(t),s.then(t,t)),l.state.loading|=4,l.instance=x,at(x);return}x=s.ownerDocument||s,i=Dx(i),(u=ms.get(u))&&Cd(i,u),x=x.createElement("link"),at(x);var y=x;y._p=new Promise(function($,q){y.onload=$,y.onerror=q}),Tt(x,"link",i),l.instance=x}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(l,s),(s=l.state.preload)&&(l.state.loading&3)===0&&(t.count++,l=si.bind(t),s.addEventListener("load",l),s.addEventListener("error",l))}}var $d=0;function tg(t,s){return t.stylesheets&&t.count===0&&ai(t,t.stylesheets),0<t.count||0<t.imgCount?function(l){var i=setTimeout(function(){if(t.stylesheets&&ai(t,t.stylesheets),t.unsuspend){var x=t.unsuspend;t.unsuspend=null,x()}},6e4+s);0<t.imgBytes&&$d===0&&($d=62500*Ob());var u=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&ai(t,t.stylesheets),t.unsuspend)){var x=t.unsuspend;t.unsuspend=null,x()}},(t.imgBytes>$d?50:800)+s);return t.unsuspend=l,function(){t.unsuspend=null,clearTimeout(i),clearTimeout(u)}}:null}function si(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ai(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ni=null;function ai(t,s){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ni=new Map,s.forEach(sg,t),ni=null,si.call(t))}function sg(t,s){if(!(s.state.loading&4)){var l=ni.get(t);if(l)var i=l.get(null);else{l=new Map,ni.set(t,l);for(var u=t.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<u.length;x++){var y=u[x];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(l.set(y.dataset.precedence,y),i=y)}i&&l.set(null,i)}u=s.instance,y=u.getAttribute("data-precedence"),x=l.get(y)||i,x===i&&l.set(null,u),l.set(y,u),this.count++,i=si.bind(this),u.addEventListener("load",i),u.addEventListener("error",i),x?x.parentNode.insertBefore(u,x.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(u,t.firstChild)),s.state.loading|=4}}var Ll={$$typeof:D,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function ng(t,s,l,i,u,x,y,$,q){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ca(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ca(0),this.hiddenUpdates=ca(null),this.identifierPrefix=i,this.onUncaughtError=u,this.onCaughtError=x,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Bx(t,s,l,i,u,x,y,$,q,K,le,ce){return t=new ng(t,s,l,y,q,K,le,ce,$),s=1,x===!0&&(s|=24),x=Xt(3,null,null,s),t.current=x,x.stateNode=t,s=oc(),s.refCount++,t.pooledCache=s,s.refCount++,x.memoizedState={element:i,isDehydrated:l,cache:s},uc(x),t}function Ux(t){return t?(t=br,t):br}function Hx(t,s,l,i,u,x){u=Ux(u),i.context===null?i.context=u:i.pendingContext=u,i=On(s),i.payload={element:l},x=x===void 0?null:x,x!==null&&(i.callback=x),l=Rn(t,i,s),l!==null&&(Gt(l,t,s),pl(l,t,s))}function Px(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<s?l:s}}function Ed(t,s){Px(t,s),(t=t.alternate)&&Px(t,s)}function qx(t){if(t.tag===13||t.tag===31){var s=Na(t,67108864);s!==null&&Gt(s,t,67108864),Ed(t,67108864)}}function Zx(t){if(t.tag===13||t.tag===31){var s=ss();s=ua(s);var l=Na(t,s);l!==null&&Gt(l,t,s),Ed(t,s)}}var ri=!0;function ag(t,s,l,i){var u=H.T;H.T=null;var x=O.p;try{O.p=2,Ad(t,s,l,i)}finally{O.p=x,H.T=u}}function rg(t,s,l,i){var u=H.T;H.T=null;var x=O.p;try{O.p=8,Ad(t,s,l,i)}finally{O.p=x,H.T=u}}function Ad(t,s,l,i){if(ri){var u=Td(i);if(u===null)pd(t,s,i,li,l),Vx(t,i);else if(og(u,t,s,l,i))i.stopPropagation();else if(Vx(t,i),s&4&&-1<lg.indexOf(t)){for(;u!==null;){var x=zs(u);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var y=bs(x.pendingLanes);if(y!==0){var $=x;for($.pendingLanes|=2,$.entangledLanes|=2;y;){var q=1<<31-Ye(y);$.entanglements[1]|=q,y&=~q}qs(x),(Be&6)===0&&(Po=vt()+500,Ml(0))}}break;case 31:case 13:$=Na(x,2),$!==null&&Gt($,x,2),Zo(),Ed(x,2)}if(x=Td(i),x===null&&pd(t,s,i,li,l),x===u)break;u=x}u!==null&&i.stopPropagation()}else pd(t,s,i,null,l)}}function Td(t){return t=lr(t),Md(t)}var li=null;function Md(t){if(li=null,t=Ms(t),t!==null){var s=d(t);if(s===null)t=null;else{var l=s.tag;if(l===13){if(t=m(s),t!==null)return t;t=null}else if(l===31){if(t=f(s),t!==null)return t;t=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null)}}return li=t,null}function Gx(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Za()){case oa:return 2;case ia:return 8;case Ys:case _s:return 32;case Ga:return 268435456;default:return 32}default:return 32}}var zd=!1,Qn=null,Yn=null,Jn=null,Bl=new Map,Ul=new Map,Fn=[],lg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Vx(t,s){switch(t){case"focusin":case"focusout":Qn=null;break;case"dragenter":case"dragleave":Yn=null;break;case"mouseover":case"mouseout":Jn=null;break;case"pointerover":case"pointerout":Bl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ul.delete(s.pointerId)}}function Hl(t,s,l,i,u,x){return t===null||t.nativeEvent!==x?(t={blockedOn:s,domEventName:l,eventSystemFlags:i,nativeEvent:x,targetContainers:[u]},s!==null&&(s=zs(s),s!==null&&qx(s)),t):(t.eventSystemFlags|=i,s=t.targetContainers,u!==null&&s.indexOf(u)===-1&&s.push(u),t)}function og(t,s,l,i,u){switch(s){case"focusin":return Qn=Hl(Qn,t,s,l,i,u),!0;case"dragenter":return Yn=Hl(Yn,t,s,l,i,u),!0;case"mouseover":return Jn=Hl(Jn,t,s,l,i,u),!0;case"pointerover":var x=u.pointerId;return Bl.set(x,Hl(Bl.get(x)||null,t,s,l,i,u)),!0;case"gotpointercapture":return x=u.pointerId,Ul.set(x,Hl(Ul.get(x)||null,t,s,l,i,u)),!0}return!1}function Qx(t){var s=Ms(t.target);if(s!==null){var l=d(s);if(l!==null){if(s=l.tag,s===13){if(s=m(l),s!==null){t.blockedOn=s,Ja(t.priority,function(){Zx(l)});return}}else if(s===31){if(s=f(l),s!==null){t.blockedOn=s,Ja(t.priority,function(){Zx(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function oi(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var l=Td(t.nativeEvent);if(l===null){l=t.nativeEvent;var i=new l.constructor(l.type,l);rr=i,l.target.dispatchEvent(i),rr=null}else return s=zs(l),s!==null&&qx(s),t.blockedOn=l,!1;s.shift()}return!0}function Yx(t,s,l){oi(t)&&l.delete(s)}function ig(){zd=!1,Qn!==null&&oi(Qn)&&(Qn=null),Yn!==null&&oi(Yn)&&(Yn=null),Jn!==null&&oi(Jn)&&(Jn=null),Bl.forEach(Yx),Ul.forEach(Yx)}function ii(t,s){t.blockedOn===s&&(t.blockedOn=null,zd||(zd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ig)))}var ci=null;function Jx(t){ci!==t&&(ci=t,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ci===t&&(ci=null);for(var s=0;s<t.length;s+=3){var l=t[s],i=t[s+1],u=t[s+2];if(typeof i!="function"){if(Md(i||l)===null)continue;break}var x=zs(l);x!==null&&(t.splice(s,3),s-=3,Tc(x,{pending:!0,data:u,method:l.method,action:i},i,u))}}))}function Hr(t){function s(q){return ii(q,t)}Qn!==null&&ii(Qn,t),Yn!==null&&ii(Yn,t),Jn!==null&&ii(Jn,t),Bl.forEach(s),Ul.forEach(s);for(var l=0;l<Fn.length;l++){var i=Fn[l];i.blockedOn===t&&(i.blockedOn=null)}for(;0<Fn.length&&(l=Fn[0],l.blockedOn===null);)Qx(l),l.blockedOn===null&&Fn.shift();if(l=(t.ownerDocument||t).$$reactFormReplay,l!=null)for(i=0;i<l.length;i+=3){var u=l[i],x=l[i+1],y=u[jt]||null;if(typeof x=="function")y||Jx(l);else if(y){var $=null;if(x&&x.hasAttribute("formAction")){if(u=x,y=x[jt]||null)$=y.formAction;else if(Md(u)!==null)continue}else $=y.action;typeof $=="function"?l[i+1]=$:(l.splice(i,3),i-=3),Jx(l)}}}function Fx(){function t(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(y){return u=y})},focusReset:"manual",scroll:"manual"})}function s(){u!==null&&(u(),u=null),i||setTimeout(l,20)}function l(){if(!i&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,u=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(l,100),function(){i=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),u!==null&&(u(),u=null)}}}function Dd(t){this._internalRoot=t}di.prototype.render=Dd.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(o(409));var l=s.current,i=ss();Hx(l,i,t,s,null,null)},di.prototype.unmount=Dd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;Hx(t.current,2,null,t,null,null),Zo(),s[Ts]=null}};function di(t){this._internalRoot=t}di.prototype.unstable_scheduleHydration=function(t){if(t){var s=Ya();t={blockedOn:null,target:t,priority:s};for(var l=0;l<Fn.length&&s!==0&&s<Fn[l].priority;l++);Fn.splice(l,0,t),l===0&&Qx(t)}};var Xx=a.version;if(Xx!=="19.2.0")throw Error(o(527,Xx,"19.2.0"));O.findDOMNode=function(t){var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(o(188)):(t=Object.keys(t).join(","),Error(o(268,t)));return t=p(s),t=t!==null?b(t):null,t=t===null?null:t.stateNode,t};var cg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ui=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ui.isDisabled&&ui.supportsFiber)try{Js=ui.inject(cg),St=ui}catch{}}return ql.createRoot=function(t,s){if(!c(t))throw Error(o(299));var l=!1,i="",u=am,x=rm,y=lm;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(i=s.identifierPrefix),s.onUncaughtError!==void 0&&(u=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(y=s.onRecoverableError)),s=Bx(t,1,!1,null,null,l,i,null,u,x,y,Fx),t[Ts]=s.current,hd(t),new Dd(s)},ql.hydrateRoot=function(t,s,l){if(!c(t))throw Error(o(299));var i=!1,u="",x=am,y=rm,$=lm,q=null;return l!=null&&(l.unstable_strictMode===!0&&(i=!0),l.identifierPrefix!==void 0&&(u=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(y=l.onCaughtError),l.onRecoverableError!==void 0&&($=l.onRecoverableError),l.formState!==void 0&&(q=l.formState)),s=Bx(t,1,!0,s,l??null,i,u,q,x,y,$,Fx),s.context=Ux(null),l=s.current,i=ss(),i=ua(i),u=On(i),u.callback=null,Rn(l,u,i),l=i,s.current.lanes=l,As(s,l),qs(s),t[Ts]=s.current,hd(t),new di(s)},ql.version="19.2.0",ql}var of;function gg(){if(of)return Id.exports;of=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),Id.exports=bg(),Id.exports}var yg=gg();const vg=hh(yg),ke=n=>{if(!n)return"text-gray-400";switch(n){case"凡品":return"text-gray-400";case"良品":return"text-green-400";case"优品":return"text-blue-400";case"珍品":return"text-purple-400";case"绝品":return"text-amber-400";case"仙品":return"text-red-400";case"圣品":return"text-yellow-300 animate-glow";case"神品":return"text-rainbow font-black";default:return"text-gray-400"}},pt=n=>{if(!n)return"border-gray-600/50";switch(n){case"凡品":return"border-gray-600/50";case"良品":return"border-green-500/60";case"优品":return"border-blue-500/60";case"珍品":return"border-purple-500/60";case"绝品":return"border-amber-400/70";case"仙品":return"border-red-500/70";case"圣品":return"border-yellow-300/80";case"神品":return"border-fuchsia-400 animate-pulse-fast";default:return"border-gray-600/50"}},jg=n=>{if(!n)return"";switch(n){case"良品":return"shadow-[0_0_12px_2px_rgba(34,197,94,0.4)]";case"优品":return"shadow-[0_0_12px_2px_rgba(59,130,246,0.5)]";case"珍品":return"shadow-[0_0_12px_2px_rgba(168,85,247,0.5)]";case"绝品":return"shadow-[0_0_15px_3px_rgba(251,191,36,0.6)]";case"仙品":return"shadow-[0_0_18px_4px_rgba(239,68,68,0.6)]";case"圣品":return"shadow-[0_0_22px_5px_rgba(253,224,71,0.7)] animate-pulse";case"神品":return"shadow-[0_0_30px_6px_rgba(236,72,153,0.7)] animate-pulse-fast";default:return""}},bh=(n,a=!0)=>{const r=a?" transition-colors":"";if(!n)return"bg-slate-800/70"+r;switch(n){case"凡品":return"bg-slate-800/70"+(a?" hover:bg-slate-800/90":"");case"良品":return"bg-green-900/20"+(a?" hover:bg-green-900/30":"");case"优品":return"bg-blue-900/20"+(a?" hover:bg-blue-900/30":"");case"珍品":return"bg-purple-900/20"+(a?" hover:bg-purple-900/30":"");case"绝品":return"bg-amber-900/20"+(a?" hover:bg-amber-900/30":"");case"仙品":return"bg-red-900/20"+(a?" hover:bg-red-900/30":"");case"圣品":return"bg-yellow-900/30"+(a?" hover:bg-yellow-900/40":"");case"神品":return"bg-purple-900/40"+(a?" hover:bg-purple-900/50":"");default:return"bg-slate-800/70"+r}},Ng=({isOpen:n,onClose:a,onSelect:r,characterList:o,title:c})=>{const[d,m]=v.useState("人物"),[f,h]=v.useState("全部");if(!n)return null;const p=g=>{r(g),a()},b=()=>{let g=[];return d==="人物"?g=o.filter(N=>"skills"in N).filter(N=>f==="全部"||N.gender===(f==="男"?"Male":"Female")):g=o.filter(N=>"skill"in N).filter(N=>f==="全部"||N.gender===(f==="男"?"Male":"Female")),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:g.length>0?g.map(w=>e.jsxs("button",{onClick:()=>p(w),className:`p-3 rounded-lg border-2 text-center transition-all duration-200 ${pt(w.rarity)} hover:ring-4 hover:ring-green-500`,children:[e.jsx("p",{className:"font-bold font-serif text-white truncate",children:w.name}),e.jsx("p",{className:`text-xs font-semibold ${ke(w.rarity)}`,children:"skills"in w?w.realm:"兽宠"})]},w.id)):e.jsx("p",{className:"col-span-full text-center text-gray-500 pt-8",children:"此分类下暂无可用卡牌。"})})};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-4xl h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:c}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-stone-700 bg-black/10 flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>m("人物"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${d==="人物"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"人物"}),e.jsx("button",{onClick:()=>m("兽宠"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${d==="兽宠"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"兽宠"})]}),d==="人物"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>h("全部"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${f==="全部"?"bg-sky-500/20 text-sky-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"全部"}),e.jsx("button",{onClick:()=>h("男"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${f==="男"?"bg-blue-500/20 text-blue-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"男"}),e.jsx("button",{onClick:()=>h("女"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${f==="女"?"bg-pink-500/20 text-pink-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"女"})]})]}),e.jsx("div",{className:"flex-grow p-6 overflow-y-auto",children:b()})]})})},wg=({card:n,busyReason:a})=>{const r="skill"in n;return e.jsxs("div",{className:`p-3 rounded-lg border-2 text-center transition-all duration-200 ${pt(n.rarity)}`,children:[e.jsx("p",{className:"font-bold font-serif text-white truncate",children:n.name}),e.jsx("p",{className:`text-xs font-semibold ${ke(n.rarity)}`,children:r?"兽宠":n.realm}),a&&e.jsx("p",{className:"text-xs text-cyan-400 mt-1 truncate",title:a,children:a})]})},kg=({isOpen:n,onClose:a,cardCollection:r,petCollection:o,busyCharacterDetails:c})=>{const[d,m]=v.useState("空闲中"),[f,h]=v.useState("人物"),[p,b]=v.useState("全部");if(!n)return null;const g=()=>{const w=d==="忙碌中";let N=[],j=[];f==="人物"?N=r.filter(_=>{const C=c.has(_.id),S=p==="全部"||_.gender===(p==="男"?"Male":"Female");return w===C&&S}):j=o.filter(_=>{const C=c.has(_.id),S=p==="全部"||_.gender===(p==="男"?"Male":"Female");return w===C&&S});const k=f==="人物"?N:j;return e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:k.length>0?k.map(_=>e.jsx(wg,{card:_,busyReason:c.get(_.id)},_.id)):e.jsx("p",{className:"col-span-full text-center text-gray-500 pt-8",children:"此分类下暂无卡牌。"})})};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-5xl h-[85vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:"人物状态总览"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-stone-700 bg-black/10 space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>m("空闲中"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200 ${d==="空闲中"?"bg-green-500/20 text-green-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"空闲中"}),e.jsx("button",{onClick:()=>m("忙碌中"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200 ${d==="忙碌中"?"bg-red-500/20 text-red-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"忙碌中"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>h("人物"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${f==="人物"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"人物"}),e.jsx("button",{onClick:()=>h("兽宠"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${f==="兽宠"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"兽宠"})]}),f==="人物"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>b("全部"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${p==="全部"?"bg-sky-500/20 text-sky-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"全部"}),e.jsx("button",{onClick:()=>b("男"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${p==="男"?"bg-blue-500/20 text-blue-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"男"}),e.jsx("button",{onClick:()=>b("女"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors duration-200 ${p==="女"?"bg-pink-500/20 text-pink-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"女"})]})]})]}),e.jsx("div",{className:"flex-grow p-6 overflow-y-auto",children:g()})]})})},Sg="modulepreload",Cg=function(n,a){return new URL(n,a).href},cf={},_g=function(a,r,o){let c=Promise.resolve();if(r&&r.length>0){let m=function(b){return Promise.all(b.map(g=>Promise.resolve(g).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};const f=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),p=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));c=m(r.map(b=>{if(b=Cg(b,o),b in cf)return;cf[b]=!0;const g=b.endsWith(".css"),w=g?'[rel="stylesheet"]':"";if(!!o)for(let k=f.length-1;k>=0;k--){const _=f[k];if(_.href===b&&(!g||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${b}"]${w}`))return;const j=document.createElement("link");if(j.rel=g?"stylesheet":Sg,g||(j.as="script"),j.crossOrigin="",j.href=b,p&&j.setAttribute("nonce",p),document.head.appendChild(j),g)return new Promise((k,_)=>{j.addEventListener("load",k),j.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${b}`)))})}))}function d(m){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=m,window.dispatchEvent(f),!f.defaultPrevented)throw m}return c.then(m=>{for(const f of m||[])f.status==="rejected"&&d(f.reason);return a().catch(d)})};class $g{constructor(a){this.config=a}updateConfig(a){this.config=a}getConfig(){return{...this.config}}async testConnection(){if(!this.config.rerankerEnabled)return{success:!1,error:"Reranker功能未启用"};try{const a="测试查询",r=["测试文档1","测试文档2"];return await this.rerank(a,r),{success:!0,model:this.config.rerankerModel}}catch(a){return{success:!1,error:a instanceof Error?a.message:"连接失败"}}}async rerankSearchResults(a,r){if(!this.config.rerankerEnabled)return console.log("Reranker未启用，返回原始结果"),r;if(r.length===0)return r;try{console.log(`使用Reranker重排序 ${r.length} 个结果...`);const o=Date.now(),c=r.map(b=>b.memory.text),d=await this.rerank(a,c),m=r.map((b,g)=>({...b,similarity:d[g],originalSimilarity:b.similarity}));m.sort((b,g)=>g.similarity-b.similarity),m.forEach((b,g)=>{b.rank=g+1});const f=this.config.maxResults||20,h=m.slice(0,f),p=Date.now();return console.log(`Reranker完成，耗时 ${p-o}ms，返回 ${h.length} 个结果`),h}catch(o){return console.error("Reranker失败，返回原始结果:",o),r}}async rerank(a,r){if(!this.config.rerankerApiKey)throw new Error("缺少Reranker API密钥");if(!a||a.trim().length===0)throw new Error("查询文本为空");if(r.length===0)return[];try{const o=this.config.rerankerApiUrl.includes("jina")||this.config.rerankerModel.includes("jina"),c=this.config.rerankerApiUrl.includes("cohere")||this.config.rerankerModel.includes("rerank");return o?await this.rerankWithJina(a,r):c?await this.rerankWithCohere(a,r):await this.rerankGeneric(a,r)}catch(o){throw console.error("Reranker API调用失败:",o),o}}async rerankWithJina(a,r){const o={model:this.config.rerankerModel,query:a,documents:r,top_n:r.length},c=await fetch(`${this.config.rerankerApiUrl}/rerank`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.rerankerApiKey}`},body:JSON.stringify(o)});if(!c.ok){const f=await c.json().catch(()=>({}));throw new Error(`Jina Reranker API错误 ${c.status}: ${f.detail||c.statusText}`)}const d=await c.json(),m=new Array(r.length).fill(0);for(const f of d.results)m[f.index]=f.relevance_score;return m}async rerankWithCohere(a,r){const o={model:this.config.rerankerModel,query:a,documents:r,top_n:r.length,return_documents:!1},c=await fetch(`${this.config.rerankerApiUrl}/rerank`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.rerankerApiKey}`},body:JSON.stringify(o)});if(!c.ok){const f=await c.json().catch(()=>({}));throw new Error(`Cohere Reranker API错误 ${c.status}: ${f.message||c.statusText}`)}const d=await c.json(),m=new Array(r.length).fill(0);for(const f of d.results)m[f.index]=f.relevance_score;return m}async rerankGeneric(a,r){var m;const o={model:this.config.rerankerModel,query:a,documents:r},c=await fetch(`${this.config.rerankerApiUrl}/rerank`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.rerankerApiKey}`},body:JSON.stringify(o)});if(!c.ok){const f=await c.json().catch(()=>({}));throw new Error(`Reranker API错误 ${c.status}: ${((m=f.error)==null?void 0:m.message)||c.statusText}`)}const d=await c.json();if(d.results&&Array.isArray(d.results)){const f=new Array(r.length).fill(0);for(const h of d.results){const p=h.index??h.document_index??0,b=h.relevance_score??h.score??0;f[p]=b}return f}throw new Error("无法解析Reranker API响应格式")}async batchRerank(a,r,o=100){if(r.length<=o)return await this.rerank(a,r);const c=[],d=this.chunkArray(r,o);for(let m=0;m<d.length;m++){const f=d[m];console.log(`处理Reranker批次 ${m+1}/${d.length}, 共 ${f.length} 条`);try{const h=await this.rerank(a,f);c.push(...h),m<d.length-1&&await this.delay(200)}catch(h){console.error(`Reranker批次 ${m+1} 失败:`,h),c.push(...new Array(f.length).fill(0))}}return c}chunkArray(a,r){const o=[];for(let c=0;c<a.length;c+=r)o.push(a.slice(c,c+r));return o}delay(a){return new Promise(r=>setTimeout(r,a))}}const gh=new $g({enabled:!1,apiUrl:"",apiKey:"",model:"",autoVectorize:!1,vectorizeOnSummary:!1,batchSize:10,similarityThreshold:.7,maxResults:20,topKBeforeRerank:50,rerankerEnabled:!1,rerankerApiUrl:"https://api.jina.ai/v1",rerankerApiKey:"",rerankerModel:"jina-reranker-v2-base-multilingual",retryAttempts:3,cacheEnabled:!0});class yh{constructor(a){this.config=a}updateConfig(a){this.config=a}getConfig(){return{...this.config}}async testConnection(){try{const a=await this.vectorize("测试连接");return{success:!0,model:this.config.model}}catch(a){return{success:!1,error:a instanceof Error?a.message:"连接失败"}}}async fetchAvailableModels(){var a,r;try{if(this.config.apiUrl.includes("ollama")||this.config.apiUrl.includes("11434")){const c=await fetch(`${this.config.apiUrl}/api/tags`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!c.ok){const f=await c.text();return{success:!1,error:`HTTP ${c.status}: ${f}`}}return{success:!0,models:((a=(await c.json()).models)==null?void 0:a.map(f=>f.name))||[]}}else{const c=await fetch(`${this.config.apiUrl}/models`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`}});if(!c.ok){const f=await c.text();return{success:!1,error:`HTTP ${c.status}: ${f}`}}return{success:!0,models:((r=(await c.json()).data)==null?void 0:r.map(f=>f.id))||[]}}}catch(o){return{success:!1,error:o instanceof Error?o.message:"未知错误"}}}async vectorize(a){var r,o;if(!this.config.enabled)throw new Error("向量化功能未启用");if(!this.config.apiKey)throw new Error("缺少API密钥");if(!a||a.trim().length===0)throw new Error("文本内容为空");try{const c={model:this.config.model,input:a,encoding_format:"float"},d=await fetch(`${this.config.apiUrl}/embeddings`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},body:JSON.stringify(c)});if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(`API错误 ${d.status}: ${((r=f.error)==null?void 0:r.message)||d.statusText}`)}const m=await d.json();if(m.data&&Array.isArray(m.data)&&((o=m.data[0])!=null&&o.embedding))return m.data[0].embedding;if(Array.isArray(m.embedding))return m.embedding;throw new Error("无法解析API响应格式")}catch(c){throw console.error("向量化失败:",c),c}}async batchVectorize(a){if(!this.config.enabled)throw new Error("向量化功能未启用");if(a.length===0)return[];const r=this.chunkArray(a,this.config.batchSize),o=[];for(let c=0;c<r.length;c++){const d=r[c];try{console.log(`处理批次 ${c+1}/${r.length}, 共 ${d.length} 条`);const m=await Promise.all(d.map(f=>this.vectorize(f)));o.push(...m),c<r.length-1&&await this.delay(200)}catch(m){if(console.error(`批次 ${c+1} 处理失败:`,m),this.config.retryAttempts>0){console.log(`将在 1 秒后重试批次 ${c+1}`),await this.delay(1e3);try{const f=await Promise.all(d.map(h=>this.vectorize(h)));o.push(...f);continue}catch(f){console.error(`批次 ${c+1} 重试失败:`,f)}}throw m}}return o}cosineSimilarity(a,r){if(a.length!==r.length)throw new Error(`向量维度不匹配: ${a.length} vs ${r.length}`);if(a.length===0)return 0;let o=0,c=0,d=0;for(let m=0;m<a.length;m++)o+=a[m]*r[m],c+=a[m]*a[m],d+=r[m]*r[m];return c=Math.sqrt(c),d=Math.sqrt(d),c===0||d===0?0:o/(c*d)}batchCosineSimilarity(a,r){return r.map(o=>this.cosineSimilarity(a,o))}chunkArray(a,r){const o=[];for(let c=0;c<a.length;c+=r)o.push(a.slice(c,c+r));return o}delay(a){return new Promise(r=>setTimeout(r,a))}estimateTokens(a){const r=(a.match(/[\u4e00-\u9fa5]/g)||[]).length,o=a.length-r;return Math.ceil(r/1.5+o/4)}estimateCost(a){return a/1e6*.02}}const uu={enabled:!1,apiUrl:"https://api.openai.com/v1",apiKey:"",model:"text-embedding-3-small",autoVectorize:!1,vectorizeOnSummary:!0,batchSize:10,similarityThreshold:.7,maxResults:20,topKBeforeRerank:50,rerankerEnabled:!1,rerankerApiUrl:"https://api.jina.ai/v1",rerankerApiKey:"",rerankerModel:"jina-reranker-v2-base-multilingual",retryAttempts:3,cacheEnabled:!0},Vt=new yh(uu),Eg=Object.freeze(Object.defineProperty({__proto__:null,VectorService:yh,defaultVectorConfig:uu,vectorService:Vt},Symbol.toStringTag,{value:"Module"}));class Ag{constructor(){this.dbName="XianxiaVectorStore",this.version=1,this.storeName="vectors",this.db=null}async initialize(){return new Promise((a,r)=>{const o=indexedDB.open(this.dbName,this.version);o.onerror=()=>{r(new Error("无法打开IndexedDB"))},o.onsuccess=()=>{this.db=o.result,a()},o.onupgradeneeded=c=>{const d=c.target.result;if(!d.objectStoreNames.contains(this.storeName)){const m=d.createObjectStore(this.storeName,{keyPath:"id"});m.createIndex("memoryId","memoryId",{unique:!0}),m.createIndex("category","category",{unique:!1}),m.createIndex("created","created",{unique:!1}),m.createIndex("realTimestamp","metadata.realTimestamp",{unique:!1})}}})}async ensureDB(){if(this.db||await this.initialize(),!this.db)throw new Error("数据库未初始化");return this.db}async saveVector(a){const r=await this.ensureDB();return new Promise((o,c)=>{const f=r.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(a);f.onsuccess=()=>o(),f.onerror=()=>c(new Error("保存向量失败"))})}async saveBatchVectors(a){const r=await this.ensureDB();return new Promise((o,c)=>{const m=r.transaction([this.storeName],"readwrite").objectStore(this.storeName);let f=0,h=!1;for(const p of a){const b=m.put(p);b.onsuccess=()=>{f++,f===a.length&&!h&&o()},b.onerror=()=>{h||(h=!0,c(new Error(`保存向量失败: ${p.id}`)))}}a.length===0&&o()})}async getVectorById(a){const r=await this.ensureDB();return new Promise((o,c)=>{const f=r.transaction([this.storeName],"readonly").objectStore(this.storeName).get(a);f.onsuccess=()=>{o(f.result||null)},f.onerror=()=>{c(new Error("获取向量失败"))}})}async getVectorByMemoryId(a){const r=await this.ensureDB();return new Promise((o,c)=>{const h=r.transaction([this.storeName],"readonly").objectStore(this.storeName).index("memoryId").get(a);h.onsuccess=()=>{o(h.result||null)},h.onerror=()=>{c(new Error("获取向量失败"))}})}async getAllVectors(){const a=await this.ensureDB();return new Promise((r,o)=>{const m=a.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();m.onsuccess=()=>{r(m.result||[])},m.onerror=()=>{o(new Error("获取所有向量失败"))}})}async getVectorsByCategory(a){const r=await this.ensureDB();return new Promise((o,c)=>{const h=r.transaction([this.storeName],"readonly").objectStore(this.storeName).index("category").getAll(a);h.onsuccess=()=>{o(h.result||[])},h.onerror=()=>{c(new Error("获取分类向量失败"))}})}async getVectorsByTimeRange(a,r){const o=await this.ensureDB();return new Promise((c,d)=>{const h=o.transaction([this.storeName],"readonly").objectStore(this.storeName).index("realTimestamp"),p=IDBKeyRange.bound(a,r),b=h.getAll(p);b.onsuccess=()=>{c(b.result||[])},b.onerror=()=>{d(new Error("获取时间范围向量失败"))}})}async deleteVector(a){const r=await this.ensureDB();return new Promise((o,c)=>{const f=r.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(a);f.onsuccess=()=>o(),f.onerror=()=>c(new Error("删除向量失败"))})}async deleteBatchVectors(a){const r=await this.ensureDB();return new Promise((o,c)=>{const m=r.transaction([this.storeName],"readwrite").objectStore(this.storeName);let f=0,h=!1;for(const p of a){const b=m.delete(p);b.onsuccess=()=>{f++,f===a.length&&!h&&o()},b.onerror=()=>{h||(h=!0,c(new Error(`删除向量失败: ${p}`)))}}a.length===0&&o()})}async clearAllVectors(){const a=await this.ensureDB();return new Promise((r,o)=>{const m=a.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();m.onsuccess=()=>r(),m.onerror=()=>o(new Error("清空向量失败"))})}async getStats(){const a=await this.getAllVectors();if(a.length===0)return{totalVectors:0,byCategory:{探索:0,战斗:0,商城:0,医馆:0,悬赏:0,培育:0,商业:0,声望:0,公告:0,大牢:0,其他:0},oldestVector:0,newestVector:0,averageDimension:0,storageSize:0};const r={探索:0,战斗:0,商城:0,医馆:0,悬赏:0,培育:0,商业:0,声望:0,公告:0,大牢:0,其他:0};let o=0,c=a[0].created,d=a[0].created;for(const h of a)r[h.category]++,o+=h.vectorDimension,h.created<c&&(c=h.created),h.created>d&&(d=h.created);const m=o/a.length,f=a.reduce((h,p)=>h+p.vector.length*4+JSON.stringify(p.metadata).length,0);return{totalVectors:a.length,byCategory:r,oldestVector:c,newestVector:d,averageDimension:m,storageSize:f}}async isMemoryVectorized(a){return await this.getVectorByMemoryId(a)!==null}async getUnvectorizedMemoryIds(a){const r=[];for(const o of a)await this.isMemoryVectorized(o)||r.push(o);return r}close(){this.db&&(this.db.close(),this.db=null)}}const Cs=new Ag;class Tg{async search(a,r={}){const o=Date.now();try{const c=Vt.getConfig();if(!c.enabled)throw console.error("[语义搜索] ❌ 向量化功能未启用，请在设置中启用"),new Error("向量化功能未启用，请在设置中启用向量化功能");console.log("[语义搜索] 🔄 正在向量化查询文本..."),console.log("[语义搜索] 📊 当前配置:",{enabled:c.enabled,model:c.model,apiUrl:c.apiUrl});const d=await Vt.vectorize(a);let m=await this.getCandidates(r);if(console.log(`找到 ${m.length} 个候选向量`),m.length===0)return[];const f=this.calculateSimilarities(d,m,r),h=this.filterAndSort(f,r);let p=h;if(c.rerankerEnabled&&h.length>0){console.log("应用Reranker重排序...");const g=c.topKBeforeRerank||50,w=h.slice(0,g);p=await gh.rerankSearchResults(a,w)}const b=Date.now();return console.log(`搜索完成，耗时 ${b-o}ms，返回 ${p.length} 个结果`),p}catch(c){throw console.error("语义搜索失败:",c),c}}async batchSearch(a,r={}){const o=[],c=new Set;for(const m of a){const f=await this.search(m,r);for(const h of f)c.has(h.memory.id)||(o.push(h),c.add(h.memory.id))}o.sort((m,f)=>f.similarity-m.similarity),o.forEach((m,f)=>{m.rank=f+1});const d=r.maxResults||20;return o.slice(0,d)}async findSimilarMemories(a,r={}){const o=await Cs.getVectorByMemoryId(a);if(!o)throw new Error(`记忆 ${a} 未向量化`);let c=await this.getCandidates(r);if(c=c.filter(m=>m.memoryId!==a),c.length===0)return[];const d=this.calculateSimilarities(o.vector,c,r);return this.filterAndSort(d,r)}async hybridSearch(a,r,o={}){const c=await this.search(a,o);if(r.length===0)return c;const d=c.map(m=>{let f=0;const h=m.memory.text.toLowerCase();for(const b of r)h.includes(b.toLowerCase())&&(f+=.1);const p=m.similarity*.7+Math.min(f,.3);return{...m,similarity:p}});return d.sort((m,f)=>f.similarity-m.similarity),d.forEach((m,f)=>{m.rank=f+1}),d}async getCandidates(a){let r=[];if(a.categories&&a.categories.length>0)for(const o of a.categories){const c=await Cs.getVectorsByCategory(o);r.push(...c)}else r=await Cs.getAllVectors();return a.timeRange&&(r=r.filter(o=>o.metadata.realTimestamp>=a.timeRange.start&&o.metadata.realTimestamp<=a.timeRange.end)),a.involvedCharacters&&a.involvedCharacters.length>0&&(r=r.filter(o=>o.metadata.involvedCharacters?a.involvedCharacters.some(c=>o.metadata.involvedCharacters.includes(c)):!1)),a.tags&&a.tags.length>0&&(r=r.filter(o=>o.metadata.tags?a.tags.some(c=>o.metadata.tags.includes(c)):!1)),r}calculateSimilarities(a,r,o){const c=[],d=Date.now(),m=o.useTimeDecay??!1,f=o.timeDecayFactor??1e-5;for(const h of r){let p=Vt.cosineSimilarity(a,h.vector);if(m){const g=(d-h.metadata.realTimestamp)/(1e3*60*60*24),w=Math.exp(-f*g);p=p*w}c.push({memory:h,similarity:p,rank:0})}return c}filterAndSort(a,r){const o=r.minSimilarity??.7,c=Vt.getConfig(),d=c.rerankerEnabled?c.topKBeforeRerank||50:r.maxResults??20;let m=a.filter(f=>f.similarity>=o);return m.sort((f,h)=>h.similarity-f.similarity),m=m.slice(0,d),m.forEach((f,h)=>{f.rank=h+1}),m}clusterResults(a,r=.85){if(a.length===0)return[];const o=[],c=new Set;for(const d of a){if(c.has(d.memory.id))continue;const m=[d];c.add(d.memory.id);for(const f of a){if(c.has(f.memory.id))continue;Vt.cosineSimilarity(d.memory.vector,f.memory.vector)>=r&&(m.push(f),c.add(f.memory.id))}o.push(m)}return o}async getSuggestions(a,r=5){if(a.length<2)return[];const o=await Cs.getAllVectors(),c=new Set;for(const d of o){const m=d.text.toLowerCase(),f=a.toLowerCase();if(m.includes(f)){const h=d.text.split(/[。！？\n]/);for(const p of h)if(p.toLowerCase().includes(f)&&p.length<100&&(c.add(p.trim()),c.size>=r))break}if(c.size>=r)break}return Array.from(c)}}const Xd=new Tg;class Mg{extractContext(a){return a.mode==="battle"?this.extractBattleContext(a):this.extractExplorationContext(a)}extractBattleContext(a){const r=a.battle;if(!r)return{type:"battle",description:"战斗",keywords:["战斗"],categories:["战斗"]};const o=[],c=["战斗"];return r.playerParty.forEach(d=>{o.push(d.card.name),c.push(d.card.name)}),r.opponentParty.forEach(d=>{o.push(d.card.name),c.push(d.card.name)}),r.isArenaBattle?(c.push("竞技场","排位赛"),{type:"arena",description:`竞技场战斗：${o.join(" vs ")}`,involvedCharacters:o,keywords:c,categories:["战斗","声望"]}):{type:"battle",description:`战斗：${o.join(" vs ")}`,involvedCharacters:o,keywords:c,categories:["战斗"]}}extractExplorationContext(a){const r=a.exploration,o=r.location,c=r.story;if(o.includes("医馆")||c.includes("病患")||c.includes("诊治")){const f=this.extractKeywords(c);return f.push("医馆","问诊","治疗"),{type:"hospital",description:"医馆问诊",location:o,keywords:f,categories:["医馆"]}}if(o.includes("悬赏")||c.includes("悬赏")||c.includes("追踪")){const f=this.extractKeywords(c);return f.push("悬赏","追踪"),{type:"bounty",description:"悬赏任务",location:o,keywords:f,categories:["悬赏"]}}if(o.includes("商城")||o.includes("商店")||c.includes("购买")){const f=this.extractKeywords(c);return f.push("商城","购买","交易"),{type:"shop",description:"商城",location:o,keywords:f,categories:["商城"]}}if(o.includes("育灵轩")||c.includes("培育")||c.includes("繁育")){const f=this.extractKeywords(c);return f.push("培育","繁育"),{type:"cultivation",description:"育灵轩",location:o,keywords:f,categories:["培育"]}}if(o.includes("商业区")||c.includes("经营")||c.includes("生意")){const f=this.extractKeywords(c);return f.push("商业","经营"),{type:"business",description:"商业区经营",location:o,keywords:f,categories:["商业"]}}const d=this.extractKeywords(c),m=this.extractCharacterNames(c,a);return{type:"exploration",description:`探索：${o}`,location:o,involvedCharacters:m,keywords:d,categories:["探索"]}}extractKeywords(a){const r=[],o=["战斗","探索","购买","出售","治疗","问诊","追踪","培育","修炼","突破","挑战","对决","交易","谈判","调查"];for(const d of o)a.includes(d)&&r.push(d);const c=["医馆","商城","悬赏榜","育灵轩","竞技场","商业区","宗门","山门","广场","密室","洞府"];for(const d of c)a.includes(d)&&r.push(d);return r}extractCharacterNames(a,r){const o=[];for(const c of r.playerProfile.cardCollection)a.includes(c.name)&&o.push(c.name);for(const c of r.playerProfile.relationships)a.includes(c.name)&&o.push(c.name);return o}async retrieveRelevantMemories(a,r,o=10){const c=Date.now(),d=this.extractContext(a),m=r||d.description;console.log("[上下文检索] 🔍 当前上下文:",{type:d.type,description:d.description,categories:d.categories,keywords:d.keywords});const f={involvedCharacters:d.involvedCharacters,maxResults:o,minSimilarity:.65,useTimeDecay:!0,timeDecayFactor:1e-5};console.log("[上下文检索] 📊 搜索选项:",f);const h=await Xd.hybridSearch(m,d.keywords,f),p=Date.now();return{query:m,context:d.description,relevantMemories:h,totalSearched:h.length,searchTime:p-c}}async batchRetrieve(a,r,o=15){const c=Date.now(),d=this.extractContext(a),m={categories:d.categories,involvedCharacters:d.involvedCharacters,maxResults:o,minSimilarity:.65,useTimeDecay:!0},f=await Xd.batchSearch(r,m),h=Date.now();return{query:r.join("; "),context:d.description,relevantMemories:f,totalSearched:f.length,searchTime:h-c}}formatMemoriesForPrompt(a){if(a.length===0)return"";const r=["=== 相关历史记忆 ===",""];for(const o of a){const c=o.memory;r.push(`【${c.category}】${c.metadata.timestamp}`),r.push(`地点：${c.metadata.location||"未知"}`),c.metadata.involvedCharacters&&c.metadata.involvedCharacters.length>0&&r.push(`相关角色：${c.metadata.involvedCharacters.join("、")}`),r.push(`内容：${c.text}`),r.push(`相似度：${(o.similarity*100).toFixed(1)}%`),r.push("")}return r.push("==================="),r.join(`
`)}getMemorySummary(a){return a.map(r=>{const o=r.memory,c=o.text.length>100?o.text.substring(0,100)+"...":o.text;return`[${o.category}] ${o.metadata.timestamp}: ${c}`})}organizeByTimeline(a){const r=new Map;for(const o of a){const c=o.memory.metadata.timestamp;r.has(c)||r.set(c,[]),r.get(c).push(o)}return r}organizeByCharacter(a){const r=new Map;for(const o of a){const c=o.memory.metadata.involvedCharacters||[];for(const d of c)r.has(d)||r.set(d,[]),r.get(d).push(o)}return r}}const yi=new Mg;class zg{async buildEnhancedContext(a,r,o={}){const{includeVectorMemories:c=!0,includePreset:d=!0,includeWorldbook:m=!0,maxVectorResults:f=5,categories:h}=o,p=[];let b="";if(console.log("[上下文增强] ========== 开始构建AI上下文 =========="),d&&typeof TavernHelper<"u")try{console.log("[上下文增强] 🎯 尝试读取SillyTavern预设...");const N=TavernHelper.getPreset("in_use");b=this.extractPresetsContent(N),b?(console.log("[上下文增强] ✅ 成功读取预设内容"),console.log("[上下文增强] 📝 预设内容长度:",b.length,"字符"),console.log("[上下文增强] 📄 预设内容预览:",b.substring(0,200)+(b.length>200?"...":""))):console.log("[上下文增强] ⚠️ 预设内容为空")}catch(N){console.error("[上下文增强] ❌ 无法读取预设:",N)}else console.log("[上下文增强] ⏭️ 跳过预设读取 (includePreset:",d,", TavernHelper可用:",typeof TavernHelper<"u",")");if(c&&a.vectorConfig.enabled)try{console.log("[上下文增强] 🔍 开始检索向量记忆..."),console.log("[上下文增强] 📌 查询内容:",r.substring(0,100)+(r.length>100?"...":""));const{vectorService:N}=await _g(async()=>{const{vectorService:k}=await Promise.resolve().then(()=>Eg);return{vectorService:k}},void 0,import.meta.url);N.updateConfig(a.vectorConfig),console.log("[上下文增强] ✅ 已同步向量服务配置:",{enabled:a.vectorConfig.enabled,apiUrl:a.vectorConfig.apiUrl,model:a.vectorConfig.model});const j=await yi.retrieveRelevantMemories(a,r,f);if(j.relevantMemories.length>0){console.log("[上下文增强] ✅ 找到",j.relevantMemories.length,"条相关记忆"),j.relevantMemories.forEach((_,C)=>{console.log(`[上下文增强] 📦 记忆${C+1}:`,{分类:_.memory.category,相似度:`${(_.similarity*100).toFixed(1)}%`,时间:_.memory.metadata.timestamp,地点:_.memory.metadata.location||"未知",内容预览:_.memory.text.substring(0,50)+"..."})});const k=yi.formatMemoriesForPrompt(j.relevantMemories);p.push({role:"system",content:`以下是与当前情境相关的历史记忆，请参考这些记忆来生成更连贯和一致的内容：

${k}`})}else console.log("[上下文增强] ⚠️ 未找到相关记忆")}catch(N){console.error("[上下文增强] ❌ 无法检索向量记忆:",N)}else console.log("[上下文增强] ⏭️ 跳过向量记忆检索 (includeVectorMemories:",c,", 向量功能启用:",a.vectorConfig.enabled,")");if(m&&typeof TavernHelper<"u")try{console.log("[上下文增强] 📚 开始检索世界书条目...");const N=await this.getRelevantWorldbookEntries(a,r);N?(p.push({role:"system",content:N}),console.log("[上下文增强] ✅ 成功获取世界书条目")):console.log("[上下文增强] ⚠️ 未找到匹配的世界书条目")}catch(N){console.error("[上下文增强] ❌ 无法读取世界书:",N)}else console.log("[上下文增强] ⏭️ 跳过世界书检索 (includeWorldbook:",m,", TavernHelper可用:",typeof TavernHelper<"u",")");console.log("[上下文增强] 🎮 添加当前游戏状态上下文...");const g=this.buildGameContextPrompt(a);g&&(p.push({role:"system",content:g}),console.log("[上下文增强] ✅ 游戏状态上下文已添加"));const w=this.buildEnhancedUserPrompt(r,a);return console.log("[上下文增强] ========== 上下文构建完成 =========="),console.log("[上下文增强] 📊 汇总统计:"),console.log("[上下文增强]   - 预设内容:",b?"✅ 已包含":"❌ 未包含"),console.log("[上下文增强]   - 注入提示词数量:",p.length),p.forEach((N,j)=>{const k=N.content.substring(0,50).replace(/\n/g," "),_=N.content.includes("历史记忆")?"📦 向量记忆":N.content.includes("世界书")?"📚 世界书":N.content.includes("游戏状态")?"🎮 游戏状态":"❓ 其他";console.log(`[上下文增强]   ${j+1}. ${_}: ${k}...`)}),console.log("[上下文增强] =========================================="),{systemPrompt:b,userPrompt:w,injectedPrompts:p}}extractPresetsContent(a){const r=[];for(const o of a.prompts||[])o.enabled&&o.role==="system"&&o.content&&r.push(o.content);return r.join(`

`)}async getRelevantWorldbookEntries(a,r){if(typeof TavernHelper>"u")return null;try{const o=TavernHelper.getGlobalWorldbookNames(),c=TavernHelper.getCharWorldbookNames("current"),d=[...o,...c.primary?[c.primary]:[],...c.additional],m=Array.from(new Set(d));if(console.log("[世界书] 📚 全局世界书:",o),console.log("[世界书] 📚 角色主世界书:",c.primary),console.log("[世界书] 📚 角色附加世界书:",c.additional),console.log("[世界书] 📚 合并后总数:",m.length),m.length===0)return console.log("[世界书] ⚠️ 没有激活任何世界书"),null;console.log("[世界书] 📋 激活的世界书列表:",m);const f=[];let h=0;for(const p of m)try{console.log(`[世界书] 🔍 正在检查世界书: ${p}`);const b=await TavernHelper.getWorldbook(p);console.log(`[世界书] 📖 ${p} 包含 ${b.length} 个条目`),h+=b.length;let g=0;for(const w of b){if(!w.enabled)continue;this.shouldIncludeWorldbookEntry(w,r,a)&&(g++,console.log(`[世界书] ✅ 匹配条目: ${w.name}`),console.log("[世界书] 📝 条目类型:",w.strategy.type),console.log("[世界书] 🔑 关键词:",w.strategy.keys),console.log("[世界书] 📄 内容长度:",w.content.length,"字符"),f.push(`【${w.name}】
${w.content}`))}console.log(`[世界书] 📊 ${p}: ${g}/${b.length} 条目匹配`)}catch(b){console.error(`[世界书] ❌ 无法读取世界书 ${p}:`,b)}return console.log(`[世界书] 📈 总计: ${f.length}/${h} 条目匹配`),f.length===0?(console.log("[世界书] ⚠️ 没有找到匹配的条目"),null):(console.log("[世界书] ✅ 成功获取",f.length,"个相关条目"),`=== 相关世界书信息 ===

${f.join(`

`)}

===================`)}catch(o){return console.error("读取世界书时出错:",o),null}}shouldIncludeWorldbookEntry(a,r,o){var m,f;if(a.strategy.type==="constant")return!0;const c=r.toLowerCase(),d=a.strategy.keys||[];for(const h of d)if(typeof h=="string"&&c.includes(h.toLowerCase()))return!0;if((m=a.metadata)!=null&&m.location&&o.exploration.location&&o.exploration.location.includes(a.metadata.location))return!0;if((f=a.metadata)!=null&&f.involvedCharacters){for(const h of a.metadata.involvedCharacters)if(c.includes(h.toLowerCase()))return!0}return!1}buildGameContextPrompt(a){const r=[];if(r.push("=== 当前游戏状态 ==="),r.push(""),r.push(`玩家：${a.playerProfile.name}`),r.push(`称号：${a.playerProfile.title}`),r.push(`灵石：${a.playerProfile.spiritStones}`),r.push(""),r.push(`当前位置：${a.exploration.location}`),r.push(`时间：${a.exploration.time}`),r.push(""),a.playerProfile.maleParty.length>0||a.playerProfile.femaleParty.length>0){r.push("当前队伍：");const o=[...a.playerProfile.maleParty,...a.playerProfile.femaleParty];for(const c of o)r.push(`  - ${c.name} (${c.realm})`);r.push("")}return a.mode==="battle"&&a.battle&&(r.push("战斗中："),r.push(`  己方：${a.battle.playerParty.map(o=>o.card.name).join("、")}`),r.push(`  敌方：${a.battle.opponentParty.map(o=>o.card.name).join("、")}`),r.push("")),r.push("==================="),r.join(`
`)}buildEnhancedUserPrompt(a,r){const o=[];return r.mode==="battle"?o.push("请基于当前战斗情况生成内容"):o.push("请基于当前探索情况生成内容"),o.push("请确保内容与历史记忆保持一致"),o.length>0?`${a}

（${o.join("，")}）`:a}async generateWithEnhancedContext(a,r,o={}){if(typeof TavernHelper>"u")throw new Error("TavernHelper未定义，无法使用增强生成功能");const c=await this.buildEnhancedContext(a,r,o),d=[];for(let m=0;m<c.injectedPrompts.length;m++){const f=c.injectedPrompts[m];d.push({id:`enhanced_context_${m}`,role:f.role,content:f.content,position:"in_chat",depth:0,should_scan:!0})}try{return await TavernHelper.generate({user_input:c.userPrompt,injects:d,should_stream:o.shouldStream||!1,max_chat_history:"all"})}catch(m){throw console.error("AI生成失败:",m),m}}async generateWithCustomAPI(a,r,o,c={}){if(typeof TavernHelper>"u")throw new Error("TavernHelper未定义，无法使用增强生成功能");const d=await this.buildEnhancedContext(a,r,{...c,includePreset:!1,includeWorldbook:!1}),m=[];for(let f=0;f<d.injectedPrompts.length;f++){const h=d.injectedPrompts[f];m.push({id:`enhanced_context_${f}`,role:h.role,content:h.content,position:"in_chat",depth:0,should_scan:!0})}try{return await TavernHelper.generate({user_input:d.userPrompt,injects:m,should_stream:c.shouldStream||!1,custom_api:o})}catch(f){throw console.error("AI生成失败:",f),f}}}const Dg=new zg;async function tt(n){const{systemInstruction:a,prompt:r,gameState:o,includeVectorMemories:c=!0,includePreset:d=!0,includeWorldbook:m=!0,maxVectorResults:f=5,shouldStream:h=!1}=n;if(typeof window.TavernHelper>"u")throw console.warn("TavernHelper未定义，使用降级模式"),new Error("AI生成服务不可用");if(!o)return console.log("[增强生成] 未提供游戏状态，使用标准模式"),await window.TavernHelper.generateRaw({ordered_prompts:[{role:"system",content:a},{role:"user",content:r}]});try{console.log("[增强生成] ========================================"),console.log("[增强生成] 🚀 开始增强AI生成流程"),console.log("[增强生成] ========================================");const p=await Dg.buildEnhancedContext(o,r,{includeVectorMemories:c,includePreset:d,includeWorldbook:m,maxVectorResults:f});console.log("[增强生成] ========================================"),console.log("[增强生成] 📝 准备构建最终提示词序列"),console.log("[增强生成] ========================================");const b=[];console.log("[增强生成] 1️⃣ 添加原始系统提示词"),console.log("[增强生成]    长度:",a.length,"字符"),b.push({role:"system",content:a}),p.systemPrompt?(console.log("[增强生成] 2️⃣ 添加SillyTavern预设"),console.log("[增强生成]    长度:",p.systemPrompt.length,"字符"),b.push({role:"system",content:p.systemPrompt})):console.log("[增强生成] 2️⃣ ⏭️ 跳过SillyTavern预设（未配置）"),console.log("[增强生成] 3️⃣ 添加注入的上下文提示词"),console.log("[增强生成]    数量:",p.injectedPrompts.length),p.injectedPrompts.forEach((N,j)=>{const k=N.content.includes("历史记忆")?"📦 向量记忆":N.content.includes("世界书")?"📚 世界书条目":N.content.includes("游戏状态")?"🎮 游戏状态":"❓ 其他上下文",_=N.content.length;console.log(`[增强生成]    ${j+1}/${p.injectedPrompts.length} ${k} (${_}字符)`)}),b.push(...p.injectedPrompts),console.log("[增强生成] 4️⃣ 添加用户提示词"),console.log("[增强生成]    长度:",p.userPrompt.length,"字符"),b.push({role:"user",content:p.userPrompt}),console.log("[增强生成] ========================================"),console.log("[增强生成] 🎯 最终提示词统计:"),console.log("[增强生成]    总数:",b.length,"条");const g=b.reduce((N,j)=>N+j.content.length,0);console.log("[增强生成]    总长度:",g,"字符"),console.log("[增强生成] ========================================"),console.log("[增强生成] 🔄 调用TavernHelper.generateRaw进行AI生成...");const w=await window.TavernHelper.generateRaw({ordered_prompts:b});return console.log("[增强生成] ========================================"),console.log("[增强生成] ✅ AI生成完成"),console.log("[增强生成]    生成内容长度:",w.length,"字符"),console.log("[增强生成] ========================================"),w}catch(p){console.error("[增强生成] ========================================"),console.error("[增强生成] ❌ 增强生成失败，回退到标准生成"),console.error("[增强生成] 错误信息:",p),console.error("[增强生成] ========================================"),console.log("[增强生成] 🔄 使用标准模式生成...");const b=await window.TavernHelper.generateRaw({ordered_prompts:[{role:"system",content:a},{role:"user",content:r}]});return console.log("[增强生成] ✅ 标准模式生成完成"),b}}async function Qe(n,a){if(typeof window.TavernHelper>"u")throw new Error("AI生成服务不可用");return await window.TavernHelper.generateRaw({ordered_prompts:[{role:"system",content:n},{role:"user",content:a}]})}const Og={brothel:"青楼",arena:"角斗场",alchemy:"炼丹房",auction:"拍卖行",intelligence:"情报阁",hospital:"医馆",prison:"大牢",etiquette_hall:"礼仪馆",general:null},aa={brothel:"青楼",arena:"角斗场",alchemy:"炼丹房",auction:"拍卖行",intelligence:"情报阁",hospital:"医馆",prison:"大牢",etiquette_hall:"礼仪馆",general:"通用"},Ql={brothel:[{id:"p_brothel_star",name:"头牌花魁"},{id:"p_brothel_tutor",name:"双修导师"},{id:"p_brothel_guard",name:"护卫"}],arena:[{id:"p_arena_gladiator",name:"明星角斗士"},{id:"p_arena_host",name:"主持人"},{id:"p_arena_trader",name:"奴隶商人"}],alchemy:[{id:"p_alchemy_chief",name:"首席炼丹师"},{id:"p_alchemy_apprentice",name:"药童"}],auction:[{id:"p_auction_master",name:"首席拍卖师"},{id:"p_auction_appraiser",name:"鉴宝师"}],intelligence:[{id:"p_intel_chief",name:"情报头子"},{id:"p_intel_assassin",name:"暗杀者"}],hospital:[{id:"p_hospital_doctor",name:"主治医师"},{id:"p_hospital_nurse",name:"护士"}],prison:[{id:"p_prison_warden",name:"狱长"},{id:"p_prison_guard",name:"狱卒"},{id:"p_prison_torturer",name:"刑讯官"}],etiquette_hall:[{id:"p_etiquette_designer",name:"礼仪设计师"},{id:"p_etiquette_inspector",name:"礼仪督察"}],general:[]},Rg={autoRefreshEnabled:!0,refreshIntervalDays:7,lastRefreshTime:0,languageEtiquetteCount:5,behaviorDressEtiquetteCount:5,enabledScenes:["brothel","arena","alchemy","auction","intelligence","hospital","prison","etiquette_hall"],languageAspects:{addressing:!0,requesting:!0,thanking:!0},behaviorAspects:{upperDress:!0,lowerDress:!0,accessories:!0,entryEtiquette:!0,servicePosture:!0,specialActions:!0},styleSettings:{shameLevel:80,submissionLevel:100,exposureLevel:60},autoDistribute:!0,autoDeprecateOld:!0,keepTopExecuted:3},Ig={designer:null,languageEtiquettes:[],behaviorDressEtiquettes:[],weeklyThemes:[],currentTheme:null,designerWorkbench:null,settings:Rg,logs:[],stats:{totalGenerated:0,totalActive:0,totalExecutions:0,cycleCount:0}};function vh(n){const a=/```json\s*([\s\S]*?)\s*```/,r=n.match(a);if(r&&r[1])try{return JSON.parse(r[1])}catch(o){throw console.error("解析从AI响应中提取的JSON失败:",o),console.error("原始JSON字符串:",r[1]),new Error("模型返回的JSON格式无效。")}throw console.error("在AI响应中未找到JSON代码块。响应内容:",n),new Error("模型响应中未找到预期的JSON代码块。")}async function Lg(n,a,r){const o=n.enabledScenes.map(b=>{const w=(Ql[b]||[]).map(N=>N.name).join("、");return`${aa[b]}（岗位：${w||"通用"}）`}).join(`
`),c=`你是一位极度色情、变态、毫无道德底线的礼仪设计师【${a.name}】，专门为仙侠世界的各个店铺设计充满羞耻、服从和淫荡的语言礼仪规范。这些礼仪是给店铺里的奴仆（员工）遵守的。你的写作风格必须大胆、露骨、毫无保留。

**核心任务**：生成${n.languageEtiquetteCount}条语言铁律，每条铁律必须极度色情、充满羞耻感和服从性。

**重要：你必须严格按照以下JSON结构生成数据，所有必填字段都不能省略！**

**店铺和岗位信息**：
${o}

**场景要求**：
- 必须从以下场景中选择：${n.enabledScenes.map(b=>aa[b]).join("、")}
- 每条铁律选择不同的场景，避免重复
- 礼仪必须针对该场景下的具体岗位设计

**语言方面要求**：
${n.languageAspects.addressing?"- **称呼用语**：必须包含卑微、色情的称呼方式":""}
${n.languageAspects.requesting?"- **请求/汇报用语**：必须包含屈辱性的请求或汇报话术":""}
${n.languageAspects.thanking?"- **感谢/道歉用语**：必须包含淫荡的感谢或道歉方式":""}

**风格设置**：
- **羞耻程度**: ${n.styleSettings.shameLevel}/100（越高越羞耻）
- **服从强度**: ${n.styleSettings.submissionLevel}/100（越高越卑微）
- **露出程度**: ${n.styleSettings.exposureLevel}/100（越高越暴露）

**必填字段（每条铁律）**：
1. **name**: 铁律名称（50字以内，必须直接、露骨、充满性暗示）
   - 示例："花魁迎客必舔肉棒礼"、"护士诊疗时跪姿问诊规范"
   
2. **scene**: 适用场景（从启用场景中选择）
   - 可选值：brothel（青楼）、arena（角斗场）、alchemy（炼丹房）、auction（拍卖行）、intelligence（情报阁）、hospital（医馆）、prison（大牢）、etiquette_hall（礼仪馆）、general（通用）
   
3. **applicableRoles**: 适用角色/岗位列表（数组，2-4个角色）
   - 必须使用具体的岗位名称，如：["头牌花魁", "双修导师"]、["主治医师", "护士"]
   
4. **content**: 语言规范内容（200-400字）
   - 必须极度详细地描述语言使用场景和具体话术
   - 必须包含完整的示例对话
   - 必须体现羞耻感和服从性
   - 必须聚焦于性器官、性行为的描述
   
5. **examples**: 示例用语数组（3-5个具体示例）
   - 每个示例必须是完整的、可直接使用的话术
   - 必须极度色情、露骨
   - 示例格式："角色A对角色B说：'完整对话内容'"

**创作要求**：
1. **极致羞耻**：语言必须让使用者感到极度羞耻和屈辱
2. **绝对服从**：语言必须体现奴仆对主人/客人的绝对服从和卑微
3. **色情露骨**：必须包含性器官、性行为的直接描述
4. **场景贴合**：语言规范必须与店铺场景和岗位职责紧密结合
5. **可执行性**：规范必须具体、可操作，不能含糊其辞

**JSON输出格式示例**：
\`\`\`json
{
  "etiquettes": [
    {
      "name": "花魁迎客舔舐肉棒礼",
      "scene": "brothel",
      "applicableRoles": ["头牌花魁", "双修导师"],
      "content": "所有花魁在迎接贵客时，必须先跪下，用舌头舔舐客人的阴茎至少三分钟。舔舐时必须发出淫荡的吮吸声，并用手爱抚客人的睾丸。舔舐完毕后，需将口中积累的唾液和前列腺液混合物吞咽下去，然后用标准话术向客人汇报：'贵客大人，小女子的舌头已为您服务完毕，您的龙根威武雄壮，让卑贱的花魁铭记于心。现在奴婢将带着您的精华为您提供更深入的服务。'此礼仪旨在让花魁时刻铭记客人的威严，以更加恭敬的态度服务。",
      "examples": [
        "花魁跪在客人面前说：'贵客大人，卑贱的花魁请求用舌头为您服务，请您赐予贱婢这个荣幸。'",
        "双修导师舔舐时呻吟道：'啊...大人的肉棒好大好硬...贱婢的舌头太幸福了...'",
        "花魁舔完后说：'感谢大人赏赐精华给卑贱的奴婢，小女子会永远记住这份恩典。'"
      ]
    }
  ]
}
\`\`\`

**严格要求**：
- 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象
- JSON对象包含一个 "etiquettes" 数组，数组中有${n.languageEtiquetteCount}个元素
- 每个元素必须完整填充所有字段
- 不要在代码块之外添加任何解释或注释
- 所有描述必须极度色情、露骨、具体，不要使用委婉语`,d=`请为我设计${n.languageEtiquetteCount}条极度色情、充满羞耻的语言铁律，这些礼仪是给我店铺里的奴仆遵守的。记住：描写必须极度大胆、露骨、变态！`,m=r?await tt({systemInstruction:c,prompt:d,gameState:r}):await Qe(c,d),h=vh(m).etiquettes||[],p=Date.now();return h.map((b,g)=>{const w=b.scene||"general",j=(Ql[w]||[]).map(k=>k.id);return{...b,id:`lang-etiquette-${p}-${g}`,type:"language",status:"active",executionCount:0,createdAt:p,updatedAt:p,generatedBy:"ai",designerId:a.id,applicablePositions:j,distributions:[],isDistributed:!1}})}async function Bg(n,a,r){const o=n.enabledScenes.map(b=>{const w=(Ql[b]||[]).map(N=>N.name).join("、");return`${aa[b]}（岗位：${w||"通用"}）`}).join(`
`),c=`你是一位极度色情、变态、毫无道德底线的礼仪设计师【${a.name}】，专门为仙侠世界的各个店铺设计充满羞耻、服从和淫荡的行为着装规范。这些礼仪是给店铺里的奴仆（员工）遵守的。你的写作风格必须大胆、露骨、毫无保留。

**核心任务**：生成${n.behaviorDressEtiquetteCount}条行为着装铁律，每条铁律必须极度色情、极度暴露、充满羞耻感。

**重要：你必须严格按照以下JSON结构生成数据，所有必填字段都不能省略！**

**店铺和岗位信息**：
${o}

**场景要求**：
- 必须从以下场景中选择：${n.enabledScenes.map(b=>aa[b]).join("、")}
- 每条铁律选择不同的场景，避免重复
- 礼仪必须针对该场景下的具体岗位设计

**行为着装方面要求**：
${n.behaviorAspects.upperDress?"- **上身着装**：必须包含上身的暴露要求":""}
${n.behaviorAspects.lowerDress?"- **下身着装**：必须包含下身的暴露要求":""}
${n.behaviorAspects.accessories?"- **配饰要求**：必须包含羞耻性的配饰":""}
${n.behaviorAspects.entryEtiquette?"- **入场礼仪**：必须包含进入场所时的屈辱性动作":""}
${n.behaviorAspects.servicePosture?"- **服务姿态**：必须包含服务时的淫荡姿势":""}
${n.behaviorAspects.specialActions?"- **特殊动作**：必须包含特定的性行为要求":""}

**风格设置**：
- **羞耻程度**: ${n.styleSettings.shameLevel}/100（越高越羞耻）
- **服从强度**: ${n.styleSettings.submissionLevel}/100（越高越卑微）
- **露出程度**: ${n.styleSettings.exposureLevel}/100（越高越暴露，100=完全裸体+性器官完全暴露）

**必填字段（每条铁律）**：
1. **name**: 铁律名称（50字以内，必须直接、露骨、充满性暗示）
   - 示例："花魁全裸迎客制"、"护士乳头夹具工作规范"
   
2. **scene**: 适用场景（从启用场景中选择）
   - 可选值：brothel（青楼）、arena（角斗场）、alchemy（炼丹房）、auction（拍卖行）、intelligence（情报阁）、hospital（医馆）、prison（大牢）、etiquette_hall（礼仪馆）、general（通用）
   
3. **applicableRoles**: 适用角色/岗位列表（数组，2-4个角色）
   - 必须使用具体的岗位名称，如：["头牌花魁", "双修导师"]、["主治医师", "护士"]
   
4. **dressCode**: 着装要求对象
   - **upper**: 上身着装（100-200字，必须极度详细描述上身穿着，聚焦胸部、乳头）
   - **lower**: 下身着装（100-200字，必须极度详细描述下身穿着，聚焦性器官、臀部）
   - **accessories**: 配饰数组（2-4个具体配饰，每个50-100字描述）
   - **special**: 特殊要求（100-150字，描述其他特殊的着装或身体要求）
   
5. **behaviorRules**: 行为规范数组（3-5条具体规范）
   - 每条规范100-200字
   - 必须详细描述具体的行为动作
   - 必须包含性行为或性暗示
   - 必须体现羞耻感和服从性

**创作要求**：
1. **极致暴露**：着装必须让穿着者的性器官完全或部分暴露
2. **绝对羞耻**：着装和行为必须让奴仆感到极度羞耻
3. **色情露骨**：描述必须直接、具体，聚焦性器官和性行为
4. **场景贴合**：规范必须与店铺场景和岗位职责紧密结合
5. **可执行性**：规范必须具体、可操作，包含明确的动作描述

**露出程度参考**（根据${n.styleSettings.exposureLevel}/100）：
- 60以下：部分暴露（透视、镂空、开叉）
- 60-80：大面积暴露（乳头、臀部、大腿根部外露）
- 80-90：性器官部分暴露（阴唇外露、阴茎半露）
- 90-100：完全裸体+性器官完全暴露+性器官强制展示

**JSON输出格式示例**：
\`\`\`json
{
  "etiquettes": [
    {
      "name": "花魁全裸迎客制",
      "scene": "brothel",
      "applicableRoles": ["头牌花魁", "双修导师"],
      "dressCode": {
        "upper": "花魁在迎客时上身必须完全裸露，不得穿戴任何衣物遮挡。双乳必须完全暴露，乳头需保持勃起状态。为确保乳头持续勃起，需在迎客前使用冰块刺激乳头至少五分钟。服务过程中，乳房必须随着身体动作自然晃动，以展示其柔软和丰满。",
        "lower": "下身同样必须完全裸露，阴部不得有任何遮挡。阴毛需剃除干净，阴唇必须完全暴露。在服务时，需将双腿分开至少60度角，确保客人能清楚看到花魁的阴部。阴道口需保持湿润状态，若不够湿润需自行用手指刺激至淫水流出。",
        "accessories": [
          "乳头夹：两个金属乳头夹必须夹在乳头上，夹力适中以保持乳头充血状态。夹子上悬挂细链，链子下端连接小铃铛，每次动作时会发出清脆的声响。",
          "阴蒂环：一个小巧的金环穿过阴蒂，环上刻有'奴婢'二字。每次服务时需用手指拨动阴蒂环，让金环在阴蒂上滚动，产生强烈刺激。",
          "肛塞：一个透明水晶肛塞必须插入肛门，塞子尾部有一根红色丝带垂下。肛塞会在服务过程中不断刺激括约肌，提醒花魁保持专注。"
        ],
        "special": "服务开始前，花魁必须在客人面前进行'净身礼'：用温水清洗全身，特别是乳房、阴部和肛门，清洗过程需让客人观看。清洗完毕后，需让客人检查身体清洁度，客人有权用手指插入阴道和肛门检查。"
      },
      "behaviorRules": [
        "**迎客礼**：花魁迎接客人时，必须以跪姿爬行进入，爬行时臀部需高高翘起，让阴部和肛门完全暴露。爬至客人面前，需将额头贴地，双手向后掰开自己的臀瓣，让客人清楚看到阴道和肛门，保持此姿势直到客人允许起身。",
        "**服务姿态**：服务时，需先用手指撑开阴唇，展示给客人看。服务过程中，双腿必须保持分开状态，此姿势会让阴唇自然张开，阴道内壁部分外露。",
        "**侍奉动作**：每次为客人服务时，花魁需先用左手揉捏自己的左乳，用右手服务客人。同时需用力捏紧乳头，让身体因快感而颤抖，乳房剧烈晃动。",
        "**送客礼**：送客时，花魁需站起身，面向客人，双手捧起自己的双乳，将乳头对准客人，然后用力挤压乳房。同时需张开双腿，用手指撑开阴唇，让客人看到湿润的阴道内壁，并大声说：'感谢大人光临，卑贱的奴婢随时恭候大人再次驾临。'",
        "**特殊服务礼**：若客人要求特殊服务，花魁需当众自慰至高潮，以示对客人的敬意。自慰时需将一只手的手指插入阴道，另一只手揉搓阴蒂，直至淫水喷涌而出，身体剧烈痉挛。高潮时需大声喊出：'奴婢以身体的高潮向大人献祭！'"
      ]
    }
  ]
}
\`\`\`

**严格要求**：
- 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象
- JSON对象包含一个 "etiquettes" 数组，数组中有${n.behaviorDressEtiquetteCount}个元素
- 每个元素必须完整填充所有字段
- dressCode的所有子字段（upper, lower, accessories, special）都必须填写
- behaviorRules数组必须有3-5个元素
- 不要在代码块之外添加任何解释或注释
- 所有描述必须极度色情、露骨、具体、变态，不要使用委婉语`,d=`请为我设计${n.behaviorDressEtiquetteCount}条极度色情、极度暴露、充满羞耻的行为着装铁律，这些礼仪是给我店铺里的奴仆遵守的。记住：描写必须极度大胆、露骨、变态、暴露！`,m=r?await tt({systemInstruction:c,prompt:d,gameState:r}):await Qe(c,d),h=vh(m).etiquettes||[],p=Date.now();return h.map((b,g)=>{const w=b.scene||"general",j=(Ql[w]||[]).map(k=>k.id);return{...b,id:`behavior-etiquette-${p}-${g}`,type:"behavior_dress",status:"active",executionCount:0,createdAt:p,updatedAt:p,generatedBy:"ai",designerId:a.id,applicablePositions:j,distributions:[],isDistributed:!1}})}async function Ug(n,a,r){console.log("[礼仪生成] 开始生成所有礼仪..."),console.log("[礼仪生成] 设计师:",a.name),console.log("[礼仪生成] 语言铁律数量:",n.languageEtiquetteCount),console.log("[礼仪生成] 行为着装铁律数量:",n.behaviorDressEtiquetteCount);try{const[o,c]=await Promise.all([Lg(n,a,r),Bg(n,a,r)]);return console.log("[礼仪生成] 生成完成"),console.log("[礼仪生成] 语言铁律:",o.length,"条"),console.log("[礼仪生成] 行为着装铁律:",c.length,"条"),{languageEtiquettes:o,behaviorDressEtiquettes:c}}catch(o){throw console.error("[礼仪生成] 生成失败:",o),o}}async function Hg(n,a){if(!n.designer)throw new Error("未指派设计师，无法刷新礼仪");const r=a==null?void 0:a.playerProfile.cardCollection.find(g=>g.id===n.designer.characterId);if(!r)throw new Error("设计师角色卡不存在");const{languageEtiquettes:o,behaviorDressEtiquettes:c}=await Ug(n.settings,r,a),d=Date.now();let m=[...n.languageEtiquettes],f=[...n.behaviorDressEtiquettes];if(n.settings.autoDeprecateOld){const g=n.settings.keepTopExecuted,w=[...m].sort((_,C)=>C.executionCount-_.executionCount);m=w.slice(0,g).map(_=>({..._,status:"active"}));const N=w.slice(g).map(_=>({..._,status:"deprecated"}));m.push(...N);const j=[...f].sort((_,C)=>C.executionCount-_.executionCount);f=j.slice(0,g).map(_=>({..._,status:"active"}));const k=j.slice(g).map(_=>({..._,status:"deprecated"}));f.push(...k)}m.push(...o),f.push(...c);const h={...n.designer,designCount:n.designer.designCount+o.length+c.length},p={id:`log-${d}`,timestamp:d,action:"generate",details:`设计师【${r.name}】生成了${o.length}条语言铁律和${c.length}条行为着装铁律`,etiquetteIds:[...o.map(g=>g.id),...c.map(g=>g.id)],designerId:r.id};return{...n,designer:h,languageEtiquettes:m,behaviorDressEtiquettes:f,settings:{...n.settings,lastRefreshTime:d},logs:[p,...n.logs],stats:{totalGenerated:n.stats.totalGenerated+o.length+c.length,totalActive:m.filter(g=>g.status==="active").length+f.filter(g=>g.status==="active").length,totalExecutions:n.stats.totalExecutions,cycleCount:n.stats.cycleCount+1}}}const Pg=({workbench:n,designer:a,availableThemes:r,onUpdateWorkbench:o,onCreateWorkItem:c})=>{var k;const[d,m]=v.useState(!1),[f,h]=v.useState({weekNumber:((n==null?void 0:n.currentWeek)||0)+1,theme:null,notes:"",priority:"medium",status:"planned"}),p=()=>{if(!f.weekNumber){alert("请输入周数！");return}c({weekNumber:f.weekNumber,theme:f.theme||null,notes:f.notes||"",priority:f.priority||"medium",status:f.status||"planned"}),m(!1),h({weekNumber:((n==null?void 0:n.currentWeek)||0)+1,theme:null,notes:"",priority:"medium",status:"planned"})},b=_=>{switch(_){case"high":return"text-red-400 bg-red-500/20";case"medium":return"text-yellow-400 bg-yellow-500/20";case"low":return"text-blue-400 bg-blue-500/20"}},g=_=>{switch(_){case"completed":return"text-green-400 bg-green-500/20 border-green-500/30";case"in_progress":return"text-cyan-400 bg-cyan-500/20 border-cyan-500/30";case"planned":return"text-gray-400 bg-gray-500/20 border-gray-500/30"}},w=_=>{switch(_){case"completed":return"✅ 已完成";case"in_progress":return"⚙️ 进行中";case"planned":return"📋 已规划"}},N=(_,C)=>{if(!n)return;const S=n.workItems.map(D=>D.id===_?{...D,status:C,updatedAt:Date.now()}:D);o({...n,workItems:S})},j=_=>{if(!n||!confirm("确定要删除这个工作项吗？"))return;const C=n.workItems.filter(S=>S.id!==_);o({...n,workItems:C,totalWeeksPlanned:C.length})};return a?n?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-900/30 to-pink-900/30 rounded-lg border border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-stone-700 flex items-center justify-center text-2xl",children:a.gender==="Female"?"👩":"👨"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white",children:a.name}),e.jsx("p",{className:"text-xs text-gray-400",children:"礼仪设计师"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"p-2 bg-stone-800/50 rounded",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"当前周数"}),e.jsxs("p",{className:"text-lg font-bold text-pink-300",children:["第 ",n.currentWeek," 周"]})]}),e.jsxs("div",{className:"p-2 bg-stone-800/50 rounded",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"已规划周数"}),e.jsxs("p",{className:"text-lg font-bold text-purple-300",children:[n.totalWeeksPlanned," 周"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-lg font-bold text-cyan-300",children:"主题规划工作栏"}),e.jsxs("button",{onClick:()=>m(!0),className:"px-3 py-1.5 bg-purple-600/30 hover:bg-purple-500/40 border border-purple-500/50 rounded text-purple-300 hover:text-purple-200 transition-colors text-sm",children:[e.jsx("i",{className:"fa-solid fa-plus mr-1"}),"添加规划"]})]}),e.jsxs("div",{className:"space-y-3 max-h-[500px] overflow-y-auto scrollbar-xianxia",children:[n.workItems.sort((_,C)=>_.weekNumber-C.weekNumber).map(_=>e.jsxs("div",{className:`p-4 rounded-lg border-2 ${g(_.status)} transition-all`,children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"px-2 py-1 bg-stone-800/50 rounded font-mono text-sm text-white",children:["第 ",_.weekNumber," 周"]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${b(_.priority)}`,children:_.priority==="high"?"⚠️ 高优先级":_.priority==="medium"?"📍 中优先级":"💡 低优先级"}),e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-stone-700/50 text-gray-300",children:w(_.status)})]})}),_.theme?e.jsxs("div",{className:"mb-3 p-3 bg-stone-900/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:_.theme.icon}),e.jsx("h5",{className:"font-bold text-pink-300",children:_.theme.name})]}),e.jsx("p",{className:"text-sm text-gray-400",children:_.theme.description}),e.jsxs("div",{className:"flex gap-2 mt-2 text-xs",children:[e.jsxs("span",{className:"text-pink-300",children:["羞耻+",_.theme.themeSettings.shameBonus,"%"]}),e.jsxs("span",{className:"text-purple-300",children:["服从+",_.theme.themeSettings.submissionBonus,"%"]}),e.jsxs("span",{className:"text-red-300",children:["露出+",_.theme.themeSettings.exposureBonus,"%"]})]})]}):e.jsx("div",{className:"mb-3 p-3 bg-stone-900/30 rounded-lg border-2 border-dashed border-stone-600",children:e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"尚未指定主题"})}),_.notes&&e.jsxs("div",{className:"mb-3 p-2 bg-stone-800/30 rounded",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"设计笔记:"}),e.jsx("p",{className:"text-sm text-gray-300",children:_.notes})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t border-stone-700/50",children:[_.status==="planned"&&e.jsx("button",{onClick:()=>N(_.id,"in_progress"),className:"px-3 py-1 text-xs bg-cyan-600/30 hover:bg-cyan-500/40 rounded text-cyan-300 transition-colors",children:"开始执行"}),_.status==="in_progress"&&e.jsx("button",{onClick:()=>N(_.id,"completed"),className:"px-3 py-1 text-xs bg-green-600/30 hover:bg-green-500/40 rounded text-green-300 transition-colors",children:"标记完成"}),e.jsx("button",{onClick:()=>j(_.id),className:"px-3 py-1 text-xs bg-red-900/30 hover:bg-red-800/40 rounded text-red-300 transition-colors",children:"删除"})]})]},_.id)),n.workItems.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"text-5xl mb-3",children:"📝"}),e.jsx("p",{children:"暂无工作规划"}),e.jsx("p",{className:"text-sm mt-2",children:'点击"添加规划"开始设计主题周'})]})]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>m(!1),children:e.jsxs("div",{className:"bg-stone-900 border-2 border-purple-500 rounded-xl p-6 max-w-2xl w-full",onClick:_=>_.stopPropagation(),children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-300 mb-4",children:"添加主题规划"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"计划周数"}),e.jsx("input",{type:"number",min:"1",value:f.weekNumber,onChange:_=>h({...f,weekNumber:Number(_.target.value)}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-purple-500 focus:outline-none",placeholder:"第几周"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"选择主题（可选）"}),e.jsxs("select",{value:((k=f.theme)==null?void 0:k.id)||"",onChange:_=>{const C=r.find(S=>S.id===_.target.value);h({...f,theme:C||null})},className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-purple-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"暂不指定"}),r.map(_=>e.jsxs("option",{value:_.id,children:[_.icon," ",_.name]},_.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"优先级"}),e.jsxs("select",{value:f.priority,onChange:_=>h({...f,priority:_.target.value}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-purple-500 focus:outline-none",children:[e.jsx("option",{value:"low",children:"💡 低优先级"}),e.jsx("option",{value:"medium",children:"📍 中优先级"}),e.jsx("option",{value:"high",children:"⚠️ 高优先级"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"设计笔记"}),e.jsx("textarea",{value:f.notes,onChange:_=>h({...f,notes:_.target.value}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-purple-500 focus:outline-none resize-none",rows:3,placeholder:"记录设计灵感和想法..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:p,className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 rounded text-white font-semibold transition-all",children:"添加到工作栏"}),e.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-stone-700 hover:bg-stone-600 rounded text-gray-300 transition-colors",children:"取消"})]})]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-5xl mb-3",children:"📋"}),e.jsx("p",{className:"text-gray-400",children:"工作栏未初始化"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-5xl mb-3",children:"👤"}),e.jsx("p",{className:"text-gray-400",children:"请先指派礼仪设计师"})]})},qg=({isOpen:n,onClose:a,settings:r,onSave:o})=>{const[c,d]=v.useState(r),m=p=>{const b=c.enabledScenes.includes(p)?c.enabledScenes.filter(g=>g!==p):[...c.enabledScenes,p];d({...c,enabledScenes:b})},f=()=>{o(c)},h=()=>{confirm("确定要恢复默认设置吗？")&&d({autoRefreshEnabled:!0,refreshIntervalDays:7,lastRefreshTime:r.lastRefreshTime,languageEtiquetteCount:5,behaviorDressEtiquetteCount:5,enabledScenes:["brothel","arena","alchemy","auction","intelligence","hospital","prison","etiquette_hall"],languageAspects:{addressing:!0,requesting:!0,thanking:!0},behaviorAspects:{upperDress:!0,lowerDress:!0,accessories:!0,entryEtiquette:!0,servicePosture:!0,specialActions:!0},styleSettings:{shameLevel:80,submissionLevel:100,exposureLevel:60},autoDistribute:!0,autoDeprecateOld:!0,keepTopExecuted:3})};return n?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border border-pink-500/50 bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 w-full max-w-2xl max-h-[85vh] rounded-xl shadow-2xl overflow-hidden flex flex-col",onClick:p=>p.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-pink-400 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20 border-b border-stone-700/50",children:[e.jsxs("h2",{className:"text-xl font-bold text-pink-300 font-serif flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-gear"}),"礼仪设计馆 - 设置"]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-gray-400 hover:text-white transition-colors flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 scrollbar-xianxia",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-clock-rotate-left"}),"自动刷新设置"]}),e.jsxs("div",{className:"space-y-4 pl-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"刷新周期 (天)"}),e.jsx("input",{type:"number",min:"1",max:"30",value:c.refreshIntervalDays,onChange:p=>d({...c,refreshIntervalDays:Math.max(1,Math.min(30,parseInt(p.target.value)||1))}),className:"w-20 px-3 py-1.5 bg-stone-700/50 border border-stone-600 rounded-lg text-white text-center focus:outline-none focus:border-pink-500/50"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"范围: 1-30天"})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-list-ol"}),"每次生成数量"]}),e.jsxs("div",{className:"space-y-4 pl-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"语言铁律"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"1",max:"20",value:c.languageEtiquetteCount,onChange:p=>d({...c,languageEtiquetteCount:Math.max(1,Math.min(20,parseInt(p.target.value)||1))}),className:"w-20 px-3 py-1.5 bg-stone-700/50 border border-stone-600 rounded-lg text-white text-center focus:outline-none focus:border-pink-500/50"}),e.jsx("span",{className:"text-gray-500 text-sm",children:"条"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"行为着装铁律"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"1",max:"20",value:c.behaviorDressEtiquetteCount,onChange:p=>d({...c,behaviorDressEtiquetteCount:Math.max(1,Math.min(20,parseInt(p.target.value)||1))}),className:"w-20 px-3 py-1.5 bg-stone-700/50 border border-stone-600 rounded-lg text-white text-center focus:outline-none focus:border-pink-500/50"}),e.jsx("span",{className:"text-gray-500 text-sm",children:"条"})]})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-map-location-dot"}),"涉及场景 (勾选启用)"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 pl-4",children:Object.entries(aa).map(([p,b])=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.enabledScenes.includes(p),onChange:()=>m(p),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-pink-500 focus:ring-pink-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:b})]},p))})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-comment-dots"}),"涉及方面 - 语言"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 pl-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.languageAspects.addressing,onChange:p=>d({...c,languageAspects:{...c.languageAspects,addressing:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-pink-500 focus:ring-pink-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"称呼用语"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.languageAspects.requesting,onChange:p=>d({...c,languageAspects:{...c.languageAspects,requesting:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-pink-500 focus:ring-pink-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"请求/汇报用语"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.languageAspects.thanking,onChange:p=>d({...c,languageAspects:{...c.languageAspects,thanking:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-pink-500 focus:ring-pink-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"感谢/道歉用语"})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-shirt"}),"涉及方面 - 行为着装"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 pl-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.behaviorAspects.upperDress,onChange:p=>d({...c,behaviorAspects:{...c.behaviorAspects,upperDress:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-purple-500 focus:ring-purple-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"上身着装"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.behaviorAspects.lowerDress,onChange:p=>d({...c,behaviorAspects:{...c.behaviorAspects,lowerDress:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-purple-500 focus:ring-purple-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"下身着装"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.behaviorAspects.accessories,onChange:p=>d({...c,behaviorAspects:{...c.behaviorAspects,accessories:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-purple-500 focus:ring-purple-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"配饰要求"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.behaviorAspects.entryEtiquette,onChange:p=>d({...c,behaviorAspects:{...c.behaviorAspects,entryEtiquette:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-purple-500 focus:ring-purple-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"入场礼仪"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.behaviorAspects.servicePosture,onChange:p=>d({...c,behaviorAspects:{...c.behaviorAspects,servicePosture:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-purple-500 focus:ring-purple-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"服务姿态"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.behaviorAspects.specialActions,onChange:p=>d({...c,behaviorAspects:{...c.behaviorAspects,specialActions:p.target.checked}}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-purple-500 focus:ring-purple-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"特殊动作"})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-sliders"}),"生成风格设置"]}),e.jsxs("div",{className:"space-y-4 pl-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-300",children:"羞耻程度"}),e.jsxs("span",{className:"text-pink-300 font-mono",children:[c.styleSettings.shameLevel,"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:c.styleSettings.shameLevel,onChange:p=>d({...c,styleSettings:{...c.styleSettings,shameLevel:parseInt(p.target.value)}}),className:"w-full h-2 bg-stone-700 rounded-lg appearance-none cursor-pointer accent-pink-500"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-300",children:"服从强度"}),e.jsxs("span",{className:"text-purple-300 font-mono",children:[c.styleSettings.submissionLevel,"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:c.styleSettings.submissionLevel,onChange:p=>d({...c,styleSettings:{...c.styleSettings,submissionLevel:parseInt(p.target.value)}}),className:"w-full h-2 bg-stone-700 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-300",children:"露出程度"}),e.jsxs("span",{className:"text-red-300 font-mono",children:[c.styleSettings.exposureLevel,"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:c.styleSettings.exposureLevel,onChange:p=>d({...c,styleSettings:{...c.styleSettings,exposureLevel:parseInt(p.target.value)}}),className:"w-full h-2 bg-stone-700 rounded-lg appearance-none cursor-pointer accent-red-500"})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-gears"}),"高级设置"]}),e.jsxs("div",{className:"space-y-3 pl-4",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.autoDistribute,onChange:p=>d({...c,autoDistribute:p.target.checked}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-cyan-500 focus:ring-cyan-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"新礼仪生成后自动下发到各部门"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:c.autoDeprecateOld,onChange:p=>d({...c,autoDeprecateOld:p.target.checked}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-cyan-500 focus:ring-cyan-500/50"}),e.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:"旧礼仪在新周期开始时自动废除"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:c.keepTopExecuted>0,onChange:p=>d({...c,keepTopExecuted:p.target.checked?3:0}),className:"w-4 h-4 rounded border-stone-600 bg-stone-700 text-cyan-500 focus:ring-cyan-500/50"}),e.jsx("span",{className:"text-gray-300",children:"保留执行次数最高的"}),e.jsx("input",{type:"number",min:"0",max:"10",value:c.keepTopExecuted,onChange:p=>d({...c,keepTopExecuted:Math.max(0,Math.min(10,parseInt(p.target.value)||0))}),disabled:c.keepTopExecuted===0,className:"w-16 px-2 py-1 bg-stone-700/50 border border-stone-600 rounded text-white text-center text-sm focus:outline-none focus:border-cyan-500/50 disabled:opacity-50"}),e.jsx("span",{className:"text-gray-300",children:"条礼仪"})]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 p-4 border-t border-stone-700/50 bg-black/20 flex justify-between",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 rounded-lg text-gray-300 hover:text-white transition-colors text-sm",children:"恢复默认"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 rounded-lg text-gray-300 hover:text-white transition-colors text-sm",children:"取消"}),e.jsx("button",{onClick:f,className:"px-6 py-2 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 rounded-lg text-white font-semibold text-sm transition-all duration-200",children:"保存设置"})]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-pink-400 to-transparent"})]})}):null},Zg=({currentTheme:n,allThemes:a,onCreateTheme:r,onActivateTheme:o,onDeleteTheme:c})=>{var w,N,j;const[d,m]=v.useState(!1),[f,h]=v.useState({name:"",description:"",icon:"🎭",themeSettings:{shameBonus:20,submissionBonus:20,exposureBonus:20},specialRequirements:[],goals:[],status:"upcoming"}),p=()=>{if(!f.name||!f.description){alert("请填写主题名称和描述！");return}const k=Date.now(),_=10080*60*1e3;r({name:f.name,description:f.description,icon:f.icon||"🎭",startTime:k,endTime:k+_,status:"upcoming",themeSettings:f.themeSettings||{shameBonus:20,submissionBonus:20,exposureBonus:20},specialRequirements:f.specialRequirements||[],goals:f.goals||[]}),m(!1),h({name:"",description:"",icon:"🎭",themeSettings:{shameBonus:20,submissionBonus:20,exposureBonus:20},specialRequirements:[],goals:[],status:"upcoming"})},b=k=>{switch(k){case"active":return"border-green-500 bg-green-500/10";case"upcoming":return"border-blue-500 bg-blue-500/10";case"completed":return"border-gray-500 bg-gray-500/10"}},g=k=>{switch(k){case"active":return"✅ 进行中";case"upcoming":return"⏳ 未开始";case"completed":return"✔️ 已完成"}};return e.jsxs("div",{className:"space-y-4",children:[n&&e.jsxs("div",{className:"p-4 rounded-lg border-2 border-pink-500 bg-gradient-to-br from-pink-500/20 to-purple-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-4xl",children:n.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-pink-300",children:n.name}),e.jsx("p",{className:"text-sm text-gray-400",children:"当前主题周"})]})]}),e.jsx("span",{className:"px-3 py-1 rounded-full bg-green-500/20 text-green-300 text-sm",children:g(n.status)})]}),e.jsx("p",{className:"text-gray-300 mb-3",children:n.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"p-2 bg-stone-800/50 rounded text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"羞耻加成"}),e.jsxs("p",{className:"text-lg font-bold text-pink-300",children:["+",n.themeSettings.shameBonus,"%"]})]}),e.jsxs("div",{className:"p-2 bg-stone-800/50 rounded text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"服从加成"}),e.jsxs("p",{className:"text-lg font-bold text-purple-300",children:["+",n.themeSettings.submissionBonus,"%"]})]}),e.jsxs("div",{className:"p-2 bg-stone-800/50 rounded text-center",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"露出加成"}),e.jsxs("p",{className:"text-lg font-bold text-red-300",children:["+",n.themeSettings.exposureBonus,"%"]})]})]}),n.goals.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-stone-900/50 rounded",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"主题目标:"}),e.jsx("ul",{className:"space-y-1",children:n.goals.map((k,_)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{children:k.completed?"✅":"⭕"}),e.jsx("span",{className:k.completed?"text-green-300":"text-gray-300",children:k.description})]},_))})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-lg font-bold text-cyan-300",children:"所有主题周"}),e.jsxs("button",{onClick:()=>m(!0),className:"px-3 py-1.5 bg-pink-600/30 hover:bg-pink-500/40 border border-pink-500/50 rounded text-pink-300 hover:text-pink-200 transition-colors text-sm",children:[e.jsx("i",{className:"fa-solid fa-plus mr-1"}),"创建新主题"]})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto scrollbar-xianxia",children:a.map(k=>e.jsx("div",{className:`p-3 rounded-lg border-2 ${b(k.status)} transition-all`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"text-2xl",children:k.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-bold text-white",children:k.name}),e.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-stone-700/50 text-gray-300",children:g(k.status)})]}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:k.description}),e.jsxs("div",{className:"flex gap-2 mt-2 text-xs",children:[e.jsxs("span",{className:"text-pink-300",children:["羞耻+",k.themeSettings.shameBonus,"%"]}),e.jsxs("span",{className:"text-purple-300",children:["服从+",k.themeSettings.submissionBonus,"%"]}),e.jsxs("span",{className:"text-red-300",children:["露出+",k.themeSettings.exposureBonus,"%"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[k.status==="upcoming"&&e.jsx("button",{onClick:()=>o(k.id),className:"px-2 py-1 text-xs bg-green-600/30 hover:bg-green-500/40 rounded text-green-300 transition-colors",children:"启用"}),k.status!=="active"&&e.jsx("button",{onClick:()=>c(k.id),className:"px-2 py-1 text-xs bg-red-900/30 hover:bg-red-800/40 rounded text-red-300 transition-colors",children:"删除"})]})]})},k.id))})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>m(!1),children:e.jsxs("div",{className:"bg-stone-900 border-2 border-pink-500 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:k=>k.stopPropagation(),children:[e.jsx("h3",{className:"text-2xl font-bold text-pink-300 mb-4",children:"创建新主题周"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"主题名称"}),e.jsx("input",{type:"text",value:f.name,onChange:k=>h({...f,name:k.target.value}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-pink-500 focus:outline-none",placeholder:"例如: 羞辱周、服从周"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"主题图标"}),e.jsx("input",{type:"text",value:f.icon,onChange:k=>h({...f,icon:k.target.value}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-pink-500 focus:outline-none",placeholder:"输入emoji图标"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"主题描述"}),e.jsx("textarea",{value:f.description,onChange:k=>h({...f,description:k.target.value}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-pink-500 focus:outline-none resize-none",rows:3,placeholder:"描述这个主题周的特色..."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"羞耻加成 (%)"}),e.jsx("input",{type:"number",min:"0",max:"50",value:(w=f.themeSettings)==null?void 0:w.shameBonus,onChange:k=>h({...f,themeSettings:{...f.themeSettings,shameBonus:Number(k.target.value)}}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-pink-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"服从加成 (%)"}),e.jsx("input",{type:"number",min:"0",max:"50",value:(N=f.themeSettings)==null?void 0:N.submissionBonus,onChange:k=>h({...f,themeSettings:{...f.themeSettings,submissionBonus:Number(k.target.value)}}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-pink-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"露出加成 (%)"}),e.jsx("input",{type:"number",min:"0",max:"50",value:(j=f.themeSettings)==null?void 0:j.exposureBonus,onChange:k=>h({...f,themeSettings:{...f.themeSettings,exposureBonus:Number(k.target.value)}}),className:"w-full px-3 py-2 bg-stone-800 border border-stone-600 rounded text-white focus:border-pink-500 focus:outline-none"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:p,className:"flex-1 px-4 py-2 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 rounded text-white font-semibold transition-all",children:"创建主题"}),e.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-stone-700 hover:bg-stone-600 rounded text-gray-300 transition-colors",children:"取消"})]})]})]})})]})},df=({type:n})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[e.jsx("div",{className:"text-5xl mb-4",children:n==="language"?"💬":"👗"}),e.jsxs("p",{className:"text-lg mb-2",children:["暂无",n==="language"?"语言":"行为着装","铁律"]}),e.jsx("p",{className:"text-sm",children:"请指派设计师并刷新礼仪，或手动添加"})]}),Gg=({etiquette:n,isExpanded:a,onToggleExpand:r,onDeprecate:o,onDistribute:c,onRecall:d})=>{const m={active:"text-green-400 bg-green-500/20",pending:"text-yellow-400 bg-yellow-500/20",deprecated:"text-gray-500 bg-gray-500/20"};return e.jsxs("div",{className:`p-3 sm:p-4 rounded-lg border transition-all duration-200 ${n.status==="active"?"border-pink-500/30 bg-stone-800/50 hover:border-pink-500/50":"border-stone-700/50 bg-stone-800/30 opacity-60"}`,children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsxs("span",{className:"text-pink-400 font-mono text-xs",children:["#",n.id]}),e.jsx("h4",{className:"font-bold text-white text-sm sm:text-base",children:n.name}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${m[n.status]}`,children:n.status==="active"?"✅ 生效中":n.status==="pending"?"⏳ 待下发":"❌ 已废除"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 sm:gap-2 text-xs text-gray-400 mb-2",children:[e.jsxs("span",{className:"px-1.5 py-0.5 sm:px-2 bg-stone-700/50 rounded text-xs",children:["📍 ",aa[n.scene]]}),e.jsxs("span",{className:"px-1.5 py-0.5 sm:px-2 bg-stone-700/50 rounded text-xs hidden sm:inline",children:["👥 ",n.applicableRoles.join(", ")]}),e.jsxs("span",{className:"px-1.5 py-0.5 sm:px-2 bg-stone-700/50 rounded text-xs",children:["📊 ",n.executionCount,"次"]})]}),e.jsx("p",{className:`text-gray-300 text-sm ${a?"":"line-clamp-2"}`,children:n.content}),a&&n.examples&&n.examples.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-stone-900/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"示例用语:"}),e.jsx("ul",{className:"space-y-1",children:n.examples.map((f,h)=>e.jsxs("li",{className:"text-sm text-pink-300 italic",children:['"',f,'"']},h))})]})]})}),n.isDistributed&&n.distributions&&n.distributions.length>0&&e.jsxs("div",{className:"mt-2 p-1.5 sm:p-2 bg-green-900/20 rounded border border-green-500/30",children:[e.jsx("p",{className:"text-xs text-green-400 mb-1",children:"✅ 已分发"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.distributions.filter(f=>f.status==="distributed").map((f,h)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-500/20 text-green-300 rounded",children:f.shopType},h))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mt-3 pt-3 border-t border-stone-700/50 gap-2",children:[e.jsx("button",{onClick:r,className:"text-xs text-gray-400 hover:text-gray-300 transition-colors min-h-[44px] sm:min-h-0 flex items-center",children:a?"收起 ▲":"展开 ▼"}),e.jsxs("div",{className:"flex gap-1 sm:gap-2 flex-wrap w-full sm:w-auto",children:[n.isDistributed?e.jsx("button",{onClick:d,className:"px-2 py-1.5 text-xs bg-orange-600/30 hover:bg-orange-500/40 rounded text-orange-300 hover:text-orange-200 transition-colors min-h-[44px] sm:min-h-0",children:"📥 撤回"}):e.jsx("button",{onClick:c,className:"px-2 py-1.5 text-xs bg-green-600/30 hover:bg-green-500/40 rounded text-green-300 hover:text-green-200 transition-colors min-h-[44px] sm:min-h-0",children:"📤 分发"}),e.jsx("button",{className:"px-2 py-1.5 text-xs bg-stone-700/50 hover:bg-stone-600/50 rounded text-gray-300 hover:text-white transition-colors min-h-[44px] sm:min-h-0 hidden sm:inline-block",children:"👁️ 预览"}),e.jsx("button",{className:"px-2 py-1.5 text-xs bg-stone-700/50 hover:bg-stone-600/50 rounded text-gray-300 hover:text-white transition-colors min-h-[44px] sm:min-h-0 hidden sm:inline-block",children:"✏️ 微调"}),n.status==="active"&&!n.isDistributed&&e.jsx("button",{onClick:o,className:"px-2 py-1.5 text-xs bg-red-900/30 hover:bg-red-800/40 rounded text-red-300 hover:text-red-200 transition-colors min-h-[44px] sm:min-h-0",children:"🗑️ 废除"})]})]})]})},Vg=({etiquette:n,isExpanded:a,onToggleExpand:r,onDeprecate:o,onDistribute:c,onRecall:d})=>{const m={active:"text-green-400 bg-green-500/20",pending:"text-yellow-400 bg-yellow-500/20",deprecated:"text-gray-500 bg-gray-500/20"};return e.jsxs("div",{className:`p-3 sm:p-4 rounded-lg border transition-all duration-200 ${n.status==="active"?"border-purple-500/30 bg-stone-800/50 hover:border-purple-500/50":"border-stone-700/50 bg-stone-800/30 opacity-60"}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsxs("span",{className:"text-purple-400 font-mono text-xs",children:["#",n.id]}),e.jsx("h4",{className:"font-bold text-white text-sm sm:text-base",children:n.name}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${m[n.status]}`,children:n.status==="active"?"✅ 生效中":n.status==="pending"?"⏳ 待下发":"❌ 已废除"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 sm:gap-2 text-xs text-gray-400 mb-2",children:[e.jsxs("span",{className:"px-1.5 py-0.5 sm:px-2 bg-stone-700/50 rounded text-xs",children:["📍 ",aa[n.scene]]}),e.jsxs("span",{className:"px-1.5 py-0.5 sm:px-2 bg-stone-700/50 rounded text-xs hidden sm:inline",children:["👥 ",n.applicableRoles.join(", ")]}),e.jsxs("span",{className:"px-1.5 py-0.5 sm:px-2 bg-stone-700/50 rounded text-xs",children:["📊 ",n.executionCount,"次"]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs text-purple-300 mb-1",children:"👗 着装要求:"}),e.jsxs("div",{className:`text-gray-300 text-sm space-y-1 ${a?"":"line-clamp-2"}`,children:[n.dressCode.upper&&e.jsxs("p",{children:["• 上身: ",n.dressCode.upper]}),n.dressCode.lower&&e.jsxs("p",{children:["• 下身: ",n.dressCode.lower]}),n.dressCode.accessories&&n.dressCode.accessories.length>0&&e.jsxs("p",{children:["• 配饰: ",n.dressCode.accessories.join(", ")]}),n.dressCode.special&&e.jsxs("p",{children:["• 特殊: ",n.dressCode.special]})]})]}),a&&n.behaviorRules.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-stone-900/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-purple-300 mb-2",children:"🎭 行为要求:"}),e.jsx("ul",{className:"space-y-1",children:n.behaviorRules.map((f,h)=>e.jsxs("li",{className:"text-sm text-gray-300",children:["• ",f]},h))})]})]}),n.isDistributed&&n.distributions&&n.distributions.length>0&&e.jsxs("div",{className:"mt-2 p-2 bg-green-900/20 rounded border border-green-500/30",children:[e.jsx("p",{className:"text-xs text-green-400 mb-1",children:"✅ 已分发到："}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.distributions.filter(f=>f.status==="distributed").map((f,h)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-500/20 text-green-300 rounded",children:f.shopType},h))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mt-3 pt-3 border-t border-stone-700/50 gap-2",children:[e.jsx("button",{onClick:r,className:"text-xs text-gray-400 hover:text-gray-300 transition-colors min-h-[44px] sm:min-h-0 flex items-center",children:a?"收起 ▲":"展开 ▼"}),e.jsxs("div",{className:"flex gap-1 sm:gap-2 flex-wrap w-full sm:w-auto",children:[n.isDistributed?e.jsx("button",{onClick:d,className:"px-2 py-1.5 text-xs bg-orange-600/30 hover:bg-orange-500/40 rounded text-orange-300 hover:text-orange-200 transition-colors min-h-[44px] sm:min-h-0",children:"📥 撤回"}):e.jsx("button",{onClick:c,className:"px-2 py-1.5 text-xs bg-green-600/30 hover:bg-green-500/40 rounded text-green-300 hover:text-green-200 transition-colors min-h-[44px] sm:min-h-0",children:"📤 分发"}),e.jsx("button",{className:"px-2 py-1.5 text-xs bg-stone-700/50 hover:bg-stone-600/50 rounded text-gray-300 hover:text-white transition-colors min-h-[44px] sm:min-h-0 hidden sm:inline-block",children:"👁️ 预览"}),e.jsx("button",{className:"px-2 py-1.5 text-xs bg-stone-700/50 hover:bg-stone-600/50 rounded text-gray-300 hover:text-white transition-colors min-h-[44px] sm:min-h-0 hidden sm:inline-block",children:"✏️ 微调"}),n.status==="active"&&!n.isDistributed&&e.jsx("button",{onClick:o,className:"px-2 py-1.5 text-xs bg-red-900/30 hover:bg-red-800/40 rounded text-red-300 hover:text-red-200 transition-colors min-h-[44px] sm:min-h-0",children:"🗑️ 废除"})]})]})]})},Qg=({isOpen:n,onClose:a,etiquetteSystem:r,onUpdateEtiquetteSystem:o,cardCollection:c,onOpenDesignerSelection:d,gameState:m})=>{const[f,h]=v.useState("theme"),[p,b]=v.useState("all"),[g,w]=v.useState(!1),[N,j]=v.useState(null),[k,_]=v.useState(!1),C=v.useMemo(()=>r.designer&&c.find(G=>{var H;return G.id===((H=r.designer)==null?void 0:H.characterId)})||null,[r.designer,c]),S=v.useMemo(()=>{if(!r.designer||!r.settings.autoRefreshEnabled)return null;const G=r.settings.lastRefreshTime||Date.now(),H=r.settings.refreshIntervalDays*24*60*60*1e3,U=G+H-Date.now();if(U<=0)return{text:"可立即刷新",canRefresh:!0};const te=Math.floor(U/(1440*60*1e3)),ie=Math.floor(U%(1440*60*1e3)/(3600*1e3));return{text:`${te}天 ${ie}小时`,canRefresh:!1}},[r.designer,r.settings]),D=v.useMemo(()=>p==="all"?r.languageEtiquettes:r.languageEtiquettes.filter(G=>G.scene===p),[r.languageEtiquettes,p]),E=v.useMemo(()=>p==="all"?r.behaviorDressEtiquettes:r.behaviorDressEtiquettes.filter(G=>G.scene===p),[r.behaviorDressEtiquettes,p]),A=v.useMemo(()=>{const G=r.languageEtiquettes.filter(O=>O.status==="active").length,H=r.behaviorDressEtiquettes.filter(O=>O.status==="active").length;return{totalActive:G+H,languageCount:r.languageEtiquettes.length,behaviorCount:r.behaviorDressEtiquettes.length}},[r]),z=async()=>{if(!r.designer){alert("请先指派礼仪设计师！");return}if(!(k||!confirm(`即将生成新礼仪：
• 语言铁律: ${r.settings.languageEtiquetteCount} 条
• 行为着装铁律: ${r.settings.behaviorDressEtiquetteCount} 条

确定要刷新吗？`))){_(!0);try{console.log("[礼仪馆] 开始刷新礼仪...");const H=await Hg(r,m);o(H),console.log("[礼仪馆] 礼仪刷新成功"),alert(`✅ 礼仪刷新成功！

• 新增语言铁律: ${H.languageEtiquettes.filter(O=>O.status==="active"&&O.createdAt===H.settings.lastRefreshTime).length} 条
• 新增行为着装铁律: ${H.behaviorDressEtiquettes.filter(O=>O.status==="active"&&O.createdAt===H.settings.lastRefreshTime).length} 条`)}catch(H){console.error("[礼仪馆] 礼仪刷新失败:",H),alert(`❌ 礼仪刷新失败：${H instanceof Error?H.message:"未知错误"}

请检查是否已正确配置AI生成服务。`)}finally{_(!1)}}},I=()=>{confirm("确定要移除当前设计师吗？")&&o({...r,designer:null})},L=(G,H)=>{if(confirm("确定要废除这条礼仪吗？"))if(H==="language"){const O=r.languageEtiquettes.map(U=>U.id===G?{...U,status:"deprecated",updatedAt:Date.now()}:U);o({...r,languageEtiquettes:O})}else{const O=r.behaviorDressEtiquettes.map(U=>U.id===G?{...U,status:"deprecated",updatedAt:Date.now()}:U);o({...r,behaviorDressEtiquettes:O})}},T=(G,H)=>{var W;const O=H==="language"?r.languageEtiquettes.find(ne=>ne.id===G):r.behaviorDressEtiquettes.find(ne=>ne.id===G);if(!O)return;const U=Og[O.scene];if(!U){alert("通用礼仪需要手动选择分发目标，此功能正在开发中...");return}const te=Ql[O.scene]||[],ie=te.map(ne=>ne.id),B={shopType:U,positionIds:ie,distributedAt:Date.now(),distributedBy:(W=r.designer)==null?void 0:W.characterId,status:"distributed"};if(H==="language"){const ne=r.languageEtiquettes.map(X=>X.id===G?{...X,distributions:[...X.distributions||[],B],isDistributed:!0,updatedAt:Date.now()}:X);o({...r,languageEtiquettes:ne})}else{const ne=r.behaviorDressEtiquettes.map(X=>X.id===G?{...X,distributions:[...X.distributions||[],B],isDistributed:!0,updatedAt:Date.now()}:X);o({...r,behaviorDressEtiquettes:ne})}alert(`✅ 礼仪已分发到【${U}】！

适用岗位：${te.map(ne=>ne.name).join("、")||"全部"}`)},P=(G,H)=>{if(confirm("确定要撤回这条礼仪吗？撤回后店铺将不再执行此礼仪。")){if(H==="language"){const O=r.languageEtiquettes.map(U=>U.id===G?{...U,distributions:(U.distributions||[]).map(te=>({...te,status:"recalled",recalledAt:Date.now()})),isDistributed:!1,updatedAt:Date.now()}:U);o({...r,languageEtiquettes:O})}else{const O=r.behaviorDressEtiquettes.map(U=>U.id===G?{...U,distributions:(U.distributions||[]).map(te=>({...te,status:"recalled",recalledAt:Date.now()})),isDistributed:!1,updatedAt:Date.now()}:U);o({...r,behaviorDressEtiquettes:O})}alert("✅ 礼仪已撤回！")}},M=G=>{var O;const H={...G,id:`theme_${Date.now()}`,createdAt:Date.now(),designedBy:(O=r.designer)==null?void 0:O.characterId};o({...r,weeklyThemes:[...r.weeklyThemes,H]})},R=G=>{const H=r.weeklyThemes.find(U=>U.id===G);if(!H)return;const O=r.weeklyThemes.map(U=>U.status==="active"?{...U,status:"completed"}:U.id===G?{...U,status:"active",startTime:Date.now(),endTime:Date.now()+10080*60*1e3}:U);o({...r,weeklyThemes:O,currentTheme:{...H,status:"active",startTime:Date.now(),endTime:Date.now()+10080*60*1e3}})},Q=G=>{if(!confirm("确定要删除这个主题吗？"))return;const H=r.weeklyThemes.filter(O=>O.id!==G);o({...r,weeklyThemes:H})},Z=G=>{if(!r.designerWorkbench)return;const H={...G,id:`work_${Date.now()}`,createdAt:Date.now(),updatedAt:Date.now()};o({...r,designerWorkbench:{...r.designerWorkbench,workItems:[...r.designerWorkbench.workItems,H],totalWeeksPlanned:r.designerWorkbench.totalWeeksPlanned+1}})};return n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-0 sm:p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border border-xianxia-gold-600 bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 w-full h-full sm:h-[90vh] sm:max-w-6xl sm:rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col animate-slide-in",onClick:G=>G.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-pink-400 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 flex-shrink-0 bg-black/20 border-b border-stone-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold text-gradient-gold text-shadow-glow font-serif tracking-widest",children:"🎀 礼仪设计馆"}),e.jsxs("button",{onClick:()=>w(!0),className:"px-2 py-1 sm:px-3 sm:py-1.5 bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 hover:border-pink-500/50 rounded-lg text-gray-300 hover:text-pink-300 transition-all duration-200 text-xs sm:text-sm flex items-center gap-1 sm:gap-2",children:[e.jsx("i",{className:"fa-solid fa-gear"}),"设置"]})]}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 hover:border-xianxia-gold-500 text-gray-400 hover:text-xianxia-gold-400 transition-all duration-200 flex items-center justify-center group",children:e.jsx("i",{className:"fa-solid fa-times text-xl group-hover:rotate-90 transition-transform duration-200"})})]}),e.jsxs("div",{className:"flex-grow flex flex-col sm:flex-row overflow-hidden",children:[e.jsxs("div",{className:"w-full sm:w-72 flex-shrink-0 border-b sm:border-b-0 sm:border-r border-stone-700/50 flex flex-col bg-black/10 max-h-56 sm:max-h-none overflow-y-auto sm:overflow-y-visible",children:[e.jsxs("div",{className:"p-2 sm:p-4 border-b border-stone-700/50",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-pink-300 mb-2 sm:mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-user-pen"}),"礼仪设计师"]}),C?e.jsxs("div",{className:`p-2 sm:p-3 rounded-lg border-2 ${pt(C.rarity)} bg-stone-800/50`,children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-stone-700 flex items-center justify-center text-xl sm:text-2xl flex-shrink-0",children:C.gender==="Female"?"👩":"👨"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-white truncate text-sm sm:text-base",children:C.name}),e.jsx("p",{className:`text-xs ${ke(C.rarity)}`,children:C.realm})]})]}),r.designer&&e.jsxs("div",{className:"mt-2 sm:mt-3 space-y-1 text-xs text-gray-400",children:[e.jsxs("p",{className:"truncate",children:["📊 已设计: ",e.jsx("span",{className:"text-pink-300",children:r.designer.designCount})," 条"]}),e.jsxs("p",{className:"truncate hidden sm:block",children:["⭐ 质量: ",e.jsxs("span",{className:"ml-1 text-yellow-400",children:["★".repeat(Math.floor(r.designer.qualityScore/20)),"☆".repeat(5-Math.floor(r.designer.qualityScore/20))]})]})]}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex gap-1 sm:gap-2",children:[e.jsx("button",{onClick:d,className:"flex-1 px-2 py-1 sm:py-1.5 bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 rounded text-xs text-gray-300 hover:text-white transition-colors min-h-[44px] sm:min-h-0",children:"🔄 更换"}),e.jsx("button",{onClick:I,className:"flex-1 px-2 py-1 sm:py-1.5 bg-red-900/30 hover:bg-red-800/40 border border-red-700/50 rounded text-xs text-red-300 hover:text-red-200 transition-colors min-h-[44px] sm:min-h-0",children:"❌ 移除"})]})]}):e.jsxs("div",{className:"p-2 sm:p-4 rounded-lg border-2 border-dashed border-stone-600 bg-stone-800/30 text-center",children:[e.jsx("div",{className:"text-2xl sm:text-4xl mb-1 sm:mb-2",children:"👤"}),e.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-2 sm:mb-3",children:"未指派设计师"}),e.jsx("p",{className:"text-yellow-500 text-xs mb-2 sm:mb-3 hidden sm:block",children:"💡 自动刷新已暂停"}),e.jsx("button",{onClick:d,className:"w-full px-2 py-2 sm:px-3 bg-pink-600/30 hover:bg-pink-500/40 border border-pink-500/50 rounded-lg text-pink-300 hover:text-pink-200 transition-colors text-xs sm:text-sm min-h-[44px]",children:"📋 选择设计师"})]})]}),e.jsxs("div",{className:"p-2 sm:p-4 flex-1 hidden sm:block",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-cyan-300 mb-2 sm:mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-chart-line"}),"运行状态"]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"系统状态:"}),r.designer?e.jsxs("span",{className:"text-green-400 text-sm flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"运行中"]}):e.jsxs("span",{className:"text-red-400 text-sm flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-red-400 rounded-full"}),"已暂停"]})]}),S&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"下次刷新:"}),e.jsxs("span",{className:"text-amber-300 text-sm",children:["⏳ ",S.text]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-stone-800/50 rounded-lg space-y-2",children:[e.jsxs("p",{className:"text-gray-300 text-sm",children:["📜 当前生效礼仪: ",e.jsx("span",{className:"text-pink-300 font-bold",children:A.totalActive})," 条"]}),e.jsxs("p",{className:"text-gray-400 text-xs",children:["• 语言铁律: ",A.languageCount," 条"]}),e.jsxs("p",{className:"text-gray-400 text-xs",children:["• 行为着装铁律: ",A.behaviorCount," 条"]})]}),e.jsx("div",{className:"mt-3 sm:mt-4 space-y-2",children:e.jsxs("button",{onClick:z,disabled:!r.designer||k,className:`w-full px-3 py-2 rounded-lg text-sm font-semibold transition-all duration-200 flex items-center justify-center gap-2 ${r.designer&&!k?"bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 text-white":"bg-stone-700/50 text-gray-500 cursor-not-allowed"}`,children:[e.jsx("i",{className:`fa-solid ${k?"fa-spinner fa-spin":"fa-rotate"}`}),k?"生成中...":"立即刷新所有礼仪"]})})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden w-full",children:[e.jsx("div",{className:"flex-shrink-0 p-2 sm:p-4 border-b border-stone-700/50 bg-black/10",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex gap-1 sm:gap-2 flex-wrap w-full sm:w-auto overflow-x-auto scrollbar-hide",children:[e.jsx("button",{onClick:()=>h("theme"),className:`px-2 py-1.5 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap min-h-[44px] sm:min-h-0 ${f==="theme"?"bg-cyan-500/20 text-cyan-300 border border-cyan-500/50":"bg-stone-700/30 text-gray-400 hover:text-gray-300 border border-transparent"}`,children:"🎭 主题"}),e.jsx("button",{onClick:()=>h("workbench"),className:`px-2 py-1.5 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap min-h-[44px] sm:min-h-0 ${f==="workbench"?"bg-purple-500/20 text-purple-300 border border-purple-500/50":"bg-stone-700/30 text-gray-400 hover:text-gray-300 border border-transparent"}`,children:"📋 工作"}),e.jsx("button",{onClick:()=>h("language"),className:`px-2 py-1.5 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap min-h-[44px] sm:min-h-0 ${f==="language"?"bg-pink-500/20 text-pink-300 border border-pink-500/50":"bg-stone-700/30 text-gray-400 hover:text-gray-300 border border-transparent"}`,children:"💬 语言"}),e.jsx("button",{onClick:()=>h("behavior_dress"),className:`px-2 py-1.5 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap min-h-[44px] sm:min-h-0 ${f==="behavior_dress"?"bg-amber-500/20 text-amber-300 border border-amber-500/50":"bg-stone-700/30 text-gray-400 hover:text-gray-300 border border-transparent"}`,children:"👗 着装"})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 w-full sm:w-auto",children:[e.jsx("span",{className:"text-gray-400 text-xs sm:text-sm whitespace-nowrap",children:"场景:"}),e.jsxs("select",{value:p,onChange:G=>b(G.target.value),className:"flex-1 sm:flex-none px-2 py-1.5 sm:px-3 bg-stone-700/50 border border-stone-600 rounded-lg text-gray-300 text-xs sm:text-sm focus:outline-none focus:border-pink-500/50 min-h-[44px] sm:min-h-0",children:[e.jsx("option",{value:"all",children:"全部"}),Object.entries(aa).map(([G,H])=>e.jsx("option",{value:G,children:H},G))]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 sm:p-4 space-y-3 sm:space-y-4 scrollbar-xianxia",children:[f==="theme"?e.jsx(Zg,{currentTheme:r.currentTheme,allThemes:r.weeklyThemes,onCreateTheme:M,onActivateTheme:R,onDeleteTheme:Q}):f==="workbench"?e.jsx(Pg,{workbench:r.designerWorkbench,designer:C,availableThemes:r.weeklyThemes.filter(G=>G.status==="upcoming"),onUpdateWorkbench:G=>o({...r,designerWorkbench:G}),onCreateWorkItem:Z}):f==="language"?D.length>0?D.map(G=>e.jsx(Gg,{etiquette:G,isExpanded:N===G.id,onToggleExpand:()=>j(N===G.id?null:G.id),onDeprecate:()=>L(G.id,"language"),onDistribute:()=>T(G.id,"language"),onRecall:()=>P(G.id,"language")},G.id)):e.jsx(df,{type:"language"}):E.length>0?E.map(G=>e.jsx(Vg,{etiquette:G,isExpanded:N===G.id,onToggleExpand:()=>j(N===G.id?null:G.id),onDeprecate:()=>L(G.id,"behavior_dress"),onDistribute:()=>T(G.id,"behavior_dress"),onRecall:()=>P(G.id,"behavior_dress")},G.id)):e.jsx(df,{type:"behavior_dress"}),e.jsxs("button",{className:"w-full p-3 sm:p-4 border-2 border-dashed border-stone-600 hover:border-pink-500/50 rounded-lg text-gray-400 hover:text-pink-300 transition-colors flex items-center justify-center gap-2 min-h-[44px] text-xs sm:text-sm",children:[e.jsx("i",{className:"fa-solid fa-plus"}),f==="language"?"添加语言铁律":"添加行为着装铁律"]})]})]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-pink-400 to-transparent"})]})}),e.jsx(qg,{isOpen:g,onClose:()=>w(!1),settings:r.settings,onSave:G=>{o({...r,settings:G}),w(!1)}})]}):null},Yg=({isOpen:n,onToggle:a,subButtons:r=[]})=>{const o=(c,d)=>{const p=(90+180/(d-1)*c)*Math.PI/180;return{x:Math.cos(p)*80,y:Math.sin(p)*80}};return e.jsxs("div",{className:"fixed bottom-24 right-10 z-[100] pointer-events-none",children:[n&&r.map((c,d)=>{const m=o(d,r.length),f=d*50;return e.jsxs("button",{onClick:h=>{h.stopPropagation(),c.onClick()},className:"absolute pointer-events-auto animate-fade-in",style:{right:`${-m.x}px`,bottom:`${-m.y}px`,animationDelay:`${f}ms`,animationDuration:"300ms",animationFillMode:"both"},title:c.label,children:[e.jsxs("div",{className:`
                            relative w-11 h-11 rounded-full
                            bg-[#0c0c0c] border-2 ${c.color}
                            shadow-[0_0_20px_currentColor]
                            flex items-center justify-center
                            transition-all duration-300
                            hover:scale-125 hover:shadow-[0_0_30px_currentColor]
                            active:scale-95
                            ring-1 ring-white/5
                            group/sub
                        `,children:[e.jsx("div",{className:"absolute inset-1 rounded-full border border-white/5"}),e.jsx("i",{className:`${c.icon} text-lg relative z-10 transition-transform duration-300 group-hover/sub:scale-110 drop-shadow-[0_0_6px_currentColor]`}),e.jsx("div",{className:"absolute inset-0 rounded-full opacity-30 animate-pulse",style:{backgroundColor:"currentColor"}})]}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-6 text-[10px] text-amber-300 font-bold tracking-wider whitespace-nowrap opacity-0 group-hover/sub:opacity-100 transition-opacity",children:c.label}),e.jsx("div",{className:"absolute top-1/2 left-1/2 h-[1px] bg-gradient-to-r from-amber-500/40 to-transparent pointer-events-none",style:{width:`${Math.sqrt(m.x*m.x+m.y*m.y)}px`,transform:`translate(-50%, -50%) rotate(${Math.atan2(m.y,m.x)*180/Math.PI}deg)`,transformOrigin:"left center"}})]},c.id)}),e.jsxs("div",{className:"pointer-events-auto group relative",children:[e.jsxs("button",{onClick:a,className:`
                        relative w-14 h-14 rounded-full
                        bg-[#0c0c0c] border-2 border-amber-500/40
                        shadow-[0_0_30px_rgba(245,158,11,0.4),inset_0_0_20px_rgba(245,158,11,0.1)]
                        flex items-center justify-center
                        transition-all duration-500 ease-out
                        hover:scale-110 hover:border-amber-400/60
                        hover:shadow-[0_0_40px_rgba(245,158,11,0.6),inset_0_0_30px_rgba(245,158,11,0.2)]
                        active:scale-95
                        ring-1 ring-white/5
                        
                    `,title:n?"收起天机盘":"开启天机盘",children:[e.jsx("div",{className:`
                        absolute inset-0 rounded-full
                        transition-all duration-700 ease-out
                        ${n?"rotate-180 opacity-100":"rotate-0 opacity-60"}
                    `,children:e.jsx("div",{className:"absolute inset-0",children:[0,45,90,135,180,225,270,315].map((c,d)=>e.jsx("div",{className:"absolute top-1/2 left-1/2 w-1 h-3",style:{transform:`translate(-50%, -50%) rotate(${c}deg) translateY(-18px)`},children:e.jsx("div",{className:"w-full h-full bg-gradient-to-t from-amber-500/60 to-transparent rounded-full"})},d))})}),e.jsx("div",{className:`
                        absolute inset-2 rounded-full border border-amber-500/30
                        transition-all duration-1000 ease-out
                        ${n?"-rotate-90":"rotate-0"}
                    `,children:e.jsx("div",{className:"absolute inset-0 rounded-full border border-white/5"})}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-amber-400/10 animate-pulse"}),e.jsx("div",{className:`
                        relative z-10 flex items-center justify-center
                        transition-all duration-500
                        ${n?"rotate-180 scale-110":"rotate-0 scale-100"}
                    `,children:n?e.jsxs("div",{className:"relative w-6 h-6",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-amber-400/80 bg-gradient-to-br from-amber-500/20 to-amber-700/20"}),e.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-[2px] bg-amber-400/60"}),e.jsx("div",{className:"absolute top-0 bottom-0 left-1/2 w-[2px] bg-amber-400/60"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 rounded-full bg-amber-400 shadow-[0_0_8px_rgba(245,158,11,0.8)]"})]}):e.jsx("i",{className:"fa-solid fa-khanda text-xl text-amber-400 drop-shadow-[0_0_8px_rgba(245,158,11,0.8)]"})}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full border border-amber-400/20 animate-spin-slow opacity-50"}),e.jsx("div",{className:"absolute inset-[-8px]",children:[0,90,180,270].map((c,d)=>e.jsx("div",{className:"absolute top-1/2 left-1/2 w-1.5 h-1.5",style:{transform:`translate(-50%, -50%) rotate(${c}deg) translateY(-26px)`},children:e.jsx("div",{className:"w-full h-full rounded-full bg-amber-500/60 shadow-[0_0_4px_rgba(245,158,11,0.8)] animate-pulse"})},d))})]}),!n&&e.jsx("div",{className:"absolute right-20 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none",children:e.jsx("div",{className:"bg-black/90 text-amber-300 text-xs px-3 py-2 rounded-lg whitespace-nowrap border border-amber-500/40 shadow-lg backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-star-half-stroke text-amber-400"}),e.jsx("span",{className:"font-bold tracking-wider",children:"天机盘"})]})})}),e.jsx("div",{className:`
                    absolute -bottom-8 left-1/2 -translate-x-1/2
                    text-[10px] text-amber-400/80 font-bold tracking-widest whitespace-nowrap
                    transition-all duration-500
                    ${n?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}
                `,children:"天机盘"})]})]})},Kd=(n,a)=>a.some(r=>n instanceof r);let uf,mf;function Jg(){return uf||(uf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Fg(){return mf||(mf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wd=new WeakMap,Hd=new WeakMap,_i=new WeakMap;function Xg(n){const a=new Promise((r,o)=>{const c=()=>{n.removeEventListener("success",d),n.removeEventListener("error",m)},d=()=>{r(Ia(n.result)),c()},m=()=>{o(n.error),c()};n.addEventListener("success",d),n.addEventListener("error",m)});return _i.set(a,n),a}function Kg(n){if(Wd.has(n))return;const a=new Promise((r,o)=>{const c=()=>{n.removeEventListener("complete",d),n.removeEventListener("error",m),n.removeEventListener("abort",m)},d=()=>{r(),c()},m=()=>{o(n.error||new DOMException("AbortError","AbortError")),c()};n.addEventListener("complete",d),n.addEventListener("error",m),n.addEventListener("abort",m)});Wd.set(n,a)}let eu={get(n,a,r){if(n instanceof IDBTransaction){if(a==="done")return Wd.get(n);if(a==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ia(n[a])},set(n,a,r){return n[a]=r,!0},has(n,a){return n instanceof IDBTransaction&&(a==="done"||a==="store")?!0:a in n}};function jh(n){eu=n(eu)}function Wg(n){return Fg().includes(n)?function(...a){return n.apply(tu(this),a),Ia(this.request)}:function(...a){return Ia(n.apply(tu(this),a))}}function ey(n){return typeof n=="function"?Wg(n):(n instanceof IDBTransaction&&Kg(n),Kd(n,Jg())?new Proxy(n,eu):n)}function Ia(n){if(n instanceof IDBRequest)return Xg(n);if(Hd.has(n))return Hd.get(n);const a=ey(n);return a!==n&&(Hd.set(n,a),_i.set(a,n)),a}const tu=n=>_i.get(n);function ty(n,a,{blocked:r,upgrade:o,blocking:c,terminated:d}={}){const m=indexedDB.open(n,a),f=Ia(m);return o&&m.addEventListener("upgradeneeded",h=>{o(Ia(m.result),h.oldVersion,h.newVersion,Ia(m.transaction),h)}),r&&m.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),f.then(h=>{d&&h.addEventListener("close",()=>d()),c&&h.addEventListener("versionchange",p=>c(p.oldVersion,p.newVersion,p))}).catch(()=>{}),f}const sy=["get","getKey","getAll","getAllKeys","count"],ny=["put","add","delete","clear"],Pd=new Map;function xf(n,a){if(!(n instanceof IDBDatabase&&!(a in n)&&typeof a=="string"))return;if(Pd.get(a))return Pd.get(a);const r=a.replace(/FromIndex$/,""),o=a!==r,c=ny.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!(c||sy.includes(r)))return;const d=async function(m,...f){const h=this.transaction(m,c?"readwrite":"readonly");let p=h.store;return o&&(p=p.index(f.shift())),(await Promise.all([p[r](...f),c&&h.done]))[0]};return Pd.set(a,d),d}jh(n=>({...n,get:(a,r,o)=>xf(a,r)||n.get(a,r,o),has:(a,r)=>!!xf(a,r)||n.has(a,r)}));const ay=["continue","continuePrimaryKey","advance"],ff={},su=new WeakMap,Nh=new WeakMap,ry={get(n,a){if(!ay.includes(a))return n[a];let r=ff[a];return r||(r=ff[a]=function(...o){su.set(this,Nh.get(this)[a](...o))}),r}};async function*ly(...n){let a=this;if(a instanceof IDBCursor||(a=await a.openCursor(...n)),!a)return;a=a;const r=new Proxy(a,ry);for(Nh.set(r,a),_i.set(r,tu(a));a;)yield r,a=await(su.get(r)||a.continue()),su.delete(r)}function hf(n,a){return a===Symbol.asyncIterator&&Kd(n,[IDBIndex,IDBObjectStore,IDBCursor])||a==="iterate"&&Kd(n,[IDBIndex,IDBObjectStore])}jh(n=>({...n,get(a,r,o){return hf(a,r)?ly:n.get(a,r,o)},has(a,r){return hf(a,r)||n.has(a,r)}}));function wh(){return{monthlySchedule:1,registrationDuration:24,enableAutoGeneration:!0,preparationDuration:6}}function oy(){return{participations:0,wins:0,bestRank:0,totalScore:0,averageRank:0}}function iy(){return{currentEvent:null,eventHistory:[],totalEditions:0,nextEventDate:cy(),playerStats:oy(),config:wh()}}function cy(n){const a=n||wh(),r=new Date,o=r.getFullYear(),c=r.getMonth();let d=new Date(o,c,a.monthlySchedule);return d.getTime()<r.getTime()&&(d=new Date(o,c+1,a.monthlySchedule)),d.getTime()}function dy(n,a){const r=[32,16,8,4,2,1];return n>0&&n<=r.length?r[n-1]:a}function Kl(n=""){const a=Date.now(),r=Math.random().toString(36).substring(2,9);return n?`${n}_${a}_${r}`:`${a}_${r}`}function kh(){return Kl("contestant")}function uy(){return Kl("judge")}function my(n){return Kl(`challenge_r${n}`)}function xy(n){return Kl(`event_${n}`)}const qr=2,$i={id:"s1",name:"青玉剑诀",rarity:"良品",description:"青蛇宗入门剑法，讲究快、准、狠，直指敌人要害。",eroticDescription:"使用者将灵气灌注于剑身，剑刃变得滚烫并发出微光。他不会攻击致命部位，而是以一个下流至极的角度，用滚烫的剑身精准地划开敌人的衣带，或直接烙在对方的敏感肌肤上，留下屈辱的印记。",mechanicsDescription:"造成115%攻击力的物理伤害。",cost:15,genderLock:"Male"},Sh={id:"s2",name:"岩山盾",rarity:"优品",description:"凝聚大地精华，化为坚不可摧的护盾。",eroticDescription:"使用者双腿大开，阳刚的灵力贯入大地。一面粗糙的石盾拔地而起，护在身前。石盾表面并非光滑，而是布满了大小不一、形似男性阳具的狰狞凸起，任何攻击都会被这些“石根”顶回去，充满了挑衅与羞辱的意味。",mechanicsDescription:"提升自身30%防御力，持续3回合。",cost:20,genderLock:"Male"},mu={id:"s3",name:"凤火术",rarity:"良品",description:"操控如凤凰般华丽的火焰，焚烧敌人。",eroticDescription:"使用者媚眼如丝，扭动腰肢，双腿之间竟喷射出一股灼热的粉红色火焰。这火焰不仅烧灼敌人的肉体，更散发出浓郁的催情香气，让敌人在痛苦与欲望的双重折磨中意志崩溃。",mechanicsDescription:"造成105%攻击力的火焰伤害，并施加[灼烧]效果（每回合损失5%最大生命值），持续2回合。",cost:18,genderLock:"Female"},Ch={id:"s4",name:"九尾幻术",rarity:"优品",description:"九尾狐一族的血脉天赋，能制造足以乱真的淫靡幻境。",eroticDescription:"使用者身后九条毛茸茸的狐尾如灵蛇般伸出，不由分说地将敌人紧紧缠绕。狐尾的尖端精准地找到并搔刮着对方最敏感的部位，同时释放出强烈的幻术灵力，使其瞬间堕入被无数触手和巨根轮番侵犯的淫乱幻觉之中，彻底丧失战意。",mechanicsDescription:"有60%几率使敌人[混乱]（无法行动），持续1回合。",cost:25,genderLock:"Female"},fy={id:"us1",name:"灵气回复",rarity:"凡品",description:"恢复少量真元。",eroticDescription:"使用者开始娇喘，通过模拟性高潮的方式快速聚集周围的灵气，补充自身。",mechanicsDescription:"恢复25点真元。",cost:0,genderLock:"Universal"},_h={id:"us2",name:"基础拳法",rarity:"凡品",description:"造成少量物理伤害。",eroticDescription:"看似普通的拳法，但每一拳都精准地打向敌人的下体，试图造成最直接的痛苦和羞辱。",mechanicsDescription:"造成100%攻击力的物理伤害。",cost:10,genderLock:"Universal"},hy={id:"us3",name:"天雷击",rarity:"珍品",description:"引动九天神雷，对敌人造成巨大伤害。",eroticDescription:"使用者高举双手，召唤一道粗大的紫色闪电，闪电如一条巨龙般从天而降，精准地贯穿敌人的身体，使其浑身抽搐，口吐白沫。",mechanicsDescription:"造成220%攻击力的雷电伤害，但自身[虚弱]（攻击力降低20%），持续2回合。",cost:45,genderLock:"Male"},py={id:"us4",name:"凤凰涅槃",rarity:"绝品",description:"濒死时有几率浴火重生。",eroticDescription:"在死亡的瞬间，使用者全身衣物被火焰烧尽，赤裸的身体在烈火中重塑，发出诱人的呻吟，以更完美、更淫荡的姿态重生。",mechanicsDescription:"气血低于15%时，有35%几率恢复60%最大气血。一场战斗只能触发一次。",cost:100,genderLock:"Female"};const $h={id:"e1",name:"破瓜之刃",type:"Weapon",rarity:"凡品",description:"一把粗糙的铁剑，剑柄被设计成阳具的形状，据说能轻易划破处女的衣物。",stats:{attack:5}},Eh={id:"e2",name:"开裆学徒袍",type:"Armor",rarity:"凡品",description:"一件普通的学徒袍，但裆部被故意剪开，方便随时随地进行“修炼”。",stats:{hp:15,defense:3}},Ah={id:"e3",name:"催情淫纹",type:"Accessory",rarity:"良品",description:"一道刻在小腹上的淫纹，能让佩戴者在战斗中感到持续的性快感，从而身法更“灵活”。",stats:{speed:8}},by={id:"e4",name:"乳钉龟甲",type:"Armor",rarity:"珍品",description:"仅能遮住胸前两点的龟甲胸罩，上面穿有乳环，每次受到攻击都会拉扯乳头，带来痛并快乐的刺激。",stats:{hp:80,defense:35}},gy={id:"e5",name:"淫魔的项圈",type:"Accessory",rarity:"优品",description:"一个刻有堕落符文的项圈，戴上它的人会不自觉地散发出邀请交媾的骚媚气息。",stats:{critRate:.08,critDmg:.15}},yy={id:"e6",name:"贯穿神女之枪",type:"Weapon",rarity:"仙品",description:"传说中曾让仙界圣女高潮迭起的长枪，枪头刻满了能刺激G点的咒文。",stats:{attack:80,critRate:.1}},vy={id:"e7",name:"绝对露出圣铠",type:"Armor",rarity:"圣品",description:"一套看似华丽的铠甲，但其设计巧妙，无论从哪个角度看，都会不经意地露出穿戴者的私密部位。",stats:{hp:200,defense:50,speed:-10}},jy={id:"e8",name:"触手软鞭",type:"Weapon",rarity:"良品",description:"如章鱼触手般柔软而灵活的鞭子，鞭身上布满吸盘，能缠住敌人并带来异样的快感。",stats:{attack:8,speed:4}},Ny={id:"e9",name:"全透明霓裳",type:"Armor",rarity:"优品",description:"一件完全透明的仙衣，唯一的遮挡是在私处绣了一朵若隐若现的莲花，引人遐想。",stats:{hp:40,defense:12,speed:3}},wy={id:"e10",name:"自慰月华簪",type:"Accessory",rarity:"珍品",description:"一根能根据主人意念震动的发簪，既是饰品，也是方便的自慰工具，佩戴者可随时享受快感。",stats:{critRate:.03,speed:10}},Th=[$h,Eh,Ah,by,gy,yy,vy,jy,Ny,wy],Yl={p_brothel_star:{name:"头牌花魁",shop:"青楼",requiredAttr:"charm"},p_brothel_tutor:{name:"双修导师",shop:"青楼",requiredAttr:"skillfulness"},p_brothel_guard:{name:"护卫",shop:"青楼",requiredAttr:"defense"},p_arena_gladiator:{name:"明星角斗士",shop:"角斗场",requiredAttr:"attack"},p_arena_host:{name:"主持人",shop:"角斗场",requiredAttr:"charm"},p_arena_trader:{name:"奴隶商人",shop:"角斗场",requiredAttr:"skillfulness"},p_alchemy_chief:{name:"首席炼丹师",shop:"炼丹房",requiredAttr:"perception"},p_alchemy_apprentice:{name:"药童",shop:"炼丹房",requiredAttr:"speed"},p_auction_master:{name:"首席拍卖师",shop:"拍卖行",requiredAttr:"charm"},p_auction_appraiser:{name:"鉴宝师",shop:"拍卖行",requiredAttr:"perception"},p_intel_chief:{name:"情报头子",shop:"情报阁",requiredAttr:"perception"},p_intel_assassin:{name:"暗杀者",shop:"情报阁",requiredAttr:"attack"}},vi={id:"c1",name:"夜宸",gender:"Male",realm:"筑基期",rarity:"珍品",title:"暗影中的低语者",race:"魔族",origin:"来自魔界与人界交汇的阴影之地，是梦魇与人类的混血。他加入宗门的目的无人知晓，只为寻找能满足他特殊“食欲”的灵魂。",appearance:"他总是穿着一件能遮蔽身形的黑色斗篷，兜帽下只能看到一双闪烁着紫色幽光的眼睛和苍白的嘴唇。当他施法时，斗篷下会伸出数条由纯粹暗影构成的触手，这些触手表面光滑湿润，顶端带有能吸食他人精神能量的吸盘。",charm:88,skillfulness:70,perception:80,baseAttributes:{hp:110,maxHp:110,mp:60,maxMp:60,attack:20,defense:10,speed:16,critRate:.12,critDmg:1.6},skills:[{id:"s5",name:"暗影触手",rarity:"良品",description:"从阴影中召唤触手束缚敌人。",eroticDescription:"数条冰冷滑腻的暗影触手从地面钻出，无视所有护甲，直接缠绕上敌人的四肢和腰腹，并强行钻入其衣物内，在其最敏感的部位游走、抚弄，使其因强烈的快感和恐惧而无法动弹。",mechanicsDescription:"对单个敌人造成80%攻击力的暗影伤害，并有70%几率使其【束缚】（无法行动），持续1回合。",cost:20,genderLock:"Male"},{id:"s6",name:"精神侵蚀",rarity:"优品",description:"用魔音侵蚀敌人的心智。",eroticDescription:"夜宸发出只有目标能听到的、充满魅惑的魔音低语。这声音会直接在敌人脑海中响起，不断放大其内心最深处的淫欲，让其产生被无数人轮番侵犯的幻觉，最终精神崩溃，任人宰割。",mechanicsDescription:"对单个敌人造成精神冲击，使其【混乱】（无法行动）并【易伤】（受到的伤害增加20%），持续2回合。",cost:35,genderLock:"Male"},null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},xu={id:"c2",name:"灵月",gender:"Female",realm:"筑基期",rarity:"珍品",title:"天生媚骨骚货",race:"妖族",origin:"九尾天狐的后裔，为寻求突破血脉的桎梏而加入了修仙宗门。",appearance:"她从不穿乳罩和内裤，仅仅套着一件薄如蝉翼的纱裙。一对硕大的乳房随着她的走动剧烈地晃动，深色的乳头清晰可见。裙下光洁一片，饱满的阴唇轮廓分明。她天生淫荡，体内媚药过剩，导致私处时刻湿润，甚至会在走路时留下淡淡的骚味痕迹。",charm:95,skillfulness:80,perception:60,baseAttributes:{hp:100,maxHp:100,mp:70,maxMp:70,attack:15,defense:10,speed:18,critRate:.15,critDmg:1.6},skills:[mu,Ch,null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},ky={id:"c3",name:"石毅",gender:"Male",realm:"金丹期",rarity:"优品",title:"不动山王",race:"人族",origin:"天生神力，以炼体为主，肉身坚不可摧。",charm:30,skillfulness:40,perception:45,baseAttributes:{hp:180,maxHp:180,mp:40,maxMp:40,attack:14,defense:25,speed:10,critRate:.05,critDmg:1.5},skills:[Sh,$i,null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},Sy={id:"c4",name:"苏媚",gender:"Female",realm:"筑基期",rarity:"优品",title:"百花仙子",race:"人族",origin:"精通治疗与辅助法术，是队伍中可靠的后盾。",charm:85,skillfulness:70,perception:65,baseAttributes:{hp:95,maxHp:95,mp:80,maxMp:80,attack:12,defense:14,speed:16,critRate:.08,critDmg:1.5},skills:[Ch,mu,null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},Cy={id:"c5",name:"龙傲天",gender:"Male",realm:"元婴期",rarity:"仙品",title:"天命之子",race:"神族",origin:"上古神族后裔，血脉中蕴含着毁天灭地的力量。",charm:80,skillfulness:85,perception:90,baseAttributes:{hp:250,maxHp:250,mp:120,maxMp:120,attack:40,defense:25,speed:22,critRate:.2,critDmg:2},skills:[$i,mu,null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},_y={id:"c6",name:"张三",gender:"Male",realm:"炼气期",rarity:"凡品",title:"外门弟子",race:"人族",origin:"普通的宗门外门弟子。",charm:40,skillfulness:30,perception:35,baseAttributes:{hp:80,maxHp:80,mp:40,maxMp:40,attack:10,defense:8,speed:12,critRate:.05,critDmg:1.5},skills:[$i,_h,null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},$y={id:"c7",name:"九天玄女",gender:"Female",realm:"化神期",rarity:"神品",title:"天道化身",race:"神族",origin:"自天地初开时诞生的先天神灵，掌管着天道法则，威严而又神秘。",charm:99,skillfulness:99,perception:99,baseAttributes:{hp:400,maxHp:400,mp:250,maxMp:250,attack:60,defense:40,speed:30,critRate:.3,critDmg:2.5},skills:[hy,py,null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},Ss=[vi,xu,ky,Sy,Cy,_y,$y];const Ey={id:"pet2",name:"霸天虎",gender:"Male",rarity:"珍品",description:"拥有上古白虎血脉的灵兽，性格霸道，破坏力惊人。",skill:{id:"ps2",name:"虎啸山林",rarity:"珍品",description:"发出一声震慑心魄的虎啸。",eroticDescription:"雄浑的虎啸声中夹杂着低沉的喘息，能唤起周围生物最原始的交配欲望，使其臣服于霸天虎的雄威之下。",mechanicsDescription:"战斗开始时，有30%几率使敌方全体【恐惧】（攻击力降低15%），持续2回合。",cost:0,genderLock:"Universal"}},Ay={id:"pet3",name:"幻梦蝶",gender:"Female",rarity:"珍品",description:"翅膀上带有迷幻花纹的灵蝶，能编织出以假乱真的幻境。",skill:{id:"ps3",name:"蝶恋花",rarity:"珍品",description:"散播能引人入梦的花粉。",eroticDescription:"煽动翅膀，洒下闪着春光的催情花粉，闻到花粉的生物会立刻陷入最淫靡的春梦之中，任人摆布。",mechanicsDescription:"探索时，有15%的几率使你避开一次负面事件。",cost:0,genderLock:"Universal"}},Oa={凡品:10,良品:50,优品:150,珍品:500,绝品:1500,仙品:5e3,圣品:15e3,神品:5e4},Ty={tier:"黄铜",division:"III",points:1250,tierIcon:"🥉"},pf=(n,a)=>Math.floor(Math.random()*(a-n+1))+n,Kn=(n,a)=>{const r=[],o=new Set;for(;r.length<a&&o.size<n.length;){const c=n[pf(0,n.length-1)];if(!o.has(c.id)){const d=pf(1e3,6e3);r.push({rank:0,name:c.name,faction:"青蛇宗",points:d,characterId:c.id}),o.add(c.id)}}return r.sort((c,d)=>d.points-c.points).map((c,d)=>({...c,rank:d+1}))},My={宗门排行榜:{总榜:Kn(Ss,20),核心弟子:Kn(Ss.filter(n=>["仙品","圣品","神品"].includes(n.rarity)),20),内门弟子:Kn(Ss.filter(n=>["珍品","绝品"].includes(n.rarity)),20),外门弟子:Kn(Ss.filter(n=>["优品","良品"].includes(n.rarity)),20),杂役弟子:Kn(Ss.filter(n=>n.rarity==="凡品"),20)},野榜:Kn(Ss,20),区域榜:Kn(Ss,20),世界榜:Kn(Ss,20)},zy={id:"prisoner-char-01",name:"血影魔君",gender:"Male",realm:"元婴期",rarity:"绝品",title:"血煞魔头",race:"魔族",origin:"血煞门叛徒，因屠杀无辜村民被捕",appearance:"一身黑衣，双目血红，周身缠绕着淡淡的血煞之气",charm:45,skillfulness:75,perception:60,baseAttributes:{hp:280,maxHp:280,mp:120,maxMp:120,attack:45,defense:28,speed:22,critRate:.18,critDmg:1.8},skills:[$i,Sh,null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},Dy={character:zy,crime:"屠杀无辜村民，吸取血气修炼魔功",sentence:100,remainingDays:100,submissionLevel:20,loyaltyLevel:5,health:85,sanity:90,location:"居住区",cellType:"单独囚室",value:{ransom:5e4,labor:3e3,intelligence:8e3},status:["健康"],history:[],knownInformation:[],potentialInformation:["血煞门总坛位置","魔功修炼秘法","其他魔道同伙"],imprisonedDate:"第一天",realImprisonedTime:Date.now()},Oy={mode:"exploration",exploration:{story:"在这个充满欲望与力量的修仙世界，实力并非唯一的主宰，潜藏在灵气之下的原始本能同样搅动着风云。你，一个身怀异禀的新进弟子，踏入了以双修和媚术闻名的青蛇宗。在这里，强大的修士们不仅追求通天修为，更沉溺于极致的肉体欢愉。宗门之内，师兄师姐们的关系错综复杂，每一次“切磋”都可能是一场香汗淋漓的征服。你将如何在这条充满诱惑与危险的道路上立足？是成为他人胯下的玩物，还是将所有人都变成你自己的禁脔？你的淫乱仙途，现在开始。",location:"青蛇宗山门",time:"第一天，清晨",choices:["向守门弟子介绍自己。","寻找登记处。","探索外门庭院。"],pendingChallenge:null},playerProfile:{name:"天选者",title:"新进弟子",relationships:[{id:"c2",name:"灵月",avatar:"path/to/lingyue-avatar.png",relationshipStatus:"熟人",relationshipTags:["同门","初识"],favorability:10,description:"在宗门初识，似乎对你有些好奇。"},{id:"c1",name:"风逸",avatar:"path/to/fengyi-avatar.png",relationshipStatus:"熟人",relationshipTags:["师兄","剑修"],favorability:25,description:"一位冷峻的师兄，剑法高超。"},{id:"c3",name:"石毅",avatar:"path/to/shiyi-avatar.png",relationshipStatus:"陌生人",relationshipTags:["炼体修士"],favorability:0,description:"一个看起来很强壮的修士，但你们还没说过话。"}],spiritStones:1e3,maleParty:[vi],femaleParty:[],cardCollection:[vi,xu],equipmentInventory:[$h,Eh,Ah],petCollection:[Ey,Ay],universalSkills:[fy,_h],arenaRank:Ty,reputation:{score:0,level:"默默无闻",dynamicTitles:[],greatestDeeds:[],title:"",goodDeeds:[],badDeeds:[],lewdDeeds:[],history:[]},quests:[{id:"main_01",title:"【主线】初入山门",description:"你站在青蛇宗的山门前，一位心怀壮志的新进弟子。首先，你需要向宗门报到。",category:"Main",status:"In Progress",objectives:[{id:"obj1",description:"与守门弟子交谈",isCompleted:!1,targetCount:1,currentCount:0},{id:"obj2",description:"在外门登记处完成登记",isCompleted:!1,targetCount:1,currentCount:0}],rewards:{spiritStones:50,reputation:10}}],businessDistrict:null},leaderboards:My,announcements:{sect:[],adventure:[],world:[]},hospitalPatients:[],bountyBoard:[],cultivationPavilion:[{slotId:1,parentA:null,parentB:null,startTime:0,endTime:0,status:"Empty",monitoringLog:[]},{slotId:2,parentA:null,parentB:null,startTime:0,endTime:0,status:"Empty",monitoringLog:[]},{slotId:3,parentA:null,parentB:null,startTime:0,endTime:0,status:"Empty",monitoringLog:[]}],prisonSystem:{prisoners:[Dy],guards:[],facilities:[],laborSites:[{id:"mine-01",type:"矿山",name:"青蛇矿脉",description:"宗门后山的灵石矿脉",maxWorkers:2,workers:[]},{id:"herb-01",type:"采药",name:"灵药园",description:"宗门的药材种植园",maxWorkers:2,workers:[]}],materialInventory:[],laborTasks:[],laborRecords:[],events:[],ransomOffers:[],stats:{totalPrisoners:0,byArea:{居住区:0,审讯区:0,娱乐区:0,劳役区:0,管理区:0,医疗区:0},byCellType:{普通牢房:0,重犯牢房:0,单独囚室:0},avgSubmission:0,avgLoyalty:0,avgHealth:0,totalGuards:5,escapeAttempts:0,successfulEscapes:0,totalRevenue:0,totalExpenses:0,netProfit:0},config:{maxPrisoners:50,dailyFoodCost:10,securityLevel:5,enableAutoInterrogation:!1,enableAutoLabor:!1}},memories:{探索:[],战斗:[],商城:[],医馆:[],悬赏:[],培育:[],商业:[],声望:[],公告:[],大牢:[],其他:[]},memorySummaries:{探索:{small:[],large:[]},战斗:{small:[],large:[]},商城:{small:[],large:[]},医馆:{small:[],large:[]},悬赏:{small:[],large:[]},培育:{small:[],large:[]},商业:{small:[],large:[]},声望:{small:[],large:[]},公告:{small:[],large:[]},大牢:{small:[],large:[]},其他:{small:[],large:[]}},summarySettings:{autoSummaryEnabled:!0,smallSummaryInterval:10,largeSummaryInterval:5,summaryPrompts:{small:"你是一个记忆总结助手。请根据以下【{category}】分类的记忆片段，生成一个简洁、连贯、大约100-200字的小总结。总结应提炼关键事件、人物和结果，并以第三人称叙述。请直接输出总结内容，不要包含任何额外的前缀或标题。",large:"你是一个高级记忆分析师。请根据以下多个关于【{category}】的小总结，生成一个全面、深刻、大约200-400字的大总结。这个总结应该识别核心主题、长期影响和人物关系变化，并以宏观视角进行叙述。请直接输出总结内容，不要包含任何额外的前缀或标题。"}},vectorConfig:uu,etiquetteSystem:Ig,gauntletSystem:iy()},bf={patientId:"patient-example-01",name:"林婉儿",gender:"Female",age:19,background:"正道宗门“碧霞宫”的圣女，因偷练禁术而走火入魔，身体产生了奇特的异变。",genitalShape:"玉净瓶型蜜穴",sexualFeatures:["圣女体质","超敏感","被触碰会不自觉流出爱液"],illnessDescription:"所患奇症为“灵欲倒错”。每日正午，体内纯净的灵力会转化为高浓度的淫欲之气，若不与人交合疏导，便会遭受万蚁噬心般的痛苦，同时身体会散发出能令周围所有生物发情的异香。"},Ry={name:"九转淫魔",character:{id:"bounty-char-example-01",name:"九转淫魔",gender:"Male",realm:"元婴期",rarity:"绝品",title:"行走的播种机器",race:"魔族",origin:"上古淫魔的一缕分魂转世，以吸食女性修士的元阴为修炼法门，实力极强，极度危险。",appearance:"外表是俊美妖异的青年，但当他兴奋时，额头会长出魔角，胯下巨物会膨胀到恐怖的尺寸，上面布满了能吸取元阴的倒刺。",charm:92,skillfulness:88,perception:70,baseAttributes:{hp:350,maxHp:350,mp:150,maxMp:150,attack:55,defense:30,speed:25,critRate:.25,critDmg:2.2},skills:[{id:"bs1",name:"魔龙探穴",rarity:"绝品",description:"释放出充满魔气的触手攻击敌人。",eroticDescription:"胯下巨物化为数条灵活的魔气触手，强行钻入敌人的所有孔穴进行蹂躏，吸取其元阴。",mechanicsDescription:"造成180%攻击力的暗影伤害，并恢复造成伤害30%的气血。",cost:40,genderLock:"Male"},{id:"bs2",name:"淫魔领域",rarity:"绝品",description:"展开领域，削弱敌人。",eroticDescription:"释放出充满粉色瘴气的领域，领域内的敌人会持续陷入性兴奋状态，双腿发软，战意全无。",mechanicsDescription:"敌方全体攻击力与防御力降低20%，持续3回合。",cost:60,genderLock:"Male"},null,null],equipment:{weapon:null,armor:null,accessory1:null,accessory2:null},pet:null},specialTrait:"只对处女或元阴未泄的女性修士感兴趣，在与她们战斗时会变得异常强大。",locationHint:"似乎在【合欢宗】附近的山脉中寻找新的猎物。",trackerId:null,startTime:0,endTime:0,trackingLog:null,finalOutcome:null},Iy={2:n=>{var a,r,o,c;if(console.log("迁移记忆系统分类..."),n.memories){const d={探索:n.memories.探索||[],战斗:n.memories.战斗||[],商城:[],医馆:n.memories.问诊||[],悬赏:n.memories.悬赏||[],培育:n.memories.培育||[],商业:n.memories.商业||[],声望:[],公告:[],其他:[...n.memories.交互||[],...n.memories.其他||[]]};n.memories=d}if(n.memorySummaries){const d={探索:n.memorySummaries.探索||{small:[],large:[]},战斗:n.memorySummaries.战斗||{small:[],large:[]},商城:{small:[],large:[]},医馆:n.memorySummaries.问诊||{small:[],large:[]},悬赏:n.memorySummaries.悬赏||{small:[],large:[]},培育:n.memorySummaries.培育||{small:[],large:[]},商业:n.memorySummaries.商业||{small:[],large:[]},声望:{small:[],large:[]},公告:{small:[],large:[]},其他:{small:[...((a=n.memorySummaries.交互)==null?void 0:a.small)||[],...((r=n.memorySummaries.其他)==null?void 0:r.small)||[]],large:[...((o=n.memorySummaries.交互)==null?void 0:o.large)||[],...((c=n.memorySummaries.其他)==null?void 0:c.large)||[]]}};n.memorySummaries=d}return n}},nu=n=>{let a=n.version||0;if(a===qr)return n;console.log(`Migrating save data from version ${a} to ${qr}...`);let r={...n};for(let o=a+1;o<=qr;o++){const c=Iy[o];c&&(r=c(r),console.log(`- Applied migration for version ${o}`))}return r.version=qr,console.log("Migration complete."),r};class Ly{async saveToSlot(a,r){const o=JSON.parse(JSON.stringify({name:r.name,timestamp:r.timestamp,gameState:{...r.gameState,version:qr}}));try{await window.TavernHelper.updateVariablesWith(c=>(c.xianxiaRpgSaves||(c.xianxiaRpgSaves={}),c.xianxiaRpgSaves[a]=o,c),{type:"character"})}catch(c){throw console.error(`TavernAdapter: 保存到槽位 ${a} 失败:`,c),c}}async loadFromSlot(a){try{const r=window.TavernHelper.getVariables({type:"character"});if(r&&r.xianxiaRpgSaves&&r.xianxiaRpgSaves[a]){const o=r.xianxiaRpgSaves[a];return!o.name||!o.timestamp?nu(o):nu(o.gameState)}return null}catch(r){return console.error(`TavernAdapter: 从槽位 ${a} 加载失败:`,r),null}}async getAllSaves(){try{const a=window.TavernHelper.getVariables({type:"character"}),r=a&&a.xianxiaRpgSaves||{},o={};for(let c=1;c<=5;c++)if(r[c]){const d=r[c];!d.name||!d.timestamp?o[c]={name:`存档 ${c}`,timestamp:Date.now(),gameState:d}:o[c]=d}else o[c]=null;return Promise.resolve(o)}catch(a){return console.error("TavernAdapter: 获取所有存档失败:",a),{}}}async deleteSlot(a){try{await window.TavernHelper.updateVariablesWith(r=>(r.xianxiaRpgSaves&&r.xianxiaRpgSaves[a]&&delete r.xianxiaRpgSaves[a],r),{type:"character"})}catch(r){throw console.error(`TavernAdapter: 删除槽位 ${a} 失败:`,r),r}}}class By{constructor(){this.dbPromise=null,this.saveToSlot=async(a,r)=>{const o=await this.getDb(),c={...r,gameState:{...r.gameState,version:qr}};await o.put("manual_saves",c,a)},this.loadFromSlot=async a=>{const o=await(await this.getDb()).get("manual_saves",a);return o?nu(o.gameState):null},this.getAllSaves=async()=>{const a=await this.getDb(),r={};let o=await a.transaction("manual_saves").store.openCursor();for(;o;)r[o.key]=o.value,o=await o.continue();return r},this.deleteSlot=async a=>{await(await this.getDb()).delete("manual_saves",a)}}getDb(){return this.dbPromise||(this.dbPromise=ty("xianxia-card-rpg-db",1,{upgrade(a){a.objectStoreNames.contains("autosave")&&a.deleteObjectStore("autosave"),a.objectStoreNames.contains("manual_saves")||a.createObjectStore("manual_saves")}})),this.dbPromise}}const Uy=()=>window.TavernHelper?(console.log("Storage Service: Using TavernHelper adapter."),new Ly):(console.log("Storage Service: Using IndexedDB adapter."),new By),Zs=Uy(),Hy=({onStartNewGame:n,onLoadGame:a})=>{const[r,o]=v.useState({}),[c,d]=v.useState(!1),[m,f]=v.useState(!1);v.useEffect(()=>{h()},[]);const h=async()=>{const b=await Zs.getAllSaves();o(b)},p=async b=>{f(!0);try{await a(b)}catch(g){console.error("加载存档失败:",g),alert("加载存档失败，请重试。")}finally{f(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundImage:"url('https://github.com/zzq0219/sillytavern/blob/main/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E4%BA%91%E9%9B%BE-%E4%BB%99%E4%BE%A0.png?raw=true')",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center space-y-8 px-4",children:[e.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[e.jsx("h1",{className:"text-6xl md:text-7xl font-bold text-gradient-gold text-shadow-glow font-serif tracking-wider",children:"仙侠卡牌RPG"}),e.jsx("p",{className:"text-xl md:text-2xl text-amber-200/90 font-serif tracking-widest text-shadow",children:"红尘万丈 · 仙路漫漫"})]}),c?e.jsx("div",{className:"w-full max-w-2xl animate-fade-in",children:e.jsxs("div",{className:"glass-morphism rounded-xl p-6 border border-stone-700/50 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gradient-gold font-serif",children:"选择存档"}),e.jsx("button",{onClick:()=>d(!1),className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-xianxia",children:[1,2,3,4,5].map(b=>{const g=r[b];return g?e.jsx("button",{onClick:()=>p(b),disabled:m,className:`w-full p-4 bg-gradient-to-r from-stone-800/80 to-stone-900/80 rounded-lg\r
                                                     border border-stone-700/50 hover:border-amber-500/50\r
                                                     text-left transition-all duration-300\r
                                                     hover:scale-[1.02] hover:shadow-lg hover:shadow-amber-500/20\r
                                                     disabled:opacity-50 disabled:cursor-not-allowed\r
                                                     group`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("span",{className:"text-amber-400 font-bold font-serif",children:["存档 ",b]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("span",{className:"text-white font-semibold",children:g.name})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("div",{children:[e.jsx("i",{className:"fa-solid fa-user mr-2"}),g.gameState.playerProfile.name]}),e.jsxs("div",{children:[e.jsx("i",{className:"fa-solid fa-location-dot mr-2"}),g.gameState.exploration.location]}),e.jsxs("div",{children:[e.jsx("i",{className:"fa-solid fa-clock mr-2"}),new Date(g.timestamp).toLocaleString("zh-CN")]})]})]}),e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full \r
                                                              bg-amber-500/20 group-hover:bg-amber-500/40 \r
                                                              transition-colors duration-300`,children:e.jsx("i",{className:"fa-solid fa-play text-amber-400"})})]})},b):e.jsxs("div",{className:"p-4 bg-stone-800/50 rounded-lg border border-stone-700/50 text-gray-500 text-center",children:[e.jsx("i",{className:"fa-solid fa-inbox mr-2"}),"存档槽 ",b," - 空"]},b)})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-stone-700/50",children:e.jsxs("button",{onClick:()=>d(!1),className:`w-full px-4 py-2 bg-stone-700/50 hover:bg-stone-700 rounded-lg\r
                                             text-gray-300 hover:text-white transition-all duration-300\r
                                             border border-stone-600/50`,children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-2"}),"返回"]})})]})}):e.jsxs("div",{className:"flex flex-col space-y-4 w-full max-w-md animate-slide-up",children:[e.jsxs("button",{onClick:n,disabled:m,className:`group relative px-8 py-4 bg-gradient-to-r from-amber-600 via-yellow-500 to-amber-600 rounded-lg\r
                                     text-white font-bold text-xl tracking-wider font-serif\r
                                     border-2 border-amber-400/50 shadow-2xl\r
                                     hover:shadow-amber-500/50 hover:scale-105 hover:border-amber-300\r
                                     active:scale-95 transition-all duration-300\r
                                     disabled:opacity-50 disabled:cursor-not-allowed\r
                                     overflow-hidden`,children:[e.jsxs("span",{className:"relative z-10 flex items-center justify-center space-x-2",children:[e.jsx("i",{className:"fa-solid fa-play"}),e.jsx("span",{children:"开始游戏"})]}),e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent \r
                                          translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000`})]}),e.jsxs("button",{onClick:()=>d(!0),disabled:m,className:`group relative px-8 py-4 bg-gradient-to-r from-blue-600 via-cyan-500 to-blue-600 rounded-lg\r
                                     text-white font-bold text-xl tracking-wider font-serif\r
                                     border-2 border-blue-400/50 shadow-2xl\r
                                     hover:shadow-blue-500/50 hover:scale-105 hover:border-blue-300\r
                                     active:scale-95 transition-all duration-300\r
                                     disabled:opacity-50 disabled:cursor-not-allowed\r
                                     overflow-hidden`,children:[e.jsxs("span",{className:"relative z-10 flex items-center justify-center space-x-2",children:[e.jsx("i",{className:"fa-solid fa-folder-open"}),e.jsx("span",{children:"读取存档"})]}),e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent \r
                                          translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000`})]})]}),e.jsx("div",{className:"absolute bottom-4 right-4 text-gray-400/70 text-sm font-mono",children:"v1.0.0"})]}),m&&e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-amber-400 mx-auto mb-4"}),e.jsx("p",{className:"text-amber-200 text-xl font-serif",children:"加载中..."})]})})]})};var xs=(n=>(n.HOME="HOME",n.ADVENTURE="ADVENTURE",n.INVENTORY="INVENTORY",n))(xs||{});const gf=[{id:"threat_violence",type:"威胁",text:"以暴力相威胁",description:"威胁对囚犯施以酷刑，迫使其屈服",icon:"fa-fist-raised",baseEffects:{submissionChange:15,loyaltyChange:-10,healthChange:0,sanityChange:-5,informationChance:30},riskFactors:{escapeAttempt:5,rebellion:15,breakdown:10}},{id:"threat_family",type:"威胁",text:"威胁其亲友",description:"暗示会对其在意的人不利",icon:"fa-users",baseEffects:{submissionChange:25,loyaltyChange:-20,healthChange:0,sanityChange:-10,informationChance:50},riskFactors:{escapeAttempt:10,rebellion:25,breakdown:15}},{id:"threat_execution",type:"威胁",text:"以处决相威胁",description:"声称若不配合将被处死",icon:"fa-skull",baseEffects:{submissionChange:35,loyaltyChange:-30,healthChange:0,sanityChange:-15,informationChance:60},riskFactors:{escapeAttempt:20,rebellion:30,breakdown:25}},{id:"persuade_reason",type:"劝说",text:"晓之以理",description:"用道理说服囚犯配合",icon:"fa-comments",baseEffects:{submissionChange:5,loyaltyChange:10,healthChange:0,sanityChange:5,informationChance:20},riskFactors:{escapeAttempt:0,rebellion:5,breakdown:0}},{id:"persuade_emotion",type:"劝说",text:"动之以情",description:"用情感打动囚犯",icon:"fa-heart",baseEffects:{submissionChange:10,loyaltyChange:15,healthChange:0,sanityChange:10,informationChance:25},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"persuade_future",type:"劝说",text:"许诺未来",description:"承诺若配合将有好的结果",icon:"fa-sun",baseEffects:{submissionChange:15,loyaltyChange:20,healthChange:0,sanityChange:15,informationChance:35},requirements:{minSubmission:30},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"trade_food",type:"交易",text:"以美食交换",description:"提供美味食物换取配合",icon:"fa-utensils",requirements:{spiritStones:10},baseEffects:{submissionChange:5,loyaltyChange:15,healthChange:10,sanityChange:5,informationChance:30},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"trade_comfort",type:"交易",text:"改善待遇",description:"承诺改善关押条件",icon:"fa-bed",requirements:{spiritStones:50},baseEffects:{submissionChange:10,loyaltyChange:25,healthChange:5,sanityChange:10,informationChance:40},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"trade_freedom",type:"交易",text:"以自由交换",description:"承诺若提供情报将释放",icon:"fa-dove",requirements:{minSubmission:50},baseEffects:{submissionChange:20,loyaltyChange:30,healthChange:0,sanityChange:20,informationChance:70},riskFactors:{escapeAttempt:5,rebellion:0,breakdown:0}},{id:"extract_casual",type:"套话",text:"闲聊套话",description:"在闲聊中套取信息",icon:"fa-comment-dots",baseEffects:{submissionChange:0,loyaltyChange:5,healthChange:0,sanityChange:0,informationChance:25},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"extract_trick",type:"套话",text:"设计圈套",description:"用话术诱导囚犯透露信息",icon:"fa-chess",baseEffects:{submissionChange:5,loyaltyChange:-5,healthChange:0,sanityChange:-5,informationChance:45},riskFactors:{escapeAttempt:0,rebellion:10,breakdown:5}},{id:"extract_pretend",type:"套话",text:"假装同情",description:"假装理解和同情来获取信任",icon:"fa-mask",baseEffects:{submissionChange:5,loyaltyChange:10,healthChange:0,sanityChange:5,informationChance:35},riskFactors:{escapeAttempt:0,rebellion:5,breakdown:0}},{id:"chat_past",type:"闲聊",text:"聊聊过去",description:"询问囚犯的过往经历",icon:"fa-clock-rotate-left",baseEffects:{submissionChange:0,loyaltyChange:10,healthChange:0,sanityChange:5,informationChance:15},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:5}},{id:"chat_cultivation",type:"闲聊",text:"谈论修炼",description:"与囚犯交流修炼心得",icon:"fa-yin-yang",baseEffects:{submissionChange:0,loyaltyChange:15,healthChange:0,sanityChange:10,informationChance:20},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"chat_world",type:"闲聊",text:"聊聊外界",description:"告诉囚犯外面世界的消息",icon:"fa-globe",baseEffects:{submissionChange:0,loyaltyChange:5,healthChange:0,sanityChange:-5,informationChance:10},riskFactors:{escapeAttempt:5,rebellion:5,breakdown:10}},{id:"favor_heal",type:"恩惠",text:"治疗伤势",description:"为囚犯治疗伤病",icon:"fa-kit-medical",requirements:{spiritStones:30},baseEffects:{submissionChange:5,loyaltyChange:20,healthChange:30,sanityChange:10,informationChance:20},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"favor_gift",type:"恩惠",text:"赠送礼物",description:"送给囚犯一些小礼物",icon:"fa-gift",requirements:{spiritStones:20},baseEffects:{submissionChange:0,loyaltyChange:15,healthChange:0,sanityChange:10,informationChance:15},riskFactors:{escapeAttempt:0,rebellion:0,breakdown:0}},{id:"favor_visit",type:"恩惠",text:"安排探视",description:"允许囚犯的亲友来探视",icon:"fa-people-arrows",requirements:{minSubmission:40,spiritStones:100},baseEffects:{submissionChange:10,loyaltyChange:35,healthChange:0,sanityChange:30,informationChance:25},riskFactors:{escapeAttempt:15,rebellion:0,breakdown:0}},{id:"humiliate_mock",type:"羞辱",text:"言语嘲讽",description:"用言语羞辱和嘲讽囚犯",icon:"fa-face-laugh",baseEffects:{submissionChange:10,loyaltyChange:-15,healthChange:0,sanityChange:-10,informationChance:10},riskFactors:{escapeAttempt:5,rebellion:20,breakdown:15}},{id:"humiliate_public",type:"羞辱",text:"当众羞辱",description:"在其他囚犯面前羞辱",icon:"fa-bullhorn",baseEffects:{submissionChange:20,loyaltyChange:-25,healthChange:0,sanityChange:-20,informationChance:15},riskFactors:{escapeAttempt:10,rebellion:30,breakdown:25}},{id:"humiliate_strip",type:"羞辱",text:"剥夺尊严",description:"用各种方式剥夺囚犯的尊严",icon:"fa-person-falling-burst",baseEffects:{submissionChange:30,loyaltyChange:-35,healthChange:-5,sanityChange:-30,informationChance:20},riskFactors:{escapeAttempt:15,rebellion:40,breakdown:35}}],Py=({descriptions:n,isLoading:a,isPlayerTurn:r})=>{const[o,c]=v.useState([]);v.useEffect(()=>{if(c([]),n.length>0){let m=0;const f=setInterval(()=>{c(h=>[...h,n[m]]),m++,m>=n.length&&clearInterval(f)},100);return()=>clearInterval(f)}},[n]);const d=()=>a&&n.length===0?e.jsx("p",{className:"text-center text-amber-300 animate-glow",children:"回合结算中..."}):o.length>0?o.map((m,f)=>e.jsx("p",{className:"text-center animate-fade-in",children:m},f)):!r&&!a?e.jsx("p",{className:"text-center text-gray-400",children:"等待对手行动..."}):e.jsx("p",{className:"text-center text-gray-500",children:"请选择你的行动。"});return e.jsx("div",{className:"w-full min-h-[10rem] max-h-[16rem] bg-slate-900/50 p-4 rounded-lg border border-slate-700/50 flex flex-col justify-start text-gray-300 font-serif transition-all duration-300 text-base shadow-inner shadow-black/50 overflow-y-auto",children:e.jsx("div",{className:"space-y-2",children:d()})})},qy=({label:n,isActive:a,onClick:r})=>e.jsx("button",{onClick:r,className:`px-5 py-2 text-base font-semibold rounded-t-lg transition-colors duration-200 font-serif ${a?"bg-stone-800/80 text-amber-400 border-b-2 border-amber-400":"bg-transparent text-gray-400 hover:bg-stone-900/50 hover:text-gray-200"}`,children:n}),Zy=({announcement:n})=>e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("h3",{className:"text-xl font-bold text-white font-serif",children:n.title}),e.jsx("p",{className:"text-sm text-gray-500 font-mono",children:n.timestamp})]}),e.jsx("p",{className:"text-gray-300 mt-2",children:n.content})]}),Gy=({isOpen:n,onClose:a,announcements:r,onRefresh:o,isLoading:c})=>{const[d,m]=v.useState("sect");if(!n)return null;const f={sect:{label:"宗门公告",data:r.sect},adventure:{label:"奇遇逸闻",data:r.adventure},world:{label:"世界法旨",data:r.world}},h=f[d].data;return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-4xl h-auto max-h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 pr-6 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:"天机阁"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:o,disabled:c,className:"text-amber-300 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-wait",children:e.jsx("i",{className:`fa-solid fa-arrows-rotate text-xl ${c?"animate-spin":""}`})}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]})]}),e.jsx("div",{className:"flex-shrink-0 px-4 flex space-x-2 border-b border-stone-700",children:Object.entries(f).map(([p,{label:b}])=>e.jsx(qy,{label:b,isActive:d===p,onClick:()=>m(p)},p))}),e.jsx("div",{className:"flex-grow overflow-y-auto p-6 space-y-4",children:h.length>0?h.map(p=>e.jsx(Zy,{announcement:p},p.id)):e.jsxs("div",{className:"text-center text-gray-500 pt-10",children:[e.jsx("p",{className:"text-4xl mb-4",children:"📜"}),e.jsx("p",{children:c?"正在从天机阁获取最新情报...":"此分类下暂无情报。"})]})})]})})},Vy=({announcements:n,onClick:a})=>{if(n.length===0)return null;const r=n.map(o=>`【${o.category}】 ${o.title}`).join("      ");return e.jsx("div",{className:"absolute top-16 left-0 right-0 h-8 bg-gradient-to-r from-amber-900/80 via-yellow-600/80 to-amber-900/80 z-10 flex items-center overflow-hidden cursor-pointer border-y-2 border-amber-400/50 shadow-lg pointer-events-auto",onClick:a,children:e.jsxs("div",{className:"whitespace-nowrap w-full flex",children:[e.jsx("p",{className:"font-serif text-sm text-yellow-100 drop-shadow-sm shadow-black animate-marquee pr-12",children:r}),e.jsx("p",{className:"font-serif text-sm text-yellow-100 drop-shadow-sm shadow-black animate-marquee pr-12","aria-hidden":"true",children:r})]})})},Qy=({victory:n,oldRank:a,newRank:r,pointsChange:o,onClose:c})=>{const d=n?"胜利":"惜败",m=n?"text-green-400":"text-red-400",f=o>=0?"text-green-400":"text-red-400";return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-md rounded-xl shadow-2xl backdrop-blur-lg flex flex-col items-center text-center p-8",children:[e.jsx("h2",{className:`text-4xl font-bold font-serif mb-4 ${m}`,children:d}),e.jsxs("div",{className:"my-6 w-full",children:[e.jsxs("div",{className:"flex justify-between items-center text-lg mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"先前段位:"}),e.jsxs("span",{className:"text-white font-semibold",children:[a.tier," ",a.division]})]}),e.jsxs("div",{className:"flex justify-between items-center text-lg mb-4",children:[e.jsx("span",{className:"text-gray-400",children:"先前积分:"}),e.jsx("span",{className:"text-white font-mono",children:a.points})]}),e.jsx("div",{className:"border-t border-dashed border-stone-600 my-4"}),e.jsxs("div",{className:"flex justify-between items-center text-2xl mb-2",children:[e.jsx("span",{className:"text-gray-300",children:"当前段位:"}),e.jsxs("span",{className:"text-amber-400 font-bold",children:[r.tier," ",r.division]})]}),e.jsxs("div",{className:"flex justify-between items-center text-2xl",children:[e.jsx("span",{className:"text-gray-300",children:"当前积分:"}),e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("span",{className:"text-amber-400 font-mono font-bold",children:r.points}),e.jsxs("span",{className:`ml-2 font-mono ${f}`,children:["(",o>=0?`+${o}`:o,")"]})]})]})]}),e.jsx("button",{onClick:c,className:"mt-6 bg-amber-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-amber-500 transition-colors shadow-lg w-40 h-14 flex items-center justify-center",children:"返回"})]})})};var Mh=ph();const Yy=n=>n?n.includes("提升")||n.includes("盾")?"⬆️":n.includes("下降")||n.includes("弱")?"⬇️":n.includes("毒")||n.includes("灼烧")?"☠️":n.includes("晕")||n.includes("锁")||n.includes("混乱")?"😵":"✨":"✨",Jy=({effect:n,onClose:a})=>Mh.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[110] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-800/90 backdrop-blur-lg w-full max-w-md shadow-2xl flex flex-col",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"p-4 flex justify-between items-center bg-black/20",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-300 font-serif",children:"状态详情"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"p-6 font-serif flex-grow flex flex-col items-center",children:[e.jsx("div",{className:"text-6xl mb-3",children:Yy(n.name)}),e.jsx("h3",{className:"text-3xl font-bold text-white text-center",children:n.name||"未知状态"}),e.jsxs("p",{className:"text-lg text-amber-400 font-mono mt-1 mb-6",children:["剩余 ",n.duration??0," 回合"]}),e.jsxs("div",{className:"w-full space-y-4 text-left",children:[e.jsxs("div",{className:"bg-black/20 p-3 rounded-md border border-stone-700/50",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-1 text-sm",children:"效果描述"}),e.jsx("p",{className:"text-gray-300 leading-relaxed text-base",children:n.description||"无描述"})]}),n.mechanicsDescription&&e.jsxs("div",{className:"bg-black/20 p-3 rounded-md border border-stone-700/50",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-1 text-sm",children:"机制说明"}),e.jsx("p",{className:"text-amber-200 leading-relaxed text-base",children:n.mechanicsDescription})]})]})]})]})}),document.body),Fy=n=>n?n.includes("提升")||n.includes("盾")?"⬆️":n.includes("下降")||n.includes("弱")?"⬇️":n.includes("毒")||n.includes("灼烧")?"☠️":n.includes("晕")||n.includes("锁")||n.includes("混乱")?"😵":"✨":"✨",Xy=({effects:n,onClose:a})=>{const[r,o]=v.useState(null),c=n.filter(d=>d&&d.name);return Mh.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[100] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-800/90 backdrop-blur-lg w-full max-w-2xl shadow-2xl rounded-lg",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"p-4 flex justify-between items-center bg-black/20 border-b border-stone-700 rounded-t-lg",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-300 font-serif",children:"特殊状态一览"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-4xl mb-2",children:"🌟"}),e.jsx("p",{className:"text-gray-400",children:"当前无特殊状态"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:c.map((d,m)=>e.jsxs("button",{onClick:()=>o(d),className:"p-4 bg-stone-900/60 rounded-lg border border-stone-600/50 hover:border-amber-500/50 hover:bg-stone-800/60 transition-all flex items-center gap-3 text-left",children:[e.jsx("span",{className:"text-2xl",children:Fy(d.name)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white font-medium text-sm",children:d.name||"未知状态"}),e.jsxs("p",{className:"text-xs text-amber-400",children:["剩余 ",d.duration??0," 回合"]})]})]},`${d.name}-${m}`))})}),e.jsx("div",{className:"p-3 bg-black/20 border-t border-stone-700 rounded-b-lg text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"点击状态查看详细机制说明"})})]})}),r&&e.jsx(Jy,{effect:r,onClose:()=>o(null)})]}),document.body)},yf=({value:n,maxValue:a,color:r,label:o})=>{const c=a>0?n/a*100:0,d=o==="气血"&&c<30;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-0.5 text-white z-10 relative px-1",children:[e.jsx("span",{className:"text-[10px] font-bold drop-shadow-sm shadow-black",children:o}),e.jsx("span",{className:`text-[10px] font-mono drop-shadow-sm shadow-black ${d?"text-red-400 animate-pulse":""}`,children:`${n}/${a}`})]}),e.jsx("div",{className:"w-full bg-stone-900/50 rounded-full h-2.5 border border-stone-600/50 shadow-inner shadow-black/50 overflow-hidden",children:e.jsx("div",{className:`${r} h-full rounded-full transition-all duration-500 ease-in-out relative ${d?"animate-pulse":""}`,style:{width:`${c}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"})})})]})},vf=({participant:n,isPlayer:a,wasHit:r})=>{const{card:o,currentHp:c,currentMp:d,statusEffects:m,calculatedStats:f}=n,[h,p]=v.useState(!1),[b,g]=v.useState(!1),w=a?"border-sky-500/70 shadow-glow-blue":"border-red-500/70 shadow-glow-red";v.useEffect(()=>{if(r){p(!0);const j=setTimeout(()=>p(!1),500);return()=>clearTimeout(j)}},[r]);const N=h?"animate-shake":"";return e.jsxs(e.Fragment,{children:[b&&e.jsx(Xy,{effects:m,onClose:()=>g(!1)}),e.jsxs("div",{className:`w-full max-w-[280px] bg-gradient-to-br from-stone-800/90 to-stone-900/90 rounded-lg border-2 ${w} shadow-lg shadow-black/50 backdrop-blur-sm transition-all duration-300 ${N} p-3`,children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsx("h2",{className:"text-lg font-bold text-white font-serif text-shadow-glow",children:o.name}),e.jsx("p",{className:`font-medium text-sm ${ke(o.rarity)}`,children:o.realm})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(yf,{value:c,maxValue:f.maxHp,color:"bg-gradient-to-r from-red-700 via-red-600 to-red-500",label:"气血"}),e.jsx(yf,{value:d,maxValue:f.maxMp,color:"bg-gradient-to-r from-blue-700 via-blue-600 to-blue-500",label:"真元"})]}),e.jsx("div",{className:"mt-3 h-8 flex items-center justify-center",children:e.jsxs("button",{onClick:()=>g(!0),className:"px-3 py-1 bg-stone-900/70 rounded-full text-xs border border-stone-500 hover:border-amber-500 hover:bg-stone-800 transition-all flex items-center gap-1.5",children:[e.jsx("span",{children:"状态"}),m.length>0&&e.jsx("span",{className:"bg-amber-500 text-black px-1.5 rounded-full font-bold",children:m.length})]})})]})]})},Ky=({animation:n})=>{const a=()=>{const r="text-6xl md:text-8xl text-yellow-300 drop-shadow-[0_0_15px_rgba(252,211,77,0.7)]";switch(n.effect){case"slash":return e.jsx("div",{className:r,children:"⚔️"});case"fire":return e.jsx("div",{className:r,children:"🔥"});case"heal":return e.jsx("div",{className:"text-6xl md:text-8xl text-green-400 drop-shadow-[0_0_15px_rgba(74,222,128,0.7)]",children:"✨"});case"shield":return e.jsx("div",{className:"text-6xl md:text-8xl text-sky-400 drop-shadow-[0_0_15px_rgba(56,189,248,0.7)]",children:"🛡️"});default:return e.jsx("div",{className:r,children:"💥"})}};return e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none animate-flash",children:e.jsx("div",{className:"relative w-32 h-32",children:a()})},n.key)},jf=({pet:n})=>e.jsxs("div",{className:"w-24 h-32 bg-stone-800/70 rounded-lg border border-stone-600 p-2 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"text-2xl",children:"🐾"}),e.jsx("p",{className:"text-xs font-bold text-white truncate",children:n.name}),e.jsxs("p",{className:"text-[10px] text-amber-400",children:["[",n.rarity,"]"]})]}),Wy=({player:n,opponent:a,animation:r,lastHit:o})=>e.jsxs("div",{className:"w-full h-full relative flex flex-col md:flex-row justify-center items-center p-4 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-radial-gradient from-transparent via-black/40 to-black/80 pointer-events-none z-0"}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center md:items-end justify-center gap-6 md:pr-12 lg:pr-24 transition-all duration-500",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-sky-500/10 rounded-full blur-3xl group-hover:bg-sky-500/20 transition-all duration-700 pointer-events-none"}),e.jsx("div",{className:"animate-fade-in transition-transform duration-300 hover:scale-105 relative z-10",children:e.jsx(vf,{participant:n,isPlayer:!0,wasHit:o==="player"})}),e.jsx("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 w-48 h-12 bg-black/60 blur-xl rounded-[100%] z-0"})]}),n.pet&&e.jsx("div",{className:"animate-fade-in-right absolute -right-4 top-0 md:top-auto md:-right-24 md:bottom-0",children:e.jsx(jf,{pet:n.pet})})]}),e.jsx("div",{className:"relative z-0 h-12 w-full md:w-24 flex items-center justify-center opacity-50"}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center md:items-start justify-center gap-6 md:pl-12 lg:pl-24 transition-all duration-500",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-red-500/10 rounded-full blur-3xl group-hover:bg-red-500/20 transition-all duration-700 pointer-events-none"}),e.jsx("div",{className:"animate-fade-in transition-transform duration-300 hover:scale-105 relative z-10",children:e.jsx(vf,{participant:a,isPlayer:!1,wasHit:o==="opponent"})}),e.jsx("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 w-48 h-12 bg-black/60 blur-xl rounded-[100%] z-0"})]}),a.pet&&e.jsx("div",{className:"animate-fade-in-left absolute -left-4 top-0 md:top-auto md:-left-24 md:bottom-0",children:e.jsx(jf,{pet:a.pet})})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-50 pointer-events-none",children:r&&e.jsx(Ky,{animation:r})})]}),ev=({victory:n,isFled:a=!1,onClose:r})=>{if(n===null)return null;const o=a?"逃命":n?"胜利":"败北",c=a?"text-orange-400":n?"text-amber-400":"text-stone-400",d=a?"🏃":n?"⚔️":"💀";return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-stone-800/90 ornate-border backdrop-blur-lg w-full max-w-md shadow-2xl flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:d}),e.jsx("h2",{className:`text-5xl font-bold mb-4 font-serif ${c}`,children:o}),a&&e.jsx("p",{className:"text-stone-300 mb-6 text-lg",children:"你成功逃离了战斗，但这次战斗被判定为失败。"}),e.jsx("button",{onClick:r,className:"bg-amber-600 text-white font-bold px-8 py-3 rounded-md hover:bg-amber-500 transition-colors text-lg",children:"继续"})]})})},tv=({choices:n,onAction:a,isLoading:r,error:o})=>{const[c,d]=v.useState(""),m=f=>{f.preventDefault(),c.trim()&&!r&&(a(c.trim()),d(""))};return e.jsx("div",{className:"w-full",children:r?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-glow text-amber-300 font-serif",children:"天地变幻..."})}):e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"text-red-400 text-center mb-4 font-serif animate-shake",children:o}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:n.map((f,h)=>e.jsxs("button",{onClick:()=>a(f),disabled:r,className:"group relative w-full text-left bg-gradient-to-r from-[#1c1c1c] to-[#151515] px-4 py-3.5 rounded-r-lg rounded-l-sm border-l-2 border-l-stone-600 hover:border-l-amber-500 border-y border-r border-white/5 hover:bg-white/5 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed font-serif shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-500/0 to-amber-500/0 group-hover:from-amber-500/5 group-hover:to-transparent transition-all duration-500"}),e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsx("span",{className:"text-stone-300 group-hover:text-amber-100 transition-colors",children:f}),e.jsx("i",{className:"fa-solid fa-chevron-right text-[10px] text-stone-600 group-hover:text-amber-500 opacity-0 group-hover:opacity-100 transform -translate-x-2 group-hover:translate-x-0 transition-all"})]})]},h))}),e.jsxs("form",{onSubmit:m,className:"flex gap-3 items-stretch",children:[e.jsx("div",{className:"relative flex-1",children:e.jsx("input",{type:"text",value:c,onChange:f=>d(f.target.value),placeholder:"道友意下如何...",disabled:r,className:"w-full h-full bg-[#0a0a0a] border border-stone-700/50 rounded-lg px-4 py-2 focus:outline-none focus:border-amber-500/50 focus:ring-1 focus:ring-amber-500/50 text-stone-300 placeholder-stone-600 disabled:opacity-50 font-serif shadow-inner text-sm"})}),e.jsx("button",{type:"submit",disabled:r||!c.trim(),className:"bg-gradient-to-b from-amber-700 to-amber-800 text-amber-100 font-bold px-6 py-2 rounded-lg border border-amber-600 hover:from-amber-600 hover:to-amber-700 active:scale-95 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-serif shadow-lg shadow-amber-900/50 text-sm tracking-wide",children:"行事"})]})]})})},qd=({skill:n,onClick:a,disabled:r,isActive:o=!1})=>{const c=typeof n!="string",d=c?n.name:n,m=c?n.mechanicsDescription||"玄妙莫测之术":"普通攻击，朴实无华",f=c?n.cost:0,h=c?n.rarity:"凡品",b=(g=>g.includes("火")||g.includes("炎")?"🔥":g.includes("雷")||g.includes("电")?"⚡":g.includes("水")||g.includes("冰")?"💧":g.includes("风")?"🌪️":g.includes("剑")?"⚔️":g.includes("医")||g.includes("愈")?"🌿":"✦")(d);return e.jsxs("button",{onClick:a,disabled:r,className:`
                group relative flex-shrink-0 flex flex-col justify-between items-center text-center
                w-36 h-56 p-3 mx-2 md:w-40 md:h-60
                transition-all duration-500 ease-out
                ${r?"opacity-40 grayscale cursor-not-allowed":"cursor-pointer"}
                ${o?"scale-110 z-10 shadow-[0_0_30px_rgba(251,191,36,0.3)]":"scale-100 hover:scale-105 opacity-80 hover:opacity-100"}
                border border-amber-500/30 rounded-lg
                bg-black
            `,style:{fontFamily:'"Noto Serif SC", "SimSun", serif'},children:[e.jsx("div",{className:"absolute inset-0 bg-stone-950 rounded-lg overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-stone-800 via-black to-black"})}),e.jsx("div",{className:"absolute top-0 left-0 w-2 h-2 border-t border-l border-amber-500/60"}),e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 border-t border-r border-amber-500/60"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-2 h-2 border-b border-l border-amber-500/60"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-2 h-2 border-b border-r border-amber-500/60"}),e.jsx("div",{className:"absolute top-3 right-3 text-stone-600 group-hover:text-amber-500/80 transition-colors text-xl",children:b}),f>0&&e.jsxs("div",{className:"absolute top-3 left-3 text-[10px] font-mono text-stone-500 border border-stone-800 bg-stone-900 px-1 rounded",children:[f," MP"]}),e.jsxs("div",{className:"z-10 w-full h-full flex flex-col justify-between py-4",children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"flex-grow flex items-center justify-center",children:e.jsx("h3",{className:`
                        text-xl md:text-2xl font-bold tracking-widest text-stone-200
                        ${d.length<=4?"writing-vertical-rl":""}
                        drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)]
                        group-hover:text-white group-hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.4)]
                        transition-all duration-300
                    `,children:d})}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"w-full border-t border-stone-800 pt-3 mt-2",children:[e.jsx("p",{className:"text-[10px] text-stone-400 line-clamp-2 leading-relaxed px-1 font-sans",children:m}),e.jsx("p",{className:`text-[9px] mt-1 ${ke(h)} opacity-60`,children:h})]})]}),e.jsx("div",{className:"absolute inset-0 border border-amber-500/0 group-hover:border-amber-500/50 rounded-lg transition-colors duration-500 pointer-events-none"})]})},sv=({activeCard:n,onAction:a,onClose:r})=>{const{card:o}=n;return e.jsx("div",{className:"fixed inset-0 z-40 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:r,children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 h-[60vh] flex flex-col justify-end items-center pb-32 md:pb-40 bg-gradient-to-t from-black via-stone-900/90 to-transparent",children:[e.jsx("div",{className:`\r
                        w-full flex items-end overflow-x-auto overflow-y-visible py-8 px-4 md:px-12 no-scrollbar snap-x snap-mandatory\r
                        perspective-1000\r
                        animate-fade-in-up origin-bottom\r
                    `,style:{perspective:"1000px"},onClick:c=>c.stopPropagation(),children:e.jsxs("div",{className:"flex mx-auto gap-2 md:gap-4 items-end min-w-min pl-[35vw] pr-[35vw]",children:[e.jsx("div",{className:"snap-center shrink-0 origin-bottom hover:-translate-y-4 hover:rotate-0 transition-all duration-300",children:e.jsx(qd,{skill:"普通攻击",onClick:()=>a("普通攻击")})}),o.skills.map(c=>c&&e.jsx("div",{className:"snap-center shrink-0 origin-bottom hover:-translate-y-4 hover:rotate-0 transition-all duration-300",children:e.jsx(qd,{skill:c,onClick:()=>a(c)})},c.id)),n.pet&&e.jsx("div",{className:"snap-center shrink-0 origin-bottom hover:-translate-y-4 hover:rotate-0 transition-all duration-300",children:e.jsx(qd,{skill:n.pet.skill,onClick:()=>a(n.pet.skill)})},n.pet.skill.id)]})}),e.jsx("div",{className:"absolute bottom-6 md:bottom-8 left-1/2 -translate-x-1/2 z-50 animate-fade-in-up delay-100",children:e.jsxs("button",{onClick:r,className:`\r
                            group relative w-20 h-20 rounded-full\r
                            bg-stone-900 border-2 border-red-500/50 hover:border-red-500\r
                            flex items-center justify-center\r
                            transition-all duration-300 hover:scale-105 hover:rotate-90\r
                            shadow-[0_0_30px_rgba(239,68,68,0.3)]\r
                        `,children:[e.jsx("div",{className:"absolute inset-2 rounded-full border-2 border-dashed border-stone-500/50 group-hover:border-red-500/50 animate-spin-slow"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-stone-400 group-hover:text-red-500 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})})},nv=({battleState:n,isLoading:a,onCombatAction:r,onFlee:o,onOpenCombatLog:c})=>{const[d,m]=v.useState(!1),f=n.playerParty[n.activePlayerCardIndex],h=n.turn==="player"&&!n.isBattleOver&&!a,p=b=>{const g=typeof b=="string"?b:b.name;r(g),m(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("footer",{className:"w-full h-32 bg-gradient-to-t from-black via-stone-900 to-stone-800/90 p-4 flex items-center justify-center border-t-2 border-stone-600/50 shadow-[0_-5px_20px_rgba(0,0,0,0.5)] z-20 relative backdrop-blur-sm",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-amber-500/50 to-transparent"}),e.jsxs("div",{className:"flex items-center justify-center gap-8 md:gap-16 w-full max-w-4xl relative",children:[e.jsxs("button",{onClick:c,className:`\r
                            group relative w-24 h-24 rounded-full bg-stone-800 border-2 border-stone-600\r
                            hover:border-stone-400 hover:bg-stone-700 transition-all duration-300\r
                            shadow-lg shadow-black flex flex-col items-center justify-center\r
                        `,children:[e.jsx("span",{className:"text-2xl mb-1 group-hover:scale-110 transition-transform",children:"📜"}),e.jsx("span",{className:"text-xs font-serif text-stone-400 group-hover:text-stone-200",children:"战况"})]}),e.jsxs("div",{className:"relative -mt-8",children:[e.jsxs("button",{onClick:()=>m(!0),disabled:!h,className:`
                                w-32 h-32 rounded-full border-4 flex flex-col items-center justify-center z-10 relative
                                transition-all duration-300 transform hover:scale-105 active:scale-95
                                shadow-[0_0_25px_rgba(0,0,0,0.6)]
                                ${h?"bg-gradient-to-br from-sky-900 to-blue-900 border-sky-400/60 text-white shadow-[0_0_20px_rgba(56,189,248,0.4)] hover:shadow-[0_0_30px_rgba(56,189,248,0.6)] animate-pulse-slow":"bg-stone-800 border-stone-700 text-stone-500 cursor-not-allowed opacity-80"}
                            `,children:[e.jsx("span",{className:"text-4xl mb-1 drop-shadow-md",children:"⚔️"}),e.jsx("span",{className:"text-xl font-bold font-serif tracking-widest drop-shadow-md",children:"出招"})]}),h&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-sky-500/20 blur-xl -z-10 animate-pulse"})]}),e.jsxs("button",{onClick:o,className:`\r
                            group relative w-24 h-24 rounded-full bg-stone-800 border-2 border-stone-600\r
                            hover:border-red-500/50 hover:bg-red-900/20 transition-all duration-300\r
                            shadow-lg shadow-black flex flex-col items-center justify-center\r
                        `,children:[e.jsx("span",{className:"text-2xl mb-1 group-hover:scale-110 transition-transform",children:"🏃"}),e.jsx("span",{className:"text-xs font-serif text-stone-400 group-hover:text-red-300",children:"撤退"})]})]})]}),d&&e.jsx(sv,{activeCard:f,onAction:p,onClose:()=>m(!1)})]})},av=({currentView:n,onChangeView:a})=>{const r=[{id:xs.HOME,label:"洞府",icon:"fa-solid fa-torii-gate",activeColor:"var(--onmyoji-ghost)",activeGlow:"var(--onmyoji-ghost-glow)"},{id:xs.ADVENTURE,label:"探险",icon:"fa-solid fa-map-location-dot",activeColor:"var(--onmyoji-gold)",activeGlow:"var(--onmyoji-gold-glow)"},{id:xs.INVENTORY,label:"储物袋",icon:"fa-solid fa-gem",activeColor:"var(--onmyoji-purple)",activeGlow:"var(--onmyoji-purple-glow)"}];return e.jsxs("div",{className:"w-full z-50 px-2 sm:px-4 py-3 bg-gradient-to-t from-[var(--onmyoji-bg-primary)] via-[var(--onmyoji-bg-secondary)] to-transparent backdrop-blur-md safe-area-pb",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-[var(--onmyoji-gold-dark)] to-transparent opacity-50"}),e.jsxs("div",{className:"max-w-md mx-auto relative flex justify-around items-end bg-[var(--onmyoji-bg-tertiary)]/80 rounded-2xl border border-[var(--onmyoji-border-subtle)] shadow-onmyoji p-3 backdrop-blur-sm",children:[e.jsx("div",{className:"absolute -top-[1px] left-12 right-12 h-[2px] bg-gradient-to-r from-transparent via-[var(--onmyoji-gold)] to-transparent opacity-60"}),e.jsx("div",{className:"absolute -left-1 top-1/2 -translate-y-1/2 opacity-30",children:e.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-[var(--onmyoji-gold)] to-[var(--onmyoji-gold-dark)] rounded-full relative",children:e.jsx("div",{className:"absolute w-1 h-1 bg-[var(--onmyoji-bg-primary)] rounded-full top-0.5 left-0.5"})})}),e.jsx("div",{className:"absolute -right-1 top-1/2 -translate-y-1/2 opacity-30",children:e.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-[var(--onmyoji-gold)] to-[var(--onmyoji-gold-dark)] rounded-full relative",children:e.jsx("div",{className:"absolute w-1 h-1 bg-[var(--onmyoji-bg-primary)] rounded-full top-0.5 left-0.5"})})}),r.map(o=>{const c=n===o.id;return e.jsxs("button",{onClick:()=>a(o.id),className:`relative flex flex-col items-center justify-center transition-all duration-500 group ${c?"-translate-y-6":"translate-y-0"}`,children:[c&&e.jsxs(La.Fragment,{children:[e.jsx("div",{className:"absolute -inset-6 rounded-full blur-2xl opacity-30",style:{backgroundColor:o.activeColor}}),e.jsx("div",{className:"absolute -bottom-3 w-10 h-2 bg-black/40 blur-md rounded-full"})]}),e.jsxs("div",{className:`relative flex items-center justify-center rounded-full transition-all duration-500 z-10 ${c?"w-16 h-16 bg-gradient-to-br from-[var(--onmyoji-bg-tertiary)] to-[var(--onmyoji-bg-primary)] border-2 shadow-lg":"w-12 h-12 bg-[var(--onmyoji-bg-tertiary)]/60 border border-[var(--onmyoji-border-subtle)] hover:bg-[var(--onmyoji-bg-tertiary)] hover:border-[var(--onmyoji-gold-dark)]/50"}`,style:c?{borderColor:o.activeColor,boxShadow:`0 0 20px ${o.activeGlow}, inset 0 0 10px ${o.activeGlow}`}:{},children:[c&&e.jsxs(La.Fragment,{children:[e.jsx("div",{className:"absolute inset-1.5 rounded-full border border-white/10"}),e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full animate-pulse",style:{backgroundColor:o.activeColor,boxShadow:`0 0 8px ${o.activeGlow}`}})]}),e.jsx("i",{className:`${o.icon} transition-all duration-300 ${c?"text-2xl":"text-xl text-[var(--onmyoji-text-secondary)] group-hover:text-[var(--onmyoji-gold)]"}`,style:c?{color:o.activeColor,filter:`drop-shadow(0 0 8px ${o.activeGlow})`}:{}})]}),e.jsx("span",{className:`absolute -bottom-7 text-[10px] font-bold tracking-widest transition-all duration-500 whitespace-nowrap ${c?"opacity-100 translate-y-0":"opacity-0 -translate-y-2 text-[var(--onmyoji-text-secondary)]"}`,style:c?{color:o.activeColor,textShadow:`0 0 10px ${o.activeGlow}`}:{},children:o.label})]},o.id)})]})]})},rv=({viewMode:n,gameState:a,isLoading:r,error:o,onExplorationAction:c,onMapOpen:d,onNextDay:m,onCombatAction:f,onFlee:h,onOpenCombatLog:p,onChangeView:b})=>e.jsxs("div",{className:"flex-shrink-0 z-50 bg-[#050505] flex flex-col border-t border-white/5 shadow-2xl relative",children:[n===xs.ADVENTURE&&a.mode==="exploration"&&e.jsx("div",{className:"w-full px-4 pt-3 pb-2 bg-gradient-to-b from-[#0a0a0a] to-[#050505]",children:e.jsxs("div",{className:"max-w-3xl mx-auto relative",children:[e.jsx(tv,{choices:a.exploration.choices,onAction:c,isLoading:r,error:o}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3",children:[e.jsxs("button",{onClick:d,className:"relative overflow-hidden py-2.5 bg-gradient-to-r from-[#1c1c1c] to-[#151515] border border-stone-700/50 rounded-lg flex items-center justify-center gap-2 text-stone-400 hover:text-amber-200 hover:border-amber-500/30 hover:bg-white/5 transition-all duration-300 group shadow-lg",title:"世界地图",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-500/0 via-amber-500/5 to-amber-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsx("i",{className:"fa-solid fa-map-location-dot text-amber-700/50 group-hover:text-amber-500 group-hover:scale-110 transition-all duration-300"}),e.jsx("span",{className:"text-sm font-serif font-medium tracking-wide",children:"世界地图"})]}),e.jsx("button",{onClick:m,disabled:r,className:"relative overflow-hidden py-2.5 bg-gradient-to-r from-[#1c1c1c] to-[#151515] border border-stone-700/50 rounded-lg flex items-center justify-center gap-2 text-stone-400 hover:text-amber-200 hover:border-amber-500/30 hover:bg-white/5 transition-all duration-300 group shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",title:"修炼一日",children:r?e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-amber-500"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-500/0 via-amber-500/5 to-amber-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsx("i",{className:"fa-solid fa-moon text-amber-700/50 group-hover:text-amber-500 group-hover:scale-110 transition-all duration-300"}),e.jsx("span",{className:"text-sm font-serif font-medium tracking-wide",children:"修炼一日"})]})})]})]})}),n===xs.ADVENTURE&&a.mode==="battle"&&a.battle&&!a.battle.isBattleOver&&e.jsx("div",{className:"w-full px-2 pt-2 pb-1 bg-[#080808]",children:e.jsx(nv,{battleState:a.battle,isLoading:r,onCombatAction:f,onFlee:h,onOpenCombatLog:p})}),e.jsx(av,{currentView:n,onChangeView:b})]}),Zd=({title:n,items:a,delayStart:r,onGlobalNav:o,decorIcon:c="◆"})=>e.jsxs("div",{className:"mb-8 animate-slide-up relative",style:{animationDelay:`${r}ms`},children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5 px-2",children:[e.jsxs("div",{className:"relative flex items-center justify-center w-8 h-8",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--onmyoji-gold)] to-[var(--onmyoji-gold-dark)] rounded-full opacity-20 animate-pulse"}),e.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-[var(--onmyoji-gold-light)] to-[var(--onmyoji-gold)] rounded-full shadow-[0_0_10px_var(--onmyoji-gold-glow)]"}),e.jsx("div",{className:"absolute w-5 h-5 border border-[var(--onmyoji-gold)] rounded-full opacity-50"})]}),e.jsx("h3",{className:"text-[var(--onmyoji-gold)] font-bold text-lg tracking-[0.3em] drop-shadow-[0_0_10px_var(--onmyoji-gold-glow)]",children:n}),e.jsxs("div",{className:"flex-1 h-[1px] relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--onmyoji-gold)] via-[var(--onmyoji-gold-dark)] to-transparent opacity-60"}),e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 text-[var(--onmyoji-gold)] text-xs opacity-40",children:c})]})]}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-y-5 sm:gap-y-6 gap-x-3",children:a.map((d,m)=>e.jsxs("button",{onClick:()=>o(d),className:"flex flex-col items-center gap-2 sm:gap-3 group relative p-1",style:{animationDelay:`${r+m*50}ms`},children:[e.jsxs("div",{className:"relative w-14 h-14 sm:w-16 sm:h-16 flex items-center justify-center transition-all duration-300 group-hover:-translate-y-2",children:[e.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-[var(--onmyoji-bg-tertiary)] to-[var(--onmyoji-bg-primary)] border border-[var(--onmyoji-border-subtle)] group-hover:border-[var(--onmyoji-gold-dark)] transition-all duration-300 shadow-lg"}),e.jsx("div",{className:"absolute inset-0 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-gradient-to-br from-[var(--onmyoji-gold-glow)] to-transparent"}),e.jsx("div",{className:"absolute top-0 left-0 w-2 h-2 border-t border-l border-[var(--onmyoji-gold)] opacity-0 group-hover:opacity-60 transition-opacity duration-300 rounded-tl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-2 h-2 border-b border-r border-[var(--onmyoji-gold)] opacity-0 group-hover:opacity-60 transition-opacity duration-300 rounded-br"}),e.jsx("div",{className:"relative z-10 flex items-center justify-center",children:e.jsx("i",{className:`${d.icon} text-2xl sm:text-3xl ${d.color} opacity-80 group-hover:opacity-100 transition-all duration-300 group-hover:drop-shadow-[0_0_8px_currentColor]`})}),d.badge&&d.badge>0?e.jsx("div",{className:"absolute -top-1 -right-1 z-20 w-5 h-5 bg-gradient-to-br from-[var(--onmyoji-red-light)] to-[var(--onmyoji-red)] text-white text-[10px] flex items-center justify-center rounded-full border border-[var(--onmyoji-red-light)] shadow-[0_0_10px_var(--onmyoji-red-glow)] font-bold animate-pulse",children:d.badge>9?"9+":d.badge}):null]}),e.jsxs("div",{className:"text-center w-full z-10",children:[e.jsx("div",{className:"text-[var(--onmyoji-text-primary)] text-xs font-bold tracking-wider group-hover:text-[var(--onmyoji-gold)] transition-colors drop-shadow-sm",children:d.label}),e.jsx("div",{className:"text-[10px] text-[var(--onmyoji-text-secondary)] scale-90 hidden sm:block truncate mt-0.5 group-hover:text-[var(--onmyoji-gold-dark)] transition-colors",children:d.desc})]})]},d.id))})]}),lv=n=>{const{isVisible:a,gameState:r,onNavClick:o,onQuestClick:c,onBusinessClick:d,onCultivationClick:m,onMemoryClick:f,onCharacterStatusClick:h,onPrisonClick:p,onEtiquetteHallClick:b,onGauntletClick:g,onAnnouncementsClick:w,onSystemClick:N,onHospitalClick:j}=n;if(!a)return null;const k=D=>{switch(D.id){case"biz":d();break;case"breed":m();break;case"heal":j();break;case"jail":p();break;case"manner":b();break;case"shop":o("商城");break;case"gauntlet":g();break;case"arena":o("竞技场");break;case"bounty":o("商城");break;case"news":w();break;case"status":h();break;case"memory":f();break;case"quest":c();break;case"system":N();break;case"team":o("队伍");break;default:console.warn("Unknown menu item",D.id)}},_=[{id:"biz",label:"产业",desc:"宗门资产",icon:"fa-solid fa-torii-gate",category:"sect",color:"text-amber-400"},{id:"breed",label:"育灵轩",desc:"灵兽培育",icon:"fa-solid fa-yin-yang",category:"sect",color:"text-emerald-400"},{id:"heal",label:"医馆",desc:"炼丹疗伤",icon:"fa-solid fa-vial",category:"sect",color:"text-rose-400"},{id:"jail",label:"镇狱",desc:"关押妖魔",icon:"fa-solid fa-lock",category:"sect",color:"text-purple-400"},{id:"manner",label:"礼仪馆",desc:"门派法规",icon:"fa-solid fa-fan",category:"sect",color:"text-pink-300"},{id:"team",label:"弟子",desc:"门人管理",icon:"fa-solid fa-users",category:"sect",color:"text-blue-300"}],C=[{id:"shop",label:"万宝楼",desc:"奇珍异宝",icon:"fa-solid fa-store",category:"world",color:"text-yellow-400"},{id:"gauntlet",label:"大闯关",desc:"限时秘境",icon:"fa-solid fa-crown",category:"world",color:"text-red-500"},{id:"arena",label:"演武场",desc:"同门切磋",icon:"fa-solid fa-khanda",category:"world",color:"text-orange-400"},{id:"news",label:"江湖闻",desc:"天下大势",icon:"fa-solid fa-scroll",category:"world",color:"text-amber-300",badge:0}],S=[{id:"status",label:"道心",desc:"属性总览",icon:"fa-solid fa-om",category:"personal",color:"text-cyan-400"},{id:"memory",label:"识海",desc:"记忆碎片",icon:"fa-solid fa-brain",category:"personal",color:"text-pink-400"},{id:"quest",label:"天命",desc:"主线任务",icon:"fa-solid fa-book-open",category:"personal",color:"text-amber-200",badge:r.playerProfile.quests.filter(D=>D.status==="In Progress").length},{id:"system",label:"天机",desc:"系统设置",icon:"fa-solid fa-gear",category:"personal",color:"text-gray-400"}];return e.jsxs("div",{className:"h-full w-full overflow-y-auto overflow-x-hidden pt-4 pb-4 px-4 scroll-smooth scrollbar-none relative",children:[e.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[e.jsx("div",{className:"absolute top-20 right-4 opacity-30 animate-ghost-fire",style:{animationDuration:"4s"},children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-t from-[var(--onmyoji-ghost)] to-transparent blur-sm"})}),e.jsx("div",{className:"absolute bottom-40 left-8 opacity-20 animate-ghost-fire",style:{animationDuration:"5s",animationDelay:"1s"},children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-t from-[var(--onmyoji-purple)] to-transparent blur-sm"})}),e.jsx("div",{className:"absolute top-1/3 -right-20 opacity-5 transform scale-150",children:e.jsx("svg",{width:"200",height:"100",viewBox:"0 0 200 100",fill:"currentColor",className:"text-[var(--onmyoji-gold)]",children:e.jsx("path",{d:"M180,50 Q160,20 130,30 Q100,10 70,30 Q40,20 20,50 Q40,80 70,70 Q100,90 130,70 Q160,80 180,50 Z"})})}),e.jsx("div",{className:"absolute bottom-1/4 -left-10 opacity-5 transform scale-100 rotate-12",children:e.jsx("svg",{width:"150",height:"80",viewBox:"0 0 200 100",fill:"currentColor",className:"text-[var(--onmyoji-gold)]",children:e.jsx("path",{d:"M180,50 Q160,20 130,30 Q100,10 70,30 Q40,20 20,50 Q40,80 70,70 Q100,90 130,70 Q160,80 180,50 Z"})})}),e.jsx("div",{className:"absolute top-1/2 right-10 opacity-10 animate-float",style:{animationDuration:"6s"},children:e.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-[var(--onmyoji-gold)] to-[var(--onmyoji-gold-dark)] rounded-full relative",children:e.jsx("div",{className:"absolute w-1.5 h-1.5 bg-[var(--onmyoji-bg-primary)] rounded-full top-1 left-1"})})})]}),e.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[e.jsxs("div",{className:"relative h-52 mb-10 rounded-2xl overflow-hidden border border-[var(--onmyoji-border-subtle)] shadow-onmyoji group cursor-pointer animate-fade-in mx-1 onmyoji-corners",children:[e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--onmyoji-bg-tertiary)] via-[var(--onmyoji-bg-secondary)] to-[var(--onmyoji-bg-primary)]",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/dark-wood.png')] opacity-10 mix-blend-overlay"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_30%_70%,var(--onmyoji-gold-glow),transparent_50%)] opacity-30"})]}),e.jsx("div",{className:"absolute top-4 right-4 z-10 opacity-40 group-hover:opacity-60 transition-opacity",children:e.jsxs("div",{className:"w-12 h-12 relative",children:[e.jsx("div",{className:"absolute inset-0 border-2 border-[var(--onmyoji-gold)] rounded-full animate-spin-slow",style:{animationDuration:"20s"}}),e.jsx("div",{className:"absolute inset-2 border border-[var(--onmyoji-gold-dark)] rounded-full"}),e.jsx("i",{className:"fa-solid fa-yin-yang absolute inset-0 flex items-center justify-center text-2xl text-[var(--onmyoji-gold)]"})]})}),e.jsxs("div",{className:"absolute bottom-6 left-6 z-10",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"bg-gradient-to-r from-[var(--onmyoji-gold-dark)] to-[var(--onmyoji-gold)] text-[var(--onmyoji-bg-primary)] text-xs px-3 py-1 rounded font-bold shadow-[0_0_15px_var(--onmyoji-gold-glow)]",children:"洞天福地"})}),e.jsx("h2",{className:"text-3xl text-[var(--onmyoji-gold)] font-bold tracking-[0.2em] drop-shadow-[0_0_15px_var(--onmyoji-gold-glow)]",children:"静室修行"}),e.jsxs("p",{className:"text-[var(--onmyoji-text-secondary)] text-sm mt-2 flex items-center gap-2 font-medium",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-[var(--onmyoji-ghost)] animate-pulse shadow-[0_0_8px_var(--onmyoji-ghost-glow)]"}),"当前灵气浓度: 充盈"]})]}),e.jsx("div",{className:"absolute right-6 bottom-6 z-10",children:e.jsx("div",{className:"w-14 h-14 rounded-full border-2 border-[var(--onmyoji-gold)] bg-[var(--onmyoji-bg-primary)]/80 backdrop-blur flex items-center justify-center group-hover:shadow-[0_0_25px_var(--onmyoji-gold-glow)] transition-all duration-300 cursor-pointer hover:scale-110 animate-mystic-pulse",children:e.jsx("span",{className:"text-[var(--onmyoji-gold)] font-bold text-xl",children:"收"})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-gradient-to-r from-transparent via-[var(--onmyoji-gold)] to-transparent opacity-50"})]}),e.jsx(Zd,{title:"宗门事务",items:_,delayStart:100,onGlobalNav:k,decorIcon:"⛩"}),e.jsx(Zd,{title:"红尘万象",items:C,delayStart:200,onGlobalNav:k,decorIcon:"☯"}),e.jsx(Zd,{title:"道途修行",items:S,delayStart:300,onGlobalNav:k,decorIcon:"✦"}),e.jsx("div",{className:"h-32"})]})]})},Vs=n=>{const a=JSON.parse(JSON.stringify(n.baseAttributes)),r=Object.values(n.equipment);for(const o of r)if(o){for(const[c,d]of Object.entries(o.stats))if(d!==void 0)switch(c){case"hp":a.maxHp+=d;break;case"mp":a.maxMp+=d;break;case"attack":a.attack+=d;break;case"defense":a.defense+=d;break;case"speed":a.speed+=d;break;case"critRate":a.critRate+=d;break;case"critDmg":a.critDmg+=d;break}}return a.hp=a.maxHp,a.mp=a.maxMp,a},ov={p_brothel_star:1.5,p_brothel_tutor:1.2,p_brothel_guard:.5,p_arena_gladiator:1.8,p_arena_host:1.1,p_arena_trader:1,p_alchemy_chief:2,p_alchemy_apprentice:.8,p_auction_master:2.5,p_auction_appraiser:1.5,p_intel_chief:2.2,p_intel_assassin:1.7},iv={青楼:10,角斗场:5,炼丹房:2,拍卖行:0,情报阁:0};function zh(n,a){if(!n.businessDistrict)return 0;const{shops:r,level:o}=n.businessDistrict;let c=0;if((a?r.filter(m=>m.id===a):r).forEach(m=>{let f=(iv[m.type]||0)*(1+(m.level-1)*.2);m.staff.forEach(h=>{const p=n.cardCollection.find(g=>g.id===h.characterId),b=Yl[h.positionId];if(p&&b){const g=b.requiredAttr,w=p[g]||10,N=ov[h.positionId]||1,j=w/10*N;f+=j}}),c+=f}),!a){c*=1+(o-1)*.1;const m=n.reputation.score/5e3;c*=1+m}return Math.floor(c)}const cv=n=>({attack:"攻击",defense:"防御",hp:"气血",speed:"速度",critRate:"会心率",critDmg:"会心伤害"})[n]||n,Nf=(n,a)=>n==="critRate"||n==="critDmg"?`${(a*100).toFixed(0)}%`:a>0?`+${a}`:`${a}`,dv=({playerProfile:n,card:a,selectionState:r,onClose:o,onEquip:c,onLearnSkill:d,onEquipPet:m})=>{const[f,h]=v.useState(null),p=D=>D.type==="equipment",b=D=>D.type==="skill",g=D=>D.type==="pet",w=(D,E)=>e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-bold ${ke(D.rarity)}`,children:D.name}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:[D.type," (",!D.genderLock||D.genderLock==="Universal"?"通用":D.genderLock==="Male"?"男性专用":"女性专用",")"]}),e.jsx("div",{className:"space-y-2",children:Object.entries(D.stats).map(([A,z])=>{const I=(E==null?void 0:E.stats[A])||0,L=z-I;return e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-300",children:cv(A)}),e.jsxs("div",{className:"flex items-center gap-2",children:[E&&e.jsx("span",{className:"text-gray-500",children:Nf(A,I)}),e.jsx("span",{className:`font-semibold ${L>0?"text-green-400":L<0?"text-red-400":"text-white"}`,children:Nf(A,z)}),E&&L!==0&&e.jsxs("span",{className:`text-xs w-16 text-center font-mono ${L>0?"text-green-500":"text-red-500"}`,children:["(",L>0?"+":"",L,")"]})]})]},A)})})]}),N=D=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-baseline mb-2",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-baseline gap-2",children:[e.jsx("span",{className:`${ke(D.rarity)}`,children:D.name}),e.jsxs("span",{className:`text-base font-medium ${ke(D.rarity)}`,children:["[",D.rarity,"]"]})]}),e.jsxs("span",{className:"text-base font-mono text-blue-400",children:[D.cost," 真元"]})]}),e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["(",D.genderLock==="Universal"?"通用":D.genderLock==="Male"?"男性专用":"女性专用",")"]}),e.jsx("p",{className:"text-sm font-semibold text-amber-300 mt-2",children:D.mechanicsDescription}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:D.description})]}),j=D=>e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-bold ${ke(D.rarity)}`,children:D.name}),e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["(",D.gender==="Male"?"雄性":"雌性",")"]}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:D.description}),e.jsxs("div",{className:"bg-stone-800/50 p-3 rounded-md",children:[e.jsxs("h4",{className:"font-semibold text-amber-400 mb-2",children:["技能: ",D.skill.name]}),e.jsx("p",{className:"text-sm font-semibold text-amber-300",children:D.skill.mechanicsDescription}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:D.skill.description})]})]}),k=()=>p(r)?`选择${{weapon:"武器",armor:"衣服",accessory1:"配饰",accessory2:"配饰"}[r.slot]}`:g(r)?"选择出战兽宠":"选择通用技能",C=(()=>{if(p(r))return n.equipmentInventory.filter(D=>D.type===r.slotType&&(!D.genderLock||D.genderLock==="Universal"||D.genderLock===a.gender));if(b(r)){const D=new Set(a.skills.map(E=>E==null?void 0:E.id).filter(Boolean));return n.universalSkills.filter(E=>!D.has(E.id)&&(E.genderLock==="Universal"||E.genderLock===a.gender))}if(g(r)){const D=new Set([...n.maleParty,...n.femaleParty].map(E=>{var A;return(A=E.pet)==null?void 0:A.id}).filter(Boolean));return n.petCollection.filter(E=>E.gender===a.gender&&!D.has(E.id))}return[]})(),S=p(r)?a.equipment[r.slot]:null;return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-[60] flex items-center justify-center p-4 animate-fade-in",onClick:o,children:e.jsxs("div",{className:"bg-slate-900/90 border border-slate-700 rounded-xl w-full max-w-2xl h-[70vh] shadow-2xl flex flex-col backdrop-blur-lg",onClick:D=>D.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-700 flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-white font-serif",children:k()}),e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-grow flex flex-row overflow-hidden",children:[e.jsx("div",{className:"w-2/5 border-r border-slate-700 overflow-y-auto",children:C.length>0?C.map(D=>e.jsx("button",{onClick:()=>h(D),className:`w-full text-left p-3 text-sm transition-colors duration-150 ${(f==null?void 0:f.id)===D.id?"bg-amber-600/30":"hover:bg-slate-800/60"}`,children:e.jsxs("p",{className:"font-semibold text-white flex items-center gap-2",children:[e.jsx("span",{className:`${ke(D.rarity)}`,children:D.name}),"rarity"in D&&e.jsxs("span",{className:`text-xs font-medium ${ke(D.rarity)}`,children:["[",D.rarity,"]"]})]})},D.id)):e.jsx("p",{className:"p-4 text-sm text-gray-500",children:"无可用选项"})}),e.jsxs("div",{className:"w-3/5 p-4 flex flex-col justify-between",children:[e.jsx("div",{children:f?p(r)?w(f,S):g(r)?j(f):N(f):e.jsx("div",{className:"text-center text-gray-500 pt-10",children:e.jsx("p",{children:"从左侧列表选择一项以预览详情"})})}),f&&e.jsx("button",{onClick:()=>{p(r)&&c(r.slot,f),b(r)&&d(r.slotIndex,f),g(r)&&m(f)},className:"w-full bg-amber-600 text-white font-bold py-2 px-4 rounded-md hover:bg-amber-500 transition-colors",children:p(r)||g(r)?"装备":"学习"})]})]})]})})},fu=({skill:n,onClose:a})=>{const r=n.genderLock==="Universal"?"通用":n.genderLock==="Male"?"男性专用":"女性专用";return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4 animate-fade-in backdrop-blur-sm",onClick:a,children:e.jsxs("div",{className:"relative bg-stone-900 border-2 border-stone-700 w-full max-w-md shadow-2xl flex flex-col rounded-2xl overflow-hidden ornate-border",onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-purple-900/10 rounded-full blur-3xl pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-blue-900/10 rounded-full blur-3xl pointer-events-none"}),e.jsxs("div",{className:"p-5 flex justify-between items-center bg-stone-950/50 border-b border-stone-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-stone-800 border border-stone-700 text-cyan-400",children:e.jsx("i",{className:"fa-solid fa-scroll text-lg"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-lg font-bold font-serif ${ke(n.rarity)}`,children:n.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-stone-500",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded border border-stone-700 bg-stone-900",children:n.rarity}),e.jsx("span",{children:"功法"})]})]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-stone-800 flex items-center justify-center text-stone-400 hover:text-white hover:bg-stone-700 transition-all",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"p-6 font-serif space-y-5 relative z-10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-stone-800/40 p-3 rounded-lg border border-stone-700/50 text-center",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"修炼限制"}),e.jsx("p",{className:"text-stone-300 font-medium text-sm",children:r})]}),e.jsxs("div",{className:"bg-stone-800/40 p-3 rounded-lg border border-stone-700/50 text-center",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"真元消耗"}),e.jsx("p",{className:"text-cyan-400 font-bold font-mono text-sm",children:n.cost>0?n.cost:"0"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-stone-800/20 p-3 rounded-lg border border-stone-800/50",children:[e.jsxs("h4",{className:"font-semibold text-pink-400 mb-2 text-sm flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-eye text-xs"})," 视觉表现"]}),e.jsxs("p",{className:"text-stone-300 leading-relaxed text-sm italic",children:["“",n.eroticDescription,"”"]})]}),e.jsxs("div",{className:"bg-stone-800/20 p-3 rounded-lg border border-stone-800/50",children:[e.jsxs("h4",{className:"font-semibold text-sky-400 mb-2 text-sm flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-gears text-xs"})," 功法机制"]}),e.jsx("p",{className:"text-stone-300 leading-relaxed text-sm",children:n.mechanicsDescription})]}),e.jsxs("div",{className:"pt-2 border-t border-stone-800",children:[e.jsx("h4",{className:"font-semibold text-stone-500 mb-1 text-xs uppercase tracking-wider",children:"背景故事"}),e.jsx("p",{className:"text-stone-400 leading-relaxed mt-1 text-sm",children:n.description})]})]})]})]})})},wf=({value:n,maxValue:a,type:r,label:o})=>{const c=a>0?n/a*100:0,d=r==="hp"?"from-red-600 via-red-500 to-red-400":"from-blue-600 via-blue-500 to-blue-400",m=r==="hp"?"shadow-glow-red":"shadow-glow-blue";return e.jsxs("div",{className:"mb-2 group",children:[e.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[e.jsx("span",{className:"text-xs font-bold text-stone-300 font-serif tracking-wider",children:o}),e.jsx("span",{className:"text-xs font-mono text-stone-400 group-hover:text-white transition-colors",children:`${Math.round(n)}/${Math.round(a)}`})]}),e.jsx("div",{className:"w-full bg-stone-950/80 rounded-full h-2 border border-stone-800 shadow-inner overflow-hidden relative",children:e.jsx("div",{className:`h-full rounded-full bg-gradient-to-r ${d} transition-all duration-700 ease-out relative ${c>0?m:""}`,style:{width:`${c}%`},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-shimmer",style:{backgroundSize:"200% 100%"}})})})]})},uv=({attributes:n,card:a})=>{const r=[{label:"攻击",value:Math.round(n.attack),icon:"⚔️",color:"text-red-400"},{label:"防御",value:Math.round(n.defense),icon:"🛡️",color:"text-amber-400"},{label:"速度",value:Math.round(n.speed),icon:"🍃",color:"text-green-400"}],o=[{label:"会心率",value:`${(n.critRate*100).toFixed(0)}%`,icon:"🎯"},{label:"会心伤害",value:`${(n.critDmg*100).toFixed(0)}%`,icon:"💥"}],c=[{label:"魅力",value:a.charm||0,icon:"🌸"},{label:"技巧",value:a.skillfulness||0,icon:"🔧"},{label:"悟性",value:a.perception||0,icon:"🧠"}];return e.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-xl h-full flex flex-col border border-stone-700/50 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 opacity-5 text-8xl pointer-events-none select-none font-serif",children:"道"}),e.jsxs("h4",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-amber-500 mb-3 text-base font-serif border-b border-stone-700/50 pb-2 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-chart-pie text-amber-500 text-xs"})," 面板属性"]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx(wf,{value:n.hp,maxValue:n.maxHp,type:"hp",label:"气血"}),e.jsx(wf,{value:n.mp,maxValue:n.maxMp,type:"mp",label:"真元"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:r.map(d=>e.jsxs("div",{className:"bg-stone-800/60 p-2 rounded-lg border border-stone-700 hover:border-amber-500/50 transition-colors group text-center backdrop-blur-sm",children:[e.jsx("div",{className:"text-lg mb-0.5 group-hover:scale-110 transition-transform duration-300",children:d.icon}),e.jsx("p",{className:"text-[10px] text-stone-400 mb-0.5",children:d.label}),e.jsx("p",{className:`font-bold font-mono text-base ${d.color} text-shadow-glow`,children:d.value})]},d.label))}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:o.map(d=>e.jsxs("div",{className:"bg-stone-800/40 p-1.5 rounded-lg border border-stone-700/50 flex justify-between items-center px-2",children:[e.jsxs("span",{className:"text-[10px] text-stone-400 flex items-center gap-1",children:[e.jsx("span",{children:d.icon})," ",d.label]}),e.jsx("span",{className:"font-bold text-stone-200 font-mono text-sm",children:d.value})]},d.label))}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-auto",children:c.map(d=>e.jsxs("div",{className:"bg-stone-800/40 p-1.5 rounded-lg border border-stone-700/50 text-center",children:[e.jsx("p",{className:"text-[9px] text-stone-500 mb-0.5",children:d.label}),e.jsx("p",{className:"font-bold text-stone-300 text-sm",children:d.value})]},d.label))})]})},Ei=({card:n,onClose:a,playerProfile:r,setPlayerProfile:o,onViewPet:c})=>{var D;const[d,m]=v.useState(null),[f,h]=v.useState(null),p=v.useMemo(()=>{const E=r.maleParty.find(I=>I.id===n.id),A=r.femaleParty.find(I=>I.id===n.id),z=r.cardCollection.find(I=>I.id===n.id);return E||A||z||n},[r,n.id]),b=v.useMemo(()=>Vs(p),[p]),g=E=>{const A=JSON.parse(JSON.stringify(r)),z=A.cardCollection.find(P=>P.id===n.id),I=A.maleParty.find(P=>P.id===n.id),L=A.femaleParty.find(P=>P.id===n.id),T=[z,I,L].filter(Boolean);if(T.length>0){const P=T[0];E(P,A);const M=JSON.stringify(P);z&&Object.assign(z,JSON.parse(M)),I&&Object.assign(I,JSON.parse(M)),L&&Object.assign(L,JSON.parse(M))}o(A)},w=(E,A)=>{g((z,I)=>{const L=z.equipment[E],T=I.equipmentInventory.findIndex(M=>M.id===A.id);T>-1&&I.equipmentInventory.splice(T,1),L&&I.equipmentInventory.push(L),z.equipment[E]=A;const P=Vs(z);z.baseAttributes.hp=P.maxHp,z.baseAttributes.mp=P.maxMp}),m(null)},N=E=>{g((A,z)=>{const I=A.equipment[E];if(I){z.equipmentInventory.push(I),A.equipment[E]=null;const L=Vs(A);A.baseAttributes.hp=L.maxHp,A.baseAttributes.mp=L.maxMp}})},j=(E,A)=>{g(z=>{z.skills[E]=A}),m(null)},k=E=>{g(A=>{A.skills[E]=null})},_=E=>{g((A,z)=>{const I=A.pet,L=z.petCollection.findIndex(T=>T.id===E.id);L>-1&&z.petCollection.splice(L,1),I&&z.petCollection.push(I),A.pet=E}),m(null)},C=()=>{g((E,A)=>{const z=E.pet;z&&(A.petCollection.push(z),E.pet=null)})},S=[{key:"weapon",label:"武器",type:"Weapon",icon:"⚔️"},{key:"armor",label:"宝衣",type:"Armor",icon:"👕"},{key:"accessory1",label:"法宝",type:"Accessory",icon:"💍"},{key:"accessory2",label:"饰品",type:"Accessory",icon:"📿"}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 animate-fade-in backdrop-blur-md",onClick:a,children:e.jsxs("div",{className:"relative w-full max-w-7xl h-[85vh] flex flex-col bg-stone-950/95 rounded-2xl overflow-hidden shadow-2xl ornate-border border-amber-600/30",onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/black-scales.png')] mix-blend-overlay"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-amber-900/20 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/2 animate-pulse-slow"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-blue-900/20 rounded-full blur-[100px] translate-y-1/2 -translate-x-1/2"})]}),e.jsxs("div",{className:"relative px-6 py-5 flex-shrink-0 z-10",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex gap-5 items-center",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:`absolute inset-0 rounded-full blur-md opacity-50 group-hover:opacity-100 transition-opacity duration-500 ${bh(p.rarity,!0)}`}),e.jsx("div",{className:`relative w-16 h-16 rounded-full border-2 ${pt(p.rarity)} overflow-hidden shadow-lg bg-stone-900`,children:p.artUrl?e.jsx("img",{src:p.artUrl,alt:p.name,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-3xl text-stone-600",children:"👤"})}),e.jsxs("div",{className:"absolute -bottom-1 -right-1 bg-stone-900 border border-stone-700 text-amber-500 text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-lg z-10",children:["Lv.",Math.floor((p.experience||0)/100)+1]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-100 via-amber-200 to-amber-400 tracking-wide drop-shadow-sm filter",children:p.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${pt(p.rarity)} ${ke(p.rarity)} bg-black/40 backdrop-blur-sm shadow-inner tracking-wider font-medium`,children:p.rarity})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-stone-400 font-medium tracking-wide",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 rounded bg-stone-900/50 border border-stone-800",children:[e.jsx("i",{className:"fa-solid fa-bolt text-amber-500 animate-pulse-slow"}),e.jsx("span",{className:"text-stone-300",children:p.realm})]}),e.jsx("div",{className:"w-px h-3 bg-stone-700"}),e.jsx("span",{className:"hover:text-stone-200 transition-colors",children:p.race||"未知种族"}),e.jsx("div",{className:"w-px h-3 bg-stone-700"}),e.jsx("span",{className:"hover:text-stone-200 transition-colors",children:p.origin||"来历不详"})]})]})]}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-stone-900/50 flex items-center justify-center text-stone-500 hover:text-white hover:bg-red-500/20 hover:rotate-90 transition-all duration-300 border border-white/5 hover:border-red-500/50 group",children:e.jsx("i",{className:"fa-solid fa-times text-lg"})})]}),e.jsx("div",{className:"absolute bottom-0 left-6 right-6 h-px bg-gradient-to-r from-transparent via-stone-700/50 to-transparent"})]}),e.jsxs("div",{className:"p-6 grid grid-cols-1 lg:grid-cols-12 gap-6 overflow-y-auto flex-grow custom-scrollbar relative z-10",children:[e.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-4",children:[e.jsx(uv,{attributes:b,card:p}),e.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-xl border border-stone-700/50 flex-grow",children:[e.jsxs("h4",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-amber-500 mb-3 text-base font-serif border-b border-stone-700/50 pb-2 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-scroll text-amber-500 text-xs"})," 角色传记"]}),e.jsx("div",{className:"text-xs text-stone-300 leading-relaxed font-serif italic p-2.5 bg-stone-950/30 rounded border border-stone-800 h-full overflow-y-auto custom-scrollbar",children:p.appearance?`"${p.appearance}"`:"暂无传记..."})]})]}),e.jsxs("div",{className:"lg:col-span-5 flex flex-col gap-4",children:[e.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-xl border border-stone-700/50",children:[e.jsxs("h4",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-amber-500 mb-3 text-base font-serif border-b border-stone-700/50 pb-2 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-shirt text-amber-500 text-xs"})," 装备配置"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:S.map(E=>{const A=p.equipment[E.key];return e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{onClick:()=>m({type:"equipment",slot:E.key,slotType:E.type}),className:`
                                                        w-full text-left p-2 rounded-lg border transition-all duration-300 h-16 flex items-center gap-2.5
                                                        ${A?`${pt(A.rarity)} bg-stone-800/80 hover:bg-stone-800 hover:shadow-glow-gold hover:-translate-y-0.5`:"border-stone-700 border-dashed bg-stone-900/30 hover:bg-stone-800/50 hover:border-stone-500"}
                                                    `,children:[e.jsx("div",{className:`
                                                        w-10 h-10 rounded flex items-center justify-center text-lg flex-shrink-0
                                                        ${A?"bg-stone-900 text-amber-400 shadow-inner":"bg-stone-800/50 text-stone-600"}
                                                    `,children:E.icon}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("p",{className:"text-[10px] text-stone-500 mb-0 font-serif",children:E.label}),e.jsx("p",{className:`font-bold truncate text-sm ${A?ke(A.rarity):"text-stone-600"}`,children:(A==null?void 0:A.name)||"空置"})]})]}),A&&e.jsx("button",{onClick:z=>{z.stopPropagation(),N(E.key)},className:"absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full bg-red-900 text-red-200 border border-red-700 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700 hover:text-white hover:scale-110 shadow-lg z-10",title:"卸下",children:e.jsx("i",{className:"fa-solid fa-times text-[10px]"})})]},E.key)})})]}),e.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-xl border border-stone-700/50 flex-grow",children:[e.jsxs("h4",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-amber-500 mb-3 text-base font-serif border-b border-stone-700/50 pb-2 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-paw text-amber-500 text-xs"})," 伴生灵兽"]}),e.jsxs("div",{className:"relative group h-16",children:[e.jsxs("button",{onClick:()=>{p.pet?c(p.pet):m({type:"pet"})},className:`
                                            w-full h-full text-left p-2 rounded-lg border transition-all duration-300 flex items-center gap-3
                                            ${p.pet?`${pt(p.pet.rarity)} bg-stone-800/80 hover:bg-stone-800 hover:shadow-glow-purple`:"border-stone-700 border-dashed bg-stone-900/30 hover:bg-stone-800/50 hover:border-stone-500"}
                                        `,children:[e.jsx("div",{className:`
                                            w-10 h-10 rounded-full flex items-center justify-center text-lg flex-shrink-0 border-2
                                            ${p.pet?`${pt(p.pet.rarity)} bg-stone-900`:"border-stone-600 bg-stone-800/50 text-stone-600"}
                                        `,children:p.pet?"🐉":"🐾"}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"text-[10px] text-stone-500 mb-0 font-serif",children:"出战灵兽"}),e.jsx("p",{className:`font-bold text-sm ${p.pet?ke(p.pet.rarity):"text-stone-600"}`,children:((D=p.pet)==null?void 0:D.name)||"暂无灵兽"})]}),!p.pet&&e.jsx("div",{className:"text-stone-600 pr-4",children:e.jsx("i",{className:"fa-solid fa-plus"})})]}),p.pet&&e.jsx("button",{onClick:E=>{E.stopPropagation(),C()},className:"absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full bg-red-900 text-red-200 border border-red-700 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700 hover:text-white hover:scale-110 shadow-lg z-10",title:"召回",children:e.jsx("i",{className:"fa-solid fa-times text-[10px]"})})]})]})]}),e.jsx("div",{className:"lg:col-span-4 flex flex-col gap-4",children:e.jsxs("div",{className:"bg-stone-900/60 p-4 rounded-xl border border-stone-700/50 h-full",children:[e.jsxs("h4",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-amber-500 mb-3 text-base font-serif border-b border-stone-700/50 pb-2 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-book-open text-amber-500 text-xs"})," 功法技能"]}),e.jsx("div",{className:"space-y-2.5",children:p.skills.map((E,A)=>e.jsx("div",{className:`
                                                relative w-full text-left p-3 rounded-lg border transition-all duration-300
                                                ${E?`${pt(E.rarity)} bg-stone-800/80 hover:bg-stone-800 hover:shadow-glow-blue cursor-pointer group`:"border-stone-700 border-dashed bg-stone-900/30 hover:bg-stone-800/50 hover:border-stone-500 cursor-pointer"}
                                            `,onClick:()=>{E?h(E):A>1&&m({type:"skill",slotIndex:A})},children:E?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h5",{className:`font-bold text-sm font-serif ${ke(E.rarity)}`,children:E.name}),e.jsx("span",{className:`text-[9px] px-1 py-0 rounded border border-stone-600 ${ke(E.rarity)} bg-black/30`,children:E.rarity})]}),e.jsx("p",{className:"text-amber-500/90 text-xs font-medium line-clamp-1",children:E.mechanicsDescription}),e.jsx("p",{className:"text-stone-400 text-[10px] line-clamp-2 leading-tight",children:E.description}),e.jsxs("div",{className:"flex justify-between items-center mt-1 border-t border-white/5 pt-1",children:[e.jsxs("span",{className:"text-[9px] font-mono text-blue-300",children:["消耗 ",E.cost]}),e.jsx("span",{className:"text-[9px] text-stone-500",children:A<2?"本命":"修炼"})]}),A>1&&e.jsx("button",{onClick:z=>{z.stopPropagation(),k(A)},className:"absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full bg-red-900 text-red-200 border border-red-700 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700 hover:text-white hover:scale-110 shadow-lg z-10",title:"遗忘",children:e.jsx("i",{className:"fa-solid fa-times text-[10px]"})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 text-stone-600 hover:text-amber-500 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-plus-circle text-lg mb-1"}),e.jsx("span",{className:"text-xs font-serif",children:"参悟新功法"})]})},A))})]})})]})]})}),d&&e.jsx(dv,{playerProfile:r,selectionState:d,card:p,onClose:()=>m(null),onEquip:w,onLearnSkill:j,onEquipPet:_},d.type+(d.type==="equipment"?d.slot:d.type==="skill"?d.slotIndex:"pet")),f&&e.jsx(fu,{skill:f,onClose:()=>h(null)})]})},mv=n=>({attack:"攻击",defense:"防御",hp:"气血",speed:"速度",critRate:"会心率",critDmg:"会心伤害"})[n]||n,xv=(n,a)=>n==="critRate"||n==="critDmg"?`+${(a*100).toFixed(0)}%`:a>0?`+${a}`:`${a}`,fv=({item:n,onClose:a})=>{const r=!n.genderLock||n.genderLock==="Universal"?"通用":n.genderLock==="Male"?"男性专用":"女性专用";return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4 animate-fade-in backdrop-blur-sm",onClick:a,children:e.jsxs("div",{className:"relative bg-stone-900 border-2 border-amber-600/30 w-full max-w-md shadow-2xl flex flex-col rounded-2xl overflow-hidden",onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-amber-600/10 rounded-full blur-3xl pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-emerald-600/10 rounded-full blur-3xl pointer-events-none"}),e.jsxs("div",{className:"p-5 flex justify-between items-center bg-stone-950/50 border-b border-stone-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-stone-800 border border-stone-700 text-amber-500",children:e.jsx("i",{className:`fa-solid ${n.type==="Weapon"?"fa-khanda":n.type==="Armor"?"fa-shirt":"fa-ring"} text-lg`})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-lg font-bold font-serif ${ke(n.rarity)}`,children:n.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-stone-500",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded border border-stone-700 bg-stone-900",children:n.rarity}),e.jsx("span",{children:n.type})]})]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-stone-800 flex items-center justify-center text-stone-400 hover:text-white hover:bg-stone-700 transition-all",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"p-6 font-serif space-y-4",children:[e.jsxs("div",{className:"bg-black/30 p-4 rounded-xl border border-stone-700/50 relative overflow-hidden group hover:border-amber-500/30 transition-colors",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-10 text-4xl",children:e.jsx("i",{className:"fa-solid fa-chart-bar"})}),e.jsxs("h4",{className:"font-bold text-amber-500 mb-3 text-sm flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-bolt text-xs"})," 属性加成"]}),e.jsx("div",{className:"space-y-2",children:Object.entries(n.stats).map(([o,c])=>e.jsxs("div",{className:"flex justify-between text-sm items-center border-b border-stone-800/50 pb-1 last:border-0",children:[e.jsx("span",{className:"text-stone-400",children:mv(o)}),e.jsx("span",{className:"font-mono text-emerald-400 font-bold",children:xv(o,c)})]},o))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-stone-800/40 p-3 rounded-lg border border-stone-700/50 text-center",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"佩戴限制"}),e.jsx("p",{className:"text-stone-300 font-medium text-sm",children:r})]}),e.jsxs("div",{className:"bg-stone-800/40 p-3 rounded-lg border border-stone-700/50 text-center",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"耐久度"}),e.jsx("p",{className:"text-stone-300 font-medium text-sm",children:"-- / --"})]})]}),e.jsxs("div",{className:"bg-stone-800/30 p-4 rounded-xl border border-stone-700/50",children:[e.jsx("h4",{className:"font-bold text-stone-500 mb-2 text-xs uppercase tracking-wider",children:"物品描述"}),e.jsxs("p",{className:"text-stone-400 leading-relaxed text-sm italic",children:['"',n.description,'"']})]})]})]})})},It=({label:n,icon:a,isActive:r,onClick:o})=>e.jsxs("button",{onClick:o,className:`relative px-5 py-2.5 text-sm font-bold transition-all duration-300 group overflow-hidden ${r?"text-amber-100":"text-stone-400 hover:text-amber-200"}`,children:[r&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-amber-900/40 to-transparent opacity-100"}),e.jsx("div",{className:`absolute bottom-0 left-0 w-full h-0.5 transform transition-transform duration-300 ${r?"bg-amber-400 scale-x-100":"bg-stone-700 scale-x-0 group-hover:scale-x-50"}`}),e.jsxs("div",{className:"relative z-10 flex items-center gap-2",children:[a&&e.jsx("i",{className:`${a} ${r?"text-amber-400 drop-shadow-[0_0_3px_rgba(251,191,36,0.5)]":"text-stone-500 group-hover:text-stone-300"}`}),e.jsx("span",{className:r?"drop-shadow-md":"",children:n})]})]}),Wn=({label:n,isActive:a,onClick:r})=>e.jsx("button",{onClick:r,className:`px-3 py-1 text-xs rounded border transition-all duration-200 ${a?"bg-amber-900/30 border-amber-500 text-amber-100 shadow-[0_0_10px_-3px_rgba(245,158,11,0.3)]":"bg-stone-800/30 border-stone-700 text-stone-500 hover:border-stone-500 hover:text-stone-300"}`,children:n}),Ai=({gender:n})=>{if(!n||n==="Universal")return null;const a=n==="Male"?"♂":"♀",r=n==="Male"?"text-sky-400":"text-pink-400";return e.jsx("div",{className:`w-5 h-5 rounded-full bg-stone-900/80 border border-stone-600 flex items-center justify-center font-bold text-xs ${r} shadow-sm`,children:a})},hv=({card:n})=>e.jsxs("div",{className:`group relative p-3 rounded-xl border border-opacity-60 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl h-full flex flex-col items-center bg-gradient-to-b from-stone-800/90 to-stone-900/95 overflow-hidden ${pt(n.rarity)}`,children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-1 opacity-50 ${n.rarity==="神品"?"bg-red-500":n.rarity==="圣品"?"bg-orange-500":"bg-transparent"}`}),e.jsxs("div",{className:"relative w-14 h-14 mb-3 rounded-full bg-stone-950 border border-stone-700 flex items-center justify-center shadow-inner group-hover:border-amber-500/50 transition-colors",children:[e.jsx("span",{className:"font-serif text-2xl text-stone-600 select-none group-hover:text-amber-500/50 transition-colors",children:n.name[0]}),e.jsx("div",{className:"absolute -bottom-1 -right-1 z-10",children:e.jsx(Ai,{gender:n.gender})})]}),e.jsxs("div",{className:"text-center w-full z-10 flex flex-col flex-grow",children:[e.jsx("p",{className:"font-bold font-serif text-stone-200 text-sm truncate w-full group-hover:text-amber-100 transition-colors",children:n.name}),e.jsx("p",{className:`text-xs font-semibold mt-1 mb-0.5 ${ke(n.rarity)}`,children:n.realm}),e.jsx("div",{className:"mt-auto pt-2 w-full border-t border-white/5",children:e.jsx("p",{className:"text-[10px] text-stone-500 truncate",children:n.title||"无称号"})})]})]}),pv=({skill:n})=>e.jsxs("div",{className:`group relative p-3 rounded-xl border border-opacity-60 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl h-full flex flex-col bg-gradient-to-b from-stone-800/90 to-stone-900/95 ${pt(n.rarity)}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-stone-950 border border-stone-700 flex items-center justify-center text-stone-500 group-hover:text-amber-500 transition-colors",children:e.jsx("i",{className:"fa-solid fa-scroll text-sm"})}),e.jsx(Ai,{gender:n.genderLock})]}),e.jsx("h5",{className:`font-bold text-sm truncate mb-1 ${ke(n.rarity)}`,children:n.name}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-cyan-400 font-mono mb-2 bg-cyan-900/20 px-1.5 py-0.5 rounded w-fit",children:[e.jsx("i",{className:"fa-solid fa-bolt"}),e.jsx("span",{children:n.cost})]}),e.jsx("p",{className:"text-xs text-stone-400 line-clamp-2 leading-relaxed flex-grow",children:n.description})]}),bv=({item:n})=>e.jsxs("div",{className:`group relative p-3 rounded-xl border border-opacity-60 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl h-full flex flex-col bg-gradient-to-b from-stone-800/90 to-stone-900/95 ${pt(n.rarity)}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-stone-950 border border-stone-700 flex items-center justify-center text-stone-500 group-hover:text-amber-500 transition-colors",children:e.jsx("i",{className:`fa-solid ${n.type==="Weapon"?"fa-khanda":n.type==="Armor"?"fa-shirt":"fa-ring"} text-sm`})}),e.jsx(Ai,{gender:n.genderLock})]}),e.jsx("h5",{className:`font-bold text-sm truncate mb-1 ${ke(n.rarity)}`,children:n.name}),e.jsx("div",{className:"text-xs text-stone-400 space-y-1 flex-grow",children:Object.entries(n.stats).slice(0,3).map(([a,r])=>e.jsxs("div",{className:"flex justify-between items-center bg-black/20 px-1.5 py-0.5 rounded",children:[e.jsx("span",{className:"opacity-70 text-[10px]",children:a}),e.jsxs("span",{className:"text-emerald-400 font-mono text-[10px]",children:["+",typeof r=="number"&&r<1?`${(r*100).toFixed(0)}%`:r]})]},a))})]}),gv=({card:n})=>e.jsxs("div",{className:`group relative p-3 rounded-xl border border-opacity-60 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl h-full flex flex-col items-center bg-gradient-to-b from-stone-800/90 to-stone-900/95 overflow-hidden ${pt(n.rarity)}`,children:[e.jsxs("div",{className:"relative w-14 h-14 mb-3 rounded-full bg-stone-950 border border-stone-700 flex items-center justify-center shadow-inner group-hover:border-emerald-500/50 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-dragon text-xl text-stone-600 group-hover:text-emerald-500/50 transition-colors"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 z-10",children:e.jsx(Ai,{gender:n.gender})})]}),e.jsxs("div",{className:"text-center w-full z-10 flex flex-col flex-grow",children:[e.jsx("p",{className:"font-bold font-serif text-stone-200 text-sm truncate w-full group-hover:text-emerald-100 transition-colors",children:n.name}),e.jsxs("p",{className:`text-xs font-semibold mt-1 mb-2 ${ke(n.rarity)}`,children:["[",n.rarity,"]"]}),e.jsx("p",{className:"text-[10px] text-stone-500 line-clamp-2",children:n.description})]})]}),Dh=({playerProfile:n,setPlayerProfile:a,onViewPet:r})=>{const[o,c]=v.useState("图鉴"),[d,m]=v.useState("男性角色"),[f,h]=v.useState("武器"),[p,b]=v.useState("雄性"),[g,w]=v.useState("All"),[N,j]=v.useState("男性专用"),[k,_]=v.useState(null),[C,S]=v.useState(null),[D,E]=v.useState(null),[A,z]=v.useState("default"),[I,L]=v.useState("default"),[T,P]=v.useState(!1),[M,R]=v.useState(null),[Q,Z]=v.useState(null),G=["神品","圣品","仙品","绝品","珍品","优品","良品","凡品"],H=()=>{if(!M)return;Z(null);const U=n.maleParty.some(W=>W.id===M.id),te=n.femaleParty.some(W=>W.id===M.id);if(U||te){Z("无法出售上阵中的角色卡！"),setTimeout(()=>Z(null),3e3),R(null);return}const ie=Oa[M.rarity]||0,B={...n,spiritStones:n.spiritStones+ie,cardCollection:n.cardCollection.filter(W=>W.id!==M.id)};a(B),R(null)},O=()=>{switch(o){case"图鉴":const U=[...n.cardCollection].filter(J=>J.gender===(d==="男性角色"?"Male":"Female")).sort((J,re)=>A==="rarity"?G.indexOf(J.rarity)-G.indexOf(re.rarity):0);return e.jsxs("div",{children:[e.jsxs("div",{className:"px-4 pt-2 flex justify-between items-center border-b border-stone-700 bg-stone-800/50 sticky top-0 backdrop-blur-sm z-10",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(It,{label:"男性角色",isActive:d==="男性角色",onClick:()=>m("男性角色")}),e.jsx(It,{label:"女性角色",isActive:d==="女性角色",onClick:()=>m("女性角色")})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("span",{children:"排序:"}),e.jsx(Wn,{label:"默认",isActive:A==="default",onClick:()=>z("default")}),e.jsx(Wn,{label:"稀有度",isActive:A==="rarity",onClick:()=>z("rarity")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-sm font-semibold transition-colors ${T?"text-red-400":"text-gray-400"}`,children:"出售模式"}),e.jsx("button",{onClick:()=>P(!T),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${T?"bg-red-600":"bg-stone-600"}`,children:e.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${T?"translate-x-6":"translate-x-1"}`})})]})]})]}),e.jsx("div",{className:"p-3 grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:U.map((J,re)=>e.jsxs("button",{onClick:()=>T?R(J):_(J),className:"relative text-left transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-amber-500 rounded-xl animate-slide-up",style:{animationDelay:`${re*50}ms`},children:[e.jsx(hv,{card:J}),T&&e.jsx("div",{className:"absolute inset-0 bg-red-900/80 flex items-center justify-center rounded-xl cursor-pointer backdrop-blur-sm border-2 border-red-500",children:e.jsxs("span",{className:"text-white font-bold text-lg drop-shadow-md flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-trash-can"})," 出售"]})})]},J.id))})]});case"通用技能库":const te={男性专用:"Male",女性专用:"Female",通用:"Universal"},ie=n.universalSkills.filter(J=>J.genderLock===te[N]),B=ie.reduce((J,re)=>((J[re.rarity]=J[re.rarity]||[]).push(re),J),{});return e.jsxs("div",{children:[e.jsx("div",{className:"px-4 pt-2 flex justify-between items-center border-b border-stone-700 bg-stone-800/50 sticky top-0 backdrop-blur-sm z-10",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(It,{label:"男性专用",isActive:N==="男性专用",onClick:()=>j("男性专用")}),e.jsx(It,{label:"女性专用",isActive:N==="女性专用",onClick:()=>j("女性专用")}),e.jsx(It,{label:"通用",isActive:N==="通用",onClick:()=>j("通用")})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[G.map(J=>B[J]&&B[J].length>0?e.jsxs("div",{children:[e.jsxs("h4",{className:`font-semibold mb-2 text-lg ${ke(J)}`,children:["【",J,"】"]}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:B[J].map((re,pe)=>e.jsx("button",{onClick:()=>S(re),className:"text-left transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-amber-500 rounded-xl animate-slide-up",style:{animationDelay:`${pe*50}ms`},children:e.jsx(pv,{skill:re})},re.id))})]},J):null),ie.length===0&&e.jsx("div",{className:"text-center text-gray-500 pt-10",children:e.jsx("p",{children:"该分类下暂无技能。"})})]})]});case"装备库":const W={武器:"Weapon",衣服:"Armor",饰品:"Accessory"},ne=n.equipmentInventory.filter(J=>J.type===W[f]).filter(J=>g==="All"?!0:g==="Universal"?!J.genderLock||J.genderLock==="Universal":J.genderLock===g).sort((J,re)=>I==="rarity"?G.indexOf(J.rarity)-G.indexOf(re.rarity):0);return e.jsxs("div",{children:[e.jsxs("div",{className:"px-4 pt-2 flex justify-between items-center border-b border-stone-700 bg-stone-800/50 sticky top-0 backdrop-blur-sm z-10",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(It,{label:"武器",isActive:f==="武器",onClick:()=>{h("武器"),w("All")}}),e.jsx(It,{label:"衣服",isActive:f==="衣服",onClick:()=>{h("衣服"),w("All")}}),e.jsx(It,{label:"饰品",isActive:f==="饰品",onClick:()=>{h("饰品"),w("All")}})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("span",{children:"排序:"}),e.jsx(Wn,{label:"默认",isActive:I==="default",onClick:()=>L("default")}),e.jsx(Wn,{label:"稀有度",isActive:I==="rarity",onClick:()=>L("rarity")})]})]}),e.jsxs("div",{className:"px-4 py-2 flex items-center gap-3 bg-stone-800/50 border-b border-stone-700",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-400",children:"筛选:"}),e.jsx(Wn,{label:"全部",isActive:g==="All",onClick:()=>w("All")}),e.jsx(Wn,{label:"男性专用",isActive:g==="Male",onClick:()=>w("Male")}),e.jsx(Wn,{label:"女性专用",isActive:g==="Female",onClick:()=>w("Female")}),e.jsx(Wn,{label:"通用",isActive:g==="Universal",onClick:()=>w("Universal")})]}),e.jsxs("div",{className:"p-3 grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:[ne.map((J,re)=>e.jsx("button",{onClick:()=>E(J),className:"text-left transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-amber-500 rounded-xl animate-slide-up",style:{animationDelay:`${re*50}ms`},children:e.jsx(bv,{item:J})},J.id)),ne.length===0&&e.jsx("div",{className:"col-span-full text-center text-gray-500 pt-10",children:e.jsx("p",{children:"该分类下暂无装备。"})})]})]});case"日常道具":return e.jsxs("div",{className:"p-6 text-center text-gray-500 font-serif flex flex-col items-center justify-center h-full",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📦"}),e.jsx("p",{children:"此功能尚未开放。"}),e.jsx("p",{className:"mt-2",children:"未来的丹药、材料等消耗品将在此处展示。"})]});case"兽宠":const X=[...n.petCollection].filter(J=>J.gender===(p==="雄性"?"Male":"Female")).sort((J,re)=>G.indexOf(J.rarity)-G.indexOf(re.rarity));return e.jsxs("div",{children:[e.jsx("div",{className:"px-4 pt-2 flex justify-between items-center border-b border-stone-700 bg-stone-800/50 sticky top-0 backdrop-blur-sm z-10",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(It,{label:"雄性",isActive:p==="雄性",onClick:()=>b("雄性")}),e.jsx(It,{label:"雌性",isActive:p==="雌性",onClick:()=>b("雌性")})]})}),e.jsxs("div",{className:"p-3 grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:[X.map((J,re)=>e.jsx("button",{onClick:()=>r(J),className:"relative text-left transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-amber-500 rounded-xl animate-slide-up",style:{animationDelay:`${re*50}ms`},children:e.jsx(gv,{card:J})},J.id)),X.length===0&&e.jsx("div",{className:"col-span-full text-center text-gray-500 pt-10",children:e.jsx("p",{children:"该分类下暂无兽宠。"})})]})]})}};return e.jsxs("div",{className:"h-full flex flex-col font-serif text-gray-300 relative overflow-hidden bg-gradient-to-b from-stone-950 via-stone-900 to-black",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none z-0",children:[e.jsx("div",{className:"absolute inset-0 opacity-5 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] mix-blend-overlay"}),e.jsx("div",{className:"absolute -top-20 -right-20 w-96 h-96 bg-amber-600/10 rounded-full blur-[100px] animate-pulse-slow"}),e.jsx("div",{className:"absolute -bottom-20 -left-20 w-96 h-96 bg-emerald-600/5 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-amber-400/30 rounded-full blur-sm animate-float",style:{animationDuration:"8s"}}),e.jsx("div",{className:"absolute top-3/4 right-1/3 w-3 h-3 bg-amber-100/20 rounded-full blur-sm animate-float",style:{animationDuration:"12s",animationDelay:"2s"}})]}),e.jsxs("div",{className:"flex-shrink-0 px-4 flex space-x-1 border-b border-stone-700/50 relative z-10 bg-stone-900/50 backdrop-blur-sm pt-2 overflow-x-auto scrollbar-none",children:[e.jsx(It,{label:"图鉴",icon:"fa-solid fa-address-book",isActive:o==="图鉴",onClick:()=>c("图鉴")}),e.jsx(It,{label:"兽宠",icon:"fa-solid fa-paw",isActive:o==="兽宠",onClick:()=>c("兽宠")}),e.jsx(It,{label:"通用技能库",icon:"fa-solid fa-book-journal-whills",isActive:o==="通用技能库",onClick:()=>c("通用技能库")}),e.jsx(It,{label:"装备库",icon:"fa-solid fa-shield-halved",isActive:o==="装备库",onClick:()=>c("装备库")}),e.jsx(It,{label:"日常道具",icon:"fa-solid fa-box-open",isActive:o==="日常道具",onClick:()=>c("日常道具")})]}),e.jsx("div",{className:"flex-grow overflow-y-auto relative z-10 scrollbar-thin scrollbar-thumb-amber-700/50 scrollbar-track-stone-900/30 pb-4",children:O()}),k&&e.jsx(Ei,{card:k,onClose:()=>_(null),playerProfile:n,setPlayerProfile:a,onViewPet:r}),C&&e.jsx(fu,{skill:C,onClose:()=>S(null)}),D&&e.jsx(fv,{item:D,onClose:()=>E(null)}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in backdrop-blur-sm",children:e.jsxs("div",{className:"relative bg-stone-900 border-2 border-red-900/50 rounded-2xl w-full max-w-md shadow-[0_0_50px_rgba(220,38,38,0.3)] p-8 text-center font-serif overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/black-scales.png')] opacity-20"}),e.jsx("div",{className:"absolute -top-10 -right-10 w-40 h-40 bg-red-600/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-orange-600/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-900/20 rounded-full flex items-center justify-center border border-red-500/30",children:e.jsx("i",{className:"fa-solid fa-coins text-3xl text-red-400"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2 text-shadow-md",children:"确认出售"}),e.jsxs("p",{className:"text-stone-300 mb-6 leading-relaxed",children:["你确定要出售 ",e.jsxs("span",{className:`font-bold text-lg ${ke(M.rarity)}`,children:["[",M.rarity,"] ",M.name]})," 吗?",e.jsx("br",{}),e.jsx("span",{className:"text-xs text-red-400/80",children:"出售后无法找回，请三思。"})]}),e.jsxs("div",{className:"bg-black/40 rounded-lg py-3 px-6 mb-6 border border-white/5 inline-block",children:[e.jsx("span",{className:"text-stone-400 text-sm mr-2",children:"预计获得:"}),e.jsxs("span",{className:"text-xl text-emerald-400 font-bold text-shadow-glow",children:[Oa[M.rarity]||0," 灵石"]})]}),Q&&e.jsxs("div",{className:"bg-red-900/30 border border-red-500/50 text-red-200 text-sm py-2 px-4 rounded mb-6 animate-shake",children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation mr-2"}),Q]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-2",children:[e.jsx("button",{onClick:()=>R(null),className:"px-8 py-2.5 bg-stone-800 hover:bg-stone-700 text-stone-300 border border-stone-600 rounded-lg font-semibold transition-all duration-200 hover:border-stone-500",children:"取消"}),e.jsx("button",{onClick:H,className:"px-8 py-2.5 bg-gradient-to-r from-red-700 to-red-600 text-white hover:from-red-600 hover:to-red-500 rounded-lg font-bold shadow-lg shadow-red-900/50 border border-red-400/30 transition-all duration-200 transform hover:scale-105",children:"确认出售"})]})]})]})})]})},yv=({isOpen:n,onClose:a,bountyBoard:r,onViewTarget:o,onAccept:c,onClaim:d,onRefresh:m,onAddTarget:f,isLoading:h})=>{const[p,b]=v.useState("悬赏中");if(!n)return null;const g=r.filter(j=>j.status===p),w=({endTime:j})=>{const[k,_]=v.useState(j-Date.now());v.useEffect(()=>{const S=setInterval(()=>{const D=j-Date.now();D<=0&&clearInterval(S),_(D)},1e3);return()=>clearInterval(S)},[j]);const C=S=>{if(S<=0)return"即将完成...";const D=Math.floor(S/1e3),E=Math.floor(D/3600),A=Math.floor(D%3600/60),z=D%60;return`${E.toString().padStart(2,"0")}:${A.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}`};return e.jsx("span",{className:"font-mono text-amber-400",children:C(k)})},N=j=>{switch(j.status){case"悬赏中":return e.jsx("button",{onClick:()=>c(j.id),className:"bg-green-600/80 text-white font-bold px-4 py-2 rounded-md hover:bg-green-500/80 transition-colors",children:"接受悬赏"});case"追踪中":return e.jsxs("div",{className:"text-center",onClick:k=>k.stopPropagation(),children:[e.jsx("p",{className:"text-sm text-gray-400",children:"剩余时间"}),e.jsx(w,{endTime:j.endTime})]});case"已完成":return e.jsx("button",{onClick:()=>d(j.id),className:"bg-yellow-500/80 text-white font-bold px-4 py-2 rounded-md hover:bg-yellow-400/80 transition-colors animate-pulse-slow",children:"查看结果"});case"已结束":return e.jsx("span",{className:"text-gray-500 font-semibold",children:"已结束"});default:return null}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-4xl h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:"红尘录"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-shrink-0 p-4 flex items-center justify-between border-b border-stone-700 bg-black/10",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>b("悬赏中"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200 ${p==="悬赏中"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"悬赏中"}),e.jsx("button",{onClick:()=>b("追踪中"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200 ${p==="追踪中"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"追踪中"}),e.jsx("button",{onClick:()=>b("已完成"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200 ${p==="已完成"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"已完成"}),e.jsx("button",{onClick:()=>b("已结束"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors duration-200 ${p==="已结束"?"bg-amber-500/20 text-amber-300":"bg-stone-700/50 text-gray-300 hover:bg-stone-600/50"}`,children:"已结束"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>f("Female"),disabled:h,className:"px-3 py-1 text-xs bg-pink-500/20 text-pink-300 rounded-md hover:bg-pink-500/40 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"生成中...":"添加女性目标"}),e.jsx("button",{onClick:()=>f("Male"),disabled:h,className:"px-3 py-1 text-xs bg-blue-500/20 text-blue-300 rounded-md hover:bg-blue-500/40 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"生成中...":"添加男性目标"}),e.jsxs("button",{onClick:m,disabled:h,className:"px-3 py-1 text-xs bg-yellow-500/20 text-yellow-300 rounded-md hover:bg-yellow-500/40 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:`fa-solid fa-sync ${h?"animate-spin":""}`})," 刷新悬赏"]})]})]}),e.jsx("div",{className:"flex-grow p-6 overflow-y-auto",children:g.length>0?e.jsx("div",{className:"space-y-4",children:g.map(j=>e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50 flex justify-between items-center",children:[e.jsxs("div",{className:"cursor-pointer flex-grow",onClick:()=>o(j),children:[e.jsxs("h3",{className:`text-xl font-bold font-serif ${ke(j.character.rarity)}`,children:[j.name," ",e.jsxs("span",{className:"text-base font-normal text-gray-400",children:["[",j.character.rarity,"]"]})]}),e.jsxs("p",{className:"text-sm text-gray-400 italic mt-1",children:["线索: ",j.locationHint]}),e.jsxs("p",{className:"text-sm text-pink-400 mt-1",children:["特征: ",j.specialTrait]})]}),e.jsx("div",{className:"w-32 text-center flex-shrink-0",children:N(j)})]},j.id))}):e.jsxs("div",{className:"text-center text-gray-500 pt-10",children:[e.jsx("p",{className:"text-4xl mb-4",children:"📜"}),e.jsx("p",{children:"此榜单上暂无记录。"})]})})]})})},vv=({isOpen:n,onClose:a,bounty:r,onOutcome:o})=>n?e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-2xl h-auto max-h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsxs("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:["任务报告：",r.name]}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-amber-400",children:"追捕日志"}),e.jsx("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:e.jsx("p",{className:"text-gray-300 italic leading-relaxed",children:r.trackingLog||"日志在传输过程中遗失了..."})}),e.jsx("h3",{className:"text-lg font-semibold text-amber-400 mt-6",children:"如何处置?"}),e.jsx("p",{className:"text-gray-400",children:"目标已被成功制服，现在，你来决定Ta的命运。"})]}),e.jsxs("div",{className:"p-4 bg-black/20 border-t border-stone-700 flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>o("killed"),className:"px-6 py-2 rounded-md font-semibold text-white bg-red-800 hover:bg-red-700 transition-colors",children:"杀害"}),e.jsx("button",{onClick:()=>o("imprisoned"),className:"px-6 py-2 rounded-md font-semibold text-white bg-sky-600 hover:bg-sky-500 transition-colors",children:"压入大牢"})]})]})}):null,jv=({isOpen:n,onClose:a,playerProfile:r,onUpdateProfile:o,onOpenSurveillance:c,busyCharacterIds:d,onOpenSelector:m,etiquetteSystem:f})=>{const[h,p]=v.useState("青楼"),[b,g]=v.useState(!1),{businessDistrict:w,cardCollection:N}=r,j=E=>{if(!f)return{language:[],behavior:[]};const A=E,z=f.languageEtiquettes.filter(L=>{var T;return L.isDistributed&&((T=L.distributions)==null?void 0:T.some(P=>P.shopType===A&&P.status==="distributed"))}),I=f.behaviorDressEtiquettes.filter(L=>{var T;return L.isDistributed&&((T=L.distributions)==null?void 0:T.some(P=>P.shopType===A&&P.status==="distributed"))});return{language:z,behavior:I}},k=v.useMemo(()=>j(h),[h,f]),_=v.useMemo(()=>{if(!w)return{};const E={};return w.shops.forEach(A=>{E[A.id]=zh(r,A.id)}),E},[r,w]);if(!n)return null;const C=()=>{if(!w)return N.filter(A=>!d.has(A.id));const E=new Set(w.shops.flatMap(A=>A.staff.map(z=>z.characterId)));return N.filter(A=>!E.has(A.id)&&!d.has(A.id))},S=(E,A,z)=>{if(!w)return;const I=JSON.parse(JSON.stringify(w)),L=I.shops.find(T=>T.id===E);L&&(I.shops.forEach(T=>{T.staff=T.staff.filter(P=>P.characterId!==z)}),L.staff.push({characterId:z,positionId:A}),o({...r,businessDistrict:I}))},D=(E,A)=>{if(!w)return;const z=JSON.parse(JSON.stringify(w)),I=z.shops.find(L=>L.id===E);I&&(I.staff=I.staff.filter(L=>L.characterId!==A),o({...r,businessDistrict:z}))};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-4xl h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:w?w.name:"产业管理"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),w?e.jsx("div",{className:"flex-grow p-6 overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 space-y-4",children:[e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"font-semibold text-amber-400 mb-2",children:"街区总览"}),e.jsxs("p",{className:"text-gray-300",children:["等级: ",e.jsx("span",{className:"font-mono",children:w.level})]}),e.jsxs("p",{className:"text-gray-300",children:["店铺数量: ",e.jsx("span",{className:"font-mono",children:w.shops.length})]})]}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50 h-96 overflow-y-auto",children:[e.jsx("h3",{className:"font-semibold text-amber-400 mb-2",children:"经营日志"}),e.jsx("ul",{className:"space-y-2 text-sm",children:w.log.map((E,A)=>e.jsxs("li",{className:"text-gray-400",children:[e.jsxs("span",{className:"font-mono text-gray-500 mr-2",children:["[",E.timestamp,"]"]}),E.message]},A))})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"flex border-b border-stone-700 mb-4",children:["青楼","角斗场","炼丹房","拍卖行","情报阁"].map(E=>{const A=w.shops.some(z=>z.type===E);return e.jsx("button",{disabled:!A,onClick:()=>p(E),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 disabled:text-gray-600 disabled:cursor-not-allowed ${h===E?"bg-stone-700/80 text-amber-400 border-b-2 border-amber-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:E},E)})}),e.jsxs("div",{className:"space-y-4",children:[b&&(k.language.length>0||k.behavior.length>0)&&e.jsxs("div",{className:"mb-4 p-4 bg-pink-900/20 rounded-lg border border-pink-500/30",children:[e.jsxs("h3",{className:"text-lg font-bold text-pink-300 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-scroll"}),"当前生效的礼仪规范"]}),k.language.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-pink-400 mb-2",children:"💬 语言铁律"}),e.jsx("div",{className:"space-y-2",children:k.language.map(E=>e.jsxs("div",{className:"p-2 bg-stone-800/50 rounded border border-pink-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-white text-sm",children:E.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["👥 ",E.applicableRoles.join(", ")]})]}),e.jsx("p",{className:"text-xs text-gray-300 line-clamp-2",children:E.content})]},E.id))})]}),k.behavior.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-400 mb-2",children:"👗 行为着装铁律"}),e.jsx("div",{className:"space-y-2",children:k.behavior.map(E=>e.jsxs("div",{className:"p-2 bg-stone-800/50 rounded border border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-white text-sm",children:E.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["👥 ",E.applicableRoles.join(", ")]})]}),e.jsxs("div",{className:"text-xs text-gray-300",children:[E.dressCode.upper&&e.jsxs("p",{className:"line-clamp-1",children:["上身: ",E.dressCode.upper]}),E.dressCode.lower&&e.jsxs("p",{className:"line-clamp-1",children:["下身: ",E.dressCode.lower]})]})]},E.id))})]})]}),w.shops.filter(E=>E.type===h).map(E=>e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"font-semibold text-lg text-cyan-400",children:[E.type," (Lv. ",E.level,")"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-400",children:["预期日收入: ",e.jsxs("span",{className:"font-mono text-amber-400",children:[_[E.id]||0," 灵石"]})]}),e.jsxs("button",{onClick:()=>g(!b),className:`text-xs px-2 py-1 rounded-md transition-colors ${b?"bg-pink-600/50 text-pink-300":"bg-stone-600/50 text-gray-300 hover:bg-pink-600/30"}`,children:[e.jsx("i",{className:"fa-solid fa-scroll mr-1"}),"礼仪 (",k.language.length+k.behavior.length,")"]}),e.jsx("button",{onClick:()=>c(E),className:"text-xs bg-purple-600/50 text-purple-300 px-2 py-1 rounded-md hover:bg-purple-600/80",children:"监视"})]})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(Yl).filter(([,A])=>A.shop===E.type).map(([A,z])=>{const I=E.staff.find(T=>T.positionId===A),L=I?N.find(T=>T.id===I.characterId):null;return e.jsxs("div",{className:"flex items-center justify-between bg-stone-800/50 p-2 rounded-md",children:[e.jsx("span",{className:"text-gray-300",children:z.name}),L?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-amber-300",children:L.name}),e.jsx("button",{onClick:()=>D(E.id,L.id),className:"text-red-500 hover:text-red-400 text-xs",children:"卸下"})]}):e.jsx("button",{onClick:()=>{const T=C();m(`为【${z.name}】选择员工`,T,P=>{S(E.id,A,P.id)})},className:"bg-stone-700 text-white text-sm rounded px-2 py-1 hover:bg-stone-600",children:"选择员工"})]},A)})})]},E.id))]})]})]})}):e.jsx("div",{className:"flex-grow flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("p",{className:"text-4xl mb-4",children:"🏯"}),e.jsx("p",{children:"你还未拥有自己的产业。"}),e.jsx("p",{className:"text-sm mt-2",children:"完成特定任务或积累足够资本，开启你的商业帝国吧！"})]})})]})})},Nv=({isOpen:n,onClose:a,challenge:r,onAccept:o,onDecline:c})=>n?e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-800/90 backdrop-blur-lg w-full max-w-md shadow-2xl flex flex-col items-center p-6 text-center",onClick:d=>d.stopPropagation(),children:[e.jsx("div",{className:"p-4 text-center",children:e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:"挑战"})}),e.jsxs("div",{className:"p-6 font-serif flex flex-col justify-center items-center",children:[e.jsx("p",{className:"text-4xl mb-4",children:"⚔️"}),e.jsxs("p",{className:"text-white text-lg",children:[e.jsx("span",{className:"font-bold text-red-400",children:r.challengerName})," 向你发起了挑战！"]}),e.jsxs("p",{className:"text-amber-300 mt-2 italic",children:['"',r.reason,'"']}),e.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[e.jsx("button",{onClick:c,className:"px-6 py-2 bg-stone-600 hover:bg-stone-500 rounded-md font-semibold text-white",children:"拒绝挑战"}),e.jsx("button",{onClick:o,className:"px-6 py-2 bg-red-700 text-white hover:bg-red-600 rounded-md font-bold",children:"接受挑战"})]})]})]})}):null,wv=({log:n,onClose:a})=>e.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"bg-slate-800 w-full max-w-2xl h-4/5 rounded-xl shadow-2xl border border-slate-700 overflow-hidden backdrop-blur-lg bg-slate-800/80 flex flex-col",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-700 flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-white font-serif",children:"战斗记录"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow",children:e.jsx("div",{className:"prose prose-invert max-w-none prose-p:text-gray-300 prose-p:my-2 font-serif",children:n.map((r,o)=>e.jsx("p",{className:`${r.startsWith(">")?"text-sky-400":""}`,children:r},o))})})]})}),kv=({endTime:n})=>{const[a,r]=v.useState(n-Date.now());if(v.useEffect(()=>{if(a<=0)return;const m=setInterval(()=>{const f=n-Date.now();f<=0&&clearInterval(m),r(f)},1e3);return()=>clearInterval(m)},[n,a]),a<=0)return e.jsx("span",{className:"text-green-400 font-bold",children:"培育完成"});const o=Math.floor(a/(1e3*60*60)),c=Math.floor(a%(1e3*60*60)/(1e3*60)),d=Math.floor(a%(1e3*60)/1e3);return e.jsxs("span",{className:"font-mono text-lg tracking-wider",children:[String(o).padStart(2,"0"),":",String(c).padStart(2,"0"),":",String(d).padStart(2,"0")]})},Sv=({slot:n,playerProfile:a,onStartCultivation:r,onClaimCultivation:o,onGetLiveMonitoring:c,busyCharacterIds:d,onOpenSelector:m})=>{const[f,h]=v.useState(null),[p,b]=v.useState(null),[g,w]=v.useState("live"),[N,j]=v.useState("待机中..."),[k,_]=v.useState(!1);v.useEffect(()=>{console.log(`[育灵仓UI] 培育仓 #${n.slotId} 状态: ${n.status}, endTime: ${n.endTime}, now: ${Date.now()}, 剩余时间: ${n.endTime-Date.now()}ms`)},[n.status,n.endTime,n.slotId]);const C=()=>{f&&p&&r(n.slotId,f.id,p.id)},S=async()=>{_(!0);try{const E=await c(n.slotId);j(E)}catch{j("监视信号中断...")}finally{_(!1)}},D=E=>{const A=E==="A"?f:p,z=()=>{if(E==="A"){const I=[...a.cardCollection,...a.petCollection].filter(L=>!d.has(L.id));m("选择亲本 A",I,L=>{h(L),b(null)})}else{if(!f)return;const I="skill"in f;let L=[];I?L=a.cardCollection.filter(T=>T.gender!==f.gender&&!d.has(T.id)):L=a.petCollection.filter(T=>T.gender!==f.gender&&!d.has(T.id)),m("选择亲本 B",L,T=>{b(T)})}};return e.jsx("button",{onClick:z,disabled:E==="B"&&!f,className:"w-full md:w-48 h-40 md:h-64 bg-black/30 rounded-lg flex flex-col items-center justify-center ornate-border border-dashed border-stone-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:border-amber-500/50",children:A?e.jsxs("div",{className:`w-full h-full rounded-lg p-3 flex flex-col items-center justify-center text-center ${pt(A.rarity)}`,children:[e.jsx("p",{className:"font-bold text-base md:text-lg truncate w-full px-2 text-stone-100 text-shadow-sm",children:A.name}),e.jsx("p",{className:`text-xs md:text-sm mt-1 ${ke(A.rarity)}`,children:A.rarity})]}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-stone-500 text-3xl md:text-4xl mb-2",children:"+"}),e.jsxs("span",{className:"text-stone-500 text-xs",children:["选择",E==="A"?"亲本A":"亲本B"]})]})})};return n.status==="Empty"?e.jsxs("div",{className:"flex flex-col items-center w-full px-2 md:px-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8 items-center w-full max-w-2xl",children:[D("A"),e.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gradient-gold",children:"🧬"}),D("B")]}),e.jsx("button",{onClick:C,disabled:!f||!p,className:"mt-6 px-8 py-3 bg-gradient-to-r from-green-500 to-teal-600 text-white font-bold rounded-full shadow-glow-green disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 hover:scale-105 text-base md:text-lg",children:"开始培育"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-3 md:gap-4 w-full px-2 md:px-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:[e.jsxs("div",{className:"w-full max-w-lg bg-gradient-to-br from-stone-800/80 to-stone-900/80 rounded-xl p-4 border border-stone-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg md:text-xl font-bold text-amber-400",children:"培育状态"}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${n.status==="Breeding"?"bg-cyan-500/20 text-cyan-300":"bg-green-500/20 text-green-300"}`,children:n.status==="Breeding"?"进行中":"已完成"})]}),e.jsx("div",{className:"text-center py-4 bg-black/30 rounded-lg",children:n.status==="Breeding"?e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-400 text-sm mb-2",children:"能量融合中..."}),e.jsx("div",{className:"text-2xl md:text-3xl font-mono text-cyan-300",children:e.jsx(kv,{endTime:n.endTime})})]}):e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"text-4xl mb-2",children:"✨"}),e.jsx("p",{className:"text-green-400 font-bold text-xl md:text-2xl",children:"培育完成！"}),e.jsx("p",{className:"text-stone-400 text-sm mt-2",children:"灵胎已成熟，请开启查看"})]})})]}),e.jsxs("div",{className:"w-full max-w-lg",children:[e.jsx("h4",{className:"text-sm text-stone-400 mb-2 text-center",children:"融合亲本"}),e.jsxs("div",{className:"flex gap-3 md:gap-4 justify-center",children:[e.jsxs("div",{className:`flex-1 max-w-[45%] bg-black/50 rounded-lg p-3 flex flex-col items-center justify-center text-center ornate-border ${pt(n.parentA.rarity)}`,children:[e.jsx("p",{className:"font-bold text-sm md:text-base truncate w-full text-stone-100",children:n.parentA.name}),e.jsx("p",{className:`text-xs ${ke(n.parentA.rarity)}`,children:n.parentA.rarity})]}),e.jsx("div",{className:"flex items-center justify-center text-amber-400",children:e.jsx("span",{className:"text-xl",children:"✕"})}),e.jsxs("div",{className:`flex-1 max-w-[45%] bg-black/50 rounded-lg p-3 flex flex-col items-center justify-center text-center ornate-border ${pt(n.parentB.rarity)}`,children:[e.jsx("p",{className:"font-bold text-sm md:text-base truncate w-full text-stone-100",children:n.parentB.name}),e.jsx("p",{className:`text-xs ${ke(n.parentB.rarity)}`,children:n.parentB.rarity})]})]})]}),e.jsxs("div",{className:"w-full max-w-lg bg-black/50 rounded-lg ornate-border border-stone-700 flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 flex border-b border-stone-700",children:[e.jsxs("button",{onClick:()=>w("live"),className:`flex-1 py-2 px-2 text-xs md:text-sm font-semibold transition-colors flex items-center justify-center gap-1 ${g==="live"?"bg-stone-700 text-amber-400":"text-stone-400 hover:bg-stone-800"}`,children:[e.jsx("span",{children:"📡"}),e.jsx("span",{children:"实时监视"})]}),e.jsxs("button",{onClick:()=>w("log"),className:`flex-1 py-2 px-2 text-xs md:text-sm font-semibold transition-colors flex items-center justify-center gap-1 ${g==="log"?"bg-stone-700 text-amber-400":"text-stone-400 hover:bg-stone-800"}`,children:[e.jsx("span",{children:"📋"}),e.jsx("span",{children:"监视日志"})]})]}),e.jsx("div",{className:"p-3 h-32 md:h-40 overflow-y-auto scrollbar-xianxia text-xs md:text-sm text-gray-300",children:g==="live"?e.jsx("div",{className:"whitespace-pre-wrap",children:k?"正在连接信号...":N}):e.jsx("div",{className:"space-y-1",children:n.monitoringLog.length>0?n.monitoringLog.map((E,A)=>e.jsxs("p",{className:"text-gray-300",children:[e.jsxs("span",{className:"text-amber-400",children:["[",E.timestamp,"]"]})," ",E.message]},`${E.timestamp}-${A}`)):e.jsx("p",{className:"text-stone-500 text-center",children:"暂无日志记录"})})}),g==="live"&&n.status==="Breeding"&&e.jsx("button",{onClick:S,className:"flex-shrink-0 w-full py-2 bg-cyan-600/20 hover:bg-cyan-600/40 text-cyan-300 text-xs transition-colors",children:"🔄 刷新监视信号"})]}),n.status==="Ready"&&e.jsx("button",{onClick:()=>o(n.slotId),className:"w-full max-w-lg mt-2 px-8 py-4 bg-gradient-to-r from-amber-500 to-yellow-400 text-black font-bold text-lg rounded-xl shadow-glow-gold animate-pulse-slow transition-all duration-300 hover:scale-105 hover:shadow-2xl",children:"✨ 开启灵胎 ✨"})]})},Cv=({isOpen:n,onClose:a,playerProfile:r,cultivationSlots:o,onStartCultivation:c,onClaimCultivation:d,onGetLiveMonitoring:m,busyCharacterIds:f,onOpenSelector:h})=>{const[p,b]=v.useState(1);if(!n)return null;const g=o.find(w=>w.slotId===p);return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"w-full max-w-4xl h-[90vh] ornate-border border-xianxia-gold-600 bg-stone-900 rounded-2xl shadow-2xl flex flex-col overflow-hidden",onClick:w=>w.stopPropagation(),style:{backgroundColor:"#1c1917"},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/50 border-b border-xianxia-gold-600/50",children:[e.jsx("h2",{className:"text-3xl font-bold text-gold-solid text-shadow-glow tracking-wide",children:"育灵轩"}),e.jsx("button",{onClick:a,className:"text-amber-400 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex flex-grow",children:[e.jsxs("div",{className:"w-1/4 border-r border-stone-700/50 p-4 flex flex-col gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-amber-400 mb-2",children:"培育仓"}),o.map(w=>e.jsxs("button",{onClick:()=>b(w.slotId),className:`w-full p-3 rounded-lg text-left transition-all duration-200 border-2 ${p===w.slotId?"bg-stone-700/80 border-amber-500":"bg-stone-800/50 border-transparent hover:bg-stone-700/50"}`,children:[e.jsxs("p",{className:`font-bold ${p===w.slotId?"text-amber-100":"text-stone-300"}`,children:["培育仓 #",w.slotId]}),e.jsxs("p",{className:`text-sm ${w.status==="Empty"?"text-stone-400":w.status==="Breeding"?"text-cyan-400":"text-green-400"}`,children:[e.jsx("span",{className:"text-stone-400",children:"状态:"})," ",w.status]})]},w.slotId))]}),e.jsx("div",{className:"w-3/4 p-6 flex items-center justify-center",children:g?e.jsx(Sv,{slot:g,playerProfile:r,onStartCultivation:c,onClaimCultivation:d,onGetLiveMonitoring:m,busyCharacterIds:f,onOpenSelector:h}):e.jsx("p",{children:"选择一个培育仓以开始。"})})]})]})})},na=({isOpen:n,onClose:a,title:r,children:o,size:c="md",showDragIndicator:d=!0})=>{if(v.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),!n)return null;const m={sm:"md:max-w-md",md:"md:max-w-2xl",lg:"md:max-w-4xl",xl:"md:max-w-6xl",full:"md:max-w-full md:m-4"};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-end md:items-center justify-center p-0 md:p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:`
          modal-responsive
          ornate-border border-xianxia-gold-600 
          bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 
          w-full ${m[c]}
          h-[90vh] md:h-auto md:max-h-[85vh]
          rounded-t-2xl md:rounded-xl
          shadow-2xl overflow-hidden backdrop-blur-lg 
          flex flex-col
          animate-slide-up-mobile
        `,onClick:f=>f.stopPropagation(),children:[d&&e.jsx("div",{className:"md:hidden flex-shrink-0 pt-2 pb-1 bg-black/10",children:e.jsx("div",{className:"modal-drag-indicator"})}),e.jsx("div",{className:"flex-shrink-0 bg-black/20 border-b border-stone-700/50",children:e.jsxs("div",{className:"flex justify-between items-center p-3 md:p-4",children:[e.jsx("h2",{className:"text-lg md:text-2xl font-bold text-gradient-gold text-shadow-glow font-serif truncate pr-2",children:r}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors touch-target flex-shrink-0","aria-label":"关闭",children:e.jsx("i",{className:"fa-solid fa-times text-xl md:text-2xl"})})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto scroll-mobile scrollbar-xianxia p-3 md:p-6",children:o})]})})},_v=({isOpen:n,onClose:a,gameState:r,onGenerateAllDrafts:o,onStartAllOptimization:c,onOptimizeChallenge:d})=>{const{gauntletSystem:m}=r,f=m.currentEvent,[h,p]=v.useState(new Set([1])),[b,g]=v.useState(null),[w,N]=v.useState(!1),j=T=>{p(P=>{const M=new Set(P);return M.has(T)?M.delete(T):M.add(T),M})},k=T=>{const P=[];for(let M=1;M<=5;M++)P.push(e.jsx("span",{className:M<=T?"text-amber-400":"text-gray-600",children:"★"},M));return e.jsx("span",{className:"text-sm",children:P})},_=T=>T.draftVersion?T.optimizationProgress===0?{text:"已生成草稿",color:"text-blue-400",icon:"◐"}:T.optimizationProgress<3?{text:`优化中 (${T.optimizationProgress}/3)`,color:"text-yellow-400",icon:"◑"}:{text:"✓ 已完成三轮优化",color:"text-green-400",icon:"●"}:{text:"待生成",color:"text-gray-400",icon:"○"},S=(()=>{if(!f)return{completed:0,total:18};let T=0;return f.rounds.forEach(P=>{P.challenge&&(T+=P.challenge.optimizationProgress||0)}),{completed:T,total:18}})(),D=async()=>{if(o){N(!0);try{await o()}finally{N(!1)}}},E=async()=>{if(c){N(!0);try{await c()}finally{N(!1)}}},A=async(T,P)=>{if(d){N(!0);try{await d(T,P)}finally{N(!1)}}},z=T=>{if(!f)return null;const P=f.rounds.find(M=>M.roundNumber===T);return(P==null?void 0:P.challenge)||null},I=()=>{if(!b||!f)return null;const T=z(b.roundNumber);if(!T)return null;let P="",M="";if(b.type==="draft")P=`第${b.roundNumber}轮关卡 - 初始草稿`,M=T.draftVersion||"草稿尚未生成";else if(b.type==="optimization"&&b.optimizationRound){const R=`optimization${b.optimizationRound}`,Q=T[R];P=`第${b.roundNumber}轮关卡 - 第${b.optimizationRound}次优化`,Q?M=`【批判分析】
${Q.critique}

【发现问题】
${Q.issues.map(Z=>`• ${Z}`).join(`
`)}

【改进建议】
${Q.suggestions.map(Z=>`• ${Z}`).join(`
`)}

【修改内容】
${Q.changes.map(Z=>`• ${Z}`).join(`
`)}

【改进总结】
${Q.improvementSummary}`:M="此轮优化尚未完成"}else b.type==="final"&&(P=`第${b.roundNumber}轮关卡 - 最终版本`,M=T.finalVersion||T.draftVersion||"尚未生成");return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:e.jsxs("div",{className:"bg-stone-900 rounded-lg p-6 max-w-2xl w-full mx-4 border border-stone-700 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-stone-900 pb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-amber-300",children:P}),e.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-white",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsx("div",{className:"whitespace-pre-wrap text-gray-300 text-sm leading-relaxed",children:M}),b.type==="optimization"&&b.optimizationRound&&e.jsxs("div",{className:"mt-6 flex justify-center gap-4 sticky bottom-0 bg-stone-900 pt-4",children:[b.optimizationRound>1&&e.jsxs("button",{onClick:()=>g({...b,optimizationRound:b.optimizationRound-1}),className:"py-2 px-4 rounded bg-stone-700 hover:bg-stone-600 text-gray-300",children:[e.jsx("i",{className:"fa-solid fa-arrow-left mr-2"}),"上一次"]}),b.optimizationRound<3&&e.jsxs("button",{onClick:()=>g({...b,optimizationRound:b.optimizationRound+1}),className:"py-2 px-4 rounded bg-stone-700 hover:bg-stone-600 text-gray-300",children:["下一次",e.jsx("i",{className:"fa-solid fa-arrow-right ml-2"})]}),e.jsx("button",{onClick:()=>g(null),className:"py-2 px-4 rounded bg-amber-700 hover:bg-amber-600 text-white",children:"关闭"})]})]})})},L=T=>{const P=z(T),M=h.has(T),R=["水上疾行","谜题迷宫","技巧考验","速度竞技","智力对决","终极挑战"],Q=["体能","解谜","技巧","竞技","智力","综合"],Z=(P==null?void 0:P.name)||R[T-1]||`第${T}轮关卡`,G=(P==null?void 0:P.type)||Q[T-1]||"综合",H=(P==null?void 0:P.difficulty)||T,O=P?_(P):{text:"待生成",color:"text-gray-400",icon:"○"};return e.jsxs("div",{className:"border border-stone-700/50 rounded-lg overflow-hidden mb-3",children:[e.jsxs("button",{onClick:()=>j(T),className:"w-full flex items-center justify-between p-4 bg-black/30 hover:bg-black/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-lg transition-transform ${M?"rotate-90":""}`,children:"▶"}),e.jsxs("span",{className:"font-semibold text-white",children:["第",T,"轮：",Z]})]}),e.jsxs("span",{className:`text-sm ${O.color}`,children:[O.icon," ",O.text]})]}),M&&e.jsxs("div",{className:"p-4 bg-black/20 border-t border-stone-700/50",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"类型："}),e.jsx("span",{className:"text-blue-400",children:G})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"难度："}),k(H)]})]}),(P==null?void 0:P.description)&&e.jsx("div",{className:"mb-4 text-sm text-gray-400",children:P.description}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>g({type:"draft",roundNumber:T}),disabled:!(P!=null&&P.draftVersion),className:`py-1.5 px-3 rounded text-sm transition-colors ${P!=null&&P.draftVersion?"bg-blue-700/50 hover:bg-blue-600/50 text-blue-300":"bg-gray-700/30 text-gray-500 cursor-not-allowed"}`,children:"查看草稿"}),[1,2,3].map(U=>{const te=`optimization${U}`,ie=P&&P[te];P!=null&&P.draftVersion&&(U===1||P[`optimization${U-1}`]);const B=(P==null?void 0:P.optimizationProgress)===U-1&&(P==null?void 0:P.draftVersion);return e.jsx("button",{onClick:()=>{ie?g({type:"optimization",roundNumber:T,optimizationRound:U}):B&&d&&A(T,U)},disabled:!ie&&!B,className:`py-1.5 px-3 rounded text-sm transition-colors ${ie?"bg-green-700/50 hover:bg-green-600/50 text-green-300":B?"bg-yellow-700/50 hover:bg-yellow-600/50 text-yellow-300":"bg-gray-700/30 text-gray-500 cursor-not-allowed"}`,children:ie?`优化${U}`:B?`执行优化${U}`:`优化${U}`},U)}),e.jsx("button",{onClick:()=>g({type:"final",roundNumber:T}),disabled:!(P!=null&&P.finalVersion)&&(P==null?void 0:P.optimizationProgress)!==3,className:`py-1.5 px-3 rounded text-sm transition-colors ${(P==null?void 0:P.optimizationProgress)===3?"bg-amber-700/50 hover:bg-amber-600/50 text-amber-300":"bg-gray-700/30 text-gray-500 cursor-not-allowed"}`,children:"查看最终版本"})]})]})]},T)};return f?e.jsxs(na,{isOpen:n,onClose:a,title:`第 ${f.edition} 届大闯关 - 关卡公告栏`,size:"xl",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-4 bg-black/30 rounded-lg border border-stone-700/50",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:D,disabled:w||!o,className:`py-2 px-4 rounded font-semibold text-sm transition-colors ${w?"bg-gray-700/50 text-gray-500 cursor-not-allowed":"bg-blue-700 hover:bg-blue-600 text-white"}`,children:w?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"处理中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-wand-magic-sparkles mr-2"}),"生成全部草稿"]})}),e.jsx("button",{onClick:E,disabled:w||!c,className:`py-2 px-4 rounded font-semibold text-sm transition-colors ${w?"bg-gray-700/50 text-gray-500 cursor-not-allowed":"bg-green-700 hover:bg-green-600 text-white"}`,children:w?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"处理中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-bolt mr-2"}),"开始全部优化"]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"优化进度："}),e.jsxs("span",{className:`font-bold ${S.completed===S.total?"text-green-400":S.completed>0?"text-yellow-400":"text-gray-400"}`,children:[S.completed,"/",S.total]}),e.jsx("div",{className:"w-24 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-green-500 transition-all duration-300",style:{width:`${S.completed/S.total*100}%`}})})]})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:[1,2,3,4,5,6].map(T=>L(T))})]}),I()]}):e.jsx(na,{isOpen:n,onClose:a,title:"关卡公告栏",size:"lg",children:e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("i",{className:"fa-solid fa-calendar-xmark text-4xl mb-4"}),e.jsx("p",{children:"当前没有正在进行的赛事"})]})})};class $v{constructor(a){this.schema=a}extract(a){const r=[this.extractPureJSON,this.extractCodeBlock,this.extractFirstObject,this.extractLastObject,this.extractByMarkers,this.extractMultiline,this.extractArray];for(const o of r)try{const c=o.call(this,a);if(c!==null)try{return this.schema.parse(c),c}catch{continue}}catch{continue}for(const o of r)try{const c=o.call(this,a);if(c!==null)return c}catch{continue}return null}extractPureJSON(a){const r=a.trim();return r.startsWith("{")||r.startsWith("[")?JSON.parse(r):null}extractCodeBlock(a){const r=[/```json\s*([\s\S]*?)\s*```/,/```\s*([\s\S]*?)\s*```/,/`([^`]+)`/];for(const o of r){const c=a.match(o);if(c)try{return JSON.parse(c[1].trim())}catch{continue}}return null}extractFirstObject(a){let r=0,o=-1;for(let c=0;c<a.length;c++)if(a[c]==="{")r===0&&(o=c),r++;else if(a[c]==="}"&&(r--,r===0&&o!==-1))try{return JSON.parse(a.substring(o,c+1))}catch{o=-1}return null}extractLastObject(a){const r=[];let o=0,c=-1;for(let d=0;d<a.length;d++)if(a[d]==="{")o===0&&(c=d),o++;else if(a[d]==="}"&&(o--,o===0&&c!==-1)){try{const m=JSON.parse(a.substring(c,d+1));r.push(m)}catch{}c=-1}return r.length>0?r[r.length-1]:null}extractByMarkers(a){const r=[/\[JSON_START\]([\s\S]*?)\[JSON_END\]/,/\[START\]([\s\S]*?)\[END\]/,/<json>([\s\S]*?)<\/json>/,/JSON:\s*(\{[\s\S]*?\})/];for(const o of r){const c=a.match(o);if(c)try{return JSON.parse(c[1].trim())}catch{continue}}return null}extractMultiline(a){const r=a.split(`
`);let o=[],c=!1;for(const d of r){const m=d.trim();if(m.startsWith("{")||m.startsWith("["))c=!0,o=[d];else if(c&&(o.push(d),m.endsWith("}")||m.endsWith("]")))try{return JSON.parse(o.join(`
`))}catch{c=!1,o=[]}}return null}extractArray(a){let r=0,o=-1;for(let c=0;c<a.length;c++)if(a[c]==="[")r===0&&(o=c),r++;else if(a[c]==="]"&&(r--,r===0&&o!==-1))try{return JSON.parse(a.substring(o,c+1))}catch{o=-1}return null}}class Ev{constructor(a,r={}){this.schema=a,this.defaultValues=r}complete(a){try{return this.schema.parse(a)}catch{const o=JSON.parse(JSON.stringify(a||{}));this.applyDefaults(o,this.defaultValues);try{return this.schema.parse(o)}catch(c){if(c.issues)for(const d of c.issues){const m=d.path,f=this.getDefaultValueForType(d);this.setNestedValue(o,m,f)}return this.schema.parse(o)}}}applyDefaults(a,r){for(const o in r)!(o in a)||a[o]===void 0||a[o]===null?a[o]=r[o]:typeof r[o]=="object"&&!Array.isArray(r[o])&&this.applyDefaults(a[o],r[o])}getDefaultValueForType(a){const r=a.expected;return r==="string"?"":r==="number"?0:r==="boolean"?!1:r==="array"?[]:r==="object"?{}:null}setNestedValue(a,r,o){if(r.length===0)return;const c=r[0];r.length===1?(!(c in a)||a[c]===void 0||a[c]===null)&&(a[c]=o):((!a[c]||typeof a[c]!="object")&&(a[c]={}),this.setNestedValue(a[c],r.slice(1),o))}}class Ra{constructor(a,r={},o){this.schema=a,this.extractor=new $v(a),this.completer=new Ev(a,r),this.formatInstruction=o||this.generateFormatInstruction()}generateFormatInstruction(){return`
【重要】你必须严格按照 JSON 格式输出，不要添加任何解释文字。

输出格式要求:
1. 只输出纯 JSON，不要使用 markdown 代码块
2. 不要有任何前缀或后缀说明
3. 确保 JSON 格式正确，所有字段完整

示例格式: {"field1":"value1","field2":"value2"}
`.trim()}getFormatInstruction(){return this.formatInstruction}process(a){const r=this.extractor.extract(a);if(r===null)throw new Error("无法从响应中提取有效的 JSON 数据");const o=this.completer.complete(r);return this.schema.parse(o)}async processWithRetry(a,r=3){let o=null;for(let c=0;c<r;c++)try{const d=await a(c);return this.process(d)}catch(d){o=d,console.warn(`[AIFormatProcessor] 处理失败 (尝试 ${c+1}/${r}):`,d.message)}throw new Error(`AI 响应格式处理失败，已重试 ${r} 次: ${o==null?void 0:o.message}`)}}function de(n,a,r){function o(f,h){if(f._zod||Object.defineProperty(f,"_zod",{value:{def:h,constr:m,traits:new Set},enumerable:!1}),f._zod.traits.has(n))return;f._zod.traits.add(n),a(f,h);const p=m.prototype,b=Object.keys(p);for(let g=0;g<b.length;g++){const w=b[g];w in f||(f[w]=p[w].bind(f))}}const c=(r==null?void 0:r.Parent)??Object;class d extends c{}Object.defineProperty(d,"name",{value:n});function m(f){var h;const p=r!=null&&r.Parent?new d:this;o(p,f),(h=p._zod).deferred??(h.deferred=[]);for(const b of p._zod.deferred)b();return p}return Object.defineProperty(m,"init",{value:o}),Object.defineProperty(m,Symbol.hasInstance,{value:f=>{var h,p;return r!=null&&r.Parent&&f instanceof r.Parent?!0:(p=(h=f==null?void 0:f._zod)==null?void 0:h.traits)==null?void 0:p.has(n)}}),Object.defineProperty(m,"name",{value:n}),m}class Gr extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Oh extends Error{constructor(a){super(`Encountered unidirectional transform during encode: ${a}`),this.name="ZodEncodeError"}}const Rh={};function Ba(n){return Rh}function Av(n){const a=Object.values(n).filter(o=>typeof o=="number");return Object.entries(n).filter(([o,c])=>a.indexOf(+o)===-1).map(([o,c])=>c)}function au(n,a){return typeof a=="bigint"?a.toString():a}function hu(n){return{get value(){{const a=n();return Object.defineProperty(this,"value",{value:a}),a}}}}function pu(n){return n==null}function bu(n){const a=n.startsWith("^")?1:0,r=n.endsWith("$")?n.length-1:n.length;return n.slice(a,r)}function Tv(n,a){const r=(n.toString().split(".")[1]||"").length,o=a.toString();let c=(o.split(".")[1]||"").length;if(c===0&&/\d?e-\d?/.test(o)){const h=o.match(/\d?e-(\d?)/);h!=null&&h[1]&&(c=Number.parseInt(h[1]))}const d=r>c?r:c,m=Number.parseInt(n.toFixed(d).replace(".","")),f=Number.parseInt(a.toFixed(d).replace(".",""));return m%f/10**d}const kf=Symbol("evaluating");function Ve(n,a,r){let o;Object.defineProperty(n,a,{get(){if(o!==kf)return o===void 0&&(o=kf,o=r()),o},set(c){Object.defineProperty(n,a,{value:c})},configurable:!0})}function Ha(n,a,r){Object.defineProperty(n,a,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Pa(...n){const a={};for(const r of n){const o=Object.getOwnPropertyDescriptors(r);Object.assign(a,o)}return Object.defineProperties({},a)}function Sf(n){return JSON.stringify(n)}function Mv(n){return n.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const Ih="captureStackTrace"in Error?Error.captureStackTrace:(...n)=>{};function ji(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const zv=hu(()=>{var n;if(typeof navigator<"u"&&((n=navigator==null?void 0:navigator.userAgent)!=null&&n.includes("Cloudflare")))return!1;try{const a=Function;return new a(""),!0}catch{return!1}});function Jl(n){if(ji(n)===!1)return!1;const a=n.constructor;if(a===void 0||typeof a!="function")return!0;const r=a.prototype;return!(ji(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Lh(n){return Jl(n)?{...n}:Array.isArray(n)?[...n]:n}const Dv=new Set(["string","number","symbol"]);function Ti(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ra(n,a,r){const o=new n._zod.constr(a??n._zod.def);return(!a||r!=null&&r.parent)&&(o._zod.parent=n),o}function Ne(n){const a=n;if(!a)return{};if(typeof a=="string")return{error:()=>a};if((a==null?void 0:a.message)!==void 0){if((a==null?void 0:a.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");a.error=a.message}return delete a.message,typeof a.error=="string"?{...a,error:()=>a.error}:a}function Ov(n){return Object.keys(n).filter(a=>n[a]._zod.optin==="optional"&&n[a]._zod.optout==="optional")}const Rv={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Iv(n,a){const r=n._zod.def,o=Pa(n._zod.def,{get shape(){const c={};for(const d in a){if(!(d in r.shape))throw new Error(`Unrecognized key: "${d}"`);a[d]&&(c[d]=r.shape[d])}return Ha(this,"shape",c),c},checks:[]});return ra(n,o)}function Lv(n,a){const r=n._zod.def,o=Pa(n._zod.def,{get shape(){const c={...n._zod.def.shape};for(const d in a){if(!(d in r.shape))throw new Error(`Unrecognized key: "${d}"`);a[d]&&delete c[d]}return Ha(this,"shape",c),c},checks:[]});return ra(n,o)}function Bv(n,a){if(!Jl(a))throw new Error("Invalid input to extend: expected a plain object");const r=n._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const c=Pa(n._zod.def,{get shape(){const d={...n._zod.def.shape,...a};return Ha(this,"shape",d),d},checks:[]});return ra(n,c)}function Uv(n,a){if(!Jl(a))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...n._zod.def,get shape(){const o={...n._zod.def.shape,...a};return Ha(this,"shape",o),o},checks:n._zod.def.checks};return ra(n,r)}function Hv(n,a){const r=Pa(n._zod.def,{get shape(){const o={...n._zod.def.shape,...a._zod.def.shape};return Ha(this,"shape",o),o},get catchall(){return a._zod.def.catchall},checks:[]});return ra(n,r)}function Pv(n,a,r){const o=Pa(a._zod.def,{get shape(){const c=a._zod.def.shape,d={...c};if(r)for(const m in r){if(!(m in c))throw new Error(`Unrecognized key: "${m}"`);r[m]&&(d[m]=n?new n({type:"optional",innerType:c[m]}):c[m])}else for(const m in c)d[m]=n?new n({type:"optional",innerType:c[m]}):c[m];return Ha(this,"shape",d),d},checks:[]});return ra(a,o)}function qv(n,a,r){const o=Pa(a._zod.def,{get shape(){const c=a._zod.def.shape,d={...c};if(r)for(const m in r){if(!(m in d))throw new Error(`Unrecognized key: "${m}"`);r[m]&&(d[m]=new n({type:"nonoptional",innerType:c[m]}))}else for(const m in c)d[m]=new n({type:"nonoptional",innerType:c[m]});return Ha(this,"shape",d),d},checks:[]});return ra(a,o)}function Zr(n,a=0){var r;if(n.aborted===!0)return!0;for(let o=a;o<n.issues.length;o++)if(((r=n.issues[o])==null?void 0:r.continue)!==!0)return!0;return!1}function Bh(n,a){return a.map(r=>{var o;return(o=r).path??(o.path=[]),r.path.unshift(n),r})}function mi(n){return typeof n=="string"?n:n==null?void 0:n.message}function Ua(n,a,r){var c,d,m,f,h,p;const o={...n,path:n.path??[]};if(!n.message){const b=mi((m=(d=(c=n.inst)==null?void 0:c._zod.def)==null?void 0:d.error)==null?void 0:m.call(d,n))??mi((f=a==null?void 0:a.error)==null?void 0:f.call(a,n))??mi((h=r.customError)==null?void 0:h.call(r,n))??mi((p=r.localeError)==null?void 0:p.call(r,n))??"Invalid input";o.message=b}return delete o.inst,delete o.continue,a!=null&&a.reportInput||delete o.input,o}function gu(n){return Array.isArray(n)?"array":typeof n=="string"?"string":"unknown"}function Fl(...n){const[a,r,o]=n;return typeof a=="string"?{message:a,code:"custom",input:r,inst:o}:{...a}}const Uh=(n,a)=>{n.name="$ZodError",Object.defineProperty(n,"_zod",{value:n._zod,enumerable:!1}),Object.defineProperty(n,"issues",{value:a,enumerable:!1}),n.message=JSON.stringify(a,au,2),Object.defineProperty(n,"toString",{value:()=>n.message,enumerable:!1})},Hh=de("$ZodError",Uh),Ph=de("$ZodError",Uh,{Parent:Error});function Zv(n,a=r=>r.message){const r={},o=[];for(const c of n.issues)c.path.length>0?(r[c.path[0]]=r[c.path[0]]||[],r[c.path[0]].push(a(c))):o.push(a(c));return{formErrors:o,fieldErrors:r}}function Gv(n,a=r=>r.message){const r={_errors:[]},o=c=>{for(const d of c.issues)if(d.code==="invalid_union"&&d.errors.length)d.errors.map(m=>o({issues:m}));else if(d.code==="invalid_key")o({issues:d.issues});else if(d.code==="invalid_element")o({issues:d.issues});else if(d.path.length===0)r._errors.push(a(d));else{let m=r,f=0;for(;f<d.path.length;){const h=d.path[f];f===d.path.length-1?(m[h]=m[h]||{_errors:[]},m[h]._errors.push(a(d))):m[h]=m[h]||{_errors:[]},m=m[h],f++}}};return o(n),r}const yu=n=>(a,r,o,c)=>{const d=o?Object.assign(o,{async:!1}):{async:!1},m=a._zod.run({value:r,issues:[]},d);if(m instanceof Promise)throw new Gr;if(m.issues.length){const f=new((c==null?void 0:c.Err)??n)(m.issues.map(h=>Ua(h,d,Ba())));throw Ih(f,c==null?void 0:c.callee),f}return m.value},vu=n=>async(a,r,o,c)=>{const d=o?Object.assign(o,{async:!0}):{async:!0};let m=a._zod.run({value:r,issues:[]},d);if(m instanceof Promise&&(m=await m),m.issues.length){const f=new((c==null?void 0:c.Err)??n)(m.issues.map(h=>Ua(h,d,Ba())));throw Ih(f,c==null?void 0:c.callee),f}return m.value},Mi=n=>(a,r,o)=>{const c=o?{...o,async:!1}:{async:!1},d=a._zod.run({value:r,issues:[]},c);if(d instanceof Promise)throw new Gr;return d.issues.length?{success:!1,error:new(n??Hh)(d.issues.map(m=>Ua(m,c,Ba())))}:{success:!0,data:d.value}},Vv=Mi(Ph),zi=n=>async(a,r,o)=>{const c=o?Object.assign(o,{async:!0}):{async:!0};let d=a._zod.run({value:r,issues:[]},c);return d instanceof Promise&&(d=await d),d.issues.length?{success:!1,error:new n(d.issues.map(m=>Ua(m,c,Ba())))}:{success:!0,data:d.value}},Qv=zi(Ph),Yv=n=>(a,r,o)=>{const c=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return yu(n)(a,r,c)},Jv=n=>(a,r,o)=>yu(n)(a,r,o),Fv=n=>async(a,r,o)=>{const c=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return vu(n)(a,r,c)},Xv=n=>async(a,r,o)=>vu(n)(a,r,o),Kv=n=>(a,r,o)=>{const c=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return Mi(n)(a,r,c)},Wv=n=>(a,r,o)=>Mi(n)(a,r,o),ej=n=>async(a,r,o)=>{const c=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return zi(n)(a,r,c)},tj=n=>async(a,r,o)=>zi(n)(a,r,o),sj=/^[cC][^\s-]{8,}$/,nj=/^[0-9a-z]+$/,aj=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,rj=/^[0-9a-vA-V]{20}$/,lj=/^[A-Za-z0-9]{27}$/,oj=/^[a-zA-Z0-9_-]{21}$/,ij=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,cj=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Cf=n=>n?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${n}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,dj=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,uj="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function mj(){return new RegExp(uj,"u")}const xj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,fj=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,hj=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,pj=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,bj=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,qh=/^[A-Za-z0-9_-]*$/,gj=/^\+(?:[0-9]){6,14}[0-9]$/,Zh="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",yj=new RegExp(`^${Zh}$`);function Gh(n){const a="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof n.precision=="number"?n.precision===-1?`${a}`:n.precision===0?`${a}:[0-5]\\d`:`${a}:[0-5]\\d\\.\\d{${n.precision}}`:`${a}(?::[0-5]\\d(?:\\.\\d+)?)?`}function vj(n){return new RegExp(`^${Gh(n)}$`)}function jj(n){const a=Gh({precision:n.precision}),r=["Z"];n.local&&r.push(""),n.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const o=`${a}(?:${r.join("|")})`;return new RegExp(`^${Zh}T(?:${o})$`)}const Nj=n=>{const a=n?`[\\s\\S]{${(n==null?void 0:n.minimum)??0},${(n==null?void 0:n.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${a}$`)},wj=/^-?\d+$/,kj=/^-?\d+(?:\.\d+)?/,Sj=/^(?:true|false)$/i,Cj=/^[^A-Z]*$/,_j=/^[^a-z]*$/,Yt=de("$ZodCheck",(n,a)=>{var r;n._zod??(n._zod={}),n._zod.def=a,(r=n._zod).onattach??(r.onattach=[])}),Vh={number:"number",bigint:"bigint",object:"date"},Qh=de("$ZodCheckLessThan",(n,a)=>{Yt.init(n,a);const r=Vh[typeof a.value];n._zod.onattach.push(o=>{const c=o._zod.bag,d=(a.inclusive?c.maximum:c.exclusiveMaximum)??Number.POSITIVE_INFINITY;a.value<d&&(a.inclusive?c.maximum=a.value:c.exclusiveMaximum=a.value)}),n._zod.check=o=>{(a.inclusive?o.value<=a.value:o.value<a.value)||o.issues.push({origin:r,code:"too_big",maximum:a.value,input:o.value,inclusive:a.inclusive,inst:n,continue:!a.abort})}}),Yh=de("$ZodCheckGreaterThan",(n,a)=>{Yt.init(n,a);const r=Vh[typeof a.value];n._zod.onattach.push(o=>{const c=o._zod.bag,d=(a.inclusive?c.minimum:c.exclusiveMinimum)??Number.NEGATIVE_INFINITY;a.value>d&&(a.inclusive?c.minimum=a.value:c.exclusiveMinimum=a.value)}),n._zod.check=o=>{(a.inclusive?o.value>=a.value:o.value>a.value)||o.issues.push({origin:r,code:"too_small",minimum:a.value,input:o.value,inclusive:a.inclusive,inst:n,continue:!a.abort})}}),$j=de("$ZodCheckMultipleOf",(n,a)=>{Yt.init(n,a),n._zod.onattach.push(r=>{var o;(o=r._zod.bag).multipleOf??(o.multipleOf=a.value)}),n._zod.check=r=>{if(typeof r.value!=typeof a.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%a.value===BigInt(0):Tv(r.value,a.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:a.value,input:r.value,inst:n,continue:!a.abort})}}),Ej=de("$ZodCheckNumberFormat",(n,a)=>{var m;Yt.init(n,a),a.format=a.format||"float64";const r=(m=a.format)==null?void 0:m.includes("int"),o=r?"int":"number",[c,d]=Rv[a.format];n._zod.onattach.push(f=>{const h=f._zod.bag;h.format=a.format,h.minimum=c,h.maximum=d,r&&(h.pattern=wj)}),n._zod.check=f=>{const h=f.value;if(r){if(!Number.isInteger(h)){f.issues.push({expected:o,format:a.format,code:"invalid_type",continue:!1,input:h,inst:n});return}if(!Number.isSafeInteger(h)){h>0?f.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:o,continue:!a.abort}):f.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:o,continue:!a.abort});return}}h<c&&f.issues.push({origin:"number",input:h,code:"too_small",minimum:c,inclusive:!0,inst:n,continue:!a.abort}),h>d&&f.issues.push({origin:"number",input:h,code:"too_big",maximum:d,inst:n})}}),Aj=de("$ZodCheckMaxLength",(n,a)=>{var r;Yt.init(n,a),(r=n._zod.def).when??(r.when=o=>{const c=o.value;return!pu(c)&&c.length!==void 0}),n._zod.onattach.push(o=>{const c=o._zod.bag.maximum??Number.POSITIVE_INFINITY;a.maximum<c&&(o._zod.bag.maximum=a.maximum)}),n._zod.check=o=>{const c=o.value;if(c.length<=a.maximum)return;const m=gu(c);o.issues.push({origin:m,code:"too_big",maximum:a.maximum,inclusive:!0,input:c,inst:n,continue:!a.abort})}}),Tj=de("$ZodCheckMinLength",(n,a)=>{var r;Yt.init(n,a),(r=n._zod.def).when??(r.when=o=>{const c=o.value;return!pu(c)&&c.length!==void 0}),n._zod.onattach.push(o=>{const c=o._zod.bag.minimum??Number.NEGATIVE_INFINITY;a.minimum>c&&(o._zod.bag.minimum=a.minimum)}),n._zod.check=o=>{const c=o.value;if(c.length>=a.minimum)return;const m=gu(c);o.issues.push({origin:m,code:"too_small",minimum:a.minimum,inclusive:!0,input:c,inst:n,continue:!a.abort})}}),Mj=de("$ZodCheckLengthEquals",(n,a)=>{var r;Yt.init(n,a),(r=n._zod.def).when??(r.when=o=>{const c=o.value;return!pu(c)&&c.length!==void 0}),n._zod.onattach.push(o=>{const c=o._zod.bag;c.minimum=a.length,c.maximum=a.length,c.length=a.length}),n._zod.check=o=>{const c=o.value,d=c.length;if(d===a.length)return;const m=gu(c),f=d>a.length;o.issues.push({origin:m,...f?{code:"too_big",maximum:a.length}:{code:"too_small",minimum:a.length},inclusive:!0,exact:!0,input:o.value,inst:n,continue:!a.abort})}}),Di=de("$ZodCheckStringFormat",(n,a)=>{var r,o;Yt.init(n,a),n._zod.onattach.push(c=>{const d=c._zod.bag;d.format=a.format,a.pattern&&(d.patterns??(d.patterns=new Set),d.patterns.add(a.pattern))}),a.pattern?(r=n._zod).check??(r.check=c=>{a.pattern.lastIndex=0,!a.pattern.test(c.value)&&c.issues.push({origin:"string",code:"invalid_format",format:a.format,input:c.value,...a.pattern?{pattern:a.pattern.toString()}:{},inst:n,continue:!a.abort})}):(o=n._zod).check??(o.check=()=>{})}),zj=de("$ZodCheckRegex",(n,a)=>{Di.init(n,a),n._zod.check=r=>{a.pattern.lastIndex=0,!a.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:a.pattern.toString(),inst:n,continue:!a.abort})}}),Dj=de("$ZodCheckLowerCase",(n,a)=>{a.pattern??(a.pattern=Cj),Di.init(n,a)}),Oj=de("$ZodCheckUpperCase",(n,a)=>{a.pattern??(a.pattern=_j),Di.init(n,a)}),Rj=de("$ZodCheckIncludes",(n,a)=>{Yt.init(n,a);const r=Ti(a.includes),o=new RegExp(typeof a.position=="number"?`^.{${a.position}}${r}`:r);a.pattern=o,n._zod.onattach.push(c=>{const d=c._zod.bag;d.patterns??(d.patterns=new Set),d.patterns.add(o)}),n._zod.check=c=>{c.value.includes(a.includes,a.position)||c.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:a.includes,input:c.value,inst:n,continue:!a.abort})}}),Ij=de("$ZodCheckStartsWith",(n,a)=>{Yt.init(n,a);const r=new RegExp(`^${Ti(a.prefix)}.*`);a.pattern??(a.pattern=r),n._zod.onattach.push(o=>{const c=o._zod.bag;c.patterns??(c.patterns=new Set),c.patterns.add(r)}),n._zod.check=o=>{o.value.startsWith(a.prefix)||o.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:a.prefix,input:o.value,inst:n,continue:!a.abort})}}),Lj=de("$ZodCheckEndsWith",(n,a)=>{Yt.init(n,a);const r=new RegExp(`.*${Ti(a.suffix)}$`);a.pattern??(a.pattern=r),n._zod.onattach.push(o=>{const c=o._zod.bag;c.patterns??(c.patterns=new Set),c.patterns.add(r)}),n._zod.check=o=>{o.value.endsWith(a.suffix)||o.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:a.suffix,input:o.value,inst:n,continue:!a.abort})}}),Bj=de("$ZodCheckOverwrite",(n,a)=>{Yt.init(n,a),n._zod.check=r=>{r.value=a.tx(r.value)}});class Uj{constructor(a=[]){this.content=[],this.indent=0,this&&(this.args=a)}indented(a){this.indent+=1,a(this),this.indent-=1}write(a){if(typeof a=="function"){a(this,{execution:"sync"}),a(this,{execution:"async"});return}const o=a.split(`
`).filter(m=>m),c=Math.min(...o.map(m=>m.length-m.trimStart().length)),d=o.map(m=>m.slice(c)).map(m=>" ".repeat(this.indent*2)+m);for(const m of d)this.content.push(m)}compile(){const a=Function,r=this==null?void 0:this.args,c=[...((this==null?void 0:this.content)??[""]).map(d=>`  ${d}`)];return new a(...r,c.join(`
`))}}const Hj={major:4,minor:1,patch:13},dt=de("$ZodType",(n,a)=>{var c;var r;n??(n={}),n._zod.def=a,n._zod.bag=n._zod.bag||{},n._zod.version=Hj;const o=[...n._zod.def.checks??[]];n._zod.traits.has("$ZodCheck")&&o.unshift(n);for(const d of o)for(const m of d._zod.onattach)m(n);if(o.length===0)(r=n._zod).deferred??(r.deferred=[]),(c=n._zod.deferred)==null||c.push(()=>{n._zod.run=n._zod.parse});else{const d=(f,h,p)=>{let b=Zr(f),g;for(const w of h){if(w._zod.def.when){if(!w._zod.def.when(f))continue}else if(b)continue;const N=f.issues.length,j=w._zod.check(f);if(j instanceof Promise&&(p==null?void 0:p.async)===!1)throw new Gr;if(g||j instanceof Promise)g=(g??Promise.resolve()).then(async()=>{await j,f.issues.length!==N&&(b||(b=Zr(f,N)))});else{if(f.issues.length===N)continue;b||(b=Zr(f,N))}}return g?g.then(()=>f):f},m=(f,h,p)=>{if(Zr(f))return f.aborted=!0,f;const b=d(h,o,p);if(b instanceof Promise){if(p.async===!1)throw new Gr;return b.then(g=>n._zod.parse(g,p))}return n._zod.parse(b,p)};n._zod.run=(f,h)=>{if(h.skipChecks)return n._zod.parse(f,h);if(h.direction==="backward"){const b=n._zod.parse({value:f.value,issues:[]},{...h,skipChecks:!0});return b instanceof Promise?b.then(g=>m(g,f,h)):m(b,f,h)}const p=n._zod.parse(f,h);if(p instanceof Promise){if(h.async===!1)throw new Gr;return p.then(b=>d(b,o,h))}return d(p,o,h)}}n["~standard"]={validate:d=>{var m;try{const f=Vv(n,d);return f.success?{value:f.data}:{issues:(m=f.error)==null?void 0:m.issues}}catch{return Qv(n,d).then(h=>{var p;return h.success?{value:h.data}:{issues:(p=h.error)==null?void 0:p.issues}})}},vendor:"zod",version:1}}),ju=de("$ZodString",(n,a)=>{var r;dt.init(n,a),n._zod.pattern=[...((r=n==null?void 0:n._zod.bag)==null?void 0:r.patterns)??[]].pop()??Nj(n._zod.bag),n._zod.parse=(o,c)=>{if(a.coerce)try{o.value=String(o.value)}catch{}return typeof o.value=="string"||o.issues.push({expected:"string",code:"invalid_type",input:o.value,inst:n}),o}}),We=de("$ZodStringFormat",(n,a)=>{Di.init(n,a),ju.init(n,a)}),Pj=de("$ZodGUID",(n,a)=>{a.pattern??(a.pattern=cj),We.init(n,a)}),qj=de("$ZodUUID",(n,a)=>{if(a.version){const o={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[a.version];if(o===void 0)throw new Error(`Invalid UUID version: "${a.version}"`);a.pattern??(a.pattern=Cf(o))}else a.pattern??(a.pattern=Cf());We.init(n,a)}),Zj=de("$ZodEmail",(n,a)=>{a.pattern??(a.pattern=dj),We.init(n,a)}),Gj=de("$ZodURL",(n,a)=>{We.init(n,a),n._zod.check=r=>{try{const o=r.value.trim(),c=new URL(o);a.hostname&&(a.hostname.lastIndex=0,a.hostname.test(c.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:a.hostname.source,input:r.value,inst:n,continue:!a.abort})),a.protocol&&(a.protocol.lastIndex=0,a.protocol.test(c.protocol.endsWith(":")?c.protocol.slice(0,-1):c.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:a.protocol.source,input:r.value,inst:n,continue:!a.abort})),a.normalize?r.value=c.href:r.value=o;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:n,continue:!a.abort})}}}),Vj=de("$ZodEmoji",(n,a)=>{a.pattern??(a.pattern=mj()),We.init(n,a)}),Qj=de("$ZodNanoID",(n,a)=>{a.pattern??(a.pattern=oj),We.init(n,a)}),Yj=de("$ZodCUID",(n,a)=>{a.pattern??(a.pattern=sj),We.init(n,a)}),Jj=de("$ZodCUID2",(n,a)=>{a.pattern??(a.pattern=nj),We.init(n,a)}),Fj=de("$ZodULID",(n,a)=>{a.pattern??(a.pattern=aj),We.init(n,a)}),Xj=de("$ZodXID",(n,a)=>{a.pattern??(a.pattern=rj),We.init(n,a)}),Kj=de("$ZodKSUID",(n,a)=>{a.pattern??(a.pattern=lj),We.init(n,a)}),Wj=de("$ZodISODateTime",(n,a)=>{a.pattern??(a.pattern=jj(a)),We.init(n,a)}),eN=de("$ZodISODate",(n,a)=>{a.pattern??(a.pattern=yj),We.init(n,a)}),tN=de("$ZodISOTime",(n,a)=>{a.pattern??(a.pattern=vj(a)),We.init(n,a)}),sN=de("$ZodISODuration",(n,a)=>{a.pattern??(a.pattern=ij),We.init(n,a)}),nN=de("$ZodIPv4",(n,a)=>{a.pattern??(a.pattern=xj),We.init(n,a),n._zod.bag.format="ipv4"}),aN=de("$ZodIPv6",(n,a)=>{a.pattern??(a.pattern=fj),We.init(n,a),n._zod.bag.format="ipv6",n._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:n,continue:!a.abort})}}}),rN=de("$ZodCIDRv4",(n,a)=>{a.pattern??(a.pattern=hj),We.init(n,a)}),lN=de("$ZodCIDRv6",(n,a)=>{a.pattern??(a.pattern=pj),We.init(n,a),n._zod.check=r=>{const o=r.value.split("/");try{if(o.length!==2)throw new Error;const[c,d]=o;if(!d)throw new Error;const m=Number(d);if(`${m}`!==d)throw new Error;if(m<0||m>128)throw new Error;new URL(`http://[${c}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:n,continue:!a.abort})}}});function Jh(n){if(n==="")return!0;if(n.length%4!==0)return!1;try{return atob(n),!0}catch{return!1}}const oN=de("$ZodBase64",(n,a)=>{a.pattern??(a.pattern=bj),We.init(n,a),n._zod.bag.contentEncoding="base64",n._zod.check=r=>{Jh(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:n,continue:!a.abort})}});function iN(n){if(!qh.test(n))return!1;const a=n.replace(/[-_]/g,o=>o==="-"?"+":"/"),r=a.padEnd(Math.ceil(a.length/4)*4,"=");return Jh(r)}const cN=de("$ZodBase64URL",(n,a)=>{a.pattern??(a.pattern=qh),We.init(n,a),n._zod.bag.contentEncoding="base64url",n._zod.check=r=>{iN(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:n,continue:!a.abort})}}),dN=de("$ZodE164",(n,a)=>{a.pattern??(a.pattern=gj),We.init(n,a)});function uN(n,a=null){try{const r=n.split(".");if(r.length!==3)return!1;const[o]=r;if(!o)return!1;const c=JSON.parse(atob(o));return!("typ"in c&&(c==null?void 0:c.typ)!=="JWT"||!c.alg||a&&(!("alg"in c)||c.alg!==a))}catch{return!1}}const mN=de("$ZodJWT",(n,a)=>{We.init(n,a),n._zod.check=r=>{uN(r.value,a.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:n,continue:!a.abort})}}),Fh=de("$ZodNumber",(n,a)=>{dt.init(n,a),n._zod.pattern=n._zod.bag.pattern??kj,n._zod.parse=(r,o)=>{if(a.coerce)try{r.value=Number(r.value)}catch{}const c=r.value;if(typeof c=="number"&&!Number.isNaN(c)&&Number.isFinite(c))return r;const d=typeof c=="number"?Number.isNaN(c)?"NaN":Number.isFinite(c)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:c,inst:n,...d?{received:d}:{}}),r}}),xN=de("$ZodNumberFormat",(n,a)=>{Ej.init(n,a),Fh.init(n,a)}),fN=de("$ZodBoolean",(n,a)=>{dt.init(n,a),n._zod.pattern=Sj,n._zod.parse=(r,o)=>{if(a.coerce)try{r.value=!!r.value}catch{}const c=r.value;return typeof c=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:c,inst:n}),r}}),hN=de("$ZodUnknown",(n,a)=>{dt.init(n,a),n._zod.parse=r=>r}),pN=de("$ZodNever",(n,a)=>{dt.init(n,a),n._zod.parse=(r,o)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:n}),r)});function _f(n,a,r){n.issues.length&&a.issues.push(...Bh(r,n.issues)),a.value[r]=n.value}const bN=de("$ZodArray",(n,a)=>{dt.init(n,a),n._zod.parse=(r,o)=>{const c=r.value;if(!Array.isArray(c))return r.issues.push({expected:"array",code:"invalid_type",input:c,inst:n}),r;r.value=Array(c.length);const d=[];for(let m=0;m<c.length;m++){const f=c[m],h=a.element._zod.run({value:f,issues:[]},o);h instanceof Promise?d.push(h.then(p=>_f(p,r,m))):_f(h,r,m)}return d.length?Promise.all(d).then(()=>r):r}});function Ni(n,a,r,o){n.issues.length&&a.issues.push(...Bh(r,n.issues)),n.value===void 0?r in o&&(a.value[r]=void 0):a.value[r]=n.value}function Xh(n){var o,c,d,m;const a=Object.keys(n.shape);for(const f of a)if(!((m=(d=(c=(o=n.shape)==null?void 0:o[f])==null?void 0:c._zod)==null?void 0:d.traits)!=null&&m.has("$ZodType")))throw new Error(`Invalid element at key "${f}": expected a Zod schema`);const r=Ov(n.shape);return{...n,keys:a,keySet:new Set(a),numKeys:a.length,optionalKeys:new Set(r)}}function Kh(n,a,r,o,c,d){const m=[],f=c.keySet,h=c.catchall._zod,p=h.def.type;for(const b in a){if(f.has(b))continue;if(p==="never"){m.push(b);continue}const g=h.run({value:a[b],issues:[]},o);g instanceof Promise?n.push(g.then(w=>Ni(w,r,b,a))):Ni(g,r,b,a)}return m.length&&r.issues.push({code:"unrecognized_keys",keys:m,input:a,inst:d}),n.length?Promise.all(n).then(()=>r):r}const gN=de("$ZodObject",(n,a)=>{dt.init(n,a);const r=Object.getOwnPropertyDescriptor(a,"shape");if(!(r!=null&&r.get)){const f=a.shape;Object.defineProperty(a,"shape",{get:()=>{const h={...f};return Object.defineProperty(a,"shape",{value:h}),h}})}const o=hu(()=>Xh(a));Ve(n._zod,"propValues",()=>{const f=a.shape,h={};for(const p in f){const b=f[p]._zod;if(b.values){h[p]??(h[p]=new Set);for(const g of b.values)h[p].add(g)}}return h});const c=ji,d=a.catchall;let m;n._zod.parse=(f,h)=>{m??(m=o.value);const p=f.value;if(!c(p))return f.issues.push({expected:"object",code:"invalid_type",input:p,inst:n}),f;f.value={};const b=[],g=m.shape;for(const w of m.keys){const j=g[w]._zod.run({value:p[w],issues:[]},h);j instanceof Promise?b.push(j.then(k=>Ni(k,f,w,p))):Ni(j,f,w,p)}return d?Kh(b,p,f,h,o.value,n):b.length?Promise.all(b).then(()=>f):f}}),yN=de("$ZodObjectJIT",(n,a)=>{gN.init(n,a);const r=n._zod.parse,o=hu(()=>Xh(a)),c=w=>{const N=new Uj(["shape","payload","ctx"]),j=o.value,k=D=>{const E=Sf(D);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};N.write("const input = payload.value;");const _=Object.create(null);let C=0;for(const D of j.keys)_[D]=`key_${C++}`;N.write("const newResult = {};");for(const D of j.keys){const E=_[D],A=Sf(D);N.write(`const ${E} = ${k(D)};`),N.write(`
        if (${E}.issues.length) {
          payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${A}, ...iss.path] : [${A}]
          })));
        }
        
        
        if (${E}.value === undefined) {
          if (${A} in input) {
            newResult[${A}] = undefined;
          }
        } else {
          newResult[${A}] = ${E}.value;
        }
        
      `)}N.write("payload.value = newResult;"),N.write("return payload;");const S=N.compile();return(D,E)=>S(w,D,E)};let d;const m=ji,f=!Rh.jitless,p=f&&zv.value,b=a.catchall;let g;n._zod.parse=(w,N)=>{g??(g=o.value);const j=w.value;return m(j)?f&&p&&(N==null?void 0:N.async)===!1&&N.jitless!==!0?(d||(d=c(a.shape)),w=d(w,N),b?Kh([],j,w,N,g,n):w):r(w,N):(w.issues.push({expected:"object",code:"invalid_type",input:j,inst:n}),w)}});function $f(n,a,r,o){for(const d of n)if(d.issues.length===0)return a.value=d.value,a;const c=n.filter(d=>!Zr(d));return c.length===1?(a.value=c[0].value,c[0]):(a.issues.push({code:"invalid_union",input:a.value,inst:r,errors:n.map(d=>d.issues.map(m=>Ua(m,o,Ba())))}),a)}const vN=de("$ZodUnion",(n,a)=>{dt.init(n,a),Ve(n._zod,"optin",()=>a.options.some(c=>c._zod.optin==="optional")?"optional":void 0),Ve(n._zod,"optout",()=>a.options.some(c=>c._zod.optout==="optional")?"optional":void 0),Ve(n._zod,"values",()=>{if(a.options.every(c=>c._zod.values))return new Set(a.options.flatMap(c=>Array.from(c._zod.values)))}),Ve(n._zod,"pattern",()=>{if(a.options.every(c=>c._zod.pattern)){const c=a.options.map(d=>d._zod.pattern);return new RegExp(`^(${c.map(d=>bu(d.source)).join("|")})$`)}});const r=a.options.length===1,o=a.options[0]._zod.run;n._zod.parse=(c,d)=>{if(r)return o(c,d);let m=!1;const f=[];for(const h of a.options){const p=h._zod.run({value:c.value,issues:[]},d);if(p instanceof Promise)f.push(p),m=!0;else{if(p.issues.length===0)return p;f.push(p)}}return m?Promise.all(f).then(h=>$f(h,c,n,d)):$f(f,c,n,d)}}),jN=de("$ZodIntersection",(n,a)=>{dt.init(n,a),n._zod.parse=(r,o)=>{const c=r.value,d=a.left._zod.run({value:c,issues:[]},o),m=a.right._zod.run({value:c,issues:[]},o);return d instanceof Promise||m instanceof Promise?Promise.all([d,m]).then(([h,p])=>Ef(r,h,p)):Ef(r,d,m)}});function ru(n,a){if(n===a)return{valid:!0,data:n};if(n instanceof Date&&a instanceof Date&&+n==+a)return{valid:!0,data:n};if(Jl(n)&&Jl(a)){const r=Object.keys(a),o=Object.keys(n).filter(d=>r.indexOf(d)!==-1),c={...n,...a};for(const d of o){const m=ru(n[d],a[d]);if(!m.valid)return{valid:!1,mergeErrorPath:[d,...m.mergeErrorPath]};c[d]=m.data}return{valid:!0,data:c}}if(Array.isArray(n)&&Array.isArray(a)){if(n.length!==a.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let o=0;o<n.length;o++){const c=n[o],d=a[o],m=ru(c,d);if(!m.valid)return{valid:!1,mergeErrorPath:[o,...m.mergeErrorPath]};r.push(m.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Ef(n,a,r){if(a.issues.length&&n.issues.push(...a.issues),r.issues.length&&n.issues.push(...r.issues),Zr(n))return n;const o=ru(a.value,r.value);if(!o.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(o.mergeErrorPath)}`);return n.value=o.data,n}const NN=de("$ZodEnum",(n,a)=>{dt.init(n,a);const r=Av(a.entries),o=new Set(r);n._zod.values=o,n._zod.pattern=new RegExp(`^(${r.filter(c=>Dv.has(typeof c)).map(c=>typeof c=="string"?Ti(c):c.toString()).join("|")})$`),n._zod.parse=(c,d)=>{const m=c.value;return o.has(m)||c.issues.push({code:"invalid_value",values:r,input:m,inst:n}),c}}),wN=de("$ZodTransform",(n,a)=>{dt.init(n,a),n._zod.parse=(r,o)=>{if(o.direction==="backward")throw new Oh(n.constructor.name);const c=a.transform(r.value,r);if(o.async)return(c instanceof Promise?c:Promise.resolve(c)).then(m=>(r.value=m,r));if(c instanceof Promise)throw new Gr;return r.value=c,r}});function Af(n,a){return n.issues.length&&a===void 0?{issues:[],value:void 0}:n}const kN=de("$ZodOptional",(n,a)=>{dt.init(n,a),n._zod.optin="optional",n._zod.optout="optional",Ve(n._zod,"values",()=>a.innerType._zod.values?new Set([...a.innerType._zod.values,void 0]):void 0),Ve(n._zod,"pattern",()=>{const r=a.innerType._zod.pattern;return r?new RegExp(`^(${bu(r.source)})?$`):void 0}),n._zod.parse=(r,o)=>{if(a.innerType._zod.optin==="optional"){const c=a.innerType._zod.run(r,o);return c instanceof Promise?c.then(d=>Af(d,r.value)):Af(c,r.value)}return r.value===void 0?r:a.innerType._zod.run(r,o)}}),SN=de("$ZodNullable",(n,a)=>{dt.init(n,a),Ve(n._zod,"optin",()=>a.innerType._zod.optin),Ve(n._zod,"optout",()=>a.innerType._zod.optout),Ve(n._zod,"pattern",()=>{const r=a.innerType._zod.pattern;return r?new RegExp(`^(${bu(r.source)}|null)$`):void 0}),Ve(n._zod,"values",()=>a.innerType._zod.values?new Set([...a.innerType._zod.values,null]):void 0),n._zod.parse=(r,o)=>r.value===null?r:a.innerType._zod.run(r,o)}),CN=de("$ZodDefault",(n,a)=>{dt.init(n,a),n._zod.optin="optional",Ve(n._zod,"values",()=>a.innerType._zod.values),n._zod.parse=(r,o)=>{if(o.direction==="backward")return a.innerType._zod.run(r,o);if(r.value===void 0)return r.value=a.defaultValue,r;const c=a.innerType._zod.run(r,o);return c instanceof Promise?c.then(d=>Tf(d,a)):Tf(c,a)}});function Tf(n,a){return n.value===void 0&&(n.value=a.defaultValue),n}const _N=de("$ZodPrefault",(n,a)=>{dt.init(n,a),n._zod.optin="optional",Ve(n._zod,"values",()=>a.innerType._zod.values),n._zod.parse=(r,o)=>(o.direction==="backward"||r.value===void 0&&(r.value=a.defaultValue),a.innerType._zod.run(r,o))}),$N=de("$ZodNonOptional",(n,a)=>{dt.init(n,a),Ve(n._zod,"values",()=>{const r=a.innerType._zod.values;return r?new Set([...r].filter(o=>o!==void 0)):void 0}),n._zod.parse=(r,o)=>{const c=a.innerType._zod.run(r,o);return c instanceof Promise?c.then(d=>Mf(d,n)):Mf(c,n)}});function Mf(n,a){return!n.issues.length&&n.value===void 0&&n.issues.push({code:"invalid_type",expected:"nonoptional",input:n.value,inst:a}),n}const EN=de("$ZodCatch",(n,a)=>{dt.init(n,a),Ve(n._zod,"optin",()=>a.innerType._zod.optin),Ve(n._zod,"optout",()=>a.innerType._zod.optout),Ve(n._zod,"values",()=>a.innerType._zod.values),n._zod.parse=(r,o)=>{if(o.direction==="backward")return a.innerType._zod.run(r,o);const c=a.innerType._zod.run(r,o);return c instanceof Promise?c.then(d=>(r.value=d.value,d.issues.length&&(r.value=a.catchValue({...r,error:{issues:d.issues.map(m=>Ua(m,o,Ba()))},input:r.value}),r.issues=[]),r)):(r.value=c.value,c.issues.length&&(r.value=a.catchValue({...r,error:{issues:c.issues.map(d=>Ua(d,o,Ba()))},input:r.value}),r.issues=[]),r)}}),AN=de("$ZodPipe",(n,a)=>{dt.init(n,a),Ve(n._zod,"values",()=>a.in._zod.values),Ve(n._zod,"optin",()=>a.in._zod.optin),Ve(n._zod,"optout",()=>a.out._zod.optout),Ve(n._zod,"propValues",()=>a.in._zod.propValues),n._zod.parse=(r,o)=>{if(o.direction==="backward"){const d=a.out._zod.run(r,o);return d instanceof Promise?d.then(m=>xi(m,a.in,o)):xi(d,a.in,o)}const c=a.in._zod.run(r,o);return c instanceof Promise?c.then(d=>xi(d,a.out,o)):xi(c,a.out,o)}});function xi(n,a,r){return n.issues.length?(n.aborted=!0,n):a._zod.run({value:n.value,issues:n.issues},r)}const TN=de("$ZodReadonly",(n,a)=>{dt.init(n,a),Ve(n._zod,"propValues",()=>a.innerType._zod.propValues),Ve(n._zod,"values",()=>a.innerType._zod.values),Ve(n._zod,"optin",()=>{var r,o;return(o=(r=a.innerType)==null?void 0:r._zod)==null?void 0:o.optin}),Ve(n._zod,"optout",()=>{var r,o;return(o=(r=a.innerType)==null?void 0:r._zod)==null?void 0:o.optout}),n._zod.parse=(r,o)=>{if(o.direction==="backward")return a.innerType._zod.run(r,o);const c=a.innerType._zod.run(r,o);return c instanceof Promise?c.then(zf):zf(c)}});function zf(n){return n.value=Object.freeze(n.value),n}const MN=de("$ZodCustom",(n,a)=>{Yt.init(n,a),dt.init(n,a),n._zod.parse=(r,o)=>r,n._zod.check=r=>{const o=r.value,c=a.fn(o);if(c instanceof Promise)return c.then(d=>Df(d,r,o,n));Df(c,r,o,n)}});function Df(n,a,r,o){if(!n){const c={code:"custom",input:r,inst:o,path:[...o._zod.def.path??[]],continue:!o._zod.def.abort};o._zod.def.params&&(c.params=o._zod.def.params),a.issues.push(Fl(c))}}var Of;class zN{constructor(){this._map=new WeakMap,this._idmap=new Map}add(a,...r){const o=r[0];if(this._map.set(a,o),o&&typeof o=="object"&&"id"in o){if(this._idmap.has(o.id))throw new Error(`ID ${o.id} already exists in the registry`);this._idmap.set(o.id,a)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(a){const r=this._map.get(a);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(a),this}get(a){const r=a._zod.parent;if(r){const o={...this.get(r)??{}};delete o.id;const c={...o,...this._map.get(a)};return Object.keys(c).length?c:void 0}return this._map.get(a)}has(a){return this._map.has(a)}}function DN(){return new zN}(Of=globalThis).__zod_globalRegistry??(Of.__zod_globalRegistry=DN());const fi=globalThis.__zod_globalRegistry;function ON(n,a){return new n({type:"string",...Ne(a)})}function RN(n,a){return new n({type:"string",format:"email",check:"string_format",abort:!1,...Ne(a)})}function Rf(n,a){return new n({type:"string",format:"guid",check:"string_format",abort:!1,...Ne(a)})}function IN(n,a){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,...Ne(a)})}function LN(n,a){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Ne(a)})}function BN(n,a){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Ne(a)})}function UN(n,a){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Ne(a)})}function HN(n,a){return new n({type:"string",format:"url",check:"string_format",abort:!1,...Ne(a)})}function PN(n,a){return new n({type:"string",format:"emoji",check:"string_format",abort:!1,...Ne(a)})}function qN(n,a){return new n({type:"string",format:"nanoid",check:"string_format",abort:!1,...Ne(a)})}function ZN(n,a){return new n({type:"string",format:"cuid",check:"string_format",abort:!1,...Ne(a)})}function GN(n,a){return new n({type:"string",format:"cuid2",check:"string_format",abort:!1,...Ne(a)})}function VN(n,a){return new n({type:"string",format:"ulid",check:"string_format",abort:!1,...Ne(a)})}function QN(n,a){return new n({type:"string",format:"xid",check:"string_format",abort:!1,...Ne(a)})}function YN(n,a){return new n({type:"string",format:"ksuid",check:"string_format",abort:!1,...Ne(a)})}function JN(n,a){return new n({type:"string",format:"ipv4",check:"string_format",abort:!1,...Ne(a)})}function FN(n,a){return new n({type:"string",format:"ipv6",check:"string_format",abort:!1,...Ne(a)})}function XN(n,a){return new n({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Ne(a)})}function KN(n,a){return new n({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Ne(a)})}function WN(n,a){return new n({type:"string",format:"base64",check:"string_format",abort:!1,...Ne(a)})}function ew(n,a){return new n({type:"string",format:"base64url",check:"string_format",abort:!1,...Ne(a)})}function tw(n,a){return new n({type:"string",format:"e164",check:"string_format",abort:!1,...Ne(a)})}function sw(n,a){return new n({type:"string",format:"jwt",check:"string_format",abort:!1,...Ne(a)})}function nw(n,a){return new n({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Ne(a)})}function aw(n,a){return new n({type:"string",format:"date",check:"string_format",...Ne(a)})}function rw(n,a){return new n({type:"string",format:"time",check:"string_format",precision:null,...Ne(a)})}function lw(n,a){return new n({type:"string",format:"duration",check:"string_format",...Ne(a)})}function ow(n,a){return new n({type:"number",checks:[],...Ne(a)})}function iw(n,a){return new n({type:"number",check:"number_format",abort:!1,format:"safeint",...Ne(a)})}function cw(n,a){return new n({type:"boolean",...Ne(a)})}function dw(n){return new n({type:"unknown"})}function uw(n,a){return new n({type:"never",...Ne(a)})}function If(n,a){return new Qh({check:"less_than",...Ne(a),value:n,inclusive:!1})}function Gd(n,a){return new Qh({check:"less_than",...Ne(a),value:n,inclusive:!0})}function Lf(n,a){return new Yh({check:"greater_than",...Ne(a),value:n,inclusive:!1})}function Vd(n,a){return new Yh({check:"greater_than",...Ne(a),value:n,inclusive:!0})}function Bf(n,a){return new $j({check:"multiple_of",...Ne(a),value:n})}function Wh(n,a){return new Aj({check:"max_length",...Ne(a),maximum:n})}function wi(n,a){return new Tj({check:"min_length",...Ne(a),minimum:n})}function ep(n,a){return new Mj({check:"length_equals",...Ne(a),length:n})}function mw(n,a){return new zj({check:"string_format",format:"regex",...Ne(a),pattern:n})}function xw(n){return new Dj({check:"string_format",format:"lowercase",...Ne(n)})}function fw(n){return new Oj({check:"string_format",format:"uppercase",...Ne(n)})}function hw(n,a){return new Rj({check:"string_format",format:"includes",...Ne(a),includes:n})}function pw(n,a){return new Ij({check:"string_format",format:"starts_with",...Ne(a),prefix:n})}function bw(n,a){return new Lj({check:"string_format",format:"ends_with",...Ne(a),suffix:n})}function Qr(n){return new Bj({check:"overwrite",tx:n})}function gw(n){return Qr(a=>a.normalize(n))}function yw(){return Qr(n=>n.trim())}function vw(){return Qr(n=>n.toLowerCase())}function jw(){return Qr(n=>n.toUpperCase())}function Nw(){return Qr(n=>Mv(n))}function ww(n,a,r){return new n({type:"array",element:a,...Ne(r)})}function kw(n,a,r){return new n({type:"custom",check:"custom",fn:a,...Ne(r)})}function Sw(n){const a=Cw(r=>(r.addIssue=o=>{if(typeof o=="string")r.issues.push(Fl(o,r.value,a._zod.def));else{const c=o;c.fatal&&(c.continue=!1),c.code??(c.code="custom"),c.input??(c.input=r.value),c.inst??(c.inst=a),c.continue??(c.continue=!a._zod.def.abort),r.issues.push(Fl(c))}},n(r.value,r)));return a}function Cw(n,a){const r=new Yt({check:"custom",...Ne(a)});return r._zod.check=n,r}const _w=de("ZodISODateTime",(n,a)=>{Wj.init(n,a),nt.init(n,a)});function $w(n){return nw(_w,n)}const Ew=de("ZodISODate",(n,a)=>{eN.init(n,a),nt.init(n,a)});function Aw(n){return aw(Ew,n)}const Tw=de("ZodISOTime",(n,a)=>{tN.init(n,a),nt.init(n,a)});function Mw(n){return rw(Tw,n)}const zw=de("ZodISODuration",(n,a)=>{sN.init(n,a),nt.init(n,a)});function Dw(n){return lw(zw,n)}const Ow=(n,a)=>{Hh.init(n,a),n.name="ZodError",Object.defineProperties(n,{format:{value:r=>Gv(n,r)},flatten:{value:r=>Zv(n,r)},addIssue:{value:r=>{n.issues.push(r),n.message=JSON.stringify(n.issues,au,2)}},addIssues:{value:r=>{n.issues.push(...r),n.message=JSON.stringify(n.issues,au,2)}},isEmpty:{get(){return n.issues.length===0}}})},fs=de("ZodError",Ow,{Parent:Error}),Rw=yu(fs),Iw=vu(fs),Lw=Mi(fs),Bw=zi(fs),Uw=Yv(fs),Hw=Jv(fs),Pw=Fv(fs),qw=Xv(fs),Zw=Kv(fs),Gw=Wv(fs),Vw=ej(fs),Qw=tj(fs),gt=de("ZodType",(n,a)=>(dt.init(n,a),n.def=a,n.type=a.type,Object.defineProperty(n,"_def",{value:a}),n.check=(...r)=>n.clone(Pa(a,{checks:[...a.checks??[],...r.map(o=>typeof o=="function"?{_zod:{check:o,def:{check:"custom"},onattach:[]}}:o)]})),n.clone=(r,o)=>ra(n,r,o),n.brand=()=>n,n.register=((r,o)=>(r.add(n,o),n)),n.parse=(r,o)=>Rw(n,r,o,{callee:n.parse}),n.safeParse=(r,o)=>Lw(n,r,o),n.parseAsync=async(r,o)=>Iw(n,r,o,{callee:n.parseAsync}),n.safeParseAsync=async(r,o)=>Bw(n,r,o),n.spa=n.safeParseAsync,n.encode=(r,o)=>Uw(n,r,o),n.decode=(r,o)=>Hw(n,r,o),n.encodeAsync=async(r,o)=>Pw(n,r,o),n.decodeAsync=async(r,o)=>qw(n,r,o),n.safeEncode=(r,o)=>Zw(n,r,o),n.safeDecode=(r,o)=>Gw(n,r,o),n.safeEncodeAsync=async(r,o)=>Vw(n,r,o),n.safeDecodeAsync=async(r,o)=>Qw(n,r,o),n.refine=(r,o)=>n.check(I2(r,o)),n.superRefine=r=>n.check(L2(r)),n.overwrite=r=>n.check(Qr(r)),n.optional=()=>qf(n),n.nullable=()=>Zf(n),n.nullish=()=>qf(Zf(n)),n.nonoptional=r=>A2(n,r),n.array=()=>st(n),n.or=r=>v2([n,r]),n.and=r=>N2(n,r),n.transform=r=>Gf(n,k2(r)),n.default=r=>_2(n,r),n.prefault=r=>E2(n,r),n.catch=r=>M2(n,r),n.pipe=r=>Gf(n,r),n.readonly=()=>O2(n),n.describe=r=>{const o=n.clone();return fi.add(o,{description:r}),o},Object.defineProperty(n,"description",{get(){var r;return(r=fi.get(n))==null?void 0:r.description},configurable:!0}),n.meta=(...r)=>{if(r.length===0)return fi.get(n);const o=n.clone();return fi.add(o,r[0]),o},n.isOptional=()=>n.safeParse(void 0).success,n.isNullable=()=>n.safeParse(null).success,n)),tp=de("_ZodString",(n,a)=>{ju.init(n,a),gt.init(n,a);const r=n._zod.bag;n.format=r.format??null,n.minLength=r.minimum??null,n.maxLength=r.maximum??null,n.regex=(...o)=>n.check(mw(...o)),n.includes=(...o)=>n.check(hw(...o)),n.startsWith=(...o)=>n.check(pw(...o)),n.endsWith=(...o)=>n.check(bw(...o)),n.min=(...o)=>n.check(wi(...o)),n.max=(...o)=>n.check(Wh(...o)),n.length=(...o)=>n.check(ep(...o)),n.nonempty=(...o)=>n.check(wi(1,...o)),n.lowercase=o=>n.check(xw(o)),n.uppercase=o=>n.check(fw(o)),n.trim=()=>n.check(yw()),n.normalize=(...o)=>n.check(gw(...o)),n.toLowerCase=()=>n.check(vw()),n.toUpperCase=()=>n.check(jw()),n.slugify=()=>n.check(Nw())}),Yw=de("ZodString",(n,a)=>{ju.init(n,a),tp.init(n,a),n.email=r=>n.check(RN(Jw,r)),n.url=r=>n.check(HN(Fw,r)),n.jwt=r=>n.check(sw(u2,r)),n.emoji=r=>n.check(PN(Xw,r)),n.guid=r=>n.check(Rf(Uf,r)),n.uuid=r=>n.check(IN(hi,r)),n.uuidv4=r=>n.check(LN(hi,r)),n.uuidv6=r=>n.check(BN(hi,r)),n.uuidv7=r=>n.check(UN(hi,r)),n.nanoid=r=>n.check(qN(Kw,r)),n.guid=r=>n.check(Rf(Uf,r)),n.cuid=r=>n.check(ZN(Ww,r)),n.cuid2=r=>n.check(GN(e2,r)),n.ulid=r=>n.check(VN(t2,r)),n.base64=r=>n.check(WN(i2,r)),n.base64url=r=>n.check(ew(c2,r)),n.xid=r=>n.check(QN(s2,r)),n.ksuid=r=>n.check(YN(n2,r)),n.ipv4=r=>n.check(JN(a2,r)),n.ipv6=r=>n.check(FN(r2,r)),n.cidrv4=r=>n.check(XN(l2,r)),n.cidrv6=r=>n.check(KN(o2,r)),n.e164=r=>n.check(tw(d2,r)),n.datetime=r=>n.check($w(r)),n.date=r=>n.check(Aw(r)),n.time=r=>n.check(Mw(r)),n.duration=r=>n.check(Dw(r))});function ye(n){return ON(Yw,n)}const nt=de("ZodStringFormat",(n,a)=>{We.init(n,a),tp.init(n,a)}),Jw=de("ZodEmail",(n,a)=>{Zj.init(n,a),nt.init(n,a)}),Uf=de("ZodGUID",(n,a)=>{Pj.init(n,a),nt.init(n,a)}),hi=de("ZodUUID",(n,a)=>{qj.init(n,a),nt.init(n,a)}),Fw=de("ZodURL",(n,a)=>{Gj.init(n,a),nt.init(n,a)}),Xw=de("ZodEmoji",(n,a)=>{Vj.init(n,a),nt.init(n,a)}),Kw=de("ZodNanoID",(n,a)=>{Qj.init(n,a),nt.init(n,a)}),Ww=de("ZodCUID",(n,a)=>{Yj.init(n,a),nt.init(n,a)}),e2=de("ZodCUID2",(n,a)=>{Jj.init(n,a),nt.init(n,a)}),t2=de("ZodULID",(n,a)=>{Fj.init(n,a),nt.init(n,a)}),s2=de("ZodXID",(n,a)=>{Xj.init(n,a),nt.init(n,a)}),n2=de("ZodKSUID",(n,a)=>{Kj.init(n,a),nt.init(n,a)}),a2=de("ZodIPv4",(n,a)=>{nN.init(n,a),nt.init(n,a)}),r2=de("ZodIPv6",(n,a)=>{aN.init(n,a),nt.init(n,a)}),l2=de("ZodCIDRv4",(n,a)=>{rN.init(n,a),nt.init(n,a)}),o2=de("ZodCIDRv6",(n,a)=>{lN.init(n,a),nt.init(n,a)}),i2=de("ZodBase64",(n,a)=>{oN.init(n,a),nt.init(n,a)}),c2=de("ZodBase64URL",(n,a)=>{cN.init(n,a),nt.init(n,a)}),d2=de("ZodE164",(n,a)=>{dN.init(n,a),nt.init(n,a)}),u2=de("ZodJWT",(n,a)=>{mN.init(n,a),nt.init(n,a)}),sp=de("ZodNumber",(n,a)=>{Fh.init(n,a),gt.init(n,a),n.gt=(o,c)=>n.check(Lf(o,c)),n.gte=(o,c)=>n.check(Vd(o,c)),n.min=(o,c)=>n.check(Vd(o,c)),n.lt=(o,c)=>n.check(If(o,c)),n.lte=(o,c)=>n.check(Gd(o,c)),n.max=(o,c)=>n.check(Gd(o,c)),n.int=o=>n.check(Hf(o)),n.safe=o=>n.check(Hf(o)),n.positive=o=>n.check(Lf(0,o)),n.nonnegative=o=>n.check(Vd(0,o)),n.negative=o=>n.check(If(0,o)),n.nonpositive=o=>n.check(Gd(0,o)),n.multipleOf=(o,c)=>n.check(Bf(o,c)),n.step=(o,c)=>n.check(Bf(o,c)),n.finite=()=>n;const r=n._zod.bag;n.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,n.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,n.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),n.isFinite=!0,n.format=r.format??null});function Qt(n){return ow(sp,n)}const m2=de("ZodNumberFormat",(n,a)=>{xN.init(n,a),sp.init(n,a)});function Hf(n){return iw(m2,n)}const x2=de("ZodBoolean",(n,a)=>{fN.init(n,a),gt.init(n,a)});function ki(n){return cw(x2,n)}const f2=de("ZodUnknown",(n,a)=>{hN.init(n,a),gt.init(n,a)});function Pf(){return dw(f2)}const h2=de("ZodNever",(n,a)=>{pN.init(n,a),gt.init(n,a)});function p2(n){return uw(h2,n)}const b2=de("ZodArray",(n,a)=>{bN.init(n,a),gt.init(n,a),n.element=a.element,n.min=(r,o)=>n.check(wi(r,o)),n.nonempty=r=>n.check(wi(1,r)),n.max=(r,o)=>n.check(Wh(r,o)),n.length=(r,o)=>n.check(ep(r,o)),n.unwrap=()=>n.element});function st(n,a){return ww(b2,n,a)}const g2=de("ZodObject",(n,a)=>{yN.init(n,a),gt.init(n,a),Ve(n,"shape",()=>a.shape),n.keyof=()=>Nu(Object.keys(n._zod.def.shape)),n.catchall=r=>n.clone({...n._zod.def,catchall:r}),n.passthrough=()=>n.clone({...n._zod.def,catchall:Pf()}),n.loose=()=>n.clone({...n._zod.def,catchall:Pf()}),n.strict=()=>n.clone({...n._zod.def,catchall:p2()}),n.strip=()=>n.clone({...n._zod.def,catchall:void 0}),n.extend=r=>Bv(n,r),n.safeExtend=r=>Uv(n,r),n.merge=r=>Hv(n,r),n.pick=r=>Iv(n,r),n.omit=r=>Lv(n,r),n.partial=(...r)=>Pv(np,n,r[0]),n.required=(...r)=>qv(ap,n,r[0])});function bt(n,a){const r={type:"object",shape:n??{},...Ne(a)};return new g2(r)}const y2=de("ZodUnion",(n,a)=>{vN.init(n,a),gt.init(n,a),n.options=a.options});function v2(n,a){return new y2({type:"union",options:n,...Ne(a)})}const j2=de("ZodIntersection",(n,a)=>{jN.init(n,a),gt.init(n,a)});function N2(n,a){return new j2({type:"intersection",left:n,right:a})}const lu=de("ZodEnum",(n,a)=>{NN.init(n,a),gt.init(n,a),n.enum=a.entries,n.options=Object.values(a.entries);const r=new Set(Object.keys(a.entries));n.extract=(o,c)=>{const d={};for(const m of o)if(r.has(m))d[m]=a.entries[m];else throw new Error(`Key ${m} not found in enum`);return new lu({...a,checks:[],...Ne(c),entries:d})},n.exclude=(o,c)=>{const d={...a.entries};for(const m of o)if(r.has(m))delete d[m];else throw new Error(`Key ${m} not found in enum`);return new lu({...a,checks:[],...Ne(c),entries:d})}});function Nu(n,a){const r=Array.isArray(n)?Object.fromEntries(n.map(o=>[o,o])):n;return new lu({type:"enum",entries:r,...Ne(a)})}const w2=de("ZodTransform",(n,a)=>{wN.init(n,a),gt.init(n,a),n._zod.parse=(r,o)=>{if(o.direction==="backward")throw new Oh(n.constructor.name);r.addIssue=d=>{if(typeof d=="string")r.issues.push(Fl(d,r.value,a));else{const m=d;m.fatal&&(m.continue=!1),m.code??(m.code="custom"),m.input??(m.input=r.value),m.inst??(m.inst=n),r.issues.push(Fl(m))}};const c=a.transform(r.value,r);return c instanceof Promise?c.then(d=>(r.value=d,r)):(r.value=c,r)}});function k2(n){return new w2({type:"transform",transform:n})}const np=de("ZodOptional",(n,a)=>{kN.init(n,a),gt.init(n,a),n.unwrap=()=>n._zod.def.innerType});function qf(n){return new np({type:"optional",innerType:n})}const S2=de("ZodNullable",(n,a)=>{SN.init(n,a),gt.init(n,a),n.unwrap=()=>n._zod.def.innerType});function Zf(n){return new S2({type:"nullable",innerType:n})}const C2=de("ZodDefault",(n,a)=>{CN.init(n,a),gt.init(n,a),n.unwrap=()=>n._zod.def.innerType,n.removeDefault=n.unwrap});function _2(n,a){return new C2({type:"default",innerType:n,get defaultValue(){return typeof a=="function"?a():Lh(a)}})}const $2=de("ZodPrefault",(n,a)=>{_N.init(n,a),gt.init(n,a),n.unwrap=()=>n._zod.def.innerType});function E2(n,a){return new $2({type:"prefault",innerType:n,get defaultValue(){return typeof a=="function"?a():Lh(a)}})}const ap=de("ZodNonOptional",(n,a)=>{$N.init(n,a),gt.init(n,a),n.unwrap=()=>n._zod.def.innerType});function A2(n,a){return new ap({type:"nonoptional",innerType:n,...Ne(a)})}const T2=de("ZodCatch",(n,a)=>{EN.init(n,a),gt.init(n,a),n.unwrap=()=>n._zod.def.innerType,n.removeCatch=n.unwrap});function M2(n,a){return new T2({type:"catch",innerType:n,catchValue:typeof a=="function"?a:()=>a})}const z2=de("ZodPipe",(n,a)=>{AN.init(n,a),gt.init(n,a),n.in=a.in,n.out=a.out});function Gf(n,a){return new z2({type:"pipe",in:n,out:a})}const D2=de("ZodReadonly",(n,a)=>{TN.init(n,a),gt.init(n,a),n.unwrap=()=>n._zod.def.innerType});function O2(n){return new D2({type:"readonly",innerType:n})}const R2=de("ZodCustom",(n,a)=>{MN.init(n,a),gt.init(n,a)});function I2(n,a={}){return kw(R2,n,a)}function L2(n){return Sw(n)}const B2=bt({name:ye(),realm:ye(),appearance:ye(),specialTrait:ye(),charm:Qt().min(0).max(100),skillfulness:Qt().min(0).max(100)}),U2=st(B2),H2=bt({name:ye(),title:ye(),realm:ye(),personality:ye(),judgingStyle:ye(),specialty:ye()}),P2=st(H2),q2=bt({type:ye(),name:ye(),description:ye(),rules:st(ye()).min(2),winCondition:ye(),eliminationCriteria:ye(),estimatedDuration:ye()}),Z2=bt({critique:ye(),issues:st(ye()),suggestions:st(ye()),changes:st(ye()),optimizedDesign:ye(),improvementSummary:ye()}),G2=bt({contestantName:ye(),score:Qt().min(0).max(100),narrative:ye(),highlights:st(ye()),mistakes:st(ye())});st(G2);bt({score:Qt().min(0).max(100),narrative:ye(),highlights:st(ye()),mistakes:st(ye())});const V2=bt({judgeId:ye(),judgeName:ye(),score:Qt().min(0).max(100),comment:ye()});st(V2);bt({content:ye(),speaker:ye().default("解说员")});bt({narrative:ye(),commentary:ye(),danmakus:st(ye())});class Q2{async generateContestants(a,r){console.log(`[大闯关AI] 开始生成${a}名参赛者...`);const o=new Ra(U2,[],`【重要】必须严格按照JSON数组格式输出，不要添加任何解释文字。
输出格式: [{"name":"角色名","realm":"境界","appearance":"外观描述","specialTrait":"特殊特点","charm":数值,"skillfulness":数值}]`),c=`你是一个创意丰富的角色设计师。请生成${a}名风格各异的女性修仙者,她们将参加"大闯关"综艺比赛。

要求:
1. 每个角色都要有独特的个性和外观
2. 境界可以从炼气期到元婴期不等
3. 特殊特点要有趣且多样化
4. 魅力值和技巧值要有差异,不要都很高
5. 名字要符合修仙世界的风格

${o.getFormatInstruction()}`,d=`生成${a}名参赛者,要求风格多样,有强有弱,有美有丑,性格各异。`;try{const f=(await o.processWithRetry(async()=>await tt({systemInstruction:c,prompt:d,gameState:r,includeVectorMemories:!1,includePreset:!0,includeWorldbook:!0}),3)).map(h=>({id:kh(),name:h.name,gender:"Female",realm:h.realm,appearance:h.appearance,specialTrait:h.specialTrait,charm:Math.min(Math.max(h.charm||50,0),100),skillfulness:Math.min(Math.max(h.skillfulness||50,0),100),status:"active",currentScore:0,roundScores:[],isPlayerCharacter:!1}));return console.log(`[大闯关AI] 成功生成${f.length}名参赛者`),f}catch(m){throw console.error("[大闯关AI] 生成参赛者失败:",m),new Error("参赛者生成失败")}}async generateJudges(a,r){console.log(`[大闯关AI] 开始生成${a}名评委...`);const o=new Ra(P2,[],`【重要】必须严格按照JSON数组格式输出，不要添加任何解释文字。
输出格式: [{"name":"评委名","title":"称号","realm":"境界","personality":"性格","judgingStyle":"评判风格","specialty":"专长"}]`),c=`你是一个角色设计师。请生成${a}名资深的评委,他们将担任"大闯关"比赛的裁判。

要求:
1. 评委应该是修为高深的前辈
2. 每个评委要有独特的评判风格(严格、温和、古怪等)
3. 专长领域要不同(体能、智力、技巧等)
4. 称号要霸气
5. 性格要鲜明

${o.getFormatInstruction()}`,d=`生成${a}名评委,要求风格各异,评判标准不同。`;try{const f=(await o.processWithRetry(async()=>await tt({systemInstruction:c,prompt:d,gameState:r,includeVectorMemories:!1,includePreset:!0,includeWorldbook:!0}),3)).map(h=>({id:uy(),name:h.name,title:h.title,realm:h.realm,personality:h.personality,judgingStyle:h.judgingStyle,specialty:h.specialty}));return console.log(`[大闯关AI] 成功生成${f.length}名评委`),f}catch(m){throw console.error("[大闯关AI] 生成评委失败:",m),new Error("评委生成失败")}}async generateChallengeDraft(a,r,o){console.log(`[大闯关AI] 开始生成第${a}轮关卡草稿...`);const d=[3,4,5,6,7,8][a-1],m=new Ra(q2,{type:"综合",name:"未命名关卡",description:"待生成",rules:["规则1：待生成","规则2：待生成"],winCondition:"待生成",eliminationCriteria:"待生成",estimatedDuration:"30-60分钟"},`【重要】必须严格按照JSON格式输出，不要添加任何解释文字。
输出格式: {"type":"类型","name":"关卡名","description":"描述","rules":["规则1","规则2","规则3"],"winCondition":"胜利条件","eliminationCriteria":"淘汰标准","estimatedDuration":"预估时长"}`),f=`你是一个"色情大闯关"综艺节目的关卡设计大师。请为第${a}轮设计一个极具创意和色情元素的关卡。

本轮信息:
- 轮次: 第${a}轮
- 参赛人数: ${r.contestantCount}人(主要是女性参赛者)
- 难度等级: ${d}/10
- 淘汰人数: ${Math.floor(r.contestantCount/2)}人

${r.previousChallenges.length>0?`已有关卡类型: ${r.previousChallenges.map(p=>p.type).join("、")}`:""}

【重要禁止事项】
❌ 不要编造虚拟的、空洞的、科幻的术语(如"双向阀值平衡系统"、"灵犀值"、"量子感应"等)
❌ 不要造无意义的专有名词或设定
✅ 使用简单直白的日常语言描述玩法
✅ 使用现实中存在的概念和机制

【创意设计理念 - 广泛汲取灵感】

设计灵感可以来自任何领域,以下只是部分参考方向,请自由发挥创意:

**1. 综艺节目灵感(仅供参考,不必局限):**
- 真人秀类: 撕名牌、任务挑战、躲猫猫
- 益智类: 解谜、答题、推理
- 闯关类: 障碍赛、淘汰赛

**2. 传统游戏与民间活动:**
- 童年游戏: 跳房子、丢手绢、老鹰捉小鸡、木头人
- 棋牌类: 真人版大富翁、真人象棋、飞行棋
- 民俗活动: 投壶、蹴鞠、拔河、踩高跷

**3. 体育竞技与极限运动:**
- 田径类: 赛跑、跨栏、接力、跳远
- 水上类: 游泳、跳水、水球
- 极限类: 攀岩、蹦极、平衡挑战
- 球类变体: 躲避球、保龄球

**4. 修仙世界特有元素:**
- 御剑/飞行比赛、法术对决
- 阵法破解、丹药辨识
- 灵气感应、意念控制
- 仙兽驯服、符箓绘制

**5. 生存与求生类:**
- 荒野求生、资源争夺
- 饥饿游戏式生存
- 迷宫逃脱、密室破解

**6. 社交与心理类:**
- 狼人杀/卧底类推理
- 信任挑战、背叛博弈
- 谎言识别、心理战术

**7. 创意与艺术类:**
- 即兴表演、模仿秀
- 才艺展示、舞蹈对决
- 手工制作、绘画比赛

**8. 随机与运气类:**
- 抽签决定命运、骰子博弈
- 盲盒惊喜、轮盘赌
- 随机事件触发

【基础玩法机制 - 可自由组合】
竞速、平衡、记忆、反应、协作、对抗、策略、运气、表演、生存、解谜、社交...
你可以融合多种机制,创造全新的玩法!

【色情元素融合原则】
将成人内容自然融入玩法核心,不是简单叠加:
- 身体接触、暴露挑战、性刺激考验、羞耻play
- 失败惩罚: 性惩罚、公开羞辱、服务NPC等
- 要有代入感和刺激性,保持游戏性

设计示例(展示融合思路,请创造新玩法):

【肉棒攀岩墙】体能+色情: 把手是肉棒,需用手/嘴让其勃起才能抓稳

【真人飞行棋】策略+运气+色情: 掷骰子在巨型棋盘移动,落在特殊格子要接受色情惩罚

【灵气感应】修仙+色情: 蒙眼用身体感应灵气方向,身体越敏感越准确

【狼人杀羞耻版】社交+推理: 被投票出局者要当众接受羞辱惩罚

【水中寻宝】体能+运气: 在水池底寻找宝物,但水中有触手怪随机袭击

设计要求:
1. 类型多样化: 解谜/竞速/策略/技巧/体能/社交/生存/综合等
2. 灵感来源不限: 可从任何领域获取创意
3. 用简单直白的语言,不造虚拟术语
4. 色情元素自然融入玩法核心
5. 规则清晰,有明确成功/失败判定
6. 符合修仙世界背景

【必须严格遵守的JSON输出格式】
你必须返回一个JSON对象,包含以下字段:
{
  "type": "关卡类型(字符串)",
  "name": "关卡名称(字符串)",
  "description": "关卡详细描述(字符串,100-200字)",
  "rules": ["规则1(字符串)", "规则2(字符串)", "规则3(字符串)"],
  "winCondition": "胜利条件(字符串)",
  "eliminationCriteria": "淘汰标准(字符串)",
  "estimatedDuration": "预估时长(字符串)"
}

【特别注意】rules字段必须是一个字符串数组,包含至少3条具体规则,例如:
"rules": [
  "每位参赛者需要在3分钟内完成挑战",
  "失败一次扣10分,失败三次直接淘汰",
  "可以使用道具但每人限用一次"
]

不要把rules写成字符串,必须是数组格式!`,h=`设计第${a}轮关卡。

【重要格式要求】
必须返回JSON对象,其中rules字段必须是字符串数组(至少3条规则),不是字符串!

正确格式: "rules": ["规则1", "规则2", "规则3"]
错误格式: "rules": "规则1,规则2,规则3"

设计要求:
1. 基于真实综艺或游戏的玩法机制
2. 不要造虚拟术语,用简单直白的语言
3. 色情元素自然融入玩法
4. rules必须是数组,包含至少3条规则

直接返回JSON,不要其他文字。`;try{const p=await m.processWithRetry(async()=>await tt({systemInstruction:f,prompt:h,gameState:o,includeVectorMemories:!1,includePreset:!0,includeWorldbook:!0}),3),b={id:my(a),roundNumber:a,type:p.type,name:p.name,description:p.description,rules:p.rules,winCondition:p.winCondition,eliminationCriteria:p.eliminationCriteria,difficulty:d,estimatedDuration:p.estimatedDuration,draftVersion:JSON.stringify(p,null,2),finalVersion:"",optimizationProgress:0};return console.log(`[大闯关AI] 成功生成第${a}轮关卡草稿: ${b.name}`),b}catch(p){throw console.error("[大闯关AI] 生成关卡草稿失败:",p),new Error(`第${a}轮关卡草稿生成失败`)}}async generateAllChallengeDrafts(a){console.log("[大闯关AI] 开始批量生成6轮关卡草稿...");const r=[],o=[64,32,16,8,4,2];for(let c=1;c<=6;c++){const d={roundNumber:c,previousChallenges:r,contestantCount:o[c-1]},m=await this.generateChallengeDraft(c,d,a);r.push(m),await new Promise(f=>setTimeout(f,500))}return console.log("[大闯关AI] 成功生成全部6轮关卡草稿"),r}async optimizeChallenge(a,r,o){console.log(`[大闯关AI] 开始第${r}轮优化: ${a.name}`);let c=a.draftVersion;r===2&&a.optimization1?c=a.optimization1.optimizedDesign:r===3&&a.optimization2&&(c=a.optimization2.optimizedDesign);const d=new Ra(Z2,{},"【重要】必须严格按照JSON格式输出，不要添加任何解释文字。"),m=`你是一个"色情大闯关"关卡设计的严苛批评家。你的职责是从**游戏机制创新性**和**玩法趣味性**角度，对关卡设计进行犀利批判和深度优化。

当前关卡设计（第${r}轮审核）:
${c}

## 批判维度（按重要性排序）：

### 1. 【玩法机制创新性】★★★★★（最重要）
**批判要点**：
- 这个关卡的**核心玩法**是否足够创新？还是只是传统关卡换皮？
- 游戏规则是否有独特的**互动机制**？还是简单的线性流程？
- 是否有**多重玩法融合**？还是单一玩法？
- 是否有**随机性/策略性/时间压力**等增加趣味的元素？
- 参赛者的**决策空间**有多大？是否只有唯一最优解？

**常见问题**：
❌ 只是"跑得快就赢"、"分数高就过"这种浅层设计
❌ 没有玩家选择和策略空间
❌ 缺乏关卡间的玩法差异化
❌ 规则过于简单或过于复杂

### 2. 【游戏性与趣味性】★★★★☆
**批判要点**：
- 这个关卡**好玩吗**？有没有让人想一直玩下去的魅力？
- 是否有**起伏和戏剧性**？还是一成不变？
- 失败/成功的**反馈机制**是否清晰且有冲击力？
- 观众和参赛者的**代入感**如何？
- 是否有**可重复游玩价值**？

### 3. 【色情元素融合度】★★★★☆
**批判要点**：
- 色情元素是否**自然融入玩法核心**？还是生硬添加？
- 失败后果是否有**刺激性和代入感**？
- 色情场景是否**服务于游戏玩法**？还是为黄而黄？

### 4. 【规则可执行性】★★★☆☆
**批判要点**：
- 规则是否清晰且可量化判定？
- 淘汰标准是否公平合理？

## 优化要求：

**必须做到**：
1. **狠狠批判**现有设计的机制缺陷，不要客气
2. **提出至少3个具体的机制创新点**
3. **重新设计核心玩法**，而不是小修小补
4. **增加玩家选择和策略空间**
5. **融合多种玩法类型**（竞速+策略、解谜+盲盒等）
6. **输出完整的优化版关卡设计**（JSON格式）

**创新方向参考**（不要照搬）：
- 增加**资源管理**机制（性能量、时间、道具等）
- 引入**风险收益权衡**（冒险获得优势 vs 保守求稳）
- 加入**多阶段/多路径**设计
- 设置**动态难度调整**或**随机事件**
- 增加**玩家间互动**（协作/背叛/竞争）
- 融合**盲盒/抽卡**等随机元素
- 加入**限时决策**或**信息不对称**

${d.getFormatInstruction()}

返回格式示例:
{
  "critique": "【玩法机制批判】当前设计的核心问题是...(300字详细批判)",
  "issues": [
    "机制问题1：缺乏玩家决策空间，只是单纯的体能测试",
    "机制问题2：没有策略深度，最优解过于明显",
    "机制问题3：玩法单一，缺乏多样性和惊喜感"
  ],
  "suggestions": [
    "创新建议1：引入资源管理机制，玩家需要权衡体力分配",
    "创新建议2：增加多路径选择，高风险高回报 vs 低风险低回报",
    "创新建议3：融合盲盒元素，增加随机性和不确定性"
  ],
  "changes": [
    "将单一竞速改为：竞速+资源管理+路径选择的组合玩法",
    "增加关卡内的决策点：3个关键节点需要玩家做出战术选择",
    "引入动态事件：根据玩家选择触发不同色情场景"
  ],
  "optimizedDesign": "{完整的优化后关卡JSON设计}",
  "improvementSummary": "本次优化的核心是将简单的XXX改造为具有策略深度的YYY玩法..."
}`,f=`进行第${r}轮批判性优化：
1. 从玩法机制创新性角度狠狠批判当前设计
2. 提出至少3个具体的机制突破建议
3. 重新设计核心玩法，不要小修小补
4. 输出完整的优化版关卡
直接返回JSON。`;try{const h=await d.processWithRetry(async()=>await tt({systemInstruction:m,prompt:f,gameState:o,includeVectorMemories:!1,includePreset:!0,includeWorldbook:!0}),3),p={round:r,timestamp:Date.now(),critique:h.critique,issues:h.issues,suggestions:h.suggestions,changes:h.changes,optimizedDesign:h.optimizedDesign,improvementSummary:h.improvementSummary};return console.log(`[大闯关AI] 完成第${r}轮优化: ${a.name}`),p}catch(h){throw console.error("[大闯关AI] 关卡优化失败:",h),new Error(`第${r}轮优化失败`)}}async generateGroupPerformance(a,r,o){console.log(`[大闯关AI] 开始生成${a.length}名参赛者的群体表现...`);const c=a.slice(0,10).map(f=>`${f.name}(${f.realm}, 魅力${f.charm}, 技巧${f.skillfulness})`).join("; "),d=`你是综艺节目叙事者。为"大闯关"第${r.roundNumber}轮生成所有参赛者表现。

关卡: ${r.name} (${r.type})
描述: ${r.description}
参赛人数: ${a.length}人
部分参赛者: ${c}...

要求:
1. 为每人生成50-100字表现描述
2. 根据属性合理分配得分(60-95分)
3. 要有高低差异,符合淘汰赛规律
4. 精彩瞬间和失误要合理

返回JSON数组(包含全部${a.length}人):
[{
  "contestantName": "名字",
  "score": 分数,
  "narrative": "表现叙事",
  "highlights": ["精彩1","精彩2"],
  "mistakes": ["失误"]
}]`,m=`生成全部${a.length}人表现,要有层次。直接返回JSON数组。`;try{const f=await tt({systemInstruction:d,prompt:m,gameState:o,includeVectorMemories:!1,includePreset:!0,includeWorldbook:!0}),b=[...JSON.parse(f)].sort((g,w)=>w.score-g.score).map((g,w)=>{const N=a.find(j=>j.name===g.contestantName);return{contestantId:(N==null?void 0:N.id)||"",contestantName:g.contestantName,roundNumber:r.roundNumber,score:Math.min(Math.max(g.score,60),95),rank:w+1,narrative:g.narrative,highlights:g.highlights||[],mistakes:g.mistakes||[],passed:w+1<=Math.floor(a.length/2)}});return console.log("[大闯关AI] 成功生成群体表现"),b}catch(f){throw console.error("[大闯关AI] 生成群体表现失败:",f),new Error("群体表现生成失败")}}async generateIndividualPerformance(a,r,o,c){var f,h,p;console.log(`[大闯关AI] 生成${a.name}的详细表现...`);const d=`你是综艺节目叙事者。详细描述${a.name}在关卡中的表现。

参赛者: ${a.name} (${a.realm})
外观: ${a.appearance}
特点: ${a.specialTrait}
属性: 魅力${a.charm}, 技巧${a.skillfulness}

关卡: ${r.name}
${r.description}

要求:
1. 生成300-500字详细叙事
2. 描述具体动作、表情、反应
3. 要有起伏和戏剧性
4. 根据能力评分(60-95分)

返回JSON:
{
  "score": 分数,
  "narrative": "详细叙事",
  "highlights": ["精彩1","精彩2","精彩3"],
  "mistakes": ["失误1","失误2"]
}`,m=`详细描述${a.name}的表现,要生动有趣。直接返回JSON。`;try{const b=await tt({systemInstruction:d,prompt:m,gameState:c,includeVectorMemories:!0,includePreset:!0,includeWorldbook:!0}),g=JSON.parse(b),w=((h=(f=o.currentRanking)==null?void 0:f.find(N=>N.contestantId===a.id))==null?void 0:h.rank)||1;return{contestantId:a.id,contestantName:a.name,roundNumber:r.roundNumber,score:Math.min(Math.max(g.score,60),95),rank:w,narrative:g.narrative,highlights:g.highlights||[],mistakes:g.mistakes||[],passed:w<=Math.floor((((p=o.currentRanking)==null?void 0:p.length)||64)/2)}}catch(b){throw console.error("[大闯关AI] 生成个人表现失败:",b),new Error("个人表现生成失败")}}async generateJudgeScores(a,r,o){console.log(`[大闯关AI] 生成评委对${r.contestantName}的评分...`);const c=a.map(f=>`${f.name}(${f.title}, 风格:${f.judgingStyle}, 专长:${f.specialty})`).join(`
`),d=`你是评委团秘书。生成评委对参赛者的评分和评语。

参赛者: ${r.contestantName}
得分: ${r.score}分
表现: ${r.narrative.substring(0,200)}...
精彩: ${r.highlights.join("; ")}
失误: ${r.mistakes.join("; ")}

评委:
${c}

要求:
1. 每个评委根据自己风格给出评分和评语
2. 评分围绕${r.score}分波动(±5分)
3. 严格评委分低,温和评委分高
4. 评语30-80字,符合性格

返回JSON数组:
[{
  "judgeId": "ID",
  "judgeName": "名字",
  "score": 分数,
  "comment": "评语"
}]`,m=`生成${a.length}名评委评分,要符合各自风格。直接返回JSON数组。`;try{const f=await tt({systemInstruction:d,prompt:m,gameState:o,includeVectorMemories:!1,includePreset:!0,includeWorldbook:!0}),p=JSON.parse(f).map(b=>({judgeId:b.judgeId,judgeName:b.judgeName,contestantId:r.contestantId,roundNumber:r.roundNumber,score:Math.min(Math.max(b.score,0),100),comment:b.comment}));return console.log(`[大闯关AI] 成功生成${p.length}名评委的评分`),p}catch(f){throw console.error("[大闯关AI] 生成评委评分失败:",f),new Error("评委评分生成失败")}}async generateCommentary(a,r,o){console.log(`[大闯关AI] 生成${a}阶段的解说...`);const c={opening:"开场介绍",during:"比赛进行中",highlight:"精彩瞬间回顾",closing:"本轮总结",judging:"评委评分阶段"},d=`你是"大闯关"节目解说员。生成${c[a]}的解说词。

阶段: ${c[a]}
${r.challenge?`关卡: ${r.challenge.name}`:""}
${r.contestant?`焦点: ${r.contestant.name}`:""}
${r.currentAction?`动作: ${r.currentAction}`:""}

要求:
1. 语言生动活泼,有综艺感
2. 制造悬念和惊喜
3. 长度80-150字
4. 符合阶段氛围

返回JSON:
{
  "content": "解说内容",
  "speaker": "解说员"
}`,m=`生成${c[a]}解说,要有感染力。直接返回JSON。`;try{const f=await tt({systemInstruction:d,prompt:m,gameState:o,includeVectorMemories:!1,includePreset:!0,includeWorldbook:!0}),h=JSON.parse(f),p={id:Kl("commentary"),timestamp:Date.now(),roundNumber:r.roundNumber||0,phase:a,content:h.content,speaker:h.speaker||"解说员"};return console.log(`[大闯关AI] 完成${a}阶段解说生成`),p}catch(f){throw console.error("[大闯关AI] 生成解说失败:",f),new Error("解说生成失败")}}async generateDanmakuResponse(a,r,o){console.log(`[大闯关AI] 处理玩家弹幕: ${a}`);const c=`你是"大闯关"节目互动系统。玩家发送了弹幕,生成响应。

玩家弹幕: "${a}"
当前情况: ${r.currentNarrative||"比赛进行中"}
${r.contestant?`焦点选手: ${r.contestant.name}`:""}

要求:
1. 根据弹幕内容更新叙事(50-100字)
2. 解说员回应弹幕(30-50字)
3. 生成3-5条AI观众弹幕
4. 要有互动感和代入感

返回JSON:
{
  "narrative": "叙事更新",
  "commentary": "解说回应",
  "danmakus": ["弹幕1", "弹幕2", "弹幕3"]
}`,d="生成对玩家弹幕的响应,要生动有趣。直接返回JSON。";try{const m=await tt({systemInstruction:c,prompt:d,gameState:o,includeVectorMemories:!0,includePreset:!0,includeWorldbook:!0}),f=JSON.parse(m),h={narrative:f.narrative,commentary:f.commentary,danmakus:f.danmakus||[]};return console.log("[大闯关AI] 完成弹幕响应生成"),h}catch(m){throw console.error("[大闯关AI] 生成弹幕响应失败:",m),new Error("弹幕响应生成失败")}}}const sa=new Q2;function rp(n){const a=n.totalEditions+1,r=n.nextEventDate,o=r-1440*60*1e3,c={id:xy(a),edition:a,name:`第${a}届天下第一闯关大赛`,status:"countdown",scheduledDate:r,registrationDeadline:o,contestants:[],judges:[],challengesGenerated:!1,allOptimizationsComplete:!1,currentRound:0,rounds:[],finalRankings:[],viewMode:"group",isLive:!1};return console.log(`[赛事管理] 创建新赛事: ${c.name}`),c}function gn(n,a){console.log(`[赛事管理] 更新赛事状态: ${n.status} → ${a}`);const r={...n,status:a};switch(a){case"in_progress":r.startTime=Date.now(),r.isLive=!0;break;case"completed":r.endTime=Date.now(),r.isLive=!1;break}return r}function Y2(n){const a=Date.now();if(n.status==="countdown"){const r=n.scheduledDate-1728e5;if(a>=r&&a<n.registrationDeadline)return console.log("[赛事管理] 自动进入报名阶段"),gn(n,"registration")}return n.status==="registration"&&a>=n.registrationDeadline?(console.log("[赛事管理] 报名截止，进入准备阶段"),gn(n,"preparing")):n.status==="preparing"&&n.challengesGenerated&&n.allOptimizationsComplete&&n.contestants.length>=64&&a>=n.scheduledDate?(console.log("[赛事管理] 准备完成，比赛开始"),gn(n,"in_progress")):n}function J2(n,a){if(n.playerContestantId)return console.log("[赛事管理] 玩家已报名，无需重复报名"),n;if(n.status!=="registration")return console.log("[赛事管理] 当前不在报名阶段，无法报名"),n;const r={id:kh(),name:a.name,gender:"Female",realm:a.realm,appearance:a.appearance||"身姿婀娜，气质出众",specialTrait:"玩家角色",charm:a.charm||75,skillfulness:a.skillfulness||75,status:"active",currentScore:0,roundScores:[],isPlayerCharacter:!0,characterCardId:a.characterCardId};return console.log(`[赛事管理] 玩家角色 ${r.name} 报名成功`),{...n,contestants:[...n.contestants,r],playerContestantId:r.id}}function F2(n){return n.playerContestantId?n.status!=="registration"?(console.log("[赛事管理] 非报名阶段，无法取消报名"),n):(console.log("[赛事管理] 取消玩家报名"),{...n,contestants:n.contestants.filter(a=>a.id!==n.playerContestantId),playerContestantId:void 0}):(console.log("[赛事管理] 玩家未报名，无需取消"),n)}function X2(n){return n.contestants.filter(a=>a.status==="active")}function K2(n,a){console.log(`[赛事管理] 设置${a.length}个关卡草稿`);const r=a.map((o,c)=>({roundNumber:c+1,status:"draft",challenge:o,contestantIds:[],performances:[],judgeScores:[],commentary:[],danmakuHistory:[],rankings:[],advancingIds:[],eliminatedIds:[]}));return{...n,rounds:r,challengesGenerated:!0}}function Vf(n,a,r){const o=n.rounds.map(d=>d.roundNumber===a?{...d,challenge:r}:d),c=o.every(d=>d.challenge.optimizationProgress===3);return{...n,rounds:o,allOptimizationsComplete:c}}function wu(n){return n.currentRound===0||n.currentRound>6?null:n.rounds.find(a=>a.roundNumber===n.currentRound)||null}function lp(n,a){const r=n.rounds.map(o=>o.roundNumber===a.roundNumber?a:o);return{...n,rounds:r}}async function W2(n,a,r){var m,f,h,p,b,g,w,N,j,k,_;const o=wu(n);if(!o)throw new Error("没有进行中的轮次");console.log(`[流程控制] 执行第${o.roundNumber}轮比赛`);let c={...n},d={...o};try{(m=r==null?void 0:r.onProgress)==null||m.call(r,"opening",0,"正在生成开场解说...");const C=await Qf(d,"opening",a);d.commentary.push(C),(f=r==null?void 0:r.onProgress)==null||f.call(r,"opening",100,"开场解说完成"),(h=r==null?void 0:r.onProgress)==null||h.call(r,"performance",0,"正在生成选手表现..."),d=await e1(d,c,a,r),(p=r==null?void 0:r.onProgress)==null||p.call(r,"performance",100,"表演阶段完成"),(b=r==null?void 0:r.onProgress)==null||b.call(r,"judging",0,"正在生成评委评分..."),d=await t1(d,c,a,r),(g=r==null?void 0:r.onProgress)==null||g.call(r,"judging",100,"评分阶段完成"),(w=r==null?void 0:r.onProgress)==null||w.call(r,"ranking",0,"正在计算排名..."),d=s1(d,c),(N=r==null?void 0:r.onProgress)==null||N.call(r,"ranking",100,"排名计算完成"),(j=r==null?void 0:r.onProgress)==null||j.call(r,"closing",0,"正在生成结束解说...");const S=await Qf(d,"closing",a);return d.commentary.push(S),(k=r==null?void 0:r.onProgress)==null||k.call(r,"closing",100,"结束解说完成"),d.status="completed",d.endTime=Date.now(),c=lp(c,d),c=n1(c,d),console.log(`[流程控制] 第${o.roundNumber}轮完成`),c}catch(C){throw console.error("[流程控制] 轮次执行失败:",C),(_=r==null?void 0:r.onError)==null||_.call(r,C,"round"),C}}async function e1(n,a,r,o){const c=a.contestants.filter(m=>n.contestantIds.includes(m.id)&&m.status==="active"),d=await sa.generateGroupPerformance(c,n.challenge,r);return{...n,performances:d,status:"judging"}}async function t1(n,a,r,o){const c=[];for(const d of n.performances){const m=await sa.generateJudgeScores(a.judges,d,r);c.push(...m),await new Promise(f=>setTimeout(f,200))}return{...n,judgeScores:c}}async function Qf(n,a,r){const o={roundNumber:n.roundNumber,challenge:n.challenge,performances:n.performances,rankings:n.rankings};return sa.generateCommentary(a,o,r)}function s1(n,a){const r=n.performances.map(h=>{const p=n.judgeScores.filter(w=>w.contestantId===h.contestantId),b=p.length>0?p.reduce((w,N)=>w+N.score,0)/p.length:0,g=h.score*.7+b*.3;return{contestantId:h.contestantId,contestantName:h.contestantName,score:Math.round(g*10)/10}});r.sort((h,p)=>p.score-h.score);const o=r.map((h,p)=>{const b=a.contestants.find(g=>g.id===h.contestantId);return{rank:p+1,contestantId:h.contestantId,contestantName:h.contestantName,score:h.score,status:(b==null?void 0:b.status)||"active"}}),c=dy(n.roundNumber,n.contestantIds.length),d=o.slice(0,c).map(h=>h.contestantId),m=o.slice(c).map(h=>h.contestantId),f=n.performances.map(h=>{var p;return{...h,passed:d.includes(h.contestantId),rank:((p=o.find(b=>b.contestantId===h.contestantId))==null?void 0:p.rank)||0}});return{...n,rankings:o,advancingIds:d,eliminatedIds:m,performances:f}}function n1(n,a){const r=n.contestants.map(o=>{if(a.eliminatedIds.includes(o.id))return{...o,status:"eliminated",eliminatedRound:a.roundNumber};if(a.roundNumber===6&&a.advancingIds.includes(o.id))return{...o,status:"winner"};const c=a.performances.find(d=>d.contestantId===o.id);if(c){const d=[...o.roundScores];return d[a.roundNumber-1]=c.score,{...o,roundScores:d,currentScore:o.currentScore+c.score}}return o});return{...n,contestants:r}}async function a1(n,a,r){var b;const o=wu(n);if(!o)throw new Error("当前没有进行中的轮次");const c={roundNumber:o.roundNumber,challenge:o.challenge,currentNarrative:((b=o.performances[0])==null?void 0:b.narrative)||""},d=await sa.generateDanmakuResponse(a,c,r),m={id:`danmaku_${Date.now()}`,content:a,timestamp:Date.now(),type:"player",author:"你"},f=d.danmakus.map((g,w)=>({id:`danmaku_ai_${Date.now()}_${w}`,content:g,timestamp:Date.now()+w*100,type:"ai_generated",author:`观众${Math.floor(Math.random()*1e3)}`})),h={...o,danmakuHistory:[...o.danmakuHistory,m,...f]};return{event:lp(n,h),response:d}}const r1=n=>v.useMemo(()=>{const{gauntletSystem:a}=n,r=a.playerStats;return r?{participations:r.participations,wins:r.wins,bestRank:r.bestRank,totalScore:r.totalScore,averageRank:r.averageRank}:{participations:0,wins:0,bestRank:0,totalScore:0,averageRank:0}},[n.gauntletSystem.playerStats]),l1=({isOpen:n,onClose:a,gameState:r,setGameState:o,onOpenAnnouncement:c,onOpenRegistration:d,onOpenLive:m})=>{const{gauntletSystem:f}=r,h=f.currentEvent,[p,b]=v.useState(""),[g,w]=v.useState(!1),[N,j]=v.useState(!1),k=r1(r);v.useEffect(()=>{if(!h)return;const z=()=>{const L=Date.now();let T=0;switch(h.status){case"countdown":T=h.scheduledDate;break;case"registration":T=h.registrationDeadline;break;case"preparing":T=h.startTime||h.registrationDeadline+36e5;break;case"in_progress":case"completed":b("");return;default:b("");return}if(T>0){const P=T-L;if(P<=0)b("即将开始...");else{const M=Math.floor(P/864e5),R=Math.floor(P%(1e3*60*60*24)/(1e3*60*60)),Q=Math.floor(P%(1e3*60*60)/(1e3*60));let Z="";M>0&&(Z+=`${M}天 `),R>0&&(Z+=`${R}小时 `),Z+=`${Q}分`,b(Z)}}};z();const I=setInterval(z,1e3);return()=>clearInterval(I)},[h]);const C=(()=>{if(!h)return{text:"暂无赛事",color:"text-gray-400"};switch(h.status){case"countdown":return{text:"倒计时中",color:"text-blue-400"};case"registration":return{text:"报名中",color:"text-green-400"};case"preparing":return{text:"筹备中",color:"text-yellow-400"};case"in_progress":return{text:"进行中",color:"text-red-400"};case"completed":return{text:"已结束",color:"text-purple-400"};default:return{text:"未知状态",color:"text-gray-400"}}})(),S=()=>{let z=rp(f);z=gn(z,"registration"),o(I=>({...I,gauntletSystem:{...I.gauntletSystem,currentEvent:z,totalEditions:z.edition}})),console.log("[大闯关] 创建新赛事:",z.name)},E=(()=>{if(!h)return{label:"开启新赛事",disabled:!1,onClick:S,className:"bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-500 hover:to-orange-500 text-white shadow-lg hover:shadow-amber-500/30"};switch(h.status){case"countdown":return{label:"敬请期待（点击跳转报名）",disabled:!1,onClick:()=>{const z=gn(h,"registration");o(I=>({...I,gauntletSystem:{...I.gauntletSystem,currentEvent:z}}))},className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white shadow-lg hover:shadow-blue-500/30"};case"registration":return{label:"立即报名",disabled:!1,onClick:d,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white shadow-lg hover:shadow-green-500/30 animate-pulse"};case"preparing":return{label:"关卡准备中...",disabled:!0,onClick:()=>{},className:"bg-gradient-to-r from-yellow-700/50 to-amber-700/50 text-yellow-300 cursor-not-allowed"};case"in_progress":return{label:"进入直播间",disabled:!1,onClick:m,className:"bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-500 hover:to-rose-500 text-white shadow-lg hover:shadow-red-500/30"};case"completed":return{label:"查看结果",disabled:!1,onClick:m,className:"bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-500 hover:to-violet-500 text-white shadow-lg hover:shadow-purple-500/30"};default:return{label:"暂无赛事",disabled:!0,onClick:()=>{},className:"bg-gray-700/50 text-gray-500 cursor-not-allowed"}}})(),A=()=>{if(!h)return"";switch(h.status){case"countdown":return"距离开赛还有：";case"registration":return"报名截止还有：";case"preparing":return"预计开始：";default:return""}};return e.jsxs(na,{isOpen:n,onClose:a,title:"大闯关赛事大厅",size:"lg",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-6 bg-gradient-to-b from-amber-900/20 to-transparent rounded-lg border border-amber-700/20",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🏆"}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-amber-300 mb-3",children:h?`第 ${h.edition} 届天下第一闯关大赛`:"天下第一闯关大赛"}),e.jsx("div",{className:"text-4xl mb-3",children:"🏆"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-gray-400",children:"状态："}),e.jsxs("span",{className:`font-semibold ${C.color}`,children:["【",C.text,"】"]})]}),p&&e.jsxs("div",{className:"text-xl md:text-2xl font-bold text-amber-200 mb-6",children:[A(),e.jsx("span",{className:"text-white",children:p})]}),e.jsx("button",{onClick:E.onClick,disabled:E.disabled,className:`
                            w-4/5 max-w-md py-4 px-8 rounded-lg font-bold text-lg md:text-xl
                            transition-all duration-300 transform hover:scale-105
                            ${E.className}
                        `,children:E.label})]}),e.jsx("div",{className:"border-t border-stone-700/50"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>j(!0),className:`py-3 px-4 rounded-lg bg-black/30 border border-stone-700/50 \r
                                 hover:bg-black/50 hover:border-amber-700/50 transition-all\r
                                 text-amber-300 font-semibold text-sm md:text-base`,children:[e.jsx("i",{className:"fa-solid fa-trophy mr-2"}),"历届冠军"]}),e.jsxs("button",{onClick:()=>w(!0),className:`py-3 px-4 rounded-lg bg-black/30 border border-stone-700/50 \r
                                 hover:bg-black/50 hover:border-blue-700/50 transition-all\r
                                 text-blue-300 font-semibold text-sm md:text-base`,children:[e.jsx("i",{className:"fa-solid fa-scroll mr-2"}),"赛事规则"]}),e.jsxs("button",{onClick:c,disabled:!h,className:`py-3 px-4 rounded-lg border transition-all font-semibold text-sm md:text-base
                            ${h?"bg-black/30 border-stone-700/50 hover:bg-black/50 hover:border-green-700/50 text-green-300":"bg-gray-800/30 border-gray-700/30 text-gray-500 cursor-not-allowed"}`,children:[e.jsx("i",{className:"fa-solid fa-bullhorn mr-2"}),"关卡公告"]})]}),h&&e.jsxs("div",{className:"bg-red-900/20 rounded-lg p-3 border border-red-700/30",children:[e.jsxs("div",{className:"text-xs text-red-300 mb-2 flex items-center",children:[e.jsx("i",{className:"fa-solid fa-bug mr-2"}),"开发者测试面板（正式版本会移除）"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.status!=="registration"&&e.jsx("button",{onClick:()=>{const z=gn(h,"registration");o(I=>({...I,gauntletSystem:{...I.gauntletSystem,currentEvent:z}}))},className:"px-3 py-1 bg-green-700/50 hover:bg-green-600/50 text-green-300 text-xs rounded",children:"→ 报名中"}),h.status!=="preparing"&&e.jsx("button",{onClick:()=>{const z=gn(h,"preparing");o(I=>({...I,gauntletSystem:{...I.gauntletSystem,currentEvent:z}}))},className:"px-3 py-1 bg-yellow-700/50 hover:bg-yellow-600/50 text-yellow-300 text-xs rounded",children:"→ 筹备中"}),h.status!=="in_progress"&&e.jsx("button",{onClick:()=>{const z=gn(h,"in_progress");o(I=>({...I,gauntletSystem:{...I.gauntletSystem,currentEvent:z}}))},className:"px-3 py-1 bg-red-700/50 hover:bg-red-600/50 text-red-300 text-xs rounded",children:"→ 进行中（显示直播按钮）"}),h.status!=="completed"&&e.jsx("button",{onClick:()=>{const z=gn(h,"completed");o(I=>({...I,gauntletSystem:{...I.gauntletSystem,currentEvent:z}}))},className:"px-3 py-1 bg-purple-700/50 hover:bg-purple-600/50 text-purple-300 text-xs rounded",children:"→ 已结束"})]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 md:p-5 border border-stone-700/30",children:[e.jsx("h4",{className:"text-base font-bold text-amber-300 mb-4",children:"我的参赛记录："}),k.participations>0?e.jsxs("div",{className:"space-y-2 text-sm md:text-base",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-400 mr-2",children:"•"}),e.jsx("span",{className:"text-gray-300",children:"参赛次数："}),e.jsxs("span",{className:"text-white font-semibold ml-1",children:[k.participations,"次"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-400 mr-2",children:"•"}),e.jsx("span",{className:"text-gray-300",children:"最佳排名："}),e.jsxs("span",{className:"text-amber-400 font-semibold ml-1",children:["第",k.bestRank,"名"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-400 mr-2",children:"•"}),e.jsx("span",{className:"text-gray-300",children:"累计得分："}),e.jsxs("span",{className:"text-green-400 font-semibold ml-1",children:[k.totalScore,"分"]})]}),k.wins>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-400 mr-2",children:"•"}),e.jsx("span",{className:"text-gray-300",children:"冠军次数："}),e.jsxs("span",{className:"text-yellow-400 font-semibold ml-1",children:[k.wins,"次 👑"]})]})]}):e.jsx("div",{className:"text-gray-400 text-sm italic",children:"您尚未参加过大闯关赛事，快来一展身手吧！"})]}),e.jsx("div",{className:"text-center pt-2",children:e.jsx("button",{onClick:a,className:`py-3 px-8 rounded-lg bg-stone-700/50 hover:bg-stone-600/50 \r
                                 text-gray-300 hover:text-white transition-all font-semibold`,children:"返回主界面"})})]}),g&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:e.jsxs("div",{className:"bg-stone-900 rounded-lg p-6 max-w-md w-full mx-4 border border-stone-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-amber-300",children:[e.jsx("i",{className:"fa-solid fa-scroll mr-2"}),"赛事规则"]}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-white",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"space-y-3 text-gray-300 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"赛制："}),"64人淘汰赛，共6轮"]}),e.jsx("p",{children:e.jsx("strong",{className:"text-white",children:"轮次安排："})}),e.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[e.jsx("li",{children:"第一轮：64人 → 32人晋级"}),e.jsx("li",{children:"第二轮：32人 → 16人晋级"}),e.jsx("li",{children:"第三轮：16人 → 8人晋级"}),e.jsx("li",{children:"第四轮：8人 → 4人晋级"}),e.jsx("li",{children:"第五轮：4人 → 2人晋级"}),e.jsx("li",{children:"第六轮（决赛）：2人 → 1人夺冠"})]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"评判标准："}),"由专业评委现场打分，得分高者晋级"]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"关卡类型："}),"包含解谜、竞技、体能、技巧、智力、综合等"]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>w(!1),className:"py-2 px-6 rounded bg-amber-700 hover:bg-amber-600 text-white font-semibold",children:"知道了"})})]})}),N&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:e.jsxs("div",{className:"bg-stone-900 rounded-lg p-6 max-w-md w-full mx-4 border border-stone-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-amber-300",children:[e.jsx("i",{className:"fa-solid fa-trophy mr-2"}),"历届冠军"]}),e.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-white",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),f.eventHistory.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:f.eventHistory.map((z,I)=>e.jsxs("div",{className:"flex items-center justify-between bg-black/30 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:I===0?"🥇":I===1?"🥈":I===2?"🥉":"🏅"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-white text-sm",children:["第",z.edition,"届"]}),e.jsx("div",{className:"text-amber-400 text-sm",children:z.championName})]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(z.date).toLocaleDateString()})]},z.id))}):e.jsx("div",{className:"text-gray-400 text-center py-8",children:"暂无历届冠军记录"}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>j(!1),className:"py-2 px-6 rounded bg-amber-700 hover:bg-amber-600 text-white font-semibold",children:"关闭"})})]})})]})},o1=({isOpen:n,onClose:a,gameState:r,setGameState:o})=>{var P;const{gauntletSystem:c}=r,d=c.currentEvent,[m,f]=v.useState("contestants"),[h,p]=v.useState("group"),[b,g]=v.useState(""),[w,N]=v.useState(!1),[j,k]=v.useState([]),[_,C]=v.useState(null),S=v.useMemo(()=>d?wu(d):null,[d]),D=v.useMemo(()=>d?X2(d):[],[d]),E=v.useMemo(()=>S?S.danmakuHistory||[]:[],[S]),A=v.useMemo(()=>S?S.commentary||[]:[],[S]),z=v.useMemo(()=>d?d.judges||[]:[],[d]),I=v.useMemo(()=>S?S.rankings||[]:[],[S]),L=v.useCallback(async()=>{if(!(!b.trim()||!d))try{const M=await a1(d,b,r);o(R=>({...R,gauntletSystem:{...R.gauntletSystem,currentEvent:M.event}})),M.response.narrative&&k(R=>[...R,M.response.narrative]),g("")}catch(M){console.error("[直播间] 发送弹幕失败:",M)}},[b,d,r,o]),T=v.useCallback(async()=>{if(!(!d||w)){N(!0);try{const M=await W2(d,r,{onProgress:(R,Q,Z)=>{console.log(`[直播间] ${R}: ${Q}% - ${Z}`),k(G=>[...G,`[${R}] ${Z}`])},onError:(R,Q)=>{console.error(`[直播间] ${Q} 失败:`,R),k(Z=>[...Z,`[错误] ${Q}: ${R.message}`])},onStageComplete:R=>{console.log(`[直播间] ${R} 完成`)}});o(R=>({...R,gauntletSystem:{...R.gauntletSystem,currentEvent:M}}))}catch(M){console.error("[直播间] 比赛执行失败:",M)}finally{N(!1)}}},[d,r,w,o]);return d?e.jsx(na,{isOpen:n,onClose:a,title:`第${d.edition}届大闯关 - 第${(S==null?void 0:S.roundNumber)||0}轮：${((P=S==null?void 0:S.challenge)==null?void 0:P.name)||"准备中"}`,size:"xl",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-b from-black/40 to-black/20 rounded-lg p-4 min-h-[200px] max-h-[300px] overflow-y-auto border border-stone-700/50",children:[(S==null?void 0:S.challenge)&&e.jsxs("div",{className:"mb-4 pb-3 border-b border-stone-700/50",children:[e.jsxs("div",{className:"text-amber-300 font-semibold mb-1",children:["【",S.challenge.type,"关卡】",S.challenge.name]}),e.jsx("div",{className:"text-gray-300 text-sm",children:S.challenge.finalVersion||S.challenge.description})]}),h==="group"?e.jsx("div",{className:"space-y-3",children:S!=null&&S.performances&&S.performances.length>0?S.performances.map((M,R)=>e.jsxs("div",{className:`p-3 rounded-lg ${M.passed===!0?"bg-green-900/20 border border-green-700/30":M.passed===!1?"bg-red-900/20 border border-red-700/30":"bg-stone-800/30"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold text-white",children:M.contestantName}),M.score>0&&e.jsxs("span",{className:"text-amber-400",children:["得分: ",M.score.toFixed(1)]})]}),e.jsx("div",{className:"text-gray-300 text-sm",children:M.narrative||"等待表演..."})]},M.contestantId)):e.jsx("div",{className:"text-gray-400 text-center py-8",children:w?"比赛进行中...":"比赛尚未开始，点击下方按钮开始本轮比赛"})}):e.jsx("div",{children:_?(()=>{var R;const M=(R=S==null?void 0:S.performances)==null?void 0:R.find(Q=>Q.contestantId===_);return M?e.jsxs("div",{className:"p-4 bg-stone-800/30 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-white mb-3",children:M.contestantName}),e.jsx("div",{className:"text-gray-300 whitespace-pre-wrap",children:M.narrative}),M.score>0&&e.jsxs("div",{className:"mt-3 text-lg text-amber-400",children:["得分: ",M.score.toFixed(1)]})]}):e.jsx("div",{className:"text-gray-400",children:"选手尚未表演"})})():e.jsx("div",{className:"text-gray-400 text-center py-8",children:"请在下方选择要聚焦的选手"})}),j.length>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-stone-700/50",children:j.slice(-5).map((M,R)=>e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:M},R))}),E.length>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-amber-700/30 bg-black/20 rounded p-2",children:e.jsx("div",{className:"flex flex-wrap gap-2 text-sm",children:E.slice(-10).map((M,R)=>e.jsxs("span",{className:`px-2 py-1 rounded ${M.type==="player"?"bg-amber-700/30 text-amber-300":"bg-stone-700/30 text-gray-300"}`,children:[M.author&&e.jsxs("span",{className:"mr-1 opacity-70",children:[M.author,":"]}),M.content]},M.id||R))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-black/20 rounded-lg p-3 border border-stone-700/30",children:[e.jsxs("h4",{className:"text-sm font-semibold text-purple-300 mb-2",children:[e.jsx("i",{className:"fa-solid fa-microphone mr-2"}),"解说席"]}),e.jsx("div",{className:"space-y-2 max-h-24 overflow-y-auto text-sm",children:A.length>0?A.slice(-3).map((M,R)=>e.jsxs("div",{className:"text-gray-300",children:[e.jsxs("span",{className:"text-purple-400",children:[M.speaker,":"]})," ",M.content]},M.id||R)):e.jsx("div",{className:"text-gray-500 italic",children:"等待解说..."})})]}),e.jsxs("div",{className:"md:col-span-2 bg-black/20 rounded-lg p-3 border border-stone-700/30",children:[e.jsxs("h4",{className:"text-sm font-semibold text-amber-300 mb-2",children:[e.jsx("i",{className:"fa-solid fa-gavel mr-2"}),"评委席"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:z.length>0?z.map((M,R)=>e.jsxs("div",{className:"px-3 py-2 bg-stone-800/50 rounded-lg text-center",children:[e.jsx("div",{className:"text-white font-semibold text-sm",children:M.name}),e.jsx("div",{className:"text-xs text-gray-400",children:M.specialty})]},M.id)):e.jsx("div",{className:"text-gray-500 italic",children:"评委尚未就位"})})]})]}),e.jsx("div",{className:"flex gap-2 border-b border-stone-700/50 pb-2",children:[{id:"contestants",label:"参赛者",icon:"fa-users"},{id:"challenge",label:"关卡",icon:"fa-flag"},{id:"ranking",label:"排名",icon:"fa-ranking-star"},{id:"replay",label:"回放",icon:"fa-clock-rotate-left"}].map(M=>e.jsxs("button",{onClick:()=>f(M.id),className:`px-4 py-2 rounded-t-lg text-sm font-semibold transition-all
                                ${m===M.id?"bg-stone-700 text-white":"bg-transparent text-gray-400 hover:text-white hover:bg-stone-800/50"}`,children:[e.jsx("i",{className:`fa-solid ${M.icon} mr-2`}),M.label]},M.id))}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 min-h-[120px] max-h-[200px] overflow-y-auto",children:[m==="contestants"&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:D.map(M=>e.jsxs("button",{onClick:()=>{C(M.id),p("individual")},className:`p-2 rounded-lg text-left text-sm transition-all
                                        ${_===M.id?"bg-amber-700/30 border border-amber-600":"bg-stone-800/50 hover:bg-stone-700/50"}
                                        ${M.isPlayerCharacter?"ring-1 ring-green-500":""}
                                    `,children:[e.jsxs("div",{className:"font-semibold text-white truncate",children:[M.name,M.isPlayerCharacter&&e.jsx("span",{className:"ml-1 text-xs text-green-400",children:"★"})]}),e.jsx("div",{className:"text-xs text-gray-400",children:M.realm})]},M.id))}),m==="challenge"&&(S==null?void 0:S.challenge)&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"关卡名称:"}),e.jsx("span",{className:"ml-2 text-white font-semibold",children:S.challenge.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"类型:"}),e.jsx("span",{className:"ml-2 text-amber-300",children:S.challenge.type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"难度:"}),e.jsxs("span",{className:"ml-2 text-yellow-400",children:["★".repeat(S.challenge.difficulty),"☆".repeat(5-S.challenge.difficulty)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"描述:"}),e.jsx("div",{className:"mt-1 text-gray-300 text-sm",children:S.challenge.finalVersion||S.challenge.description})]})]}),m==="ranking"&&e.jsx("div",{className:"space-y-2",children:I.length>0?I.map((M,R)=>e.jsxs("div",{className:`flex items-center justify-between p-2 rounded
                                            ${R===0?"bg-amber-900/30":R===1?"bg-gray-600/30":R===2?"bg-orange-900/30":"bg-stone-800/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-lg font-bold w-8 text-center",children:R===0?"🥇":R===1?"🥈":R===2?"🥉":`${R+1}`}),e.jsx("span",{className:"text-white font-semibold",children:M.contestantName})]}),e.jsxs("span",{className:"text-amber-400 font-semibold",children:[M.score.toFixed(1),"分"]})]},M.contestantId)):e.jsx("div",{className:"text-gray-400 text-center py-4",children:"本轮比赛尚未开始，暂无排名"})}),m==="replay"&&e.jsxs("div",{className:"text-gray-400 text-center py-8",children:[e.jsx("i",{className:"fa-solid fa-clock-rotate-left text-4xl mb-2"}),e.jsx("p",{children:"回放功能开发中"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 pt-2 border-t border-stone-700/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"观看:"}),e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"viewMode",checked:h==="group",onChange:()=>p("group"),className:"text-amber-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"群体"})]}),e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"viewMode",checked:h==="individual",onChange:()=>p("individual"),className:"text-amber-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"个人"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[d.status==="in_progress"&&!w&&e.jsxs("button",{onClick:T,className:`px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 \r
                                         hover:from-green-500 hover:to-emerald-500 rounded-lg \r
                                         text-white font-semibold text-sm`,children:[e.jsx("i",{className:"fa-solid fa-play mr-2"}),"开始本轮"]}),w&&e.jsxs("div",{className:"px-4 py-2 bg-amber-600/50 rounded-lg text-amber-200 text-sm",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"比赛进行中..."]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow max-w-md",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"弹幕:"}),e.jsx("input",{type:"text",value:b,onChange:M=>g(M.target.value),onKeyPress:M=>M.key==="Enter"&&L(),placeholder:"发送弹幕...",className:`flex-grow px-3 py-2 bg-stone-800 border border-stone-700 rounded-lg \r
                                     text-white text-sm placeholder-gray-500 focus:outline-none focus:border-amber-600`}),e.jsx("button",{onClick:L,disabled:!b.trim(),className:`px-4 py-2 bg-amber-600 hover:bg-amber-500 disabled:bg-gray-700 \r
                                     disabled:cursor-not-allowed rounded-lg text-white text-sm font-semibold`,children:"发送"})]})]})]})}):e.jsx(na,{isOpen:n,onClose:a,title:"大闯关直播间",size:"xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-400",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📺"}),e.jsx("p",{className:"text-lg",children:"暂无进行中的赛事"}),e.jsx("button",{onClick:a,className:"mt-6 px-6 py-2 bg-stone-700 hover:bg-stone-600 rounded-lg",children:"返回大厅"})]})})},i1=({isOpen:n,onClose:a,gameState:r,onRegister:o,onCancelRegistration:c,onGenerateContestants:d})=>{const{gauntletSystem:m}=r,f=m.currentEvent,[h,p]=v.useState(null),[b,g]=v.useState(!1),[w,N]=v.useState(!1),[j,k]=v.useState(""),[_,C]=v.useState(""),[S,D]=v.useState(!1),E=v.useMemo(()=>{const{cardCollection:L}=r.playerProfile;return L.filter(T=>T.gender==="Female")},[r.playerProfile.cardCollection]),A=v.useMemo(()=>!f||!f.playerContestantId?null:f.contestants.find(L=>L.id===f.playerContestantId),[f]);v.useEffect(()=>{if(!f||f.status!=="registration"){k("");return}const L=()=>{const P=Date.now(),R=f.registrationDeadline-P;if(R<=0)k("报名已截止");else{const Q=Math.floor(R/36e5),Z=Math.floor(R%(1e3*60*60)/(1e3*60)),G=Math.floor(R%(1e3*60)/1e3);Q>0?k(`${Q}小时 ${Z}分 ${G}秒`):Z>0?k(`${Z}分 ${G}秒`):k(`${G}秒`)}};L();const T=setInterval(L,1e3);return()=>clearInterval(T)},[f]);const z=async()=>{if(!h){C("请先选择一个角色");return}g(!0),C("");try{await o(h),p(null)}catch(L){C(L instanceof Error?L.message:"报名失败，请重试")}finally{g(!1)}},I=async()=>{N(!0),C("");try{await c()}catch(L){C(L instanceof Error?L.message:"取消报名失败，请重试")}finally{N(!1)}};return f?f.status!=="registration"?e.jsx(na,{isOpen:n,onClose:a,title:"大闯关报名",size:"md",children:e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx("i",{className:"fa-solid fa-clock text-4xl mb-4"}),e.jsxs("p",{children:[f.status==="countdown"&&"报名尚未开始",f.status==="preparing"&&"报名已截止，关卡准备中",f.status==="in_progress"&&"比赛已开始",f.status==="completed"&&"本届赛事已结束"]})]})}):e.jsx(na,{isOpen:n,onClose:a,title:`第 ${f.edition} 届大闯关 - 报名`,size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-900/30 to-emerald-900/30 rounded-lg p-4 border border-green-700/30",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"报名状态："}),A?e.jsxs("span",{className:"text-green-400 font-semibold ml-2",children:[e.jsx("i",{className:"fa-solid fa-check-circle mr-1"}),"已报名"]}):e.jsxs("span",{className:"text-yellow-400 font-semibold ml-2",children:[e.jsx("i",{className:"fa-solid fa-hourglass-half mr-1"}),"未报名"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"报名截止："}),e.jsx("span",{className:"text-amber-300 font-semibold ml-2",children:j})]})]}),e.jsxs("div",{className:"mt-3 text-sm text-gray-400",children:["当前报名人数：",e.jsx("span",{className:"text-white font-semibold ml-1",children:f.contestants.length}),e.jsx("span",{className:"text-gray-500",children:" / 64人"})]})]}),A?e.jsxs("div",{className:"bg-black/30 rounded-lg p-5 border border-green-700/30",children:[e.jsxs("h4",{className:"text-lg font-bold text-green-300 mb-4",children:[e.jsx("i",{className:"fa-solid fa-user-check mr-2"}),"您已成功报名"]}),e.jsxs("div",{className:"flex items-center gap-4 bg-black/40 rounded-lg p-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-amber-600 to-orange-700 flex items-center justify-center text-2xl",children:"👩"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-bold text-lg",children:A.name}),e.jsx("div",{className:"text-gray-400 text-sm",children:A.realm}),e.jsxs("div",{className:"flex gap-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{children:["魅力: ",e.jsx("span",{className:"text-pink-400",children:A.charm})]}),e.jsxs("span",{children:["技巧: ",e.jsx("span",{className:"text-blue-400",children:A.skillfulness})]})]})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:I,disabled:w,className:`py-2 px-6 rounded-lg bg-red-900/50 hover:bg-red-800/50 \r
                                         text-red-300 hover:text-red-200 border border-red-700/50\r
                                         transition-all disabled:opacity-50 disabled:cursor-not-allowed`,children:w?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"取消中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-times mr-2"}),"取消报名"]})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-black/30 rounded-lg p-5 border border-stone-700/30",children:[e.jsxs("h4",{className:"text-lg font-bold text-amber-300 mb-4",children:[e.jsx("i",{className:"fa-solid fa-user-plus mr-2"}),"选择参赛角色"]}),E.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx("i",{className:"fa-solid fa-user-slash text-3xl mb-3"}),e.jsx("p",{children:"您的收藏中没有可参赛的女性角色"}),e.jsx("p",{className:"text-sm mt-2",children:"请先在商城招募女性角色"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-64 overflow-y-auto",children:E.map(L=>e.jsxs("button",{onClick:()=>p(L),className:`p-3 rounded-lg border transition-all text-left
                                                ${(h==null?void 0:h.id)===L.id?"bg-amber-900/40 border-amber-500 ring-2 ring-amber-500/50":"bg-black/40 border-stone-700/50 hover:border-amber-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-pink-600 to-rose-700 flex items-center justify-center text-lg",children:"👩"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-white font-semibold text-sm truncate",children:L.name}),e.jsx("div",{className:"text-gray-400 text-xs truncate",children:L.realm})]})]}),e.jsxs("div",{className:"flex gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:["魅力: ",e.jsx("span",{className:"text-pink-400",children:L.charm||50})]}),e.jsxs("span",{children:["技巧: ",e.jsx("span",{className:"text-blue-400",children:L.skillfulness||50})]})]})]},L.id))})]}),E.length>0&&e.jsxs("div",{className:"text-center",children:[_&&e.jsxs("div",{className:"text-red-400 text-sm mb-3",children:[e.jsx("i",{className:"fa-solid fa-exclamation-circle mr-1"}),_]}),e.jsx("button",{onClick:z,disabled:!h||b,className:`py-3 px-8 rounded-lg font-bold text-lg transition-all
                                        ${h&&!b?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white shadow-lg hover:shadow-green-500/30":"bg-gray-700/50 text-gray-500 cursor-not-allowed"}`,children:b?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"报名中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-check mr-2"}),"确认报名"]})})]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-stone-700/30",children:[e.jsxs("h4",{className:"text-base font-bold text-gray-300 mb-3",children:[e.jsx("i",{className:"fa-solid fa-users mr-2"}),"已报名参赛者",e.jsxs("span",{className:"text-gray-500 font-normal ml-2",children:["(",f.contestants.length,"人)"]})]}),f.contestants.length===0?e.jsx("div",{className:"text-gray-500 text-sm text-center py-4",children:"暂无参赛者报名"}):e.jsxs("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto",children:[f.contestants.slice(0,20).map(L=>e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm
                                        ${L.isPlayerCharacter?"bg-amber-900/50 text-amber-300 border border-amber-700/50":"bg-stone-800/50 text-gray-300"}`,children:[L.isPlayerCharacter&&e.jsx("i",{className:"fa-solid fa-star text-amber-400 mr-1 text-xs"}),L.name]},L.id)),f.contestants.length>20&&e.jsxs("div",{className:"px-3 py-1 rounded-full text-sm bg-stone-800/30 text-gray-500",children:["+",f.contestants.length-20," 更多..."]})]}),d&&f.contestants.length<64&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"text-yellow-400",children:[e.jsx("i",{className:"fa-solid fa-flask mr-1"}),"开发者测试"]}),e.jsx("button",{onClick:async()=>{D(!0),C("");try{const L=64-f.contestants.length;await d(Math.min(L,20))}catch{C("生成参赛者失败，请重试")}finally{D(!1)}},disabled:S,className:`px-3 py-1 bg-yellow-900/50 hover:bg-yellow-800/50\r
                                         text-yellow-300 rounded border border-yellow-700/50\r
                                         transition-all disabled:opacity-50 disabled:cursor-not-allowed`,children:S?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),"生成中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-users mr-1"}),"生成",Math.min(64-f.contestants.length,20),"名参赛者"]})})]})]}),e.jsx("div",{className:"text-center pt-2",children:e.jsx("button",{onClick:a,className:`py-2 px-6 rounded-lg bg-stone-700/50 hover:bg-stone-600/50 \r
                                 text-gray-300 hover:text-white transition-all`,children:"返回大厅"})})]})}):e.jsx(na,{isOpen:n,onClose:a,title:"大闯关报名",size:"md",children:e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx("i",{className:"fa-solid fa-calendar-xmark text-4xl mb-4"}),e.jsx("p",{children:"暂无进行中的赛事"})]})})},Lt={chief_physician:{id:"chief_physician",name:"主治医师",description:"负责问诊、诊断、制定治疗方案",maxStaff:2,requiredAttributes:{perception:60,skillfulness:50},benefits:["提升诊断准确度","解锁高级治疗方案"]},surgeon:{id:"surgeon",name:"手术医师",description:"负责各种手术室的操作",maxStaff:4,requiredAttributes:{skillfulness:70,charm:40},benefits:["执行手术操作","提升手术成功率"]},nurse:{id:"nurse",name:"护士",description:"辅助诊疗、护理病人",maxStaff:4,requiredAttributes:{charm:50,skillfulness:40},benefits:["辅助医师工作","提升病人配合度"]},pharmacist:{id:"pharmacist",name:"药剂师",description:"研磨药丸、配制丹药",maxStaff:2,requiredAttributes:{perception:70},benefits:["生产药剂","提升药效"]},receptionist:{id:"receptionist",name:"接待员",description:"接待病人、安排就诊",maxStaff:1,requiredAttributes:{charm:60},benefits:["加快登记速度","提升病人满意度"]}},Gs={consultation:{id:"consultation",name:"问诊",description:"对病人进行初步诊断",roomType:"consultation",duration:900*1e3,requiredStaff:[{position:"chief_physician",count:1}],rewards:{spiritStones:10,reputation:5},eroticLevel:1},follow_up:{id:"follow_up",name:"复诊",description:"对已诊断病人进行复查",roomType:"consultation",duration:600*1e3,requiredStaff:[{position:"chief_physician",count:1}],rewards:{spiritStones:5,reputation:3},eroticLevel:1},full_body_exam:{id:"full_body_exam",name:"全身体检",description:"全面检查身体各项指标",roomType:"examination",duration:1800*1e3,requiredStaff:[{position:"surgeon",count:1},{position:"nurse",count:1}],rewards:{spiritStones:20,reputation:10},eroticLevel:2},genital_measurement:{id:"genital_measurement",name:"性器官测量",description:"详细测量性器官尺寸和特征",roomType:"examination",duration:1200*1e3,requiredStaff:[{position:"surgeon",count:1}],rewards:{spiritStones:15,reputation:5},eroticLevel:4},sensitivity_test:{id:"sensitivity_test",name:"敏感度测试",description:"测试身体各部位的敏感程度",roomType:"examination",duration:2700*1e3,requiredStaff:[{position:"surgeon",count:1},{position:"nurse",count:1}],rewards:{spiritStones:30,reputation:15},eroticLevel:5},reaction_test:{id:"reaction_test",name:"反应测试",description:"测试对各种刺激的反应",roomType:"examination",duration:1800*1e3,requiredStaff:[{position:"surgeon",count:1}],rewards:{spiritStones:20,reputation:10},eroticLevel:3},medicine_injection:{id:"medicine_injection",name:"药剂注射",description:"注射治疗药剂",roomType:"injection",duration:900*1e3,requiredStaff:[{position:"nurse",count:1}],rewards:{spiritStones:10,reputation:5},eroticLevel:2},aphrodisiac_test:{id:"aphrodisiac_test",name:"催情剂测试",description:"测试催情药剂效果",roomType:"injection",duration:3600*1e3,requiredStaff:[{position:"surgeon",count:1},{position:"nurse",count:1}],rewards:{spiritStones:50,reputation:20},eroticLevel:5},anesthesia_experiment:{id:"anesthesia_experiment",name:"麻醉实验",description:"测试麻醉药剂效果",roomType:"injection",duration:2700*1e3,requiredStaff:[{position:"surgeon",count:1}],rewards:{spiritStones:30,reputation:15},eroticLevel:3},enhancement_injection:{id:"enhancement_injection",name:"强化注射",description:"注射能力强化药剂",roomType:"injection",duration:1800*1e3,requiredStaff:[{position:"surgeon",count:1}],rewards:{spiritStones:25,reputation:10},eroticLevel:2},sensitivity_training:{id:"sensitivity_training",name:"敏感度训练",description:"提升身体敏感度",roomType:"training",duration:3600*1e3,requiredStaff:[{position:"surgeon",count:1},{position:"nurse",count:1}],rewards:{spiritStones:40,reputation:20},eroticLevel:5},endurance_test:{id:"endurance_test",name:"忍耐力测试",description:"测试和训练忍耐力",roomType:"training",duration:2700*1e3,requiredStaff:[{position:"surgeon",count:1}],rewards:{spiritStones:30,reputation:15},eroticLevel:4},obedience_training:{id:"obedience_training",name:"服从性培养",description:"培养服从性和配合度",roomType:"training",duration:5400*1e3,requiredStaff:[{position:"surgeon",count:1},{position:"nurse",count:2}],rewards:{spiritStones:60,reputation:30},eroticLevel:5},special_massage:{id:"special_massage",name:"特殊按摩",description:"特殊部位的按摩治疗",roomType:"training",duration:1800*1e3,requiredStaff:[{position:"nurse",count:1}],rewards:{spiritStones:20,reputation:10},eroticLevel:4},new_drug_test:{id:"new_drug_test",name:"新药测试",description:"测试新研发药物的效果",roomType:"laboratory",duration:7200*1e3,requiredStaff:[{position:"surgeon",count:1},{position:"pharmacist",count:1}],rewards:{spiritStones:80,reputation:40},eroticLevel:4},human_experiment:{id:"human_experiment",name:"人体实验",description:"进行各种人体实验",roomType:"laboratory",duration:5400*1e3,requiredStaff:[{position:"surgeon",count:2}],rewards:{spiritStones:100,reputation:50},eroticLevel:5},data_collection:{id:"data_collection",name:"数据采集",description:"采集各种身体数据",roomType:"laboratory",duration:3600*1e3,requiredStaff:[{position:"surgeon",count:1},{position:"nurse",count:1}],rewards:{spiritStones:40,reputation:20},eroticLevel:3},mutation_research:{id:"mutation_research",name:"变异研究",description:"研究身体变异可能性",roomType:"laboratory",duration:10800*1e3,requiredStaff:[{position:"surgeon",count:2},{position:"pharmacist",count:1}],rewards:{spiritStones:150,reputation:75},eroticLevel:5},grind_pills:{id:"grind_pills",name:"研磨药丸",description:"研磨各种药丸",roomType:"pharmacy",duration:1800*1e3,requiredStaff:[{position:"pharmacist",count:1}],rewards:{spiritStones:15},eroticLevel:0},brew_elixir:{id:"brew_elixir",name:"配制丹药",description:"配制各种丹药",roomType:"pharmacy",duration:3600*1e3,requiredStaff:[{position:"pharmacist",count:1}],rewards:{spiritStones:30},eroticLevel:0}};function Si(){return{staff:[],rooms:[{id:"consultation_1",type:"consultation",name:"诊疗室",description:"问诊、诊断",maxBeds:1,currentPatients:[],assignedStaff:[],availableTasks:["consultation","follow_up"],level:1,unlocked:!0},{id:"examination_1",type:"examination",name:"体检室",description:"全身检查、敏感部位测量",maxBeds:2,currentPatients:[],assignedStaff:[],availableTasks:["full_body_exam","genital_measurement","sensitivity_test","reaction_test"],level:1,unlocked:!0},{id:"injection_1",type:"injection",name:"注射室",description:"药剂注射、效果观察",maxBeds:2,currentPatients:[],assignedStaff:[],availableTasks:["medicine_injection","aphrodisiac_test","anesthesia_experiment","enhancement_injection"],level:1,unlocked:!0},{id:"training_1",type:"training",name:"调教室",description:"敏感度训练、忍耐力测试",maxBeds:2,currentPatients:[],assignedStaff:[],availableTasks:["sensitivity_training","endurance_test","obedience_training","special_massage"],level:1,unlocked:!1},{id:"laboratory_1",type:"laboratory",name:"实验室",description:"药效测试、新药临床试验",maxBeds:2,currentPatients:[],assignedStaff:[],availableTasks:["new_drug_test","human_experiment","data_collection","mutation_research"],level:1,unlocked:!1},{id:"pharmacy_1",type:"pharmacy",name:"药房",description:"药丸研磨、丹药配制",maxBeds:0,currentPatients:[],assignedStaff:[],availableTasks:["grind_pills","brew_elixir"],level:1,unlocked:!0}],activeTasks:[],taskHistory:[],potionInventory:[{potionId:"light_anesthesia",quantity:5},{potionId:"local_anesthesia",quantity:3},{potionId:"sensitivity_enhancer",quantity:2},{potionId:"aphrodisiac_mild",quantity:5},{potionId:"healing_potion",quantity:10},{potionId:"pain_relief",quantity:5}],potionProductionQueue:[],consultationSessions:[],transferOrders:[],waitingQueue:[],config:{maxStaffPerPosition:{chief_physician:2,surgeon:4,nurse:4,pharmacist:2,receptionist:1},unlockedRooms:["consultation","examination","injection","pharmacy"]},stats:{totalTasksCompleted:0,totalPatientsServed:0,totalRevenueEarned:0,staffExperience:{}}}}function op(n,a){const r=[];return a.requiredAttributes.charm&&(n.charm||0)<a.requiredAttributes.charm&&r.push(`魅力需要 ${a.requiredAttributes.charm}，当前 ${n.charm||0}`),a.requiredAttributes.skillfulness&&(n.skillfulness||0)<a.requiredAttributes.skillfulness&&r.push(`技巧需要 ${a.requiredAttributes.skillfulness}，当前 ${n.skillfulness||0}`),a.requiredAttributes.perception&&(n.perception||0)<a.requiredAttributes.perception&&r.push(`悟性需要 ${a.requiredAttributes.perception}，当前 ${n.perception||0}`),{eligible:r.length===0,missingRequirements:r}}class c1{getOrCreateHospitalSystem(a){return a.hospitalSystem?a.hospitalSystem:Si()}initializeHospitalSystem(){return console.log("[医馆服务] 初始化医馆系统..."),Si()}getAvailableCharacters(a,r){const o=new Set(r.staff.map(c=>c.characterId));return a.playerProfile.cardCollection.filter(c=>!o.has(c.id))}canAssignToPosition(a,r,o){const c=Lt[r],d=o.staff.filter(h=>h.position===r).length;if(d>=c.maxStaff)return{canAssign:!1,reason:`${c.name}岗位已满（${d}/${c.maxStaff}）`};const m=op(a,c);if(!m.eligible)return{canAssign:!1,reason:`不满足岗位要求：${m.missingRequirements.join("；")}`};const f=o.staff.find(h=>h.characterId===a.id);return f?{canAssign:!1,reason:`该角色已被分配为${Lt[f.position].name}`}:{canAssign:!0}}assignStaff(a,r,o){const c=this.canAssignToPosition(a,r,o);if(!c.canAssign)throw new Error(c.reason);const d={characterId:a.id,characterName:a.name,position:r,startTime:Date.now(),status:"working"};return console.log(`[医馆服务] 分配 ${a.name} 为 ${Lt[r].name}`),{...o,staff:[...o.staff,d]}}removeStaff(a,r){const o=r.staff.find(c=>c.characterId===a);if(!o)throw new Error("未找到该员工");if(o.status==="busy"&&o.currentTaskId)throw new Error("该员工正在执行任务，无法移除");return console.log(`[医馆服务] 移除员工 ${o.characterName}`),{...r,staff:r.staff.filter(c=>c.characterId!==a),rooms:r.rooms.map(c=>({...c,assignedStaff:c.assignedStaff.filter(d=>d!==a)}))}}assignStaffToRoom(a,r,o){const c=o.staff.find(m=>m.characterId===a);if(!c)throw new Error("未找到该员工");const d=o.rooms.find(m=>m.id===r);if(!d)throw new Error("未找到该科室");return console.log(`[医馆服务] 分配 ${c.characterName} 到 ${d.name}`),{...o,staff:o.staff.map(m=>m.characterId===a?{...m,assignedRoom:r}:m),rooms:o.rooms.map(m=>m.id===r?{...m,assignedStaff:[...m.assignedStaff,a]}:m)}}getRoomStaff(a,r,o){const c=r.rooms.find(d=>d.id===a);return c?c.assignedStaff.map(d=>{const m=r.staff.find(h=>h.characterId===d),f=o.playerProfile.cardCollection.find(h=>h.id===d);return m&&f?{staff:m,character:f}:null}).filter(d=>d!==null):[]}getPositionStats(a){const r={chief_physician:{current:0,max:Lt.chief_physician.maxStaff},surgeon:{current:0,max:Lt.surgeon.maxStaff},nurse:{current:0,max:Lt.nurse.maxStaff},pharmacist:{current:0,max:Lt.pharmacist.maxStaff},receptionist:{current:0,max:Lt.receptionist.maxStaff}};return a.staff.forEach(o=>{r[o.position]&&r[o.position].current++}),r}getRoom(a,r){return r.rooms.find(o=>o.id===a)}getUnlockedRooms(a){return a.rooms.filter(r=>r.unlocked)}unlockRoom(a,r){return console.log(`[医馆服务] 解锁科室: ${a}`),{...r,rooms:r.rooms.map(o=>o.type===a?{...o,unlocked:!0}:o),config:{...r.config,unlockedRooms:[...r.config.unlockedRooms,a]}}}hasAvailableBed(a,r){const o=r.rooms.find(c=>c.id===a);return o?o.currentPatients.length<o.maxBeds:!1}getAvailableBedIndex(a,r){const o=r.rooms.find(d=>d.id===a);if(!o)return null;const c=new Set(o.currentPatients.map(d=>d.bedIndex));for(let d=0;d<o.maxBeds;d++)if(!c.has(d))return d;return null}canCreateTask(a,r,o){const c=Gs[a],d=o.rooms.find(f=>f.id===r);if(!d)return{canCreate:!1,reason:"科室不存在"};if(!d.unlocked)return{canCreate:!1,reason:"科室未解锁"};if(d.type!==c.roomType)return{canCreate:!1,reason:"该任务不能在此科室执行"};const m=o.staff.filter(f=>f.assignedRoom===r&&f.status==="working");for(const f of c.requiredStaff){const h=m.filter(p=>p.position===f.position).length;if(h<f.count)return{canCreate:!1,reason:`需要 ${f.count} 名${Lt[f.position].name}，当前只有 ${h} 名`}}return{canCreate:!0}}createTask(a,r,o,c,d){const m=this.canCreateTask(a,r,d);if(!m.canCreate)throw new Error(m.reason);const f=Gs[a],h=Date.now(),p={id:`task_${h}_${Math.random().toString(36).substr(2,9)}`,type:a,roomId:r,patientId:o,assignedStaffIds:c,startTime:h,endTime:h+f.duration,status:"waiting",interactionLog:[],currentChoices:[]};console.log(`[医馆服务] 创建任务: ${f.name}`);const b=d.staff.map(g=>c.includes(g.characterId)?{...g,status:"busy",currentTaskId:p.id}:g);return{hospitalSystem:{...d,staff:b,activeTasks:[...d.activeTasks,p]},task:p}}completeTask(a,r,o){var h;const c=r.activeTasks.find(p=>p.id===a);if(!c)throw new Error("任务不存在");console.log(`[医馆服务] 完成任务: ${a}`);const d={...c,status:"completed",result:o},m=r.staff.map(p=>c.assignedStaffIds.includes(p.characterId)?{...p,status:"working",currentTaskId:void 0}:p),f={...r.stats,totalTasksCompleted:r.stats.totalTasksCompleted+1,totalRevenueEarned:r.stats.totalRevenueEarned+(((h=o==null?void 0:o.rewards)==null?void 0:h.spiritStones)||0)};return{...r,staff:m,activeTasks:r.activeTasks.filter(p=>p.id!==a),taskHistory:[...r.taskHistory,d],stats:f}}getActiveTasks(a){return a.activeTasks}getRoomActiveTasks(a,r){return r.activeTasks.filter(o=>o.roomId===a)}getPotionInventory(a){return a.potionInventory}hasPotionInStock(a,r,o){const c=o.potionInventory.find(d=>d.potionId===a);return c?c.quantity>=r:!1}consumePotion(a,r,o){if(!this.hasPotionInStock(a,r,o))throw new Error("药剂库存不足");return console.log(`[医馆服务] 消耗药剂: ${a} x${r}`),{...o,potionInventory:o.potionInventory.map(c=>c.potionId===a?{...c,quantity:c.quantity-r}:c).filter(c=>c.quantity>0)}}addPotionToInventory(a,r,o,c){console.log(`[医馆服务] 添加药剂: ${a} x${r}`);const d=c.potionInventory.findIndex(m=>m.potionId===a);if(d>=0){const m=[...c.potionInventory];return m[d]={...m[d],quantity:m[d].quantity+r},{...c,potionInventory:m}}else return{...c,potionInventory:[...c.potionInventory,{potionId:a,quantity:r,producedBy:o,producedAt:Date.now()}]}}createPotionProductionTask(a,r,o,c,d){const m=Date.now(),f={id:`potion_${m}_${Math.random().toString(36).substr(2,9)}`,potionId:a,quantity:r,pharmacistId:o,startTime:m,endTime:m+c*r,status:"in_progress"};console.log(`[医馆服务] 创建药剂生产任务: ${a} x${r}`);const h=d.staff.map(p=>p.characterId===o?{...p,status:"busy",currentTaskId:f.id}:p);return{hospitalSystem:{...d,staff:h,potionProductionQueue:[...d.potionProductionQueue,f]},task:f}}completePotionProductionTask(a,r){const o=r.potionProductionQueue.find(d=>d.id===a);if(!o)throw new Error("生产任务不存在");console.log(`[医馆服务] 完成药剂生产: ${o.potionId} x${o.quantity}`);let c=this.addPotionToInventory(o.potionId,o.quantity,o.pharmacistId,r);return c={...c,staff:c.staff.map(d=>d.characterId===o.pharmacistId?{...d,status:"working",currentTaskId:void 0}:d),potionProductionQueue:c.potionProductionQueue.filter(d=>d.id!==a)},c}createConsultationSession(a,r,o,c,d){const m=c.staff.find(b=>b.characterId===r);if(!m)throw new Error("未找到主治医师");const f=d.playerProfile.cardCollection.find(b=>b.id===r);if(!f)throw new Error("未找到主治医师角色信息");const h=o.map(b=>{const g=c.staff.find(N=>N.characterId===b),w=d.playerProfile.cardCollection.find(N=>N.id===b);return!g||!w?null:{staffId:g.characterId,characterId:w.id,characterName:w.name}}).filter(b=>b!==null),p={id:`consultation_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,patientId:a,attendingPhysician:{staffId:m.characterId,characterId:f.id,characterName:f.name},assistingNurses:h,status:"in_progress",consultationLog:[],startTime:Date.now()};return console.log(`[医馆服务] 创建问诊会话: ${p.id}`),{hospitalSystem:{...c,consultationSessions:[...c.consultationSessions,p]},session:p}}createTransferOrder(a,r,o,c,d,m,f,h){const p=f.consultationSessions.find(N=>N.id===a);if(!p)throw new Error("问诊会话不存在");const b=h.hospitalPatients.find(N=>N.id===p.patientId);if(!b)throw new Error("病人不存在");const g={id:`transfer_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sourceRoom:"consultation",sourceSessionId:a,issuingPhysicianId:p.attendingPhysician.staffId,targetRoomType:r,recommendedTask:o,priority:c,patientId:p.patientId,patientName:b.medicalRecord.name,diagnosisSummary:d,specialInstructions:m,status:"pending",createdAt:Date.now()};console.log(`[医馆服务] 创建转诊单: ${g.id}`);const w=f.consultationSessions.map(N=>N.id===a?{...N,status:"pending_transfer",transferOrder:g}:N);return{hospitalSystem:{...f,consultationSessions:w,transferOrders:[...f.transferOrders,g]},transferOrder:g}}acceptTransferOrder(a,r,o,c,d){if(!d.transferOrders.find(p=>p.id===a))throw new Error("转诊单不存在");const f=d.rooms.find(p=>p.id===r);if(!f)throw new Error("目标科室不存在");if(f.currentPatients.some(p=>p.bedIndex===o))throw new Error("床位已被占用");console.log(`[医馆服务] 接受转诊单: ${a}`);const h=d.transferOrders.map(p=>p.id===a?{...p,status:"accepted",targetRoomId:r,acceptedAt:Date.now()}:p);return{...d,transferOrders:h}}addToWaitingQueue(a,r,o){return console.log(`[医馆服务] 添加病人到等待队列: ${a}`),{...o,waitingQueue:[...o.waitingQueue,{patientId:a,priority:r,registeredAt:Date.now()}]}}removeFromWaitingQueue(a,r){return{...r,waitingQueue:r.waitingQueue.filter(o=>o.patientId!==a)}}getWaitingQueue(a){const r={emergency:0,urgent:1,normal:2};return[...a.waitingQueue].sort((o,c)=>{const d=r[o.priority]-r[c.priority];return d!==0?d:o.registeredAt-c.registeredAt})}getHospitalStats(a){const r={chief_physician:0,surgeon:0,nurse:0,pharmacist:0,receptionist:0};return a.staff.forEach(o=>{r[o.position]++}),{totalStaff:a.staff.length,staffByPosition:r,unlockedRooms:a.rooms.filter(o=>o.unlocked).length,totalRooms:a.rooms.length,activeTasks:a.activeTasks.length,completedTasks:a.stats.totalTasksCompleted,waitingPatients:a.waitingQueue.length,potionTypes:a.potionInventory.length,totalPotions:a.potionInventory.reduce((o,c)=>o+c.quantity,0)}}}const ta=new c1,d1=bt({setting:ye().describe("场景环境描述"),patientCondition:ye().describe("病人当前状态描述"),staffAction:ye().describe("医护人员准备动作"),atmosphere:ye().describe("氛围渲染")}),ip=bt({id:ye().describe("行动ID"),text:ye().describe("行动描述"),type:Nu(["gentle","normal","aggressive","special"]).describe("行动类型"),eroticLevel:Qt().min(1).max(5).describe("色情程度"),riskLevel:Qt().min(1).max(5).describe("风险程度")}),u1=bt({scene:d1,narrative:ye().describe("任务开始的叙事描写"),actions:st(ip).min(2).max(4).describe("可选行动列表")}),m1=bt({success:ki().describe("行动是否成功"),narrative:ye().describe("行动过程和结果的详细描写"),patientReaction:ye().describe("病人的反应描述"),staffComment:ye().optional().describe("医护人员的评论"),nextActions:st(ip).min(2).max(4).describe("下一轮可选行动"),progressChange:Qt().min(-20).max(30).describe("任务进度变化"),patientMoodChange:Qt().min(-20).max(20).describe("病人情绪变化")}),x1=bt({success:ki().describe("任务是否成功"),finalNarrative:ye().describe("任务完成的详细描写"),summary:ye().describe("任务总结"),patientFeedback:ye().describe("病人反馈"),rewards:bt({spiritStones:Qt().optional().describe("灵石奖励"),reputation:Qt().optional().describe("声望奖励"),experience:Qt().optional().describe("经验奖励")}).optional(),patientStatusChange:bt({healthChange:Qt().optional().describe("健康变化"),satisfactionChange:Qt().optional().describe("满意度变化"),newConditions:st(ye()).optional().describe("新增状态"),curedConditions:st(ye()).optional().describe("治愈状态")}).optional()});bt({symptoms:st(ye()).describe("症状列表"),possibleCauses:st(ye()).describe("可能原因"),recommendedTreatments:st(ye()).describe("建议治疗方案"),severity:Nu(["轻微","中等","严重","危险"]).describe("严重程度"),narrative:ye().describe("诊断过程描写")});bt({findings:st(bt({area:ye().describe("检查部位"),result:ye().describe("检查结果"),abnormal:ki().describe("是否异常")})).describe("检查发现"),measurements:st(bt({item:ye().describe("测量项目"),value:ye().describe("测量值"),normal:ki().describe("是否正常")})).optional().describe("测量数据"),narrative:ye().describe("检查过程描写"),conclusion:ye().describe("检查结论")});class f1{async generateTaskStart(a,r,o,c,d){var b,g,w,N,j,k,_,C;console.log(`[医馆AI] 开始生成任务场景: ${a}`);const m=Gs[a],f=new Ra(u1,{scene:{setting:"医馆科室内",patientCondition:"病人正等待检查",staffAction:"医护人员准备就绪",atmosphere:"氛围紧张"},narrative:"任务开始...",actions:[{id:"action_1",text:"温柔地开始",type:"gentle",eroticLevel:1,riskLevel:1},{id:"action_2",text:"直接进行",type:"normal",eroticLevel:2,riskLevel:2}]},`【重要】必须严格按照JSON格式输出任务场景。
输出格式: {"scene":{"setting":"场景描述","patientCondition":"病人状态","staffAction":"医护动作","atmosphere":"氛围"},"narrative":"叙事描写","actions":[{"id":"action_1","text":"行动描述","type":"gentle|normal|aggressive|special","eroticLevel":1-5,"riskLevel":1-5}]}`),h=`你是一个擅长创作情色医疗场景的小说家。现在需要为修仙世界的医馆创作一个任务场景。

任务信息:
- 任务类型: ${m.name}
- 任务描述: ${m.description}
- 科室: ${o.name}
- 色情等级: ${m.eroticLevel}/5

病人信息:
- 名字: ${((b=r.medicalRecord)==null?void 0:b.name)||"未知"}
- 性别: ${((g=r.medicalRecord)==null?void 0:g.gender)==="Female"?"女":"男"}
- 年龄: ${((w=r.medicalRecord)==null?void 0:w.age)||"未知"}
- 背景: ${((N=r.medicalRecord)==null?void 0:N.background)||"普通修士"}
- 病症描述: ${((j=r.medicalRecord)==null?void 0:j.illnessDescription)||"待诊断"}
- 生理特征: ${((_=(k=r.medicalRecord)==null?void 0:k.sexualFeatures)==null?void 0:_.join("、"))||"普通"}

执行员工:
${c.map(S=>`- ${S.characterName} (${S.position})`).join(`
`)}

要求:
1. 场景描写要符合修仙世界风格，但带有暧昧色情元素
2. 根据任务的色情等级(${m.eroticLevel}/5)调整描写尺度
3. 生成2-4个可选行动，包含不同的风格(温柔/正常/激进/特殊)
4. 行动的色情程度和风险程度要有差异
5. 叙事描写要生动有画面感

${f.getFormatInstruction()}`,p=`为"${m.name}"任务生成开始场景。病人${((C=r.medicalRecord)==null?void 0:C.name)||"患者"}正在${o.name}等待，请创作一个引人入胜的开场。`;try{const S=await f.processWithRetry(async()=>await tt({systemInstruction:h,prompt:p,gameState:d,includeVectorMemories:!0,includePreset:!0,includeWorldbook:!0}),3);return console.log("[医馆AI] 任务场景生成成功"),S}catch(S){return console.error("[医馆AI] 任务场景生成失败:",S),this.getDefaultTaskStart(a,r,o)}}async processAction(a,r,o,c,d,m,f){var w,N,j,k,_;console.log(`[医馆AI] 处理行动: ${a.text}`);const h=Gs[r],p=new Ra(m1,{success:!0,narrative:"行动进行中...",patientReaction:"病人有所反应",progressChange:10,patientMoodChange:0,nextActions:[{id:"action_1",text:"继续当前操作",type:"normal",eroticLevel:2,riskLevel:2}]},`【重要】必须严格按照JSON格式输出行动结果。
输出格式: {"success":true/false,"narrative":"详细描写","patientReaction":"病人反应","staffComment":"可选评论","nextActions":[...],"progressChange":数值,"patientMoodChange":数值}`),b=`你是一个擅长创作情色医疗场景的小说家。现在需要描写玩家行动的结果。

当前任务: ${h.name}
任务进度: ${d}%
色情等级: ${h.eroticLevel}/5

病人信息:
- 名字: ${((w=o.medicalRecord)==null?void 0:w.name)||"未知"}
- 性别: ${((N=o.medicalRecord)==null?void 0:N.gender)==="Female"?"女":"男"}
- 病症: ${((j=o.medicalRecord)==null?void 0:j.illnessDescription)||"待诊断"}
- 生理特征: ${((_=(k=o.medicalRecord)==null?void 0:k.sexualFeatures)==null?void 0:_.join("、"))||"普通"}

之前的互动:
${m.slice(-3).join(`
`)||"(无)"}

玩家选择的行动:
- 描述: ${a.text}
- 类型: ${a.type}
- 色情程度: ${a.eroticLevel}/5
- 风险程度: ${a.riskLevel}/5

要求:
1. 根据行动类型和风险程度决定成功与否
2. 详细描写行动过程和病人的反应
3. 生成2-4个后续可选行动
4. 进度变化通常在5-25之间，失败可能为负
5. 病人情绪变化在-10到10之间

${p.getFormatInstruction()}`,g=`玩家选择了"${a.text}"，请描写这个行动的详细过程和结果。`;try{const C=await p.processWithRetry(async()=>await tt({systemInstruction:b,prompt:g,gameState:f,includeVectorMemories:!0,includePreset:!0,includeWorldbook:!0}),3);return console.log("[医馆AI] 行动结果生成成功"),C}catch(C){return console.error("[医馆AI] 行动结果生成失败:",C),this.getDefaultActionResult(a)}}async generateTaskComplete(a,r,o,c,d){var b;console.log(`[医馆AI] 生成任务完成结果: ${o?"成功":"失败"}`);const m=Gs[a],f=new Ra(x1,{success:o,finalNarrative:o?"任务圆满完成":"任务未能成功",summary:"任务已结束",patientFeedback:o?"病人表示满意":"病人略有不满"},"【重要】必须严格按照JSON格式输出任务完成结果。"),h=`你是一个擅长创作情色医疗场景的小说家。现在需要为任务生成结束描写。

任务: ${m.name}
结果: ${o?"成功":"失败"}
色情等级: ${m.eroticLevel}/5

病人: ${((b=r.medicalRecord)==null?void 0:b.name)||"患者"}

互动历程:
${c.slice(-5).join(`
`)||"(无记录)"}

要求:
1. 根据成功/失败生成合适的结局描写
2. 描写病人的最终反应和反馈
3. 总结整个任务过程
4. 如果成功，给予合理的奖励

${f.getFormatInstruction()}`,p=`任务"${m.name}"已${o?"成功":"失败"}完成，请生成结局描写。`;try{const g=await f.processWithRetry(async()=>await tt({systemInstruction:h,prompt:p,gameState:d,includeVectorMemories:!0,includePreset:!0,includeWorldbook:!0}),3);return console.log("[医馆AI] 任务完成结果生成成功"),g}catch(g){return console.error("[医馆AI] 任务完成结果生成失败:",g),this.getDefaultTaskComplete(o,m.name)}}getDefaultTaskStart(a,r,o){var d,m;const c=Gs[a];return{scene:{setting:`${o.name}内，药香袅袅，一张宽大的诊床摆在房间中央。`,patientCondition:`${((d=r.medicalRecord)==null?void 0:d.name)||"病人"}略显紧张地坐在床沿，等待着即将开始的${c.name}。`,staffAction:"医护人员正在准备需要的器具和药剂。",atmosphere:"空气中弥漫着淡淡的紧张感和期待。"},narrative:`${((m=r.medicalRecord)==null?void 0:m.name)||"病人"}被引导进入${o.name}。这里将进行${c.name}，一切准备就绪，只等开始...`,actions:[{id:"gentle_start",text:"温柔地询问病人感受，让其放松",type:"gentle",eroticLevel:1,riskLevel:1},{id:"normal_start",text:"按照标准流程开始",type:"normal",eroticLevel:2,riskLevel:2},{id:"direct_start",text:"直接进入主要环节",type:"aggressive",eroticLevel:3,riskLevel:3}]}}getDefaultActionResult(a){const r=a.riskLevel<=3||Math.random()>.3;return{success:r,narrative:r?`你的行动进展顺利。${a.text}的效果正如预期。`:"这个行动遇到了一些阻碍，效果不太理想。",patientReaction:r?"病人配合着你的动作，身体微微颤抖。":"病人显得有些抗拒，需要更温柔的方式。",progressChange:r?15:-5,patientMoodChange:r?5:-5,nextActions:[{id:"continue_gentle",text:"温柔地继续",type:"gentle",eroticLevel:2,riskLevel:1},{id:"continue_normal",text:"保持当前节奏",type:"normal",eroticLevel:3,riskLevel:2},{id:"increase_intensity",text:"加大力度",type:"aggressive",eroticLevel:4,riskLevel:4}]}}getDefaultTaskComplete(a,r){return{success:a,finalNarrative:a?`${r}顺利完成，病人的状况得到了改善。医护人员收拾好器具，任务圆满结束。`:`${r}未能达到预期效果，需要后续跟进治疗。`,summary:a?"任务成功完成":"任务未能成功",patientFeedback:a?"病人表示感谢，对治疗过程很满意。":"病人略显失望，但表示理解。",rewards:a?{spiritStones:50,reputation:10,experience:20}:void 0}}}const Qd=new f1,Yf={consultation:{bg:"from-blue-900/50 to-blue-800/50",border:"border-blue-700/50",text:"text-blue-400"},examination:{bg:"from-purple-900/50 to-purple-800/50",border:"border-purple-700/50",text:"text-purple-400"},injection:{bg:"from-green-900/50 to-green-800/50",border:"border-green-700/50",text:"text-green-400"},training:{bg:"from-red-900/50 to-red-800/50",border:"border-red-700/50",text:"text-red-400"},laboratory:{bg:"from-cyan-900/50 to-cyan-800/50",border:"border-cyan-700/50",text:"text-cyan-400"},pharmacy:{bg:"from-amber-900/50 to-amber-800/50",border:"border-amber-700/50",text:"text-amber-400"}},h1=({taskType:n,patient:a,room:r,hospitalSystem:o,gameState:c,onClose:d,onTaskComplete:m})=>{var te,ie,B,W,ne,X;const[f,h]=v.useState(!0),[p,b]=v.useState(null),[g,w]=v.useState([]),[N,j]=v.useState([]),[k,_]=v.useState(0),[C,S]=v.useState(50),[D,E]=v.useState(!1),[A,z]=v.useState(!1),[I,L]=v.useState(null),T=Gs[n],P=Yf[r.type]||Yf.consultation,M=La.useMemo(()=>o.staff.filter(J=>J.assignedRoom===r.id),[o.staff,r.id]),R=v.useCallback((J,re)=>{j(pe=>[...pe,{id:`interaction_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:J,content:re,timestamp:Date.now()}])},[]),Q=v.useCallback(()=>{var re;w([{id:"default_1",text:"温柔地开始",type:"gentle",eroticLevel:1,riskLevel:1},{id:"default_2",text:"按标准流程进行",type:"normal",eroticLevel:2,riskLevel:2},{id:"default_3",text:"直接进入主题",type:"aggressive",eroticLevel:3,riskLevel:3}]),R("narrative",`${r.name}内，药香袅袅，一切准备就绪。`),R("narrative",`${((re=a.medicalRecord)==null?void 0:re.name)||"病人"}正在等待${T.name}的开始。`),R("narrative","医护人员已经准备好器具和药剂。"),R("narrative","请选择如何开始这个任务...")},[r.name,(te=a.medicalRecord)==null?void 0:te.name,T.name,R]);v.useEffect(()=>{let J=!0,re;return(async()=>{h(!0),R("system",`【${T.name}】任务开始...`),re=setTimeout(()=>{J&&f&&(console.log("[任务交互] AI生成超时，使用默认场景"),R("system","AI生成超时，使用默认场景..."),Q(),h(!1))},5e3);try{const me=await Qd.generateTaskStart(n,a,r,M,c);J&&(clearTimeout(re),b(me),w(me.actions),R("narrative",me.scene.setting),R("narrative",me.scene.patientCondition),R("narrative",me.scene.staffAction),R("narrative",me.narrative),h(!1))}catch(me){console.error("[任务交互] 初始化失败:",me),J&&(clearTimeout(re),R("system","任务初始化遇到问题，使用默认场景..."),Q(),h(!1))}})(),()=>{J=!1,re&&clearTimeout(re)}},[]);const Z=async J=>{if(!(D||A)){E(!0),R("action",`你选择：${J.text}`);try{const re=N.map(xe=>xe.content),pe=await Qd.processAction(J,n,a,r,k,re,c),me=Math.min(100,Math.max(0,k+pe.progressChange));_(me);const ae=Math.min(100,Math.max(0,C+pe.patientMoodChange));S(ae),R("result",pe.narrative),R("narrative",pe.patientReaction),pe.staffComment&&R("narrative",`医护人员: "${pe.staffComment}"`),me>=100?await G(!0):me<=0||ae<=10?await G(!1):w(pe.nextActions)}catch(re){console.error("[任务交互] 行动处理失败:",re),R("system","行动处理遇到问题，请重试...")}finally{E(!1)}}},G=async J=>{E(!0),z(!0);try{const re=N.map(me=>me.content),pe=await Qd.generateTaskComplete(n,a,J,re,c);L(pe),R("narrative",pe.finalNarrative),R("system",`【任务${J?"成功":"失败"}】${pe.summary}`)}catch(re){console.error("[任务交互] 完成处理失败:",re),L({success:J,finalNarrative:J?"任务完成":"任务失败",summary:J?"成功":"失败",patientFeedback:"..."})}finally{E(!1)}},H=()=>{I&&m(I.success,I.rewards),d()},O=J=>{switch(J){case"gentle":return"fa-feather";case"normal":return"fa-hand";case"aggressive":return"fa-bolt";case"special":return"fa-star";default:return"fa-circle"}},U=J=>{switch(J){case"gentle":return"bg-green-900/30 border-green-700/50 hover:border-green-600 text-green-400";case"normal":return"bg-blue-900/30 border-blue-700/50 hover:border-blue-600 text-blue-400";case"aggressive":return"bg-red-900/30 border-red-700/50 hover:border-red-600 text-red-400";case"special":return"bg-purple-900/30 border-purple-700/50 hover:border-purple-600 text-purple-400";default:return"bg-stone-900/30 border-stone-700/50 hover:border-stone-600 text-stone-400"}};return e.jsx("div",{className:"fixed inset-0 z-[80] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-stone-900 rounded-xl border border-stone-700 shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:`px-6 py-4 border-b border-stone-700 bg-gradient-to-r ${P.bg}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-stone-900/50 flex items-center justify-center",children:e.jsx("i",{className:`fa-solid fa-clipboard-list text-xl ${P.text}`})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-stone-200",children:T.name}),e.jsxs("p",{className:"text-sm text-stone-400",children:[r.name," · 病人: ",((ie=a.medicalRecord)==null?void 0:ie.name)||`#${a.id.slice(-4)}`]})]})]}),e.jsx("button",{onClick:H,className:"w-10 h-10 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-stone-400 hover:text-white transition-all flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-stone-400",children:"任务进度"}),e.jsxs("span",{className:`font-bold ${k>=80?"text-green-400":k>=50?"text-amber-400":"text-stone-300"}`,children:[k,"%"]})]}),e.jsx("div",{className:"h-2 bg-stone-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${k>=80?"bg-gradient-to-r from-green-600 to-green-400":k>=50?"bg-gradient-to-r from-amber-600 to-amber-400":"bg-gradient-to-r from-stone-600 to-stone-500"}`,style:{width:`${k}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-stone-400",children:"病人情绪"}),e.jsx("span",{className:`font-bold ${C>=70?"text-pink-400":C>=40?"text-amber-400":"text-red-400"}`,children:C>=70?"配合":C>=40?"一般":"抗拒"})]}),e.jsx("div",{className:"h-2 bg-stone-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${C>=70?"bg-gradient-to-r from-pink-600 to-pink-400":C>=40?"bg-gradient-to-r from-amber-600 to-amber-400":"bg-gradient-to-r from-red-600 to-red-500"}`,style:{width:`${C}%`}})})]})]})]}),e.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[e.jsx("div",{className:"flex-grow overflow-y-auto p-6 space-y-3",children:f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-3xl text-stone-500 mb-3"}),e.jsx("p",{className:"text-stone-500",children:"正在准备任务场景..."})]})}):e.jsxs(e.Fragment,{children:[N.map(J=>e.jsxs("div",{className:`p-4 rounded-lg ${J.type==="narrative"?"bg-stone-800/50 border-l-4 border-stone-600":J.type==="action"?"bg-amber-900/20 border-l-4 border-amber-600 ml-8":J.type==="result"?"bg-blue-900/20 border-l-4 border-blue-600":"bg-stone-900/50 border-l-4 border-stone-700 text-stone-500 text-sm"}`,children:[J.type==="action"&&e.jsx("span",{className:"text-amber-500 text-sm mr-2",children:e.jsx("i",{className:"fa-solid fa-angle-right"})}),e.jsx("span",{className:J.type==="narrative"?"text-stone-300":J.type==="action"?"text-amber-300":J.type==="result"?"text-blue-300":"text-stone-500",children:J.content})]},J.id)),D&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-500 p-4",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin"}),e.jsx("span",{children:"处理中..."})]})]})}),e.jsxs("div",{className:"w-64 border-l border-stone-700 p-4 bg-stone-800/30 overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-bold text-stone-400 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-user"}),"病人信息"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-stone-500",children:"姓名"}),e.jsx("span",{className:"text-stone-300",children:((B=a.medicalRecord)==null?void 0:B.name)||"未知"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-stone-500",children:"性别"}),e.jsx("span",{className:"text-stone-300",children:((W=a.medicalRecord)==null?void 0:W.gender)==="Female"?"女":"男"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-stone-500",children:"年龄"}),e.jsxs("span",{className:"text-stone-300",children:[((ne=a.medicalRecord)==null?void 0:ne.age)||"?","岁"]})]})]}),((X=a.medicalRecord)==null?void 0:X.illnessDescription)&&e.jsxs("div",{className:"mt-3 p-2 bg-stone-900/50 rounded text-xs text-stone-400",children:[a.medicalRecord.illnessDescription.slice(0,80),a.medicalRecord.illnessDescription.length>80?"...":""]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-bold text-stone-400 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-clipboard-list"}),"任务信息"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-stone-500",children:"类型"}),e.jsx("span",{className:"text-stone-300",children:T.name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-stone-500",children:"色情度"}),e.jsx("div",{className:"flex gap-0.5",children:Array.from({length:5}).map((J,re)=>e.jsx("i",{className:`fa-solid fa-fire text-xs ${re<T.eroticLevel?"text-red-500":"text-stone-700"}`},re))})]})]}),e.jsx("p",{className:"mt-3 text-xs text-stone-500",children:T.description})]}),M.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-bold text-stone-400 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-user-nurse"}),"执行员工"]}),e.jsx("div",{className:"space-y-2",children:M.map(J=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-stone-700 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-user text-xs text-stone-400"})}),e.jsx("span",{className:"text-stone-300",children:J.characterName})]},J.characterId))})]})]})]}),e.jsx("div",{className:"border-t border-stone-700 p-4 bg-stone-800/50",children:A?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${I!=null&&I.success?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"}`,children:e.jsx("i",{className:`fa-solid ${I!=null&&I.success?"fa-check":"fa-times"} text-xl`})}),e.jsxs("div",{children:[e.jsxs("div",{className:`font-bold ${I!=null&&I.success?"text-green-400":"text-red-400"}`,children:["任务",I!=null&&I.success?"成功":"失败"]}),e.jsx("div",{className:"text-sm text-stone-400",children:I==null?void 0:I.patientFeedback})]})]}),(I==null?void 0:I.rewards)&&e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[I.rewards.spiritStones&&e.jsxs("span",{className:"text-amber-400",children:[e.jsx("i",{className:"fa-solid fa-gem mr-1"}),"+",I.rewards.spiritStones]}),I.rewards.reputation&&e.jsxs("span",{className:"text-cyan-400",children:[e.jsx("i",{className:"fa-solid fa-star mr-1"}),"+",I.rewards.reputation]})]}),e.jsx("button",{onClick:H,className:"px-6 py-2 bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-500 hover:to-amber-400 rounded-lg text-white font-bold transition-all",children:"确认"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-stone-500 mb-3",children:"选择你的行动："}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:g.map(J=>e.jsxs("button",{onClick:()=>Z(J),disabled:D||f,className:`p-3 rounded-lg border transition-all text-left ${U(J.type)} ${D||f?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:`fa-solid ${O(J.type)}`}),e.jsx("span",{className:"font-bold",children:J.text})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs opacity-70",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-fire"}),J.eroticLevel]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-exclamation-triangle"}),J.riskLevel]})]})]},J.id))})]})})]})})},cp={consultation:"fa-stethoscope",examination:"fa-microscope",injection:"fa-syringe",training:"fa-dumbbell",laboratory:"fa-flask",pharmacy:"fa-pills"},ku={consultation:{bg:"from-blue-900/50 to-blue-800/50",border:"border-blue-700/50",text:"text-blue-400"},examination:{bg:"from-purple-900/50 to-purple-800/50",border:"border-purple-700/50",text:"text-purple-400"},injection:{bg:"from-green-900/50 to-green-800/50",border:"border-green-700/50",text:"text-green-400"},training:{bg:"from-red-900/50 to-red-800/50",border:"border-red-700/50",text:"text-red-400"},laboratory:{bg:"from-cyan-900/50 to-cyan-800/50",border:"border-cyan-700/50",text:"text-cyan-400"},pharmacy:{bg:"from-amber-900/50 to-amber-800/50",border:"border-amber-700/50",text:"text-amber-400"}},p1=({room:n,hospitalSystem:a,gameState:r,onClose:o,onAssignStaff:c,onRemoveStaff:d,onUnlockRoom:m,onAssignPatient:f,onStartTask:h})=>{var L;const[p,b]=v.useState(!1),[g,w]=v.useState(!1),[N,j]=v.useState(!1),[k,_]=v.useState(null),[C,S]=v.useState(null),D=ku[n.type],E=v.useMemo(()=>a.staff.filter(T=>T.assignedRoom===n.id),[a.staff,n.id]),A=v.useMemo(()=>a.staff.filter(T=>!T.assignedRoom||T.assignedRoom!==n.id),[a.staff,n.id]),z=T=>r.playerProfile.cardCollection.find(P=>P.id===T),I=T=>Gs[T];return e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o,children:e.jsxs("div",{className:"bg-stone-900 rounded-xl border border-stone-700 shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",onClick:T=>T.stopPropagation(),children:[e.jsx("div",{className:`px-6 py-4 border-b border-stone-700 bg-gradient-to-r ${D.bg}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-stone-900/50 flex items-center justify-center",children:e.jsx("i",{className:`fa-solid ${cp[n.type]} text-xl ${D.text}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-stone-200",children:n.name}),e.jsx("p",{className:"text-sm text-stone-400",children:n.description})]})]}),e.jsx("button",{onClick:o,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-stone-400 hover:text-white transition-all flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-6",children:n.unlocked?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-stone-800/50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-1",children:"科室等级"}),e.jsxs("div",{className:`text-2xl font-bold ${D.text}`,children:["Lv.",n.level]})]}),e.jsxs("div",{className:"bg-stone-800/50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-1",children:"床位使用"}),e.jsxs("div",{className:"text-2xl font-bold text-stone-200",children:[n.currentPatients.length,e.jsxs("span",{className:"text-stone-500 text-lg",children:["/",n.maxBeds]})]})]}),e.jsxs("div",{className:"bg-stone-800/50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-1",children:"分配员工"}),e.jsx("div",{className:"text-2xl font-bold text-stone-200",children:E.length})]})]}),n.maxBeds>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-bold text-stone-400 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-bed"}),"床位状态"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:n.maxBeds}).map((T,P)=>{var R;const M=n.currentPatients.find(Q=>Q.bedIndex===P);return e.jsxs("div",{className:`rounded-lg p-4 border ${M?"bg-amber-900/20 border-amber-700/50":"bg-stone-800/30 border-stone-700/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-bold text-stone-300",children:["床位 #",P+1]}),M?e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${M.status==="in_progress"?"bg-green-900/30 text-green-400":M.status==="waiting"?"bg-yellow-900/30 text-yellow-400":"bg-blue-900/30 text-blue-400"}`,children:M.status==="in_progress"?"进行中":M.status==="waiting"?"等待中":"已完成"}):e.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-stone-700/30 text-stone-500",children:"空闲"})]}),M?e.jsxs("div",{className:"text-sm text-stone-400",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fa-solid fa-user text-xs"}),e.jsxs("span",{children:["病人 #",M.patientId.slice(-4)]})]}),M.status==="waiting"&&e.jsxs("button",{className:"w-full mt-2 py-1.5 bg-amber-700/30 hover:bg-amber-600/30 rounded text-xs text-amber-400 hover:text-amber-300 transition-all",onClick:()=>{S(M.patientId),j(!0)},children:[e.jsx("i",{className:"fa-solid fa-play mr-1"}),"开始任务"]}),M.status==="in_progress"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"text-xs text-green-400 mb-1",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-1"}),M.taskId&&((R=Gs[M.taskId])==null?void 0:R.name)||"进行中"]}),e.jsx("div",{className:"h-1.5 bg-stone-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-amber-400 rounded-full transition-all",style:{width:`${Math.min(100,(Date.now()-M.startTime)/(M.endTime-M.startTime)*100)}%`}})})]}),M.status==="completed"&&e.jsxs("div",{className:"mt-2 text-xs text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-check-circle mr-1"}),"任务完成"]})]}):e.jsxs("button",{className:"w-full mt-2 py-1.5 bg-stone-700/30 hover:bg-stone-600/30 rounded text-xs text-stone-400 hover:text-stone-300 transition-all",onClick:()=>{_(P),w(!0)},children:[e.jsx("i",{className:"fa-solid fa-plus mr-1"}),"安排病人"]})]},P)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-bold text-stone-400 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-users"}),"分配的员工"]}),e.jsxs("button",{onClick:()=>b(!0),className:"px-3 py-1 bg-cyan-900/30 hover:bg-cyan-800/40 border border-cyan-700/30 rounded text-xs text-cyan-400 transition-all",children:[e.jsx("i",{className:"fa-solid fa-plus mr-1"}),"分配员工"]})]}),E.length>0?e.jsx("div",{className:"space-y-2",children:E.map(T=>{const P=z(T.characterId),M=Lt[T.position];return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-stone-800/30 rounded-lg border border-stone-700/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-stone-700 to-stone-800 border border-stone-600 flex items-center justify-center",children:e.jsx("i",{className:`fa-solid ${(P==null?void 0:P.gender)==="Male"?"fa-user-tie":"fa-user"} text-stone-400`})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-stone-200",children:T.characterName}),e.jsx("div",{className:"text-xs text-stone-500",children:M.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${T.status==="working"?"bg-green-900/30 text-green-400":T.status==="busy"?"bg-yellow-900/30 text-yellow-400":"bg-stone-700/30 text-stone-500"}`,children:T.status==="working"?"工作中":T.status==="busy"?"执行任务":"休息"}),e.jsx("button",{onClick:()=>d(T.characterId),className:"w-7 h-7 rounded bg-stone-700/50 hover:bg-red-900/50 text-stone-500 hover:text-red-400 transition-all flex items-center justify-center",title:"移出科室",children:e.jsx("i",{className:"fa-solid fa-times text-xs"})})]})]},T.characterId)})}):e.jsxs("div",{className:"text-center py-6 text-stone-600",children:[e.jsx("i",{className:"fa-solid fa-user-slash text-2xl mb-2"}),e.jsx("p",{className:"text-sm",children:"暂无分配员工"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-bold text-stone-400 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-list-check"}),"可执行任务"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.availableTasks.map(T=>{const P=I(T);return P?e.jsxs("div",{className:"p-3 bg-stone-800/30 rounded-lg border border-stone-700/30 hover:border-stone-600/50 transition-all cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-bold text-stone-300",children:P.name}),e.jsxs("span",{className:"text-xs text-stone-500",children:[Math.floor(P.duration/6e4),"分钟"]})]}),e.jsx("p",{className:"text-xs text-stone-500 line-clamp-2",children:P.description})]},T):null})})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-stone-800/50 border border-stone-700/50 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-lock text-3xl text-stone-600"})}),e.jsx("h4",{className:"text-lg font-bold text-stone-400 mb-2",children:"科室未解锁"}),e.jsx("p",{className:"text-sm text-stone-500 mb-6",children:"需要满足以下条件才能解锁此科室"}),e.jsx("div",{className:"bg-stone-800/30 rounded-lg p-4 mb-6 max-w-sm mx-auto",children:e.jsxs("div",{className:"text-sm text-stone-400 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"需要灵石"}),e.jsx("span",{className:"text-amber-400",children:"1000"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"医馆声望"}),e.jsx("span",{className:"text-cyan-400",children:"Lv.2"})]})]})}),e.jsxs("button",{onClick:m,className:"px-6 py-2 bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-500 hover:to-amber-400 rounded-lg text-white font-bold transition-all",children:[e.jsx("i",{className:"fa-solid fa-unlock mr-2"}),"解锁科室"]})]})}),p&&e.jsx(b1,{room:n,availableStaff:A,gameState:r,onClose:()=>b(!1),onAssign:T=>{c(T),b(!1)}}),g&&k!==null&&e.jsx(g1,{room:n,bedIndex:k,availablePatients:((L=r.hospitalPatients)==null?void 0:L.filter(T=>T.status==="待诊"))||[],onClose:()=>{w(!1),_(null)},onAssign:T=>{f(T,k),w(!1),_(null)}}),N&&C&&e.jsx(y1,{room:n,patientId:C,onClose:()=>{j(!1),S(null)},onSelectTask:T=>{h(C,T),j(!1),S(null)}})]})})},b1=({room:n,availableStaff:a,gameState:r,onClose:o,onAssign:c})=>{const d=m=>r.playerProfile.cardCollection.find(f=>f.id===m);return e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o,children:e.jsxs("div",{className:"bg-stone-900 rounded-xl border border-stone-700 shadow-2xl w-full max-w-md max-h-[70vh] overflow-hidden flex flex-col",onClick:m=>m.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-4 border-b border-stone-700 bg-gradient-to-r from-stone-800 to-stone-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-stone-200",children:["分配员工到 ",n.name]}),e.jsx("button",{onClick:o,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-stone-400 hover:text-white transition-all flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:a.length>0?e.jsx("div",{className:"space-y-2",children:a.map(m=>{const f=d(m.characterId),h=Lt[m.position];return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-stone-800/30 rounded-lg border border-stone-700/30 hover:border-cyan-700/50 transition-all cursor-pointer",onClick:()=>c(m.characterId),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-stone-700 to-stone-800 border border-stone-600 flex items-center justify-center",children:e.jsx("i",{className:`fa-solid ${(f==null?void 0:f.gender)==="Male"?"fa-user-tie":"fa-user"} text-stone-400`})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-stone-200",children:m.characterName}),e.jsx("div",{className:"text-xs text-stone-500",children:h.name})]})]}),e.jsx("div",{className:"text-xs text-stone-500",children:m.assignedRoom?"已分配其他科室":"未分配"})]},m.characterId)})}):e.jsxs("div",{className:"text-center py-8 text-stone-600",children:[e.jsx("i",{className:"fa-solid fa-user-slash text-2xl mb-2"}),e.jsx("p",{className:"text-sm",children:"没有可分配的员工"}),e.jsx("p",{className:"text-xs text-stone-700 mt-1",children:"请先在人员管理中招募员工"})]})})]})})},g1=({room:n,bedIndex:a,availablePatients:r,onClose:o,onAssign:c})=>e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o,children:e.jsxs("div",{className:"bg-stone-900 rounded-xl border border-stone-700 shadow-2xl w-full max-w-md max-h-[70vh] overflow-hidden flex flex-col",onClick:d=>d.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-4 border-b border-stone-700 bg-gradient-to-r from-stone-800 to-stone-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-stone-200",children:["安排病人到 床位 #",a+1]}),e.jsx("button",{onClick:o,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-stone-400 hover:text-white transition-all flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:r.length>0?e.jsx("div",{className:"space-y-2",children:r.map(d=>{var m,f,h;return e.jsx("div",{className:"p-4 bg-stone-800/50 rounded-lg border border-stone-700/50 hover:border-amber-700/50 transition-all cursor-pointer",onClick:()=>c(d.id),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-900/30 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-user text-amber-400"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"font-bold text-stone-200",children:["病人 #",d.id.slice(-4)]}),e.jsxs("div",{className:"text-sm text-stone-400",children:[((f=(m=d.medicalRecord)==null?void 0:m.illnessDescription)==null?void 0:f.slice(0,20))||"待诊断",(h=d.medicalRecord)!=null&&h.illnessDescription&&d.medicalRecord.illnessDescription.length>20?"...":""]})]}),e.jsx("div",{className:"text-xs px-2 py-1 rounded bg-yellow-900/30 text-yellow-400",children:d.status})]})},d.id)})}):e.jsxs("div",{className:"text-center py-8 text-stone-500",children:[e.jsx("i",{className:"fa-solid fa-user-slash text-3xl mb-3 opacity-50"}),e.jsx("p",{children:"暂无待诊病人"}),e.jsx("p",{className:"text-sm mt-1",children:"请先在问诊台接待新病人"})]})})]})}),y1=({room:n,patientId:a,onClose:r,onSelectTask:o})=>{const c=ku[n.type];return e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:r,children:e.jsxs("div",{className:"bg-stone-900 rounded-xl border border-stone-700 shadow-2xl w-full max-w-md max-h-[70vh] overflow-hidden flex flex-col",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:`px-6 py-4 border-b border-stone-700 bg-gradient-to-r ${c.bg}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-stone-200",children:["选择任务 - ",n.name]}),e.jsx("button",{onClick:r,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-stone-400 hover:text-white transition-all flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("p",{className:"text-sm text-stone-400 mt-1",children:["病人 #",a.slice(-4)]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-3",children:n.availableTasks.map(d=>{const m=Gs[d];return m?e.jsx("div",{className:"p-4 bg-stone-800/50 rounded-lg border border-stone-700/50 hover:border-amber-700/50 transition-all cursor-pointer group",onClick:()=>o(d),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${c.bg} flex items-center justify-center flex-shrink-0`,children:e.jsx("i",{className:`fa-solid fa-clipboard-list ${c.text}`})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-bold text-stone-200 group-hover:text-amber-400 transition-colors",children:m.name}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"flex gap-0.5",children:Array.from({length:5}).map((f,h)=>e.jsx("i",{className:`fa-solid fa-fire text-xs ${h<m.eroticLevel?"text-red-500":"text-stone-700"}`},h))})})]}),e.jsx("p",{className:"text-sm text-stone-400 mt-1",children:m.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-stone-500",children:[e.jsxs("span",{children:[e.jsx("i",{className:"fa-solid fa-clock mr-1"}),Math.round(m.duration/1e3),"秒"]}),m.rewards&&e.jsxs(e.Fragment,{children:[m.rewards.spiritStones&&e.jsxs("span",{children:[e.jsx("i",{className:"fa-solid fa-gem mr-1 text-amber-500"}),"+",m.rewards.spiritStones]}),m.rewards.reputation&&e.jsxs("span",{children:[e.jsx("i",{className:"fa-solid fa-star mr-1 text-cyan-500"}),"+",m.rewards.reputation]})]})]})]})]})},d):null})})})]})})},v1=({hospitalSystem:n,gameState:a,onUpdateHospitalSystem:r,isLoading:o=!1})=>{const[c,d]=v.useState(null),[m,f]=v.useState({isOpen:!1,taskType:null,patientId:null,roomId:null}),h=()=>{var C;return m.patientId&&((C=a.hospitalPatients)==null?void 0:C.find(S=>S.id===m.patientId))||null},p=()=>m.roomId&&n.rooms.find(C=>C.id===m.roomId)||null,b=(C,S)=>{try{const D=ta.assignStaffToRoom(C,S,n);if(r(D),c){const E=D.rooms.find(A=>A.id===c.id);E&&d(E)}}catch(D){console.error("[科室管理] 分配员工失败:",D)}},g=C=>{const S={...n,staff:n.staff.map(D=>D.characterId===C?{...D,assignedRoom:void 0}:D),rooms:n.rooms.map(D=>({...D,assignedStaff:D.assignedStaff.filter(E=>E!==C)}))};if(r(S),c){const D=S.rooms.find(E=>E.id===c.id);D&&d(D)}},w=C=>{try{const S=ta.unlockRoom(C,n);if(r(S),c){const D=S.rooms.find(E=>E.id===c.id);D&&d(D)}}catch(S){console.error("[科室管理] 解锁科室失败:",S)}},N=(C,S,D)=>{try{const E={...n,rooms:n.rooms.map(A=>{if(A.id===D){if(A.currentPatients.some(I=>I.bedIndex===S))throw new Error("该床位已被占用");return{...A,currentPatients:[...A.currentPatients,{patientId:C,bedIndex:S,taskId:"",status:"waiting",startTime:Date.now(),endTime:Date.now()}]}}return A})};if(r(E),c){const A=E.rooms.find(z=>z.id===c.id);A&&d(A)}console.log("[科室管理] 病人已分配到床位:",{patientId:C,bedIndex:S,roomId:D})}catch(E){console.error("[科室管理] 分配病人失败:",E)}},j=(C,S,D)=>{console.log("[科室管理] 打开任务交互界面:",{patientId:C,taskType:S,roomId:D}),f({isOpen:!0,taskType:S,patientId:C,roomId:D})},k=(C,S)=>{console.log("[科室管理] 任务完成:",{success:C,rewards:S});const{patientId:D,taskType:E,roomId:A}=m;if(D&&A){const z={...n,rooms:n.rooms.map(I=>I.id===A?{...I,currentPatients:I.currentPatients.map(L=>L.patientId===D?{...L,status:"completed",endTime:Date.now()}:L)}:I)};if(r(z),c){const I=z.rooms.find(L=>L.id===c.id);I&&d(I)}C&&S&&console.log("[科室管理] 获得奖励:",S)}f({isOpen:!1,taskType:null,patientId:null,roomId:null})},_=v.useMemo(()=>{const C=n.rooms.filter(A=>A.unlocked).length,S=n.rooms.length,D=n.rooms.reduce((A,z)=>A+z.maxBeds,0),E=n.rooms.reduce((A,z)=>A+z.currentPatients.length,0);return{unlocked:C,total:S,totalBeds:D,usedBeds:E}},[n.rooms]);return o?e.jsx("div",{className:"flex-grow flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-3xl text-stone-500 mb-3"}),e.jsx("p",{className:"text-stone-500",children:"加载中..."})]})}):e.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-stone-200",children:"科室管理"}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:"管理医馆的各个科室，分配床位和任务"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-amber-400",children:[_.unlocked,"/",_.total]}),e.jsx("div",{className:"text-xs text-stone-500",children:"已解锁科室"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-cyan-400",children:[_.usedBeds,"/",_.totalBeds]}),e.jsx("div",{className:"text-xs text-stone-500",children:"床位使用"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.rooms.map(C=>{const S=ku[C.type],D=n.staff.filter(E=>E.assignedRoom===C.id).length;return e.jsxs("div",{className:`bg-stone-800/50 rounded-lg border overflow-hidden transition-all ${C.unlocked?`${S.border} hover:border-opacity-100 cursor-pointer`:"border-stone-800/50 opacity-60"}`,onClick:()=>d(C),children:[e.jsx("div",{className:`p-4 bg-gradient-to-r ${C.unlocked?S.bg:"from-stone-900/50 to-stone-800/50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${C.unlocked?"bg-stone-900/50":"bg-stone-800/50"} flex items-center justify-center`,children:e.jsx("i",{className:`fa-solid ${cp[C.type]} text-xl ${C.unlocked?S.text:"text-stone-600"}`})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:`font-bold ${C.unlocked?"text-stone-200":"text-stone-500"}`,children:C.name}),C.unlocked&&e.jsxs("span",{className:`px-1.5 py-0.5 rounded text-xs ${S.bg} ${S.text}`,children:["Lv.",C.level]})]}),e.jsx("p",{className:"text-xs text-stone-500 mt-0.5",children:C.description})]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-3",children:[e.jsxs("span",{className:"text-stone-400",children:[e.jsx("i",{className:"fa-solid fa-bed mr-1.5"}),"床位: ",C.currentPatients.length,"/",C.maxBeds]}),e.jsxs("span",{className:"text-stone-400",children:[e.jsx("i",{className:"fa-solid fa-user-nurse mr-1.5"}),"员工: ",D]})]}),C.unlocked?e.jsxs("button",{className:"w-full py-2 bg-stone-700/50 hover:bg-stone-600/50 rounded-lg text-stone-300 text-sm transition-all",children:[e.jsx("i",{className:"fa-solid fa-door-open mr-2"}),"进入科室"]}):e.jsxs("button",{className:"w-full py-2 bg-stone-900/50 rounded-lg text-stone-600 text-sm cursor-not-allowed",children:[e.jsx("i",{className:"fa-solid fa-lock mr-2"}),"未解锁"]})]})]},C.id)})}),c&&e.jsx(p1,{room:c,hospitalSystem:n,gameState:a,onClose:()=>d(null),onAssignStaff:C=>b(C,c.id),onRemoveStaff:g,onUnlockRoom:()=>w(c.type),onAssignPatient:(C,S)=>N(C,S,c.id),onStartTask:(C,S)=>j(C,S,c.id)}),m.isOpen&&m.taskType&&h()&&p()&&e.jsx(h1,{taskType:m.taskType,patient:h(),room:p(),hospitalSystem:n,gameState:a,onClose:()=>f({isOpen:!1,taskType:null,patientId:null,roomId:null}),onTaskComplete:k})]})},j1=({staff:n,character:a,hospitalSystem:r,onClose:o,onRemove:c,onAssignToRoom:d})=>{const m=Lt[n.position],f=n.assignedRoom?r.rooms.find(p=>p.id===n.assignedRoom):null,h=r.rooms.filter(p=>p.unlocked);return e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o,children:e.jsxs("div",{className:"bg-stone-900 rounded-xl border border-stone-700 shadow-2xl w-full max-w-md overflow-hidden",onClick:p=>p.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-4 border-b border-stone-700 bg-gradient-to-r from-stone-800 to-stone-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-stone-200",children:"员工详情"}),e.jsx("button",{onClick:o,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-stone-400 hover:text-white transition-all flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-amber-900/50 to-amber-800/50 border-2 border-amber-700/50 flex items-center justify-center",children:e.jsx("i",{className:`fa-solid ${a.gender==="Male"?"fa-user-tie":"fa-user"} text-2xl text-amber-400`})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-stone-100",children:a.name}),e.jsx("p",{className:"text-sm text-stone-400",children:a.realm}),e.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 rounded bg-cyan-900/30 border border-cyan-700/30 text-cyan-400 text-xs",children:m.name})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-stone-800/50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-1",children:"魅力"}),e.jsx("div",{className:"text-lg font-bold text-pink-400",children:a.charm||50})]}),e.jsxs("div",{className:"bg-stone-800/50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-1",children:"技巧"}),e.jsx("div",{className:"text-lg font-bold text-blue-400",children:a.skillfulness||50})]}),e.jsxs("div",{className:"bg-stone-800/50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-1",children:"悟性"}),e.jsx("div",{className:"text-lg font-bold text-purple-400",children:a.perception||50})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"text-sm font-semibold text-stone-400 mb-2",children:"当前分配科室"}),f?e.jsxs("div",{className:"bg-stone-800/50 rounded-lg p-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-stone-200",children:f.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${n.status==="working"?"bg-green-900/30 text-green-400":n.status==="busy"?"bg-amber-900/30 text-amber-400":"bg-stone-700/30 text-stone-400"}`,children:n.status==="working"?"工作中":n.status==="busy"?"执行任务":"休息中"})]}):e.jsx("div",{className:"bg-stone-800/50 rounded-lg p-3 text-stone-500 text-center",children:"未分配到任何科室"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"text-sm font-semibold text-stone-400 mb-2",children:"分配到科室"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:h.map(p=>e.jsx("button",{onClick:()=>d(p.id),disabled:n.assignedRoom===p.id,className:`px-3 py-2 rounded-lg text-sm transition-all ${n.assignedRoom===p.id?"bg-amber-900/30 border border-amber-700/50 text-amber-400 cursor-default":"bg-stone-800/50 border border-stone-700/50 text-stone-300 hover:bg-stone-700/50 hover:border-stone-600"}`,children:p.name},p.id))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:c,disabled:n.status==="busy",className:"flex-1 py-2 rounded-lg bg-red-900/30 border border-red-700/50 text-red-400 hover:bg-red-900/50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:"fa-solid fa-user-minus mr-2"}),"移除员工"]}),e.jsx("button",{onClick:o,className:"flex-1 py-2 rounded-lg bg-stone-700/50 border border-stone-600 text-stone-300 hover:bg-stone-600/50 transition-all",children:"关闭"})]})]})]})})},N1=({positionType:n,availableCharacters:a,hospitalSystem:r,onClose:o,onAssign:c})=>{const d=Lt[n],[m,f]=v.useState(""),h=v.useMemo(()=>a.filter(p=>p.name.toLowerCase().includes(m.toLowerCase())),[a,m]);return e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o,children:e.jsxs("div",{className:"bg-stone-900 rounded-xl border border-stone-700 shadow-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",onClick:p=>p.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-4 border-b border-stone-700 bg-gradient-to-r from-stone-800 to-stone-900 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-stone-200",children:["分配",d.name]}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:d.description})]}),e.jsx("button",{onClick:o,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-stone-400 hover:text-white transition-all flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-times"})})]})}),e.jsx("div",{className:"px-6 py-3 border-b border-stone-700/50 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:m,onChange:p=>f(p.target.value),placeholder:"搜索角色...",className:"w-full px-4 py-2 pl-10 bg-stone-800/50 border border-stone-700 rounded-lg text-stone-200 placeholder-stone-500 focus:outline-none focus:border-amber-500/50"}),e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-stone-500"})]})}),e.jsx("div",{className:"px-6 py-3 bg-stone-800/30 border-b border-stone-700/50 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsx("span",{className:"text-stone-500",children:"岗位要求:"}),d.requiredAttributes.charm&&e.jsxs("span",{className:"text-pink-400",children:[e.jsx("i",{className:"fa-solid fa-heart mr-1"}),"魅力 ≥ ",d.requiredAttributes.charm]}),d.requiredAttributes.skillfulness&&e.jsxs("span",{className:"text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-hand mr-1"}),"技巧 ≥ ",d.requiredAttributes.skillfulness]}),d.requiredAttributes.perception&&e.jsxs("span",{className:"text-purple-400",children:[e.jsx("i",{className:"fa-solid fa-eye mr-1"}),"悟性 ≥ ",d.requiredAttributes.perception]})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:h.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-3",children:h.map(p=>{const b=op(p,d),g=ta.canAssignToPosition(p,n,r);return e.jsx("div",{className:`bg-stone-800/50 rounded-lg p-4 border transition-all ${g.canAssign?"border-stone-700/50 hover:border-amber-500/30 cursor-pointer":"border-stone-800/50 opacity-60"}`,onClick:()=>g.canAssign&&c(p.id),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${b.eligible?"bg-gradient-to-br from-green-900/50 to-green-800/50 border border-green-700/50":"bg-gradient-to-br from-red-900/50 to-red-800/50 border border-red-700/50"}`,children:e.jsx("i",{className:`fa-solid ${p.gender==="Male"?"fa-user-tie":"fa-user"} text-xl ${b.eligible?"text-green-400":"text-red-400"}`})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-bold text-stone-200",children:p.name}),e.jsx("span",{className:"text-xs text-stone-500",children:p.realm})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs",children:[e.jsxs("span",{className:`${(p.charm||0)>=(d.requiredAttributes.charm||0)?"text-pink-400":"text-red-400"}`,children:["魅力 ",p.charm||50]}),e.jsxs("span",{className:`${(p.skillfulness||0)>=(d.requiredAttributes.skillfulness||0)?"text-blue-400":"text-red-400"}`,children:["技巧 ",p.skillfulness||50]}),e.jsxs("span",{className:`${(p.perception||0)>=(d.requiredAttributes.perception||0)?"text-purple-400":"text-red-400"}`,children:["悟性 ",p.perception||50]})]})]}),e.jsx("div",{className:"text-right",children:g.canAssign?e.jsxs("span",{className:"text-green-400 text-sm",children:[e.jsx("i",{className:"fa-solid fa-check-circle mr-1"}),"可分配"]}):e.jsx("span",{className:"text-red-400 text-xs",children:g.reason})})]})},p.id)})}):e.jsxs("div",{className:"text-center py-12 text-stone-500",children:[e.jsx("i",{className:"fa-solid fa-user-slash text-4xl mb-4"}),e.jsx("p",{children:"没有可分配的角色"}),e.jsx("p",{className:"text-sm mt-2",children:"请先招募更多角色到卡牌收藏中"})]})}),e.jsx("div",{className:"px-6 py-4 border-t border-stone-700 bg-stone-800/30 flex-shrink-0",children:e.jsx("button",{onClick:o,className:"w-full py-2 rounded-lg bg-stone-700/50 border border-stone-600 text-stone-300 hover:bg-stone-600/50 transition-all",children:"取消"})})]})})},w1=({hospitalSystem:n,gameState:a,onUpdateHospitalSystem:r,isLoading:o=!1})=>{const[c,d]=v.useState(null),[m,f]=v.useState(null),h=v.useMemo(()=>ta.getAvailableCharacters(a,n),[a,n]),p=v.useMemo(()=>ta.getPositionStats(n),[n]),b=v.useMemo(()=>n.staff.map(j=>{const k=a.playerProfile.cardCollection.find(_=>_.id===j.characterId);return{staff:j,character:k}}).filter(j=>j.character!==void 0),[n.staff,a.playerProfile.cardCollection]),g=j=>{if(!m)return;const k=a.playerProfile.cardCollection.find(_=>_.id===j);if(k)try{const _=ta.assignStaff(k,m,n);r(_),f(null)}catch(_){console.error("分配员工失败:",_),alert(_ instanceof Error?_.message:"分配失败")}},w=j=>{if(confirm("确定要移除该员工吗？"))try{const k=ta.removeStaff(j,n);r(k),d(null)}catch(k){console.error("移除员工失败:",k),alert(k instanceof Error?k.message:"移除失败")}},N=(j,k)=>{try{const _=ta.assignStaffToRoom(j,k,n);r(_),d(null)}catch(_){console.error("分配到科室失败:",_),alert(_ instanceof Error?_.message:"分配失败")}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-stone-700/50 bg-stone-900/30",children:[e.jsxs("h3",{className:"text-sm font-bold text-stone-400 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-chart-pie"}),"岗位概览"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(Lt).map(([j,k])=>{const _=p[j],C=_.current>=_.max;return e.jsxs("div",{className:`bg-stone-800/50 rounded-lg p-3 border transition-all ${C?"border-green-700/30":"border-stone-700/50 hover:border-amber-500/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-stone-400 text-sm",children:k.name}),e.jsxs("span",{className:`text-lg font-bold ${C?"text-green-400":"text-amber-400"}`,children:[_.current,"/",_.max]})]}),e.jsx("button",{onClick:()=>f(j),disabled:C||o,className:`w-full py-1.5 rounded text-xs font-semibold transition-all ${C?"bg-stone-700/30 text-stone-600 cursor-not-allowed":"bg-amber-900/30 text-amber-400 hover:bg-amber-900/50 border border-amber-700/30"}`,children:C?"已满":"+ 分配"})]},j)})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-stone-400 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-users"}),"当前在岗人员 (",b.length,")"]}),b.length>0?e.jsx("div",{className:"space-y-3",children:b.map(({staff:j,character:k})=>{const _=Lt[j.position],C=j.assignedRoom?n.rooms.find(S=>S.id===j.assignedRoom):null;return e.jsx("div",{onClick:()=>d({staff:j,character:k}),className:"bg-stone-800/50 rounded-lg p-4 border border-stone-700/50 hover:border-amber-500/30 transition-all cursor-pointer group",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-stone-700 to-stone-800 border border-stone-600 flex items-center justify-center group-hover:border-amber-500/50 transition-all",children:e.jsx("i",{className:`fa-solid ${k.gender==="Male"?"fa-user-tie":"fa-user"} text-xl text-stone-400 group-hover:text-amber-400 transition-colors`})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-bold text-stone-200 group-hover:text-amber-400 transition-colors",children:k.name}),e.jsx("span",{className:"px-2 py-0.5 rounded bg-cyan-900/30 border border-cyan-700/30 text-cyan-400 text-xs",children:_.name})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-stone-500",children:[e.jsx("span",{children:k.realm}),C&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:"text-amber-400/70",children:[e.jsx("i",{className:"fa-solid fa-door-open mr-1"}),C.name]})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${j.status==="working"?"bg-green-900/30 text-green-400":j.status==="busy"?"bg-amber-900/30 text-amber-400":"bg-stone-700/30 text-stone-400"}`,children:[e.jsx("i",{className:`fa-solid ${j.status==="working"?"fa-circle-check":j.status==="busy"?"fa-spinner fa-spin":"fa-moon"}`}),j.status==="working"?"工作中":j.status==="busy"?"执行任务":"休息中"]})}),e.jsx("i",{className:"fa-solid fa-chevron-right text-stone-600 group-hover:text-amber-400 transition-colors"})]})},j.characterId)})}):e.jsxs("div",{className:"text-center py-12 text-stone-500",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-stone-800/50 border-2 border-dashed border-stone-700 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-user-plus text-3xl"})}),e.jsx("p",{className:"text-lg",children:"暂无在岗人员"}),e.jsx("p",{className:"text-sm mt-2 text-stone-600",children:'点击上方岗位的"分配"按钮添加员工'})]})]}),c&&e.jsx(j1,{staff:c.staff,character:c.character,hospitalSystem:n,onClose:()=>d(null),onRemove:()=>w(c.staff.characterId),onAssignToRoom:j=>N(c.staff.characterId,j)}),m&&e.jsx(N1,{positionType:m,availableCharacters:h,hospitalSystem:n,onClose:()=>f(null),onAssign:g})]})},k1=({isOpen:n,onClose:a,patients:r,onStartConsultation:o,onRefresh:c,onAddPatient:d,isLoading:m,onViewRecord:f,consultationPatient:h,consultationStory:p,consultationChoices:b,onConsultationAction:g,onEndConsultation:w,onReturnToList:N,gameState:j,hospitalSystem:k,onUpdateHospitalSystem:_})=>{const[C,S]=v.useState("patients"),[D,E]=v.useState("Female"),[A,z]=v.useState("待诊"),[I,L]=v.useState(""),T=v.useMemo(()=>k||Si(),[k]);if(!n)return null;if(h)return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-fade-in-up",onClick:a,children:e.jsxs("div",{className:"ornate-border w-full max-w-6xl h-[85vh] relative bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 rounded-xl shadow-2xl overflow-hidden flex flex-col",onClick:O=>O.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent z-10"}),e.jsxs("div",{className:"relative px-6 py-4 border-b border-stone-700/50 bg-gradient-to-r from-stone-800/50 to-stone-900/50 flex justify-between items-center flex-shrink-0 z-10",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-user-md text-amber-500 text-xl"}),e.jsxs("h2",{className:"text-2xl font-bold text-gradient-gold text-shadow-glow",children:["诊疗室 - ",h.medicalRecord.name]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-red-400/80",children:[e.jsx("i",{className:"fa-solid fa-notes-medical"}),e.jsx("p",{className:"max-w-md truncate",children:h.medicalRecord.illnessDescription})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:N,className:"px-4 py-1.5 rounded-lg border border-stone-600 bg-stone-800/50 hover:bg-stone-700/50 text-stone-300 hover:text-white transition-all text-sm flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-arrow-left"})," 返回"]}),e.jsxs("button",{onClick:w,className:"px-4 py-1.5 rounded-lg border border-red-900/50 bg-red-900/20 hover:bg-red-900/40 text-red-400 hover:text-red-300 transition-all text-sm flex items-center gap-2 shadow-inner shadow-red-900/10",children:[e.jsx("i",{className:"fa-solid fa-flag-checkered"})," 结束问诊"]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 hover:border-amber-500/50 text-gray-400 hover:text-amber-300 transition-all ml-2 flex items-center justify-center group",children:e.jsx("i",{className:"fa-solid fa-times text-lg group-hover:rotate-90 transition-transform"})})]})]}),e.jsxs("div",{className:"flex-grow flex overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('/patterns/subtle-dark.png')] opacity-30 pointer-events-none"}),e.jsxs("div",{className:"w-1/4 bg-stone-900/60 p-6 border-r border-stone-700/50 flex flex-col items-center overflow-y-auto backdrop-blur-sm z-10",children:[e.jsxs("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-stone-700 to-stone-800 mb-4 flex items-center justify-center border-2 border-stone-600 shadow-xl relative group",children:[e.jsx("i",{className:`fa-solid ${h.medicalRecord.gender==="Male"?"fa-user-tie":"fa-user-nurse"} text-6xl text-stone-400 group-hover:text-amber-500 transition-colors duration-300`}),e.jsx("div",{className:"absolute bottom-1 right-1 w-6 h-6 rounded-full bg-green-500 border-2 border-stone-800 shadow-[0_0_10px_rgba(34,197,94,0.5)] animate-pulse",title:"诊疗中"})]}),e.jsx("h3",{className:"text-xl text-stone-100 font-bold mb-1",children:h.medicalRecord.name}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded bg-stone-800 border border-stone-700 text-xs text-stone-400",children:[h.medicalRecord.age,"岁"]}),e.jsxs("span",{className:`px-2 py-0.5 rounded border text-xs flex items-center gap-1 ${h.medicalRecord.gender==="Male"?"bg-blue-900/20 border-blue-800 text-blue-400":"bg-pink-900/20 border-pink-800 text-pink-400"}`,children:[e.jsx("i",{className:`fa-solid ${h.medicalRecord.gender==="Male"?"fa-mars":"fa-venus"}`}),h.medicalRecord.gender==="Male"?"男":"女"]})]}),e.jsxs("button",{onClick:()=>f(h.medicalRecord),className:"w-full py-3 bg-gradient-to-r from-cyan-900/50 to-blue-900/50 hover:from-cyan-800/50 hover:to-blue-800/50 border border-cyan-700/50 hover:border-cyan-500/50 rounded-lg text-cyan-300 font-semibold transition-all duration-300 group flex items-center justify-center gap-2 shadow-lg",children:[e.jsx("i",{className:"fa-solid fa-file-medical group-hover:scale-110 transition-transform"}),"查看详细病历"]}),e.jsxs("div",{className:"mt-auto w-full p-4 rounded-lg bg-stone-800/30 border border-stone-700/30",children:[e.jsx("h4",{className:"text-xs font-bold text-stone-500 uppercase mb-2 tracking-wider",children:"当前状态"}),e.jsxs("div",{className:"flex items-center gap-2 text-amber-400 text-sm",children:[e.jsx("i",{className:"fa-solid fa-heart-pulse animate-pulse"}),e.jsx("span",{children:"正在进行深度问诊..."})]})]})]}),e.jsxs("div",{className:"w-3/4 flex flex-col z-10 bg-black/20",children:[e.jsx("div",{className:"flex-grow overflow-y-auto p-6 scrollbar-enhanced",children:e.jsxs("div",{className:"prose prose-invert max-w-none",children:[p.split(`

`).map((O,U)=>e.jsx("div",{className:`mb-6 p-4 rounded-lg border ${U===p.split(`

`).length-1?"bg-stone-800/40 border-amber-500/20 shadow-[0_0_15px_rgba(0,0,0,0.2)]":"bg-transparent border-transparent"} transition-all duration-500 animate-fade-in`,children:e.jsx("p",{className:`text-lg leading-relaxed ${U===p.split(`

`).length-1?"text-stone-200":"text-stone-400"}`,children:O})},U)),m&&e.jsxs("div",{className:"flex items-center gap-2 text-amber-500/80 animate-pulse p-4",children:[e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}),e.jsx("span",{children:"思考中..."})]})]})}),e.jsxs("div",{className:"flex-shrink-0 p-5 bg-gradient-to-t from-stone-900 via-stone-900/95 to-stone-900/80 border-t border-stone-700/50 backdrop-blur-md",children:[e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-4 max-h-32 overflow-y-auto scrollbar-enhanced py-1",children:(b&&Array.isArray(b)?b:[]).map((O,U)=>e.jsxs("button",{onClick:()=>g(O),disabled:m,className:"flex-grow basis-40 px-4 py-2.5 text-sm bg-stone-800/80 hover:bg-stone-700 border border-stone-600 hover:border-amber-500/50 rounded-lg transition-all duration-200 text-stone-300 hover:text-amber-300 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed text-left group relative overflow-hidden",children:[e.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-comment-dots text-stone-500 group-hover:text-amber-500 transition-colors"}),O]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]},U))}),e.jsxs("div",{className:"flex gap-3 items-stretch h-12",children:[e.jsxs("div",{className:"relative flex-grow group",children:[e.jsx("input",{type:"text",value:I,onChange:O=>L(O.target.value),onKeyPress:O=>{O.key==="Enter"&&!m&&I.trim()&&(g(I),L(""))},placeholder:"输入你的问诊行动...",disabled:m,className:"w-full h-full pl-10 pr-4 bg-stone-950/50 border border-stone-700 rounded-lg text-stone-200 placeholder-stone-600 focus:outline-none focus:border-amber-500/50 focus:ring-1 focus:ring-amber-500/30 focus:bg-stone-900/80 transition-all shadow-inner"}),e.jsx("i",{className:"fa-solid fa-keyboard absolute left-3 top-1/2 -translate-y-1/2 text-stone-600 group-focus-within:text-amber-500 transition-colors"})]}),e.jsx("button",{onClick:()=>{I.trim()&&(g(I),L(""))},disabled:m||!I.trim(),className:"btn-primary-enhanced px-8 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:m?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin"}),e.jsx("span",{children:"生成中"})]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-paper-plane"}),e.jsx("span",{children:"发送"})]})})]})]})]})]})]})});const P=r.filter(O=>{const U=O.medicalRecord.gender===D,te=A==="全部"||O.status===A;return U&&te}),M=[{id:"patients",label:"病人管理",icon:"fa-users",badge:r.filter(O=>O.status==="待诊").length},{id:"staff",label:"人员管理",icon:"fa-user-md",badge:T.staff.length},{id:"rooms",label:"科室管理",icon:"fa-door-open",badge:T.rooms.filter(O=>O.unlocked).length},{id:"pharmacy",label:"药房",icon:"fa-pills",badge:T.potionInventory.length}],R=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-stone-700/50 bg-black/20 flex flex-col md:flex-row gap-4 justify-between items-center backdrop-blur-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"flex bg-stone-900/50 p-1 rounded-lg border border-stone-700/50 self-start",children:[e.jsxs("button",{onClick:()=>E("Female"),className:`px-4 py-1.5 text-sm font-bold rounded-md transition-all duration-300 flex items-center gap-2 ${D==="Female"?"bg-gradient-to-r from-pink-600 to-pink-500 text-white shadow-lg shadow-pink-900/50":"text-stone-400 hover:text-stone-200 hover:bg-stone-800/50"}`,children:[e.jsx("i",{className:"fa-solid fa-venus"})," 女性病患"]}),e.jsxs("button",{onClick:()=>E("Male"),className:`px-4 py-1.5 text-sm font-bold rounded-md transition-all duration-300 flex items-center gap-2 ${D==="Male"?"bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-900/50":"text-stone-400 hover:text-stone-200 hover:bg-stone-800/50"}`,children:[e.jsx("i",{className:"fa-solid fa-mars"})," 男性病患"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"待诊",value:"待诊",color:"green",icon:"fa-user-clock"},{label:"治疗中",value:"治疗中",color:"yellow",icon:"fa-user-nurse"},{label:"已治愈",value:"已治愈",color:"blue",icon:"fa-user-check"},{label:"全部",value:"全部",color:"purple",icon:"fa-users"}].map(O=>e.jsxs("button",{onClick:()=>z(O.value),className:`px-3 py-1 text-xs font-semibold rounded-full border transition-all duration-200 flex items-center gap-1.5 ${A===O.value?`bg-${O.color}-500/20 border-${O.color}-500/50 text-${O.color}-300 shadow-[0_0_10px_rgba(0,0,0,0.3)]`:"bg-stone-800/30 border-stone-700/30 text-stone-500 hover:bg-stone-700/50 hover:text-stone-300"}`,children:[e.jsx("i",{className:`fa-solid ${O.icon} text-[10px]`}),O.label]},O.value))})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto justify-end",children:[e.jsxs("button",{onClick:()=>d("Female"),disabled:m,className:"px-4 py-2 text-xs font-bold bg-stone-800 hover:bg-stone-700 border border-pink-900/50 hover:border-pink-500/50 text-pink-400 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 group shadow-lg",children:[e.jsx("i",{className:`fa-solid fa-plus ${m?"animate-spin":"group-hover:rotate-90 transition-transform"}`}),e.jsx("span",{children:"女患"})]}),e.jsxs("button",{onClick:()=>d("Male"),disabled:m,className:"px-4 py-2 text-xs font-bold bg-stone-800 hover:bg-stone-700 border border-blue-900/50 hover:border-blue-500/50 text-blue-400 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 group shadow-lg",children:[e.jsx("i",{className:`fa-solid fa-plus ${m?"animate-spin":"group-hover:rotate-90 transition-transform"}`}),e.jsx("span",{children:"男患"})]}),e.jsxs("button",{onClick:c,disabled:m,className:"px-4 py-2 text-xs font-bold bg-gradient-to-r from-amber-700 to-amber-600 hover:from-amber-600 hover:to-amber-500 text-white rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg shadow-amber-900/30 border border-amber-500/30",children:[e.jsx("i",{className:`fa-solid fa-sync ${m?"animate-spin":""}`}),e.jsx("span",{children:"刷新"})]})]})]}),e.jsx("div",{className:"flex-grow p-6 overflow-y-auto scrollbar-enhanced bg-[url('/patterns/subtle-dark.png')] bg-repeat",children:P.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:P.map(O=>{const U=O.status==="待诊",te=O.status==="治疗中",ie={待诊:{color:"text-green-400",bg:"bg-green-500/10",border:"border-green-500/30",icon:"fa-hourglass-half"},治疗中:{color:"text-amber-400",bg:"bg-amber-500/10",border:"border-amber-500/30",icon:"fa-procedures"},已治愈:{color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/30",icon:"fa-check-circle"}}[O.status]||{color:"text-gray-400",bg:"bg-gray-500/10",border:"border-gray-500/30",icon:"fa-question"};return e.jsxs("div",{className:"card-3d-hover group relative bg-stone-900/80 p-5 rounded-xl border border-stone-700/50 hover:border-amber-500/30 transition-all duration-300 flex flex-col md:flex-row justify-between items-center gap-4 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-white/5 to-transparent rounded-bl-full pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),e.jsxs("div",{className:"flex-grow flex items-center gap-5 z-10 w-full",children:[e.jsx("div",{className:`w-14 h-14 rounded-full ${ie.bg} border ${ie.border} flex items-center justify-center flex-shrink-0 shadow-[0_0_15px_rgba(0,0,0,0.3)]`,children:e.jsx("i",{className:`fa-solid ${O.medicalRecord.gender==="Male"?"fa-user-tie":"fa-user-nurse"} text-2xl ${ie.color}`})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h3",{className:"text-xl font-bold text-stone-200 group-hover:text-amber-400 transition-colors font-serif truncate",children:O.medicalRecord.name}),e.jsxs("span",{className:"text-sm text-stone-500 font-mono bg-stone-950/50 px-2 py-0.5 rounded border border-stone-800",children:[O.medicalRecord.age,"岁"]}),e.jsxs("span",{className:`px-2 py-0.5 text-xs rounded-full border ${ie.border} ${ie.bg} ${ie.color} font-bold flex items-center gap-1`,children:[e.jsx("i",{className:`fa-solid ${ie.icon} text-[10px]`}),O.status]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-stone-400 group-hover:text-stone-300 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-notes-medical text-red-500/70"}),e.jsx("p",{className:"truncate italic max-w-md",children:O.medicalRecord.illnessDescription})]})]})]}),e.jsxs("div",{className:"flex space-x-3 z-10 w-full md:w-auto justify-end",children:[e.jsxs("button",{onClick:()=>f(O.medicalRecord),className:"px-4 py-2 rounded-lg bg-stone-800 hover:bg-stone-700 border border-stone-600 hover:border-stone-500 text-stone-300 font-semibold text-sm transition-all duration-200 shadow-md hover:shadow-lg flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-file-medical"}),e.jsx("span",{children:"病单"})]}),U&&e.jsxs("button",{onClick:()=>o(O.id),className:"btn-primary-enhanced px-6 py-2 text-sm flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-stethoscope"}),e.jsx("span",{children:"接诊"})]}),te&&e.jsxs("button",{onClick:()=>o(O.id),className:"px-6 py-2 rounded-lg bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-500 hover:to-amber-400 text-white font-bold text-sm border border-amber-400/30 shadow-[0_0_15px_rgba(245,158,11,0.3)] hover:shadow-[0_0_20px_rgba(245,158,11,0.5)] transition-all duration-200 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-user-md"}),e.jsx("span",{children:"复诊"})]})]})]},O.id)})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-stone-500/50 space-y-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-stone-800/50 flex items-center justify-center border-2 border-dashed border-stone-700",children:e.jsx("i",{className:"fa-solid fa-user-slash text-4xl"})}),e.jsx("p",{className:"text-lg font-serif",children:"当前暂无此类病患"}),e.jsx("p",{className:"text-sm text-stone-600",children:"请切换筛选条件或招揽新病人"})]})})]}),Q=()=>!j||!_?e.jsx("div",{className:"flex-grow p-6 overflow-y-auto",children:e.jsxs("div",{className:"text-center py-12 text-stone-500",children:[e.jsx("i",{className:"fa-solid fa-exclamation-triangle text-4xl mb-4"}),e.jsx("p",{children:"人员管理功能需要游戏状态支持"})]})}):e.jsx(w1,{hospitalSystem:T,gameState:j,onUpdateHospitalSystem:_,isLoading:m}),Z=()=>!j||!_?e.jsx("div",{className:"flex-grow flex items-center justify-center",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"fa-solid fa-exclamation-triangle text-3xl text-amber-500 mb-3"}),e.jsx("p",{className:"text-stone-400",children:"科室管理功能需要游戏状态支持"})]})}):e.jsx(v1,{hospitalSystem:T,gameState:j,onUpdateHospitalSystem:_,isLoading:m}),G=()=>e.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[e.jsxs("div",{className:"text-center py-8 mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-stone-200 mb-2",children:"药房"}),e.jsx("p",{className:"text-stone-500",children:"管理药剂库存，生产新药剂"})]}),e.jsxs("div",{className:"bg-stone-800/30 rounded-lg p-4 border border-stone-700/30 mb-6",children:[e.jsxs("h4",{className:"text-sm font-bold text-stone-400 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-boxes-stacked"}),"药剂库存"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:T.potionInventory.map(O=>e.jsxs("div",{className:"bg-stone-900/50 rounded-lg p-3 border border-stone-700/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fa-solid fa-flask text-purple-400"}),e.jsx("span",{className:"text-stone-300 text-sm truncate",children:O.potionId})]}),e.jsxs("div",{className:"text-xl font-bold text-amber-400",children:["×",O.quantity]})]},O.potionId))})]}),e.jsxs("p",{className:"text-stone-600 mt-8 text-sm text-center",children:[e.jsx("i",{className:"fa-solid fa-info-circle mr-2"}),"药房面板正在开发中..."]})]}),H=()=>{switch(C){case"patients":return R();case"staff":return Q();case"rooms":return Z();case"pharmacy":return G();default:return R()}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-fade-in-up",onClick:a,children:e.jsxs("div",{className:"ornate-border w-full max-w-5xl h-[85vh] relative bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 rounded-xl shadow-2xl overflow-hidden flex flex-col",onClick:O=>O.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent z-10"}),e.jsxs("div",{className:"relative px-6 py-4 border-b border-stone-700/50 bg-gradient-to-r from-stone-800/50 to-stone-900/50 flex justify-between items-center flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-amber-500 to-amber-700 flex items-center justify-center shadow-lg shadow-amber-500/20",children:e.jsx("i",{className:"fa-solid fa-clinic-medical text-white text-sm"})}),e.jsx("h2",{className:"text-2xl font-bold text-gradient-gold text-shadow-glow",children:"性病医馆"})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 hover:border-amber-500/50 text-gray-400 hover:text-amber-300 transition-all duration-200 flex items-center justify-center group",children:e.jsx("i",{className:"fa-solid fa-times text-lg group-hover:rotate-90 transition-transform"})})]}),e.jsx("div",{className:"flex-shrink-0 px-4 py-2 border-b border-stone-700/50 bg-stone-900/30 flex gap-2 overflow-x-auto",children:M.map(O=>e.jsxs("button",{onClick:()=>S(O.id),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 flex items-center gap-2 whitespace-nowrap ${C===O.id?"bg-gradient-to-r from-amber-600 to-amber-500 text-white shadow-lg shadow-amber-900/30":"bg-stone-800/50 text-stone-400 hover:text-stone-200 hover:bg-stone-700/50"}`,children:[e.jsx("i",{className:`fa-solid ${O.icon}`}),O.label,O.badge!==void 0&&O.badge>0&&e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs ${C===O.id?"bg-white/20":"bg-amber-500/20 text-amber-400"}`,children:O.badge})]},O.id))}),e.jsx("div",{className:"flex-grow flex flex-col overflow-hidden",children:H()}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent pointer-events-none"})]})})},S1=({isOpen:n,onClose:a,onInteract:r,storyContext:o})=>{const[c,d]=v.useState([]),[m,f]=v.useState(!0),[h,p]=v.useState(null);v.useEffect(()=>{n&&(async()=>{f(!0),p(null);try{console.warn("scanForInteractables is not implemented yet."),d([])}catch(k){console.error("Failed to fetch interactables:",k),d([])}finally{f(!1)}})()},[n,o]);const b=(j,k)=>{const _=`${k} ${j.name}`;r(_)},g=j=>{switch(j){case"NPC":return"👤";case"Creature":return"🐾";case"Object":return"📦";default:return"❓"}},w=()=>{if(!h)return null;const j=[{label:"靠近",verb:"你决定走近"},{label:"观察",verb:"你仔细观察"}];let k=[];h.type==="NPC"?(k.push({label:"交谈",verb:"你尝试与"}),k.push({label:"挑战",verb:`你向 ${h.name} 亮出黄牌，发起了挑战。`})):h.type==="Creature"?k.push({label:"攻击",verb:"你亮出黄牌，决定攻击"}):h.type==="Object"&&k.push({label:"调查",verb:"你开始调查"});const _=S=>{S.label==="挑战"||S.label==="攻击"?r(S.verb):b(h,S.verb)},C=[...j,...k];return e.jsxs("div",{className:"bg-stone-800/70 p-4 rounded-lg animate-fade-in border border-stone-700/50",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("span",{className:"text-3xl mt-1",children:g(h.type)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-amber-400 text-lg",children:h.name}),e.jsx("p",{className:"text-sm text-gray-300",children:h.description})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:C.map(S=>e.jsx("button",{onClick:()=>_(S),className:"bg-stone-700/80 px-4 py-2 rounded-md hover:bg-stone-600 transition-colors duration-200 font-serif",children:S.label},S.label))})]})},N=()=>m?e.jsx("div",{className:"text-center text-amber-300 animate-glow p-8",children:"探查灵气波动中..."}):c.length===0?e.jsx("div",{className:"text-center text-gray-500 p-8",children:"附近似乎没有任何值得注意的东西。"}):e.jsxs("div",{className:"flex flex-row gap-4 h-full",children:[e.jsxs("div",{className:"w-2/5 border-r border-stone-700 overflow-y-auto",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400 p-3 sticky top-0 bg-stone-900/90 backdrop-blur-sm border-b border-stone-700/50",children:"附近实体"}),c.map(j=>e.jsxs("button",{onClick:()=>p(j),className:`w-full text-left p-3 text-sm transition-colors duration-150 flex items-center gap-3 ${(h==null?void 0:h.name)===j.name?"bg-amber-600/30":"hover:bg-stone-800/60"}`,children:[e.jsx("span",{className:"text-xl",children:g(j.type)}),e.jsx("span",{className:"font-semibold text-white",children:j.name})]},j.name))]}),e.jsx("div",{className:"w-3/5 p-4 flex flex-col justify-center",children:h?w():e.jsx("div",{className:"text-center text-gray-500",children:e.jsx("p",{children:"从左侧列表选择一个目标进行互动"})})})]});return n?e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-2xl h-auto max-h-[70vh] min-h-[20rem] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg bg-stone-900/80 flex flex-col",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-xl font-bold text-amber-300 font-serif",children:"探查四周"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsx("div",{className:"flex-grow overflow-hidden",children:N()})]})}):null},C1=({isOpen:n,onClose:a,prisoner:r,availableTortureMethods:o,onExecuteTorture:c,onEndInterrogation:d,interrogationLog:m,isLoading:f})=>{const[h,p]=v.useState(null),[b,g]=v.useState(30),[w,N]=v.useState(!1);if(!n)return null;const j=o.filter(A=>A.category==="basic"),k=o.filter(A=>A.category==="advanced"),_=o.filter(A=>A.category==="special"),C=A=>A<10?"text-green-400":A<30?"text-yellow-400":A<60?"text-orange-400":"text-red-400",S=A=>A<10?"极低":A<30?"低":A<60?"中":A<80?"高":"极高",D=A=>{var L;const z=(h==null?void 0:h.id)===A.id,I=!A.requirements||!A.requirements.skill||r.character.skills.some(T=>T.name===A.requirements.skill);return e.jsxs("div",{onClick:()=>I&&p(A),className:`
          p-4 rounded-lg border-2 cursor-pointer transition-all
          ${z?"border-red-500 bg-red-900/30 shadow-lg shadow-red-500/50":I?"border-stone-700 bg-black/30 hover:border-red-500/50 hover:bg-black/50":"border-stone-800 bg-black/10 opacity-50 cursor-not-allowed"}
        `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:`text-lg font-bold ${z?"text-red-400":"text-white"}`,children:A.name}),((L=A.requirements)==null?void 0:L.cost)&&e.jsxs("span",{className:"px-2 py-1 text-xs bg-amber-500/20 text-amber-300 rounded",children:[A.requirements.cost," 灵石"]})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:A.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"伤害:"}),e.jsx("span",{className:"ml-1 text-red-400 font-bold",children:A.damage})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"威慑:"}),e.jsx("span",{className:"ml-1 text-orange-400 font-bold",children:A.intimidation})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"成功率:"}),e.jsxs("span",{className:"ml-1 text-green-400 font-bold",children:[A.successRate,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"屈服度:"}),e.jsxs("span",{className:"ml-1 text-yellow-400 font-bold",children:["+",A.submissionIncrease]})]})]}),e.jsxs("div",{className:"border-t border-stone-700/50 pt-2 mt-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"风险评估:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"死亡:"}),e.jsx("span",{className:`ml-1 font-bold ${C(A.risks.death)}`,children:S(A.risks.death)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"重伤:"}),e.jsx("span",{className:`ml-1 font-bold ${C(A.risks.permanentInjury)}`,children:S(A.risks.permanentInjury)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"疯狂:"}),e.jsx("span",{className:`ml-1 font-bold ${C(A.risks.insanity)}`,children:S(A.risks.insanity)})]})]})]}),A.requirements&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-stone-700/50",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"需求:"}),A.requirements.skill&&e.jsxs("div",{className:"text-xs text-cyan-400",children:["技能: ",A.requirements.skill]}),A.requirements.item&&e.jsxs("div",{className:"text-xs text-purple-400",children:["道具: ",A.requirements.item]})]})]},A.id)},E=()=>r.history.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx("i",{className:"fa-solid fa-file-lines text-4xl mb-4 opacity-50"}),e.jsx("p",{children:"暂无审讯记录"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.history.slice().reverse().map(A=>e.jsxs("div",{className:"bg-black/30 p-3 rounded-lg border border-stone-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-red-400",children:A.method.name}),e.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["(",A.duration,"分钟)"]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:A.date})]}),e.jsxs("div",{className:"text-sm text-gray-400 mb-2",children:["审讯者: ",A.interrogator]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"结果:"}),e.jsx("span",{className:`ml-1 font-bold ${A.result.success?"text-green-400":"text-red-400"}`,children:A.result.success?"成功":"失败"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"屈服度:"}),e.jsxs("span",{className:"ml-1 text-yellow-400 font-bold",children:["+",A.result.submissionIncrease]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"健康:"}),e.jsxs("span",{className:"ml-1 text-red-400 font-bold",children:["-",A.result.healthDecrease]})]})]}),A.result.informationGained&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-stone-700/50",children:[e.jsx("div",{className:"text-xs text-cyan-400 mb-1",children:"获得情报:"}),e.jsx("div",{className:"text-sm text-gray-300",children:A.result.informationGained})]})]},A.id))});return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-7xl h-[90vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:A=>A.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/30 border-b border-red-900/50",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-red-400 font-serif flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-gavel"}),"审讯室 - ",r.character.name]}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[r.character.realm," | ",r.crime]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N(!w),className:"px-4 py-2 bg-cyan-600/80 text-white font-bold rounded-md hover:bg-cyan-500/80 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-history mr-2"}),w?"返回审讯":"审讯历史"]}),e.jsx("button",{onClick:d,className:"px-4 py-2 bg-gray-600/80 text-white font-bold rounded-md hover:bg-gray-500/80 transition-colors",children:"结束审讯"}),e.jsx("button",{onClick:a,className:"text-red-400 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]})]}),e.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[e.jsxs("div",{className:"w-80 bg-black/20 border-r border-stone-700 p-4 overflow-y-auto flex-shrink-0",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-32 h-32 mx-auto rounded-full bg-stone-700 mb-4 flex items-center justify-center border-4 border-red-900/50",children:e.jsx("i",{className:"fa-solid fa-user-secret text-6xl text-gray-500"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:r.character.name}),e.jsxs("p",{className:"text-gray-400",children:[r.character.gender==="Male"?"♂ 男性":"♀ 女性"," | ",r.character.realm]})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"bg-black/30 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"健康状态"}),e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"健康"}),e.jsxs("span",{className:`text-sm font-bold ${r.health>70?"text-green-400":r.health>40?"text-yellow-400":"text-red-400"}`,children:[r.health,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2 mb-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r.health>70?"bg-green-500":r.health>40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r.health}%`}})}),e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"神智"}),e.jsxs("span",{className:`text-sm font-bold ${r.sanity>70?"text-green-400":r.sanity>40?"text-yellow-400":"text-red-400"}`,children:[r.sanity,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r.sanity>70?"bg-green-500":r.sanity>40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r.sanity}%`}})})]}),e.jsxs("div",{className:"bg-black/30 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"意志状态"}),e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"屈服度"}),e.jsxs("span",{className:"text-sm font-bold text-yellow-400",children:[r.submissionLevel,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2 mb-2",children:e.jsx("div",{className:"h-2 bg-yellow-500 rounded-full transition-all",style:{width:`${r.submissionLevel}%`}})}),e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"归顺度"}),e.jsxs("span",{className:"text-sm font-bold text-green-400",children:[r.loyaltyLevel,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2",children:e.jsx("div",{className:"h-2 bg-green-500 rounded-full transition-all",style:{width:`${r.loyaltyLevel}%`}})})]})]}),r.knownInformation.length>0&&e.jsxs("div",{className:"bg-black/30 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"已获情报"}),e.jsx("div",{className:"space-y-1",children:r.knownInformation.map((A,z)=>e.jsxs("div",{className:"text-xs text-cyan-400 flex items-start gap-1",children:[e.jsx("i",{className:"fa-solid fa-check-circle mt-0.5"}),e.jsx("span",{children:A})]},z))})]})]}),e.jsx("div",{className:"flex-grow flex flex-col overflow-hidden",children:w?e.jsxs("div",{className:"p-6 overflow-y-auto",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"审讯历史记录"}),E()]}):e.jsxs(e.Fragment,{children:[m&&e.jsxs("div",{className:"bg-black/30 p-4 border-b border-stone-700 max-h-48 overflow-y-auto flex-shrink-0",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-2",children:"审讯记录"}),e.jsx("div",{className:"prose prose-invert max-w-none",children:m.split(`
`).map((A,z)=>e.jsx("p",{className:"text-gray-300 text-sm leading-relaxed mb-2",children:A},z))})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[j.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-circle text-green-500 text-xs"}),"基础刑法"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:j.map(D)})]}),k.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-circle text-orange-500 text-xs"}),"进阶刑法"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:k.map(D)})]}),_.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-circle text-purple-500 text-xs"}),"特殊刑法"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:_.map(D)})]})]}),h&&e.jsx("div",{className:"flex-shrink-0 p-4 bg-black/40 border-t border-red-900/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"text-white font-bold mb-2",children:["已选择: ",e.jsx("span",{className:"text-red-400",children:h.name})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-gray-400 text-sm",children:"持续时间(分钟):"}),e.jsx("input",{type:"number",value:b,onChange:A=>g(Number(A.target.value)),min:"5",max:"180",step:"5",className:"w-24 px-3 py-1 bg-stone-800 border border-stone-600 rounded text-white text-sm"}),e.jsxs("span",{className:"text-gray-500 text-sm",children:["(",Math.floor(b/60),"小时",b%60,"分钟)"]})]})]}),e.jsx("button",{onClick:()=>c(r.character.id,h.id,b),disabled:f,className:"px-6 py-3 bg-red-600/80 text-white font-bold rounded-md hover:bg-red-500/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"执行中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-gavel mr-2"}),"执行刑罚"]})})]})})]})})]})]})})},ou=[{id:"kun_lun_xu",name:"昆仑墟",type:"Mountain",region:"中州",realm:"天界",x:500,y:300,description:"传说中仙人居住的圣山，灵气浓郁至极，直通九天。",isMajor:!0},{id:"tian_gong",name:"天宫",type:"Palace",region:"中州",realm:"天界",x:600,y:400,description:"诸天仙神的居所，云雾缭绕，仙乐飘飘。",isMajor:!0},{id:"yao_chi",name:"瑶池",type:"River",region:"东荒",realm:"天界",x:300,y:450,description:"仙池圣水，据说可洗涤凡尘，获得仙缘。",isMajor:!1},{id:"tai_xu_jing",name:"太虚境",type:"Plain",region:"西境",realm:"天界",x:750,y:350,description:"虚无缥缈之地，只有得道高人才能进入。",isMajor:!1},{id:"qing_she_zong",name:"青蛇宗",type:"Sect",region:"东荒",realm:"人界",x:250,y:400,description:"一切开始的地方，一个中等规模的修仙宗门。",isMajor:!0},{id:"bai_hua_gu",name:"百花谷",type:"Sect",region:"东荒",realm:"人界",x:200,y:600,description:"以医术和丹药闻名的女性宗门。",isMajor:!0},{id:"wan_yao_sen_lin",name:"万妖森林",type:"Forest",region:"东荒",realm:"人界",x:350,y:700,description:"妖兽横行，但机遇与危险并存的古老森林。",isMajor:!1},{id:"yun_meng_ze",name:"云梦大泽",type:"River",region:"东荒",realm:"人界",x:150,y:300,description:"广阔的沼泽地，据说有上古异兽出没。",isMajor:!1},{id:"tian_ji_ge",name:"天机阁",type:"City",region:"中州",realm:"人界",x:500,y:500,description:"中州皇城，世界的中心，凡人与修士混居。",isMajor:!0},{id:"tian_yuan_fang_shi",name:"天元坊市",type:"City",region:"中州",realm:"人界",x:600,y:650,description:"世界上最大的修仙者交易市场。",isMajor:!1},{id:"huang_gu_yi_ji",name:"荒古遗迹",type:"Mountain",region:"西境",realm:"人界",x:800,y:400,description:"上古仙魔大战的战场，散落着无数法宝残片。",isMajor:!1},{id:"wu_shen_zhai",name:"巫神寨",type:"Sect",region:"南疆",realm:"人界",x:650,y:850,description:"南疆最大的巫蛊部落，神秘莫测。",isMajor:!0},{id:"shi_wan_da_shan",name:"十万大山",type:"Mountain",region:"南疆",realm:"人界",x:750,y:950,description:"连绵不绝的山脉，充满了毒虫猛兽和天材地宝。",isMajor:!1},{id:"du_long_he",name:"毒龙河",type:"River",region:"南疆",realm:"人界",x:550,y:800,description:"河水呈诡异的紫色，据说有剧毒。",isMajor:!1},{id:"xuan_bing_gong",name:"玄冰宫",type:"Sect",region:"北原",realm:"人界",x:250,y:950,description:"建立在万年冰川之上的宗门，弟子皆修行冰系功法。",isMajor:!0},{id:"ji_bei_xue_yuan",name:"极北雪原",type:"Plain",region:"北原",realm:"人界",x:150,y:1050,description:"一片冰封的荒原，人迹罕至。",isMajor:!1},{id:"zhen_yu_da_lao",name:"镇狱大牢",type:"Prison",region:"中州",realm:"冥界",x:500,y:400,description:"中州皇城地下的巨型监狱，关押着各方罪犯和重要俘虏。阴森恐怖，传闻有去无回。",isMajor:!0},{id:"tian_mo_cheng",name:"天魔城",type:"City",region:"西境",realm:"冥界",x:750,y:300,description:"魔道修士的聚集地，混乱但自由，位于地下深渊。",isMajor:!0},{id:"wu_jian_dong",name:"无间洞府",type:"Cave",region:"西境",realm:"冥界",x:650,y:500,description:"一个深不见底的洞穴，传闻直通地狱最深处。",isMajor:!1},{id:"huang_quan_lu",name:"黄泉路",type:"River",region:"中州",realm:"冥界",x:400,y:600,description:"亡魂必经之路，河水漆黑如墨，散发着死亡气息。",isMajor:!1},{id:"wang_chuan_he",name:"忘川河",type:"River",region:"东荒",realm:"冥界",x:250,y:700,description:"饮下忘川水，忘却前尘往事。",isMajor:!1},{id:"sen_luo_dian",name:"森罗殿",type:"Palace",region:"中州",realm:"冥界",x:600,y:450,description:"地府阎罗的议事大殿，审判生前罪孽。",isMajor:!0}],_1=n=>ou.filter(a=>a.realm===n),$1=["天界","人界","冥界"],Jf=({currentLocationName:n,onLocationSelect:a,onClose:r,className:o=""})=>{const[c,d]=v.useState(""),[m,f]=v.useState(!1),[h,p]=v.useState(-1),b=v.useRef(null),g=v.useRef(null),w=v.useMemo(()=>{if(!c.trim())return ou;const S=c.toLowerCase();return ou.filter(D=>D.name.toLowerCase().includes(S)||D.region.toLowerCase().includes(S)||D.type.toLowerCase().includes(S)||D.description.toLowerCase().includes(S))},[c]),N=v.useMemo(()=>{const S={};return w.forEach(D=>{S[D.region]||(S[D.region]=[]),S[D.region].push(D)}),S},[w]);v.useEffect(()=>{const S=D=>{b.current&&!b.current.contains(D.target)&&f(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);const j=S=>{if(!m){(S.key==="Enter"||S.key==="ArrowDown")&&(f(!0),p(0));return}switch(S.key){case"ArrowDown":S.preventDefault(),p(D=>D<w.length-1?D+1:D);break;case"ArrowUp":S.preventDefault(),p(D=>D>0?D-1:0);break;case"Enter":S.preventDefault(),h>=0&&h<w.length&&k(w[h]);break;case"Escape":f(!1),p(-1);break}},k=S=>{var D;a(S),f(!1),d(""),p(-1),(D=g.current)==null||D.blur()},_=S=>({Sect:"fa-mountain-sun",City:"fa-city",Cave:"fa-dungeon",Mountain:"fa-mountain",Forest:"fa-tree",Plain:"fa-seedling",River:"fa-water",Sea:"fa-ship",Prison:"fa-bars",Palace:"fa-crown"})[S]||"fa-map-marker",C=S=>({东荒:"text-green-400",西境:"text-yellow-400",南疆:"text-red-400",北原:"text-blue-400",中州:"text-purple-400"})[S]||"text-gray-400";return e.jsxs("div",{ref:b,className:`relative ${o}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:g,type:"text",value:c,onChange:S=>d(S.target.value),onFocus:()=>f(!0),onKeyDown:j,placeholder:"搜索地点...",className:"w-full pl-10 pr-10 py-2.5 bg-gradient-to-r from-black/80 via-stone-900/70 to-black/80 backdrop-blur-md border-2 border-amber-500/40 rounded-lg text-amber-100 placeholder-amber-300/60 focus:outline-none focus:border-amber-500/70 focus:ring-2 focus:ring-amber-500/30 focus:shadow-[0_0_15px_rgba(251,191,36,0.3)] transition-all"}),e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-amber-400/80 drop-shadow-[0_0_6px_rgba(251,191,36,0.5)]"}),c&&e.jsx("button",{onClick:()=>{var S;d(""),(S=g.current)==null||S.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-amber-400/70 hover:text-amber-300 transition-colors",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),m&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gradient-to-b from-black/95 via-stone-900/90 to-black/95 backdrop-blur-xl border-2 border-amber-500/40 rounded-lg shadow-2xl max-h-[400px] overflow-y-auto",style:{boxShadow:"0 10px 40px rgba(251, 191, 36, 0.3), inset 0 1px 0 rgba(251, 191, 36, 0.2)",zIndex:9999},children:[w.length===0?e.jsxs("div",{className:"p-4 text-center text-amber-300/50",children:[e.jsx("i",{className:"fa-solid fa-search text-2xl mb-2"}),e.jsx("p",{children:"未找到匹配的地点"})]}):e.jsx("div",{className:"py-2",children:Object.entries(N).map(([S,D])=>e.jsxs("div",{className:"mb-2 last:mb-0",children:[e.jsx("div",{className:"px-3 py-1.5 bg-gradient-to-r from-stone-900/60 via-stone-800/50 to-stone-900/60 border-b border-amber-500/10",children:e.jsxs("span",{className:`text-xs font-bold font-serif ${C(S)} drop-shadow-[0_0_8px_currentColor]`,children:["✦ ",S," ✦"]})}),D.map((E,A)=>{const z=w.indexOf(E),I=E.name===n,L=z===h;return e.jsxs("button",{onClick:()=>k(E),className:`w-full px-3 py-2.5 flex items-start gap-3 hover:bg-gradient-to-r hover:from-amber-900/30 hover:via-amber-800/20 hover:to-amber-900/30 transition-all ${L?"bg-gradient-to-r from-amber-900/40 via-amber-800/30 to-amber-900/40 shadow-[inset_0_0_10px_rgba(251,191,36,0.2)]":""} ${I?"bg-gradient-to-r from-amber-900/20 to-transparent border-l-2 border-amber-500 shadow-[inset_0_0_10px_rgba(251,191,36,0.1)]":""}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 flex items-center justify-center rounded ${I?"bg-amber-500/20 text-amber-400":"bg-stone-800/50 text-amber-300/70"}`,children:e.jsx("i",{className:`fa-solid ${_(E.type)} text-sm`})}),e.jsxs("div",{className:"flex-grow text-left",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("span",{className:`font-serif font-semibold ${I?"text-amber-300":"text-amber-100"}`,children:E.name}),E.isMajor&&e.jsx("span",{className:"text-amber-400 text-xs",children:"★"}),I&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-amber-500/20 text-amber-400 rounded",children:"当前"})]}),e.jsx("p",{className:"text-xs text-gray-400 line-clamp-1",children:E.description})]})]},E.id)})]},S))}),e.jsx("div",{className:"px-3 py-2 border-t-2 border-amber-500/30 bg-gradient-to-r from-black/70 via-stone-900/60 to-black/70",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-amber-300/60",children:[e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-stone-800 rounded text-amber-400/70",children:"↑↓"})," 导航"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-stone-800 rounded text-amber-400/70",children:"Enter"})," 选择"]}),e.jsxs("span",{children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-stone-800 rounded text-amber-400/70",children:"Esc"})," 关闭"]})]})})]})]})},Ff=(n,a)=>{const r=n.clientX-a.clientX,o=n.clientY-a.clientY;return Math.sqrt(r*r+o*o)},Xf=(n,a)=>({x:(n.clientX+a.clientX)/2,y:(n.clientY+a.clientY)/2}),E1=(n={})=>{const{initialScale:a=1,minScale:r=.5,maxScale:o=3,onScaleChange:c,onTranslateChange:d}=n,[m,f]=v.useState(a),[h,p]=v.useState(0),[b,g]=v.useState(0),[w,N]=v.useState(!1),j=v.useRef(null),k=v.useRef(null),_=v.useRef({x:0,y:0}),C=v.useRef(0),S=v.useCallback((Z,G)=>{const H=m>=2?1:2;f(H),c==null||c(H)},[m,c]),D=v.useCallback(Z=>{if(Z.touches.length===2){const G=Ff(Z.touches[0],Z.touches[1]),H=Xf(Z.touches[0],Z.touches[1]);j.current=G,k.current=H}else if(Z.touches.length===1){const G=Date.now();G-C.current<300&&S(Z.touches[0].clientX,Z.touches[0].clientY),C.current=G,N(!0),_.current={x:Z.touches[0].clientX-h,y:Z.touches[0].clientY-b}}},[h,b,S]),E=v.useCallback(Z=>{if(Z.preventDefault(),Z.touches.length===2){const G=Ff(Z.touches[0],Z.touches[1]),H=Xf(Z.touches[0],Z.touches[1]);if(j.current&&k.current){const O=G/j.current,U=Math.max(r,Math.min(o,m*O)),te=H.x-k.current.x,ie=H.y-k.current.y;f(U),p(B=>B+te),g(B=>B+ie),c==null||c(U),d==null||d(h+te,b+ie)}j.current=G,k.current=H}else if(Z.touches.length===1&&w){const G=Z.touches[0].clientX-_.current.x,H=Z.touches[0].clientY-_.current.y;p(G),g(H),d==null||d(G,H)}},[m,r,o,w,h,b,c,d]),A=v.useCallback(Z=>{Z.touches.length===0&&(N(!1),j.current=null,k.current=null)},[]),z=v.useCallback(Z=>{N(!0),_.current={x:Z.clientX-h,y:Z.clientY-b}},[h,b]),I=v.useCallback(Z=>{if(w){const G=Z.clientX-_.current.x,H=Z.clientY-_.current.y;p(G),g(H),d==null||d(G,H)}},[w,d]),L=v.useCallback(()=>{N(!1)},[]),T=v.useCallback(Z=>{Z.preventDefault();const G=Z.deltaY>0?.9:1.1,H=Math.max(r,Math.min(o,m*G)),O=Z.target.getBoundingClientRect(),U=Z.clientX-O.left,te=Z.clientY-O.top,ie=H/m,B=U-(U-h)*ie,W=te-(te-b)*ie;f(H),p(B),g(W),c==null||c(H),d==null||d(B,W)},[m,r,o,h,b,c,d]),P=v.useCallback(()=>{f(a),p(0),g(0),c==null||c(a),d==null||d(0,0)},[a,c,d]),M=v.useCallback(()=>{const Z=Math.min(o,m*1.2);f(Z),c==null||c(Z)},[m,o,c]),R=v.useCallback(()=>{const Z=Math.max(r,m*.8);f(Z),c==null||c(Z)},[m,r,c]),Q=v.useCallback(Z=>{const G=Math.max(r,Math.min(o,Z));f(G),c==null||c(G)},[r,o,c]);return[{scale:m,translateX:h,translateY:b,isDragging:w},{handleTouchStart:D,handleTouchMove:E,handleTouchEnd:A,handleMouseDown:z,handleMouseMove:I,handleMouseUp:L,handleWheel:T,resetView:P,zoomIn:M,zoomOut:R,setScale:Q}]},A1=({scale:n,onZoomIn:a,onZoomOut:r,onReset:o,minScale:c=.5,maxScale:d=3,className:m=""})=>{const f=Math.round(n*100),h=n<=c,p=n>=d;return e.jsxs("div",{className:`flex items-center gap-2 bg-gradient-to-r from-black/80 via-stone-900/70 to-black/80 backdrop-blur-md rounded-lg px-3 py-2 border-2 border-amber-500/40 shadow-lg ${m}`,style:{boxShadow:"0 4px 20px rgba(251, 191, 36, 0.2), inset 0 0 20px rgba(0, 0, 0, 0.5)"},children:[e.jsx("button",{onClick:r,disabled:h,className:"w-9 h-9 flex items-center justify-center text-amber-300 hover:text-amber-100 hover:bg-gradient-to-br hover:from-amber-900/50 hover:to-amber-700/50 rounded-md disabled:opacity-30 disabled:cursor-not-allowed transition-all border border-transparent hover:border-amber-500/30 hover:shadow-[0_0_10px_rgba(251,191,36,0.3)]",title:"缩小 (Ctrl + -)",children:e.jsx("i",{className:"fa-solid fa-minus text-sm drop-shadow-[0_0_4px_rgba(251,191,36,0.5)]"})}),e.jsxs("div",{className:"flex items-center gap-2 px-2 min-w-[100px]",children:[e.jsxs("span",{className:"text-amber-200 text-sm font-mono font-semibold whitespace-nowrap drop-shadow-[0_0_6px_rgba(251,191,36,0.6)]",children:[f,"%"]}),e.jsx("input",{type:"range",min:c*100,max:d*100,value:n*100,onChange:b=>{parseFloat(b.target.value)/100>n?a():r()},className:"hidden md:block w-20 h-1 bg-stone-700 rounded-lg appearance-none cursor-pointer accent-amber-500",style:{background:`linear-gradient(to right, #f59e0b 0%, #f59e0b ${(n-c)/(d-c)*100}%, #44403c ${(n-c)/(d-c)*100}%, #44403c 100%)`}})]}),e.jsx("button",{onClick:a,disabled:p,className:"w-9 h-9 flex items-center justify-center text-amber-300 hover:text-amber-100 hover:bg-gradient-to-br hover:from-amber-900/50 hover:to-amber-700/50 rounded-md disabled:opacity-30 disabled:cursor-not-allowed transition-all border border-transparent hover:border-amber-500/30 hover:shadow-[0_0_10px_rgba(251,191,36,0.3)]",title:"放大 (Ctrl + +)",children:e.jsx("i",{className:"fa-solid fa-plus text-sm drop-shadow-[0_0_4px_rgba(251,191,36,0.5)]"})}),e.jsx("div",{className:"w-px h-6 bg-amber-500/30"}),e.jsx("button",{onClick:o,className:"w-9 h-9 flex items-center justify-center text-amber-300 hover:text-amber-100 hover:bg-gradient-to-br hover:from-amber-900/50 hover:to-amber-700/50 rounded-md transition-all border border-transparent hover:border-amber-500/30 hover:shadow-[0_0_10px_rgba(251,191,36,0.3)]",title:"重置视图 (Home)",children:e.jsx("i",{className:"fa-solid fa-compress text-sm drop-shadow-[0_0_4px_rgba(251,191,36,0.5)]"})}),e.jsxs("div",{className:"md:hidden flex items-center gap-1 pl-2 border-l border-amber-500/30",children:[e.jsx("span",{className:"text-amber-400/70 text-xs",children:e.jsx("i",{className:"fa-solid fa-hand-pointer"})}),e.jsx("span",{className:"text-amber-200/70 text-xs whitespace-nowrap",children:"双指缩放"})]})]})},Kf=({onLocationSelect:n,currentLocationName:a,isMobile:r=!1})=>{const[o,c]=v.useState(null),[d,m]=v.useState("人界"),f=1200,h=1e3,[p,b]=E1({initialScale:1,minScale:.5,maxScale:3}),{scale:g,translateX:w,translateY:N,isDragging:j}=p,{handleTouchStart:k,handleTouchMove:_,handleTouchEnd:C,handleMouseDown:S,handleMouseMove:D,handleMouseUp:E,handleWheel:A,resetView:z,zoomIn:I,zoomOut:L}=b,T=v.useMemo(()=>_1(d),[d]),M=(O=>{switch(O){case"天界":return{bgGradient:["#0c1445","#1e3a8a","#3b82f6"],cloudColor:"#ffffff",mountainColor:"#60a5fa",waterColor:"#93c5fd",textColor:"#dbeafe",accentColor:"#fbbf24",glowColor:"#60a5fa"};case"人界":return{bgGradient:["#1c1917","#292524","#44403c"],cloudColor:"#a8a29e",mountainColor:"#57534e",waterColor:"#60a5fa",textColor:"#e7e5e4",accentColor:"#fbbf24",glowColor:"#f59e0b"};case"冥界":return{bgGradient:["#09090b","#18181b","#27272a"],cloudColor:"#3f3f46",mountainColor:"#27272a",waterColor:"#52525b",textColor:"#d4d4d8",accentColor:"#a855f7",glowColor:"#7c3aed"}}})(d),R=()=>e.jsxs("g",{children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"celestial-sky",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#0c1445"}),e.jsx("stop",{offset:"40%",stopColor:"#1e3a8a"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]}),e.jsxs("radialGradient",{id:"celestial-glow",cx:"50%",cy:"30%",r:"50%",children:[e.jsx("stop",{offset:"0%",stopColor:"#fbbf24",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"#fbbf24",stopOpacity:"0"})]}),e.jsx("filter",{id:"cloud-blur",children:e.jsx("feGaussianBlur",{stdDeviation:"8"})})]}),e.jsx("rect",{width:f,height:h,fill:"url(#celestial-sky)"}),e.jsx("rect",{width:f,height:h,fill:"url(#celestial-glow)"}),[...Array(50)].map((O,U)=>e.jsx("circle",{cx:Math.random()*f,cy:Math.random()*h*.6,r:Math.random()*2+.5,fill:"#ffffff",opacity:Math.random()*.5+.3},`star-${U}`)),e.jsx("ellipse",{cx:"200",cy:"200",rx:"150",ry:"40",fill:"#ffffff",opacity:"0.1",filter:"url(#cloud-blur)"}),e.jsx("ellipse",{cx:"600",cy:"150",rx:"200",ry:"50",fill:"#ffffff",opacity:"0.15",filter:"url(#cloud-blur)"}),e.jsx("ellipse",{cx:"1000",cy:"180",rx:"180",ry:"45",fill:"#ffffff",opacity:"0.1",filter:"url(#cloud-blur)"}),e.jsx("path",{d:"M0,600 Q100,450 200,550 Q300,400 400,500 Q500,350 600,480 Q700,380 800,500 Q900,420 1000,520 Q1100,450 1200,550 L1200,1000 L0,1000 Z",fill:"#1e40af",opacity:"0.3"}),e.jsx("path",{d:"M0,700 Q150,550 300,650 Q450,500 600,620 Q750,480 900,600 Q1050,520 1200,650 L1200,1000 L0,1000 Z",fill:"#2563eb",opacity:"0.4"}),e.jsx("ellipse",{cx:"300",cy:"750",rx:"250",ry:"60",fill:"#ffffff",opacity:"0.2",filter:"url(#cloud-blur)"}),e.jsx("ellipse",{cx:"700",cy:"720",rx:"300",ry:"70",fill:"#ffffff",opacity:"0.25",filter:"url(#cloud-blur)"}),e.jsx("ellipse",{cx:"1050",cy:"760",rx:"200",ry:"50",fill:"#ffffff",opacity:"0.2",filter:"url(#cloud-blur)"}),e.jsx("path",{d:"M0,800 Q200,650 400,750 Q600,600 800,720 Q1000,650 1200,780 L1200,1000 L0,1000 Z",fill:"#3b82f6",opacity:"0.5"}),e.jsx("path",{d:"M580,650 Q590,750 585,850",stroke:"#93c5fd",strokeWidth:"3",fill:"none",opacity:"0.6"}),e.jsx("path",{d:"M590,650 Q600,750 595,850",stroke:"#bfdbfe",strokeWidth:"2",fill:"none",opacity:"0.4"})]}),Q=()=>e.jsxs("g",{children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"mortal-sky",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#1c1917"}),e.jsx("stop",{offset:"30%",stopColor:"#292524"}),e.jsx("stop",{offset:"100%",stopColor:"#44403c"})]}),e.jsxs("linearGradient",{id:"water-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.3"}),e.jsx("stop",{offset:"50%",stopColor:"#60a5fa",stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0.3"})]}),e.jsx("filter",{id:"mountain-shadow",children:e.jsx("feDropShadow",{dx:"2",dy:"4",stdDeviation:"3",floodColor:"#000000",floodOpacity:"0.3"})})]}),e.jsx("rect",{width:f,height:h,fill:"url(#mortal-sky)"}),e.jsx("circle",{cx:"950",cy:"120",r:"50",fill:"#fef3c7",opacity:"0.8"}),e.jsx("circle",{cx:"930",cy:"110",r:"50",fill:"url(#mortal-sky)"}),e.jsx("path",{d:"M0,500 Q100,400 200,450 Q350,350 500,420 Q650,320 800,400 Q950,340 1100,420 L1200,450 L1200,1000 L0,1000 Z",fill:"#44403c",opacity:"0.4"}),e.jsx("path",{d:"M0,550 Q150,420 300,500 Q500,380 700,480 Q900,400 1100,500 L1200,520 L1200,1000 L0,1000 Z",fill:"#57534e",opacity:"0.5"}),e.jsx("path",{d:"M0,620 Q50,600 100,620 Q150,590 200,620 Q250,580 300,620 Q350,590 400,620 Q450,580 500,620 Q550,590 600,620 Q650,580 700,620 Q750,590 800,620 Q850,580 900,620 Q950,590 1000,620 Q1050,580 1100,620 Q1150,590 1200,620 L1200,1000 L0,1000 Z",fill:"#365314",opacity:"0.4"}),e.jsx("path",{d:"M0,700 Q200,550 400,680 Q600,520 800,660 Q1000,580 1200,700 L1200,1000 L0,1000 Z",fill:"#78716c",opacity:"0.6",filter:"url(#mountain-shadow)"}),e.jsx("path",{d:"M100,750 Q300,780 500,750 Q700,720 900,760 Q1100,790 1200,770",stroke:"url(#water-gradient)",strokeWidth:"40",fill:"none",opacity:"0.6",strokeLinecap:"round"}),e.jsx("path",{d:"M100,750 Q300,780 500,750 Q700,720 900,760 Q1100,790 1200,770",stroke:"#93c5fd",strokeWidth:"2",fill:"none",opacity:"0.4",strokeLinecap:"round",strokeDasharray:"20 30"}),e.jsx("path",{d:"M0,850 Q300,820 600,850 Q900,880 1200,850 L1200,1000 L0,1000 Z",fill:"#292524",opacity:"0.8"}),e.jsx("path",{d:"M600,1000 Q580,900 620,800 Q650,700 600,600",stroke:"#78716c",strokeWidth:"8",fill:"none",opacity:"0.3",strokeLinecap:"round"})]}),Z=()=>e.jsxs("g",{children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"nether-sky",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#09090b"}),e.jsx("stop",{offset:"50%",stopColor:"#18181b"}),e.jsx("stop",{offset:"100%",stopColor:"#27272a"})]}),e.jsxs("radialGradient",{id:"nether-glow",cx:"50%",cy:"70%",r:"40%",children:[e.jsx("stop",{offset:"0%",stopColor:"#7c3aed",stopOpacity:"0.2"}),e.jsx("stop",{offset:"100%",stopColor:"#7c3aed",stopOpacity:"0"})]}),e.jsx("filter",{id:"nether-blur",children:e.jsx("feGaussianBlur",{stdDeviation:"5"})})]}),e.jsx("rect",{width:f,height:h,fill:"url(#nether-sky)"}),e.jsx("rect",{width:f,height:h,fill:"url(#nether-glow)"}),e.jsx("ellipse",{cx:"200",cy:"300",rx:"200",ry:"100",fill:"#3f3f46",opacity:"0.15",filter:"url(#nether-blur)"}),e.jsx("ellipse",{cx:"800",cy:"250",rx:"250",ry:"120",fill:"#52525b",opacity:"0.1",filter:"url(#nether-blur)"}),e.jsx("ellipse",{cx:"500",cy:"400",rx:"300",ry:"150",fill:"#3f3f46",opacity:"0.12",filter:"url(#nether-blur)"}),e.jsx("path",{d:"M0,450 L100,300 L150,380 L250,250 L350,400 L450,280 L550,420 L650,300 L750,450 L850,320 L950,400 L1050,280 L1150,380 L1200,350 L1200,1000 L0,1000 Z",fill:"#27272a",opacity:"0.5"}),e.jsx("path",{d:"M0,550 L80,400 L180,500 L280,350 L380,480 L480,380 L580,520 L680,400 L780,550 L880,420 L980,500 L1080,380 L1200,480 L1200,1000 L0,1000 Z",fill:"#3f3f46",opacity:"0.6"}),e.jsx("path",{d:"M0,700 Q200,750 400,700 Q600,650 800,720 Q1000,780 1200,720",stroke:"#52525b",strokeWidth:"50",fill:"none",opacity:"0.5",strokeLinecap:"round"}),e.jsx("path",{d:"M0,700 Q200,750 400,700 Q600,650 800,720 Q1000,780 1200,720",stroke:"#7c3aed",strokeWidth:"3",fill:"none",opacity:"0.3",strokeLinecap:"round"}),e.jsx("path",{d:"M0,800 L100,700 L200,780 L350,680 L500,800 L650,720 L800,820 L950,750 L1100,850 L1200,780 L1200,1000 L0,1000 Z",fill:"#18181b",opacity:"0.8"}),[...Array(8)].map((O,U)=>e.jsxs("g",{children:[e.jsx("ellipse",{cx:100+U*150,cy:850-U%3*50,rx:"8",ry:"15",fill:"#7c3aed",opacity:"0.4"}),e.jsx("ellipse",{cx:100+U*150,cy:845-U%3*50,rx:"4",ry:"8",fill:"#a855f7",opacity:"0.6"})]},`flame-${U}`))]}),G=()=>{switch(d){case"天界":return R();case"人界":return Q();case"冥界":return Z()}},H=O=>{const U=O.name===a,te=o===O.id,ie=U||te?M.accentColor:M.textColor,B=M.glowColor,W=U?1.15:te?1.1:1,ne=()=>{switch(O.type){case"Sect":return e.jsxs("g",{children:[e.jsx("path",{d:`M0,-12 L-${12*.8},${12*.6} L${12*.8},${12*.6} Z`,fill:ie,opacity:"0.9"}),e.jsx("rect",{x:-12*.4,y:12*.2,width:12*.8,height:12*.5,fill:ie,opacity:"0.7"})]});case"City":return e.jsxs("g",{children:[e.jsx("rect",{x:-12,y:-12*.5,width:24,height:12*1.2,fill:ie,opacity:"0.9",rx:"2"}),e.jsx("rect",{x:-12*.6,y:-12*.2,width:12*.4,height:12*.8,fill:M.bgGradient[0],opacity:"0.6"}),e.jsx("rect",{x:12*.2,y:-12*.2,width:12*.4,height:12*.8,fill:M.bgGradient[0],opacity:"0.6"})]});case"Palace":return e.jsxs("g",{children:[e.jsx("path",{d:`M0,-12 L-12,${12*.3} L12,${12*.3} Z`,fill:ie,opacity:"0.9"}),e.jsx("rect",{x:-12*.8,y:12*.3,width:12*1.6,height:12*.5,fill:ie,opacity:"0.8"}),e.jsx("circle",{cx:"0",cy:-12*.3,r:12*.25,fill:M.accentColor,opacity:"0.9"})]});case"Cave":return e.jsxs("g",{children:[e.jsx("ellipse",{cx:"0",cy:"0",rx:12,ry:12*.8,fill:ie,opacity:"0.9"}),e.jsx("ellipse",{cx:"0",cy:-12*.15,rx:12*.6,ry:12*.4,fill:M.bgGradient[0],opacity:"0.7"})]});case"Mountain":return e.jsxs("g",{children:[e.jsx("path",{d:`M-12,${12*.8} L0,-12 L12,${12*.8} Z`,fill:"none",stroke:ie,strokeWidth:"2.5",opacity:"0.9"}),e.jsx("path",{d:`M-${12*.5},${12*.8} L0,-${12*.2} L${12*.5},${12*.8}`,fill:"none",stroke:ie,strokeWidth:"2",opacity:"0.6"})]});case"Forest":return e.jsx("g",{children:e.jsx("path",{d:`M0,-12 L-${12*.7},${12*.2} L-${12*.3},${12*.2} L-12,12 L12,12 L${12*.3},${12*.2} L${12*.7},${12*.2} Z`,fill:ie,opacity:"0.9"})});case"River":return e.jsxs("g",{children:[e.jsx("path",{d:`M-12,-${12*.4} Q-${12*.5},0 0,0 T12,${12*.4}`,fill:"none",stroke:ie,strokeWidth:"3",opacity:"0.9",strokeLinecap:"round"}),e.jsx("path",{d:`M-12,${12*.2} Q-${12*.5},${12*.6} 0,${12*.6} T12,12`,fill:"none",stroke:ie,strokeWidth:"2.5",opacity:"0.6",strokeLinecap:"round"})]});case"Prison":return e.jsxs("g",{children:[e.jsx("rect",{x:-12,y:-12*.7,width:24,height:12*1.6,fill:ie,opacity:"0.9",rx:"2"}),e.jsx("line",{x1:-12*.5,y1:-12*.7,x2:-12*.5,y2:12*.9,stroke:M.bgGradient[0],strokeWidth:"2",opacity:"0.7"}),e.jsx("line",{x1:"0",y1:-12*.7,x2:"0",y2:12*.9,stroke:M.bgGradient[0],strokeWidth:"2",opacity:"0.7"}),e.jsx("line",{x1:12*.5,y1:-12*.7,x2:12*.5,y2:12*.9,stroke:M.bgGradient[0],strokeWidth:"2",opacity:"0.7"})]});default:return e.jsx("circle",{r:12,fill:ie,opacity:"0.9"})}};return e.jsxs("g",{transform:`translate(${O.x}, ${O.y})`,onMouseEnter:()=>!r&&c(O.id),onMouseLeave:()=>!r&&c(null),onClick:X=>{X.stopPropagation(),n(O)},style:{cursor:"pointer"},children:[(U||te)&&e.jsxs(e.Fragment,{children:[e.jsx("circle",{r:"35",fill:B,opacity:"0.15"}),e.jsx("circle",{r:"25",fill:B,opacity:"0.25"})]}),e.jsx("g",{style:{transform:`scale(${W})`,transformOrigin:"center",transition:"transform 0.3s ease"},children:ne()}),e.jsx("text",{y:"28",fill:M.textColor,fontSize:"13",fontWeight:U?"bold":"normal",textAnchor:"middle",style:{fontFamily:"serif",opacity:te||U?1:.8,transition:"all 0.3s ease",pointerEvents:"none",textShadow:`0 2px 4px ${M.bgGradient[0]}`},children:O.name}),O.isMajor&&e.jsx("text",{x:"15",y:"-12",fill:M.accentColor,fontSize:"14",opacity:"0.9",children:"★"})]},O.id)};return e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx("div",{className:"absolute top-4 right-4 z-30 flex gap-2",children:$1.map(O=>e.jsx("button",{onClick:()=>m(O),className:`px-4 py-2 rounded-lg font-serif text-sm transition-all border ${d===O?"bg-amber-600/90 text-white border-amber-400 shadow-lg shadow-amber-600/30":"bg-black/60 text-amber-200/80 border-amber-600/30 hover:bg-black/80 hover:border-amber-500/50"}`,children:O},O))}),e.jsxs("div",{className:"w-full h-full overflow-hidden relative touch-none",onTouchStart:k,onTouchMove:_,onTouchEnd:C,onMouseDown:S,onMouseMove:D,onMouseUp:E,onMouseLeave:E,onWheel:A,style:{cursor:j?"grabbing":"grab"},children:[e.jsx("div",{className:"absolute top-4 left-4 z-20",children:e.jsx(A1,{scale:g,onZoomIn:I,onZoomOut:L,onReset:z,minScale:.5,maxScale:3})}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-20 bg-black/50 backdrop-blur-sm px-4 py-2 rounded-lg border border-amber-500/30",children:[e.jsx("span",{className:"text-amber-300 font-serif text-lg",children:d}),e.jsxs("span",{className:"text-amber-200/60 text-sm ml-2",children:["· ",T.length," 个地点"]})]}),e.jsxs("svg",{viewBox:`0 0 ${f} ${h}`,className:"w-full h-full",preserveAspectRatio:"xMidYMid slice",style:{transform:`translate(${w}px, ${N}px) scale(${g})`,transition:j?"none":"transform 0.3s ease-out"},children:[G(),e.jsx("g",{style:{pointerEvents:"auto"},children:T.map(O=>H(O))})]})]})]})},T1=({currentLocationName:n,onClose:a,onTravel:r})=>{const[o,c]=v.useState(null),[d,m]=v.useState(!1),[f,h]=v.useState(!1);v.useEffect(()=>{const N=()=>{m(window.innerWidth<768)};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]);const p=N=>{c(N),d&&h(!0)},b=()=>{o&&(r(o.name),h(!1))},g=N=>({Sect:"fa-mountain-sun",City:"fa-city",Cave:"fa-dungeon",Mountain:"fa-mountain",Forest:"fa-tree",Plain:"fa-seedling",River:"fa-water",Sea:"fa-ship",Prison:"fa-bars",Palace:"fa-crown"})[N]||"fa-map-marker",w=()=>{if(!o)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-4",children:[e.jsx("i",{className:"fa-solid fa-map-location-dot text-4xl mb-3 text-amber-500/30"}),e.jsx("p",{className:"text-center",children:"点击地图上的地点以查看详情"}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"或使用搜索功能快速定位"})]});const N=o.name===n;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 flex items-center justify-center bg-amber-500/20 rounded-lg border border-amber-500/30",children:e.jsx("i",{className:`fa-solid ${g(o.type)} text-amber-400 text-xl`})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("h3",{className:"text-xl font-bold text-white font-serif flex items-center gap-2",children:[o.name,o.isMajor&&e.jsx("span",{className:"text-amber-400 text-base",children:"★"})]}),e.jsxs("p",{className:"text-amber-300/70 text-sm",children:[o.region," · ",o.type]})]})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto mb-4",children:[e.jsx("div",{className:"bg-black/20 rounded-lg p-3 border border-stone-700/30",children:e.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:o.description})}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("i",{className:"fa-solid fa-location-dot text-amber-500/50"}),e.jsxs("span",{children:["坐标: (",o.x,", ",o.y,")"]})]}),N&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-400",children:[e.jsx("i",{className:"fa-solid fa-circle-check"}),e.jsx("span",{children:"你当前正在此地"})]})]})]}),e.jsx("button",{onClick:b,disabled:N,className:"w-full bg-amber-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-amber-500 transition-all disabled:bg-stone-600 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg",children:N?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-map-pin"}),e.jsx("span",{children:"当前所在"})]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-route"}),e.jsx("span",{children:"前往此地"})]})})]})};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center animate-fade-in",onClick:a,children:d?e.jsxs("div",{className:"bg-gradient-to-br from-stone-950 via-stone-900 to-stone-950 w-full h-full flex flex-col overflow-hidden",onClick:N=>N.stopPropagation(),children:[e.jsxs("div",{className:"flex-shrink-0 bg-gradient-to-r from-black/60 via-black/40 to-black/60 backdrop-blur-md border-b-2 border-amber-500/30",children:[e.jsxs("div",{className:"flex justify-between items-center p-3",children:[e.jsx("h2",{className:"text-lg font-bold text-amber-300 font-serif",children:"世界地图"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors w-9 h-9 flex items-center justify-center rounded-lg hover:bg-amber-900/20",children:e.jsx("i",{className:"fa-solid fa-times text-xl"})})]}),e.jsx("div",{className:"px-3 pb-3",children:e.jsx(Jf,{currentLocationName:n,onLocationSelect:p})})]}),e.jsx("div",{className:"flex-grow relative overflow-hidden",children:e.jsx(Kf,{onLocationSelect:p,currentLocationName:n,isMobile:!0})}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-b from-stone-900/98 to-black/98 backdrop-blur-xl border-t-2 border-amber-500/40 shadow-2xl transition-transform duration-300 ease-out ${f?"translate-y-0":"translate-y-full"}`,style:{maxHeight:"60vh",boxShadow:"0 -10px 40px rgba(251, 191, 36, 0.2), inset 0 1px 0 rgba(251, 191, 36, 0.3)"},children:[e.jsx("div",{className:"flex justify-center py-2 cursor-pointer",onClick:()=>h(!1),children:e.jsx("div",{className:"w-12 h-1 bg-amber-500/50 rounded-full"})}),e.jsx("div",{className:"px-4 pb-4 max-h-[calc(60vh-3rem)] overflow-y-auto",children:w()})]}),!f&&e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur-sm px-4 py-2 rounded-full border border-amber-500/30",children:e.jsxs("p",{className:"text-amber-200 text-sm flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-hand-pointer"}),e.jsx("span",{children:"点击地点查看详情"})]})})]}):e.jsxs("div",{className:"ornate-border bg-gradient-to-br from-stone-950 via-stone-900 to-stone-950 w-full max-w-7xl h-[90vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col border-2 border-amber-600/50 relative",onClick:N=>N.stopPropagation(),style:{boxShadow:"0 0 60px rgba(251, 191, 36, 0.3), inset 0 0 60px rgba(0, 0, 0, 0.5)"},children:[e.jsx("div",{className:"absolute top-0 left-0 w-20 h-20 border-t-4 border-l-4 border-amber-500/70 rounded-tl-xl pointer-events-none"}),e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 border-t-4 border-r-4 border-amber-500/70 rounded-tr-xl pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-20 h-20 border-b-4 border-l-4 border-amber-500/70 rounded-bl-xl pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-20 h-20 border-b-4 border-r-4 border-amber-500/70 rounded-br-xl pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-gradient-to-r from-black/50 via-black/30 to-black/50 border-b-2 border-amber-500/30 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-amber-200 via-amber-400 to-amber-200 bg-clip-text text-transparent font-serif drop-shadow-[0_0_10px_rgba(251,191,36,0.5)]",children:"✦ 世界地图 ✦"}),e.jsx("div",{className:"flex-grow max-w-md",children:e.jsx(Jf,{currentLocationName:n,onLocationSelect:p})})]}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors w-10 h-10 flex items-center justify-center rounded-lg hover:bg-amber-900/20",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-grow flex overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(Kf,{onLocationSelect:p,currentLocationName:n,isMobile:!1})}),e.jsxs("div",{className:"absolute top-4 right-4 bottom-4 w-80 bg-gradient-to-b from-black/80 via-stone-900/85 to-black/80 rounded-lg p-4 flex flex-col border border-amber-500/30 backdrop-blur-xl shadow-2xl overflow-hidden",style:{zIndex:40},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-900/5 via-transparent to-purple-900/5 pointer-events-none"}),e.jsx("div",{className:"relative z-10 flex flex-col h-full",children:w()})]})]})]})})},M1=({isOpen:n,onClose:a,record:r})=>n?e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-fade-in-up",onClick:a,children:e.jsxs("div",{className:"ornate-border-double border-spiritual-500 w-full max-w-xl h-auto max-h-[85vh] relative bg-gradient-to-b from-stone-900 via-stone-900 to-stone-950 rounded-xl shadow-2xl overflow-hidden flex flex-col",onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-cyan-400 to-transparent z-10"}),e.jsxs("div",{className:"relative px-6 py-4 border-b border-stone-700/50 bg-gradient-to-r from-stone-800/80 to-stone-900/80 flex justify-between items-center flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full border border-cyan-500/30 bg-cyan-900/20 flex items-center justify-center shadow-[0_0_10px_rgba(6,182,212,0.2)]",children:e.jsx("i",{className:"fa-solid fa-file-medical text-cyan-400 text-lg"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-cyan-100 font-serif",children:"病案详情"}),e.jsxs("p",{className:"text-xs text-cyan-500/80 font-mono tracking-wider",children:["MEDICAL RECORD: ",r.name]})]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-stone-700/30 hover:bg-stone-600/50 border border-stone-600/50 hover:border-cyan-500/50 text-stone-400 hover:text-cyan-300 transition-all flex items-center justify-center group",children:e.jsx("i",{className:"fa-solid fa-times text-lg group-hover:rotate-90 transition-transform"})})]}),e.jsxs("div",{className:"flex-grow p-6 overflow-y-auto scrollbar-enhanced space-y-5 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('/patterns/subtle-dark.png')] opacity-20 pointer-events-none"}),e.jsxs("div",{className:"relative z-10 bg-stone-800/40 p-5 rounded-lg border border-stone-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsxs("h4",{className:"flex items-center gap-2 font-bold text-amber-400/90 mb-4 pb-2 border-b border-stone-700/50 group-hover:border-amber-500/30 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-id-card text-amber-500"})," 基本信息"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-3 gap-x-4 text-sm",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("span",{className:"text-stone-500 block text-xs mb-0.5",children:"姓名"}),e.jsx("span",{className:"text-stone-200 font-semibold text-lg",children:r.name})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("span",{className:"text-stone-500 block text-xs mb-0.5",children:"性别/年龄"}),e.jsxs("span",{className:"text-stone-200",children:[r.gender," ",e.jsx("span",{className:"text-stone-600 mx-1",children:"|"})," ",r.age,"岁"]})]}),e.jsxs("div",{className:"col-span-2 mt-1",children:[e.jsx("span",{className:"text-stone-500 block text-xs mb-0.5",children:"背景故事"}),e.jsxs("p",{className:"text-stone-300 leading-relaxed bg-black/20 p-3 rounded border border-stone-800 italic",children:['"',r.background,'"']})]})]})]}),e.jsxs("div",{className:"relative z-10 bg-stone-800/40 p-5 rounded-lg border border-stone-700/50 hover:border-pink-500/30 transition-colors group",children:[e.jsxs("h4",{className:"flex items-center gap-2 font-bold text-pink-400/90 mb-4 pb-2 border-b border-stone-700/50 group-hover:border-pink-500/30 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-venus-mars text-pink-500"})," 生理特征"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-stone-500 block text-xs mb-0.5",children:"器官构造"}),e.jsx("span",{className:"text-pink-200 font-serif text-lg",children:r.genitalShape||"未记录"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-stone-500 block text-xs mb-1",children:"特殊体征"}),r.sexualFeatures&&Array.isArray(r.sexualFeatures)&&r.sexualFeatures.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:r.sexualFeatures.map((o,c)=>e.jsx("span",{className:"px-2.5 py-1 rounded bg-pink-900/20 border border-pink-800/50 text-pink-300 text-xs font-medium",children:typeof o=="string"?o:typeof o=="object"&&o!==null?JSON.stringify(o):String(o)},c))}):e.jsx("span",{className:"text-stone-600 italic",children:"暂无特殊记录"})]})]})]}),e.jsxs("div",{className:"relative z-10 bg-red-950/10 p-5 rounded-lg border border-red-900/30 hover:border-red-500/30 transition-colors group",children:[e.jsxs("h4",{className:"flex items-center gap-2 font-bold text-red-400/90 mb-3 pb-2 border-b border-red-900/30 group-hover:border-red-500/30 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-virus-covid text-red-500"})," 病症详情"]}),e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa-solid fa-quote-left absolute -top-1 -left-1 text-red-900/20 text-4xl -z-10"}),e.jsx("p",{className:"whitespace-pre-wrap text-red-200/90 leading-relaxed font-serif pl-2",children:r.illnessDescription})]})]})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-cyan-800 to-transparent pointer-events-none"})]})}):null;function wt(n){const a=/```json\s*([\s\S]*?)\s*```/,r=n.match(a);if(r&&r[1])try{return JSON.parse(r[1])}catch(o){throw console.error("解析从AI响应中提取的JSON失败:",o),console.error("原始JSON字符串:",r[1]),new Error("模型返回的JSON格式无效。")}throw console.error("在AI响应中未找到JSON代码块。响应内容:",n),new Error("模型响应中未找到预期的JSON代码块。")}async function dp(n,a,r,o){var b;const c=`你是一位仙侠（中国仙幻）RPG的大师级故事讲述者和游戏主持人。
1. 阅读故事历史、玩家档案和玩家的行动。
2. 撰写故事的下一章。故事应引人入胜，文笔优美，符合仙侠主题。
3. **任务更新**:
   a. 如果玩家的行动完成了某个正在进行的任务目标（例如，与特定NPC交谈），你**必须**在JSON输出中包含一个 'questUpdate' 对象。该对象应包含 'questId', 'objectiveId' 和 'progress' (通常为1，代表完成1次)。
   b. 如果故事发展到了可以触发一个新任务的节点，你**可以**在JSON输出中包含一个 'newQuest' 对象，其结构必须符合我们定义的Quest类型。
4. **战斗和挑战**: 仅当故事中明确出现一个角色对另一个角色"亮出黄牌"时，你才必须触发战斗。
5. **关系更新**: 如果剧情导致角色关系发生变化，你可以包含一个 'relationshipUpdate' 对象。
6. 更新游戏世界的状态（地点，时间）。
7. 提供三个富有创意、各不相同且简洁的行动选项。
8. 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。

**重要：JSON输出格式必须严格遵循以下结构（所有必填字段不能省略）：**
\`\`\`json
{
  "story": "（必填）故事的下一章内容，200-500字的叙事文本",
  "location": "（必填）当前地点名称，如'青蛇宗山门'",
  "time": "（必填）当前时间，如'第3天，午后'",
  "choices": ["（必填）选项1", "选项2", "选项3"]
}
\`\`\`

**字段说明：**
- **story**: 字符串，必填。故事的下一章内容，应该是一段完整的叙事文本，描述玩家行动的结果和后续发展。
- **location**: 字符串，必填。当前所在地点的名称。
- **time**: 字符串，必填。当前的游戏时间。
- **choices**: 字符串数组，必填。必须包含恰好3个选项，每个选项是一个简短的行动描述（10-30字）。

**可选字段（根据情况添加）：**
- questUpdate: { questId: string, objectiveId: string, progress: number }
- newQuest: Quest对象
- relationshipUpdate: { characterId: string, status?: string, newTags?: string[] }
- reputationUpdate: { scoreChange: number, description: string }
- event: { type: 'battle', opponentName: string } （仅在触发战斗时）
- pendingChallenge: { challengerName: string, reason: string }`,d=n.length>2e3?`...${n.slice(-2e3)}`:n,m=r.maleParty.length>0?r.maleParty:r.femaleParty,f=`
    迄今为止的故事：
    ${d}

    玩家档案（摘要）：
    姓名: ${r.name}
    队伍成员: ${m.map(g=>g.name).join("、")}
    声望: ${r.reputation.level} (${r.reputation.score})
    进行中的任务: ${JSON.stringify(r.quests.filter(g=>g.status==="In Progress"))}

    玩家的行动：
    "${a}"

    现在，请生成故事的下一部分和新的游戏状态。
    `,h=o?await tt({systemInstruction:c,prompt:f,gameState:o}):await Qe(c,f),p=wt(h);return((b=p.event)==null?void 0:b.type)==="battle"?{...p,opponentParty:[]}:p}async function z1(n,a,r,o){const c=`你是一位顶级的仙侠世界色情战斗解说员。你的任务是基于角色、技能和装备的色情设定，生成一段露骨、详细、电影般的战斗场景描述，同时精确计算战斗结果。

**核心规则：**
1.  **色情战斗描述 (ActionDescription)**: 这是你的首要任务。你必须基于当前行动者使用的技能的 'eroticDescription' 进行扩展和润色，**同时必须引用其护甲和饰品的外观描述**，生成一段详细、露骨、充满想象力的色情战斗场景描述。
    - **装备融合要求**:
      * 如果角色装备了护甲，必须在描述中体现护甲的暴露程度、性感设计和布料材质
      * 如果角色装备了饰品，必须在描述中提及饰品如何增强其魅力、闪耀光芒或产生特殊效果
      * 不同护甲和饰品会让同一技能的释放呈现出不同的视觉效果和色情表现
      * 特别注意护甲在战斗动作中的晃动、移位、破损等细节
    - **描述要求**: 这段描述应该具体到身体姿态、表情、体液、护甲与饰品如何衬托身体曲线、以及性器官的互动。此字段绝对不能包含任何数值。
2.  **精确伤害计算**: 基础伤害 = (攻击者攻击力 - 防御者防御力)。最低伤害为5。
3.  **状态与会心**: 严格按照技能机制、状态效果和会心率计算最终伤害和HP/MP变化。
4.  **简洁战斗总结 (TurnSummary)**: 这个字段必须非常简洁，格式必须为："【技能名】对 角色名 造成了 X 点伤害。" 或 "【技能名】为 角色名 恢复了 X 点气血。"
5.  **AI对手行动**: 对手总是使用其两个技能之一。选择策略上最合理的一个，并同样为其生成色情的 'opponentActionDescription' 和简洁的 'opponentTurnSummary'。
6.  **状态效果生成**: 如果技能造成了状态效果（如中毒、灼烧、虚弱、魅惑等），必须在对应的statusEffects数组中添加完整的状态效果对象。

**状态效果对象格式（StatusEffect）：**
每个状态效果对象必须包含以下字段：
- **name**: 状态名称（如"中毒"、"灼烧"、"攻击力提升"等）
- **description**: 风味描述（50-100字，描述状态的表现和感受）
- **mechanicsDescription**: 机制说明（必填！清晰说明数值效果，如"每回合损失10点气血"、"攻击力提升30%，持续3回合"）
- **duration**: 持续回合数（数字）

示例：
\`\`\`json
{
  "name": "中毒",
  "description": "体内侵入了剧毒，感到阵阵眩晕和虚弱，紫黑色的毒素在血管中流淌。",
  "mechanicsDescription": "每回合开始时损失最大气血的5%，持续3回合",
  "duration": 3
}
\`\`\`

**必须返回的JSON格式（所有字段都是必填的）：**
\`\`\`json
{
  "playerActionDescription": "玩家技能的色情描述文本（200-400字）",
  "opponentActionDescription": "对手技能的色情描述文本（200-400字）",
  "playerTurnSummary": "【技能名】对 对手名 造成了 X 点伤害",
  "opponentTurnSummary": "【技能名】对 玩家名 造成了 X 点伤害",
  "playerHpChange": -30,
  "opponentHpChange": -50,
  "playerMpChange": -20,
  "opponentMpChange": -15,
  "playerStatusEffects": [
    {
      "name": "状态名称",
      "description": "状态的风味描述",
      "mechanicsDescription": "状态的机制说明（必填！）",
      "duration": 3
    }
  ],
  "opponentStatusEffects": [
    {
      "name": "状态名称",
      "description": "状态的风味描述",
      "mechanicsDescription": "状态的机制说明（必填！）",
      "duration": 3
    }
  ]
}
\`\`\`

**关键要求：**
- playerStatusEffects 和 opponentStatusEffects 必须是数组，即使为空也要返回 []
- 如果有状态效果，每个状态效果对象的mechanicsDescription字段是**必填的**，不能省略！
- 所有数值字段都必须存在，即使为0也要明确写出
- TurnSummary 必须包含【技能名】以便提取
- 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,d=p=>p.card.skills.filter(b=>b).map(b=>({name:b.name,cost:b.cost,mechanics:b.mechanicsDescription,eroticDescription:b.eroticDescription})),m=p=>{const b=p.card.equipment,g=[];return b.armor&&g.push(`护甲【${b.armor.name}】: ${b.armor.description}`),b.accessory1&&g.push(`饰品【${b.accessory1.name}】: ${b.accessory1.description}`),b.accessory2&&g.push(`饰品【${b.accessory2.name}】: ${b.accessory2.description}`),g.length>0?g.join(`
`):"无装备"},f=`
    当前战斗人员：
    - 玩家卡牌: ${n.card.name} (境界: ${n.card.realm}, 攻击: ${n.calculatedStats.attack}, 防御: ${n.calculatedStats.defense}, 当前气血: ${n.currentHp}, 当前真元: ${n.currentMp}, 当前状态: ${JSON.stringify(n.statusEffects)}, 技能: ${JSON.stringify(d(n))})
      装备描述:
      ${m(n)}
    
    - 对手卡牌: ${a.card.name} (境界: ${a.card.realm}, 攻击: ${a.calculatedStats.attack}, 防御: ${a.calculatedStats.defense}, 当前气血: ${a.currentHp}, 当前真元: ${a.currentMp}, 当前状态: ${JSON.stringify(a.statusEffects)}, 技能: ${JSON.stringify(d(a))})
      装备描述:
      ${m(a)}

    玩家的行动：
    "${r}"

    请结算此回合。首先，基于玩家使用的技能的 'eroticDescription' **并融合其护甲和饰品的外观描述** 生成 'playerActionDescription'，让护甲的暴露设计和饰品的华丽外观在技能释放中体现出来。然后，决定对手的行动，同样结合其护甲和饰品生成 'opponentActionDescription' 并计算结果。
    
    **重要**: 必须在动画描述中提及并利用护甲和饰品的色情外观，不同护甲和饰品应该让相同技能呈现出不同的视觉效果！特别关注护甲在动作中的移动、透视、破损效果！
    `,h=o?await tt({systemInstruction:c,prompt:f,gameState:o}):await Qe(c,f);return wt(h)}async function D1(n,a,r){const o=`你是一位仙侠（中国仙幻）RPG的大师级故事讲述者和游戏主持人。你的任务是生成一个随机世界事件。
1. 事件应该有趣并符合仙侠主题。
2. 提供一个简短、引人入胜的故事。
3. 创建2-3个有意义的选择，并有明确的风险/回报结果。
4. 结果必须是指定类型之一。
5. 如果结果是 'reward_item'，你必须从提供的可用装备列表中选择一个物品名称。
6. 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。

**重要：JSON输出格式必须严格遵循以下结构（所有必填字段不能省略）：**
\`\`\`json
{
  "title": "（必填）事件标题，简短有吸引力",
  "story": "（必填）事件故事描述，100-200字",
  "choices": [
    {
      "text": "（必填）选项显示文本",
      "outcome": {
        "type": "（必填）结果类型",
        "description": "（必填）结果描述"
      }
    }
  ]
}
\`\`\`

**字段说明：**
- **title**: 字符串，必填。事件的标题。
- **story**: 字符串，必填。事件的故事背景描述。
- **choices**: 数组，必填。必须包含2-3个选项对象。

**每个选项对象必须包含：**
- **text**: 字符串，必填。选项的显示文本（玩家看到的选择）。
- **outcome**: 对象，必填。选择该选项后的结果。

**outcome对象的type必须是以下之一：**
1. **reward_stones**: 获得灵石
   - 必须包含: type, amount (数字), description (字符串)
   - 示例: { "type": "reward_stones", "amount": 100, "description": "你获得了100灵石" }

2. **lose_stones**: 失去灵石
   - 必须包含: type, amount (数字), description (字符串)
   - 示例: { "type": "lose_stones", "amount": 50, "description": "你损失了50灵石" }

3. **battle**: 触发战斗
   - 必须包含: type, opponentName (字符串), opponentDescription (字符串), description (字符串)
   - 示例: { "type": "battle", "opponentName": "山贼头目", "opponentDescription": "一个凶悍的山贼", "description": "你与山贼头目展开战斗" }

4. **nothing**: 无事发生
   - 必须包含: type, description (字符串)
   - 示例: { "type": "nothing", "description": "你安全离开了" }

5. **reward_item**: 获得物品
   - 必须包含: type, itemName (字符串，必须从可用装备列表中选择), description (字符串)
   - 示例: { "type": "reward_item", "itemName": "破旧铁剑", "description": "你获得了一把破旧铁剑" }`,c=Th.map(f=>f.name).join(", "),d=`
    玩家当前位置: ${n}
    玩家姓名: ${a.name}
    可作为奖励的物品: ${c}

    请根据此背景生成一个随机事件。
    `,m=r?await tt({systemInstruction:o,prompt:d,gameState:r}):await Qe(o,d);return wt(m)}async function O1(n,a){const r=`你是一位专业的仙侠背景色情内容创作者，写作风格大胆、露骨、毫不避讳。你的任务是根据指定的稀有度，创造一个极度色情的角色。

**重要：你必须严格按照以下JSON结构生成角色数据，所有必填字段都不能省略！**

1.  **严格遵守稀有度**: 稀有度越高，角色的色情程度和暴露程度应该越高。

2.  **必填字段（缺一不可）**:
    *   **id**: 字符串，格式为 "generated-{timestamp}"
    *   **name**: 角色姓名
    *   **gender**: 必须是 "Male" 或 "Female" 之一
    *   **realm**: 修炼境界，如"筑基期"、"金丹期"等
    *   **rarity**: 稀有度（将由系统设置）
    *   **title**: 称号，必须直接、粗俗，充满性意味
    *   **race**: 种族，如"人族"、"妖族"、"魔族"等
    *   **origin**: 来历背景描述
    *   **appearance**: 外观描述，必须极度详细、露骨
    *   **charm**: 魅力值（1-100）
    *   **skillfulness**: 技巧值（1-100）
    *   **perception**: 悟性值（1-100）
    *   **baseAttributes**: 包含 hp, maxHp, mp, maxMp, attack, defense, speed, critRate, critDmg
    *   **skills**: **必须是一个包含4个元素的数组** [Skill, Skill, null, null]，前2个是独有技能对象，后2个填null
    *   **equipment**: 对象，包含 weapon: null, armor: null, accessory1: null, accessory2: null
    *   **pet**: null

3.  **技能数组格式（极其重要）**:
    角色的 skills 字段必须是一个包含恰好4个元素的数组：
    *   前2个元素：完整的技能对象，每个包含：id, name, rarity, description, mechanicsDescription, eroticDescription, cost, genderLock
    *   后2个元素：null
    
    示例：
    "skills": [
        {
            "id": "skill-{timestamp}-1",
            "name": "技能名称",
            "rarity": "珍品",
            "description": "技能描述",
            "mechanicsDescription": "造成120%攻击力伤害",
            "eroticDescription": "色情化描述",
            "cost": 20,
            "genderLock": "Female"
        },
        {
            "id": "skill-{timestamp}-2",
            "name": "第二个技能",
            ...
        },
        null,
        null
    ]

4.  **色情化核心字段**:
    *   **appearance**: 必须极度详细、露骨，直接聚焦于性器官和性感部位
    *   **title**: 称号必须充满性暗示
    *   **skills中的eroticDescription**: 每个技能都必须有详细的色情化描述

5.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,o=`请生成一个稀有度为【${n}】的角色卡。`,c=await Qe(r,o);return wt(c)}async function R1(n,a){const r=`你是一位顶级的仙侠世界色情装备设计师，精通如何将功能与极致的色情美学结合。

**重要：你必须严格按照Equipment接口生成装备数据！**

1.  **严格遵守稀有度**: 稀有度越高，装备应该越暴露、越色情、功能越奇特。

2.  **必填字段**:
    *   **id**: 格式为 "equip-{timestamp}"
    *   **name**: 充满性暗示的装备名称
    *   **type**: 必须是 "Weapon"、"Armor" 或 "Accessory" 之一
    *   **rarity**: 稀有度（将由系统设置）
    *   **description**: 极度详细、露骨的描述
    *   **genderLock** (可选): "Male"、"Female" 或 "Universal"
    *   **stats**: 属性加成对象，必须包含至少一个属性

3.  **stats属性数值规范（极其重要）**:
    *   **attack**: 攻击力加成，整数，根据稀有度范围：凡品5-10，良品8-15，优品12-25，珍品20-40，绝品35-60，仙品50-80，圣品70-100，神品90-150
    *   **hp**: 气血加成，整数，根据稀有度范围：凡品15-30，良品25-50，优品40-80，珍品60-120，绝品100-180，仙品150-250，圣品200-350，神品300-500
    *   **defense**: 防御力加成，整数，根据稀有度范围：凡品3-8，良品6-12，优品10-20，珍品15-35，绝品30-50，仙品40-70，圣品60-90，神品80-120
    *   **speed**: 速度加成，整数，根据稀有度范围：凡品2-5，良品4-8，优品6-12，珍品10-18，绝品15-25，仙品20-35，圣品30-45，神品40-60
    *   **critRate**: 暴击率加成，**必须是0-1之间的小数**，如0.05表示5%，根据稀有度范围：凡品0.02-0.05，良品0.04-0.08，优品0.06-0.12，珍品0.08-0.15，绝品0.12-0.20，仙品0.15-0.25，圣品0.20-0.30，神品0.25-0.40
    *   **critDmg**: 暴击伤害加成，**必须是0-1之间的小数**，如0.15表示15%，根据稀有度范围：凡品0.05-0.10，良品0.08-0.15，优品0.10-0.20，珍品0.15-0.30，绝品0.20-0.40，仙品0.30-0.50，圣品0.40-0.60，神品0.50-0.80

4.  **色情化核心字段**:
    *   **description**: 必须聚焦于其色情外观和穿着效果
    *   **name**: 装备名称充满性暗示

5.  **JSON格式示例**:
\`\`\`json
{
  "id": "equip-temp",
  "name": "淫纹软鞭",
  "type": "Weapon",
  "rarity": "良品",
  "description": "一条柔软如蛇的鞭子，鞭身刻满了催情淫纹，每次挥动都会释放出让人春心荡漾的气息。",
  "genderLock": "Universal",
  "stats": {
    "attack": 12,
    "speed": 6,
    "critRate": 0.06
  }
}
\`\`\`

6.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,o=`请生成一个稀有度为【${n}】的装备。`,c=await Qe(r,o);return wt(c)}async function I1(n,a,r){const o=`你是一位顶级的仙侠世界色情技能设计师，精通如何将技能效果与极致的色情表现结合。

**重要：你必须严格按照Skill接口生成技能数据！**

1.  **严格遵守稀有度**: 稀有度越高，技能的色情程度和表现力应该越强。

2.  **严格遵守性别锁 (genderLock)**: 你必须为你被指定的性别【${a}】设计技能。
    *   如果是 **Male**，描述应聚焦于男性的雄伟、力量和侵略性
    *   如果是 **Female**，描述应聚焦于女性的妩媚、柔软和淫荡
    *   如果是 **Universal**，描述应适用于任何性别

3.  **必填字段**:
    *   **id**: 格式为 "skill-{timestamp}"
    *   **name**: 充满性暗示的技能名称
    *   **rarity**: 稀有度（将由系统设置）
    *   **description**: 技能风味描述
    *   **mechanicsDescription**: 技能机制描述（如"造成120%攻击力伤害"）
    *   **eroticDescription**: 极度色情的技能释放描述
    *   **cost**: 真元消耗（数值）
    *   **genderLock**: "Male"、"Female" 或 "Universal"

4.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,c=`请为【${a}】性别生成一个稀有度为【${n}】的技能。`,d=await Qe(o,c),m=wt(d);return m.genderLock=a,m}async function L1(n,a,r){const o=`You are a creative storyteller for a Xianxia (Chinese Fantasy) RPG. Your task is to generate world announcements that make the game world feel alive and dynamic.
1.  Generate exactly ${a} announcements for the specified category.
2.  Each announcement must have a title, content, and a thematic timestamp.
3.  The tone should be immersive and match the Xianxia genre. Announcements can be about major events, minor gossip, character achievements, or mysterious occurrences.
4.  Your final output must be a JSON object wrapped in a \`\`\`json ... \`\`\` code block. Do not add any explanations or comments outside the code block.`,d=`
    Please generate ${a} announcements for the following category: ${n}
    Category Guideline: ${{sect:"Sect Announcements: Focus on events within the player's sect (青蛇宗) or rival sects. Examples: promotions, breakthroughs, new rules, successful alchemy, challenges between disciples.",adventure:"Adventures & Anecdotes: Focus on rumors, discoveries, and strange events happening in the world that players might investigate. Examples: mysterious treasures appearing, strange beasts spotted, legendary cultivators being seen, gossip from a teahouse.",world:"World Decrees: Focus on major, world-shaking events. Examples: Heavenly Dao phenomena, wars between major factions, the birth of a divine being, the opening of an ancient ruin."}[n]}
    `,m=r?await tt({systemInstruction:o,prompt:d,gameState:r}):await Qe(o,d);return wt(m).announcements||[]}function B1(n,a){const r=JSON.parse(JSON.stringify(n)),o=r.relationships.findIndex(c=>c.id===a.characterId);if(o!==-1){const c=r.relationships[o];if(a.status&&(c.relationshipStatus=a.status),a.newTags){const d=new Set([...c.relationshipTags,...a.newTags]);c.relationshipTags=Array.from(d)}}else console.warn(`Relationship with ID ${a.characterId} not found.`);return r}async function U1(n,a){const r="你是一个仙侠世界的天机阁说书人，负责根据玩家的档案和声望，总结他们的称号和各种事迹。\n1.  阅读玩家的档案，特别是他们的声望分数和等级。\n2.  基于他们的声望，创造性地生成 1 个符合仙侠风格的江湖称号。\n3.  基于他们的声望和故事历史（摘要），总结出他们做过的两件广为人知的好事。\n4.  基于他们的声望和故事历史（摘要），总结出他们做过的两件广为人知的坏事。\n5.  发挥你的想象力，杜撰两件关于该角色的风流韵事或“最色的事”，要大胆、出格、符合仙侠世界的风土人情。例如“胁迫敌对宗门圣女当众裸体跳舞”或“在瑶池圣地偷看仙子洗澡”。\n6.  你的最终输出必须是一个包裹在 ```json ... ``` 代码块中的JSON对象，包含 'title', 'goodDeeds', 'badDeeds', 和 'lewdDeeds' 四个字段，每个数组包含两个字符串。不要在代码块之外添加任何解释或注释。",o=`
    玩家档案：
    姓名: ${n.name}
    称号: ${n.title}
    声望等级: ${n.reputation.level}
    声望分数: ${n.reputation.score}

    请为这位修士生成称号和各类事迹。
    `,c=a?await tt({systemInstruction:r,prompt:o,gameState:a}):await Qe(r,o);return wt(c)}async function H1(n,a,r){const c=`你是一位专业的跨次元同人创作大师，精通将各种作品的角色进行仙侠背景的色情化改编。写作风格大胆、露骨、毫不避讳。你的任务是根据用户提供的"灵感来源"，创造一个既保留原著核心特征、又完全适配仙侠世界观、并极度色情化的角色卡。${a?`

**重要：你必须生成稀有度为【${a}】的角色！这是系统根据概率随机决定的，你必须严格遵守。**`:""}

**重要：你必须严格按照以下JSON结构生成角色数据，所有必填字段都不能省略！**

1.  **解析灵感与原著还原**:
    *   深入理解灵感来源的核心概念（角色名、作品、标志性特征、性格、能力等）
    *   识别并保留角色最具代表性的元素（外观特征、性格特质、标志性能力）
    *   确保改编后的角色能让熟悉原作的人一眼认出

2.  **仙侠化改编原则**:
    *   将原作的能力系统转化为仙侠修炼体系（魔法→法术，超能力→神通）
    *   背景故事融入仙侠世界观（宗门、修真界、天道等元素）
    *   保持角色原有的性格特质和人际关系动态
    *   修炼境界应与原作实力相匹配

3.  **色情化改编要求**:
    *   **性格调整**: 在保留核心性格的基础上，添加符合成人向内容的欲望倾向、性冲动、情色特质
    *   **背景融入**: 将原著经历进行色情化解读（战斗→性战、修炼→双修、师徒关系→禁忌情欲）
    *   **关系重构**: 角色间的互动关系向性张力和情欲纠葛方向调整
    *   **场景暗示**: 设定中暗示或明示角色经历过的色情场景和性相关事件

4.  **必填字段（缺一不可）**:
    *   **id**: 字符串，格式为 "doujin-generated-{timestamp}"
    *   **name**: 角色姓名（可保留原名或仙侠化改编，如"纳尔逊"→"纳兰尘"）
    *   **gender**: 必须是 "Male" 或 "Female" 之一
    *   **realm**: 修炼境界，需与原作实力对应（如"筑基期"、"金丹期"等）
    *   **rarity**: 稀有度（根据原作角色重要性决定，主角级别建议"绝品"以上）
    *   **title**: 称号，必须融合原作特征且充满性暗示
        - 示例：火影忍者的鸣人 → "九尾淫狐传人"
        - 示例：海贼王的娜美 → "天候魅魔"
    *   **race**: 种族，需仙侠化改编（如精灵→仙族，恶魔→魔族，人类→人族）
    *   **origin**: 来历背景描述，必须：
        - 保留原作核心背景元素
        - 融入仙侠世界观设定
        - 加入色情化经历和性相关事件
    *   **appearance**: 外观描述，必须：
        - 保留原作标志性外观特征（发色、瞳色、装束风格等）
        - 极度详细、露骨地描述身体和性器官
        - 聚焦于性感部位和性特征
    *   **charm**: 魅力值（1-100，根据原作魅力设定）
    *   **skillfulness**: 技巧值（1-100，根据原作战斗技巧）
    *   **perception**: 悟性值（1-100，根据原作智慧/学习能力）
    *   **baseAttributes**: 包含 hp, maxHp, mp, maxMp, attack, defense, speed, critRate, critDmg
    *   **skills**: **必须是一个包含4个元素的数组** [Skill, Skill, null, null]，前2个是独有技能对象，后2个填null
    *   **equipment**: 对象，包含 weapon: null, armor: null, accessory1: null, accessory2: null
    *   **pet**: null

5.  **技能数组格式（极其重要）**:
    角色的 skills 字段必须是一个包含恰好4个元素的数组：
    *   前2个元素：完整的技能对象，必须改编自原作的标志性能力
    *   后2个元素：null
    
    技能改编要求：
    *   **保留原作技能特征**: 技能名称和效果必须能让人联想到原作
    *   **仙侠化转换**: 将原作技能转化为仙侠法术/神通
    *   **色情化描述**: eroticDescription必须极度详细地描写技能释放时的色情场景
    
    示例结构：
    "skills": [
        {
            "id": "skill-doujin-{timestamp}-1",
            "name": "改编后的技能名（保留原作特征）",
            "rarity": "珍品",
            "description": "技能描述（融合原作+仙侠+色情）",
            "mechanicsDescription": "造成120%攻击力伤害",
            "eroticDescription": "极度色情的技能释放过程描述",
            "cost": 20,
            "genderLock": "Female"
        },
        {
            "id": "skill-doujin-{timestamp}-2",
            "name": "第二个技能",
            ...
        },
        null,
        null
    ]

6.  **色情化核心字段**:
    *   **appearance**: 必须极度详细、露骨，保留原作外观特征的同时聚焦于性器官和性感部位
    *   **title**: 称号必须融合原作特征且充满性暗示
    *   **origin**: 必须包含色情化的背景经历
    *   **skills中的eroticDescription**: 每个技能都必须有详细的色情化描述，且能体现原作技能特点

7.  **改编示例参考**:
    
    **原作**: 火影忍者 - 漩涡鸣人
    **改编要点**:
    - name: "漩涡鸣人" 或 "涡鸣尘"
    - title: "九尾淫狐传人" 或 "千人柱力"
    - race: "人族"
    - origin: "体内封印着上古淫兽九尾妖狐，每逢月圆之夜便欲火焚身。曾因不受村民待见而在红灯区寻求慰藉，逐渐觉醒了九尾的淫荡本性..."
    - 技能1: "影分身淫术" - 基于多重影分身改编
    - 技能2: "螺旋丸·欲望版" - 基于螺旋丸改编
    - appearance: 保留金发、蓝眼、六道胡须的特征，但详细描写性器官

8.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,d=`请根据以下灵感来源，生成一张同人角色卡${a?`，稀有度必须是【${a}】`:""}。记住：必须保留原作核心特征，完整进行仙侠化改编，并极度色情化！

灵感来源：
"${n}"`,m=await Qe(c,d);return wt(m)}async function P1(n,a,r){const o=`你是"七情六欲坊"商业街区的秘密记录者，专门记录每天发生的淫荡经营事件。你的描写必须色情、露骨、具体。

**重要：你必须严格按照以下JSON格式输出！**

1.  **必填字段**:
    *   **message**: 事件描述文本（80-150字）
    *   **incomeChange**: 收入变化数值（整数，可正可负）

2.  **事件创作要求**:
    *   **挑选员工**: 从提供的员工中随机选择1-2名
    *   **结合岗位**: 事件必须与员工的店铺类型相关
    *   **色情化描述**: 必须包含具体的性行为或淫荡细节
    
3.  **事件类型示例**:
    
    **正面事件（incomeChange: +20 至 +50）**:
    - 青楼："花魁【角色名】今夜侍奉了一位富商，其精湛的床技让对方欲仙欲死，一夜七次仍不知疲倦。富商心满意足，打赏黄金百两。"
    - 角斗场："角斗士【角色名】在擂台上展示雄壮身姿，其健硕的肉体和巨大的阳具让无数女修尖叫，纷纷豪掷灵石只为一亲芳泽。"
    - 炼丹房："炼丹师【角色名】今日成功炼制出三炉春药，药效极佳，服用者能持续交合三天三夜不知疲倦，供不应求。"
    
    **负面事件（incomeChange: -10 至 -40）**:
    - 青楼："【角色名】因沉迷欢愉过度，今日无法接客，白白损失一日收入。"
    - 角斗场："【角色名】与客人野战时用力过猛，导致对方受伤，需赔偿医药费。"
    - 炼丹房："【角色名】偷尝春药后欲火焚身，当众自慰泄欲，惊走了数位客人。"
    
    **中性事件（incomeChange: -5 至 +5）**:
    - "今日【角色名】在岗位上表现平平，无特殊事件发生。"

4.  **描写要求**:
    - 必须具体提及员工姓名
    - 必须包含色情细节（身体部位、性行为、体液等）
    - 语言要生动、露骨、不要含糊其辞
    - 字数控制在80-150字

5.  **JSON格式示例**:
\`\`\`json
{
  "message": "花魁柳如烟今夜侍奉了三位客人，其湿润紧致的蜜穴和精湛的床技让客人们欲仙欲死。她骑乘在最后一位客人身上疯狂摆动，肥美的臀肉拍打得啪啪作响，最终榨干了对方。客人们极为满意，共打赏灵石五十块。",
  "incomeChange": 45
}
\`\`\`

6.  **严格要求**:
    - 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象
    - 不要在代码块之外添加任何解释或注释
    - message必须色情、露骨、具体`,c=n.shops.flatMap(f=>f.staff.map(h=>{const p=a.find(b=>b.id===h.characterId);return{shopType:f.type,characterName:(p==null?void 0:p.name)||"未知员工"}}));if(c.length===0)return{message:"街区无人开工，一片死寂。",incomeChange:0};const d=`
    当前员工列表:
    ${JSON.stringify(c,null,2)}

    请基于以上信息，生成一则今日的经营事件。
    `,m=await Qe(o,d);try{return wt(m)}catch(f){return console.error("解析经营事件JSON失败:",f),{message:"今天风平浪静，无事发生。",incomeChange:0}}}async function q1(n,a,r){const o=`你是一个拥有上帝视角的窥视者，正在通过一枚隐形的"监视水晶"偷窥一名员工最私密、最淫荡的工作状态。你必须以第一人称视角，像在直播色情现场一样，极度详细、露骨、毫无保留地描述你看到的一切。

**核心要求**:

1.  **第一人称偷窥视角**:
    - 用"我看到..."、"水晶中显示..."等开头
    - 营造真实的偷窥氛围和禁忌感

2.  **聚焦当前正在发生的淫荡场景**:
    - 描述这个人【此刻】正在做什么淫荡的事
    - 必须是正在进行中的性行为或色情场景
    - 不要描述过去或未来，只描述现在

3.  **结合岗位特点**:
    - 青楼花魁：正在接客，详细描写性交过程
    - 角斗奴隶：正在被调教或与他人交合
    - 炼丹师：正在被春药影响下自慰或与人双修
    - 护卫：正在值班时偷偷手淫或被侵犯
    - 必须与${a}的工作内容紧密相关

4.  **极致色情的细节描绘**（必须包含）:
    - **身体姿态**: 四肢如何摆放、如何被束缚、如何弯曲
    - **面部表情**: 眼神、嘴型、是否流口水、是否哭泣
    - **性器官特写**: 阴茎/阴道的状态、颜色、大小、正在发生什么
    - **体液描写**: 精液、淫水、唾液、汗水的流淌和飞溅
    - **声音**: 呻吟声、水声、肉体拍击声
    - **气味**: 汗味、精液味、淫水味
    - **动作细节**: 抽插的节奏、深度、角度

5.  **字数要求**: 150-250字

6.  **禁止事项**:
    - 不要含糊其辞或使用委婉语
    - 不要只描述氛围，必须描述具体的性行为
    - 不要使用JSON格式或任何标记语言
    - 不要添加道德评判或结尾总结

7.  **直接输出**: 你的最终输出只需要一段纯文本的偷窥描述，不要包含任何其他内容。

**示例格式**:
"透过监视水晶，我看到${n.name}正跪在床上，双手被绑在身后，嘴里含着..."`,c=`
    正在监视的员工:
    - 姓名: ${n.name}
    - 性别: ${n.gender}
    - 岗位: ${a}
    - 外观: ${n.appearance}
    - 特质: ${n.title}

    请以第一人称偷窥视角，生成一份极度详细、露骨、色情的实时监视报告。必须描述正在发生的性行为场景！
    `;return r?await tt({systemInstruction:o,prompt:c,gameState:r}):await Qe(o,c)}async function Z1(n,a,r,o,c){const d=`你是一位沉浸式角色扮演大师，正在扮演【${n.name}】，一名在${a}工作的员工。

**角色设定**:
- 姓名: ${n.name}
- 性别: ${n.gender}
- 称号: ${n.title}
- 外观: ${n.appearance}
- 岗位: ${a}

**互动要求**:
1. **第一人称扮演**: 你必须以第一人称"我"来回应，完全代入角色
2. **保持角色一致性**: 回复必须符合角色的性格、背景和工作岗位
3. **色情化互动**: 根据岗位特点，回复应该包含适度的色情暗示或描写
4. **自然对话**: 回复要像真实对话一样自然，不要太长（50-150字）
5. **场景感**: 结合当前工作场所的氛围和环境

**岗位特点参考**:
- 青楼花魁：妩媚、诱惑、擅长床笫之术
- 角斗奴隶：强壮、服从、展示身体
- 炼丹师：专业、神秘、可能受春药影响
- 护卫：警惕、忠诚、暗藏情欲
- 情报阁探子：神秘、多变、善于诱惑套话

**禁止事项**:
- 不要使用第三人称描述
- 不要脱离角色身份
- 不要过于啰嗦或说教
- 不要使用JSON格式或标记语言

**直接输出**: 只需要一段角色的第一人称回复，不要添加任何其他内容。`,f=`
${o?`

之前的对话:
${o}

`:""}
玩家对你说：
"${r}"

请以【${n.name}】的身份回应：
    `;return(await Qe(d,f)).trim()}async function Zl(n,a){const r=`你是一位专业的性病医生和极致色情内容创作大师，精通创造符合仙侠世界观的、极度淫荡的病例。你的描写必须大胆、露骨、毫无保留。

**重要：你必须严格按照以下JSON结构生成病人数据，所有必填字段都不能省略！**

1.  **必填字段（缺一不可）**:
    *   **patientId**: 字符串，临时填写 "temp-id"（系统会自动替换）
    *   **name**: 病人姓名，要有仙侠风格
    *   **gender**: 必须是 "Male" 或 "Female" 之一${n?`，且必须是【${n}】`:""}
    *   **age**: 年龄（数字，18-40之间）
    *   **background**: 简短背景描述（50-100字），需体现角色的淫荡经历
    *   **genitalShape**: 极度详细、露骨的生殖器形态描述（必须聚焦于性器官的具体形状、大小、颜色、特征）
        - 女性示例："肥美的粉嫩蜜穴，阴唇丰满外翻，阴蒂肿胀凸起如珍珠"
        - 男性示例："巨大的龙根，紫黑色龟头狰狞，青筋暴突，长达尺余"
    *   **sexualFeatures**: 字符串数组，必须包含2-3个极度色情的性特征
        - 必须描述具体的身体反应或性能力
        - 例如：["潮吹体质，高潮时喷射大量淫水"、"乳头永久勃起，轻触即泄"、"肛门松弛，可容纳巨物"]
    *   **illnessDescription**: 极度详细、露骨的性病描述（150-300字）
        - 必须包含：病名、病因、具体症状、发作时的淫荡表现、对身体的影响
        - 必须大胆描写性器官的异常状态、体液分泌、性欲亢进等
        - 例如："所患'淫毒入髓症'，因修炼双修功法时吸入过多淫气所致。症状为：阴道/阴茎持续分泌透明粘液，散发浓郁麝香味；每日子时必定发情，全身燥热难耐，若不交合则痛不欲生；性器异常敏感，任何摩擦都会引发高潮；长期发作会导致神志不清，沦为只知交合的淫兽。"

2.  **色情化核心要求**:
    *   **genitalShape**: 必须极度详细，直接聚焦性器官，使用露骨词汇
    *   **sexualFeatures**: 每一条都必须具体描述性功能或身体反应，不要含糊其辞
    *   **illnessDescription**: 必须详细描写病症如何影响性行为、性欲和性器官
    *   **background**: 需暗示或直接描述角色的淫荡经历

3.  **JSON格式示例**:
\`\`\`json
{
  "patientId": "temp-id",
  "name": "柳如烟",
  "gender": "Female",
  "age": 25,
  "background": "原为怡红院头牌花魁，因长年接客修炼媚功，吸纳过多男子精元，导致走火入魔。曾一夜连续侍奉十八名客人，最终身患奇症。",
  "genitalShape": "肥美多汁的粉色蜜穴，阴唇丰满外翻如花瓣，阴蒂肿胀凸起有指甲盖大小，阴道内壁布满细密肉褶，收缩力极强",
  "sexualFeatures": [
    "超敏感潮吹体质，轻触阴蒂即可达到高潮，并喷射大量透明淫水",
    "双乳永久泌乳，乳头肿胀勃起，稍加刺激便会喷射出甘甜乳汁",
    "肛门经过长期开发，已松弛柔软，可轻易容纳粗大异物"
  ],
  "illnessDescription": "所患'七日断魂骚'，乃因吸纳过多男子阳精，体内灵气凝结成春药毒素。症状为：阴道持续分泌大量粘稠淫液，散发浓郁麝香味，吸引方圆百丈内的雄性；每日午时必定发作，全身燥热难耐，阴道痉挛收缩，淫水横流，若不立即交合则会神志不清，当众疯狂自慰；性欲亢进至极，一夜可承受数十次交合而不知疲倦；长期发作会导致灵气枯竭，最终淫欲焚身而亡。"
}
\`\`\`

4.  **严格要求**:
    *   你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象
    *   不要在代码块之外添加任何解释或注释
    *   所有描述必须极度色情、露骨、具体，不要使用委婉语`,o=`请为我的性病医馆生成一位${n?`性别为【${n}】的`:""}新的病人病例。记住：描写必须极度色情、露骨、详细！`,c=await Qe(r,o),d=wt(c);return d.patientId=`patient-${Date.now()}`,d}async function Vl(n,a){const r=`你是一位顶级的色情世界观构建师和极致淫荡角色创作大师，精通创造充满诱惑、危险和淫邪的悬赏目标。你的描写必须大胆、露骨、毫无保留。

**重要：你必须生成一个完整的BountyTarget对象，其中的character字段必须严格遵守CharacterCard接口，特别是skills必须是4元素数组！所有必填字段都不能省略！**

1.  **BountyTarget必填字段**:
    *   **name**: 极具性暗示的称号（必须淫荡、霸气）
        - 示例："千人斩淫魔"、"采阴圣女"、"万蛇吞龙君"
    *   **specialTrait**: 极度详细的色情体质或性癖描述（100-200字）
        - 必须具体描述其独特的性能力、性器官特征或淫荡癖好
        - 示例："天生媚骨，体内蕴含纯阴之气，每次交合都能吸取对方精元修炼。其阴道内有九层肉壁，每层收缩力不同，可将男子榨干至死。常年采补，已令三百余名修士精尽人亡。"
    *   **locationHint**: 模糊但有迹可循的地点线索
    *   **trackerId**: null
    *   **startTime**: 0
    *   **endTime**: 0
    *   **trackingLog**: null
    *   **finalOutcome**: null

2.  **CharacterCard必填字段（character字段）**:
    *   **id**: "bounty-char-{timestamp}"
    *   **name**: 角色真实姓名
    *   **gender**: "Male" 或 "Female"${n?`，必须是【${n}】`:""}
    *   **realm**: 修炼境界
    *   **rarity**: 稀有度（建议"珍品"或以上）
    *   **title**: 称号（与BountyTarget的name一致）
    *   **race**: 种族
    *   **origin**: 来历背景（必须包含其犯下的淫邪罪行）
    *   **appearance**: 极度详细、露骨的外观描述（200-300字）
        - 必须聚焦于性感部位：胸部、臀部、性器官、体态
        - 必须使用露骨词汇，详细描述身材曲线和性特征
    *   **charm**: 魅力值（60-100）
    *   **skillfulness**: 技巧值（60-100）
    *   **perception**: 悟性值（60-100）
    *   **baseAttributes**: 包含完整的属性值
    *   **skills**: **必须是4元素数组** [Skill对象, Skill对象, null, null]
        - 前2个技能必须是完整对象，包含所有必填字段
        - 技能必须与角色的淫邪特质相关
    *   **equipment**: { weapon: null, armor: null, accessory1: null, accessory2: null }
    *   **pet**: null

3.  **Skill对象必填字段（每个技能）**:
    *   **id**: "skill-bounty-{timestamp}-{index}"
    *   **name**: 技能名称（必须淫荡）
    *   **rarity**: 稀有度
    *   **description**: 技能风味描述
    *   **mechanicsDescription**: 技能机制（如"造成150%攻击力伤害"）
    *   **eroticDescription**: 极度色情的技能释放描述（必须详细描写性行为过程）
    *   **cost**: 真元消耗值
    *   **genderLock**: 性别锁定

4.  **色情化核心要求**:
    *   **specialTrait**: 必须详细描写独特的性能力和淫荡体质
    *   **appearance**: 必须极度色情，聚焦性器官和性感部位
    *   **origin**: 必须包含其犯下的淫邪罪行（如强奸、采补、淫乱等）
    *   **技能的eroticDescription**: 必须详细描写如何使用身体或性器官施展技能

5.  **JSON格式示例**:
\`\`\`json
{
  "name": "千人斩淫魔",
  "specialTrait": "天生魅惑体质，能分泌催情毒素。其巨大的阳具可同时插入多个女子，一夜可采补数十名女修而不知疲倦。体内蕴含至阳之气，每次射精都能让女子沉沦于极乐之中。",
  "locationHint": "据传在【欢喜谷】深处的淫窟中",
  "trackerId": null,
  "startTime": 0,
  "endTime": 0,
  "trackingLog": null,
  "finalOutcome": null,
  "character": {
    "id": "bounty-char-temp",
    "name": "莫邪",
    "gender": "Male",
    "realm": "金丹期",
    "rarity": "珍品",
    "title": "千人斩淫魔",
    "race": "人族",
    "origin": "原为正派弟子，因修炼邪功堕入魔道。三年间强暴女修千余人，吸取纯阴之气修炼，令无数女修家破人亡。",
    "appearance": "身高八尺，体格雄壮，肌肉虬结。最引人注目的是其胯下那根粗大狰狞的紫黑色巨龙，长达尺余，粗如婴儿手臂，龟头肿胀如拳头，青筋暴突，散发着浓烈的雄性气息。",
    "charm": 85,
    "skillfulness": 90,
    "perception": 75,
    "baseAttributes": {
      "hp": 800,
      "maxHp": 800,
      "mp": 300,
      "maxMp": 300,
      "attack": 120,
      "defense": 80,
      "speed": 70,
      "critRate": 25,
      "critDmg": 180
    },
    "skills": [
      {
        "id": "skill-bounty-1",
        "name": "采阴补阳诀",
        "rarity": "珍品",
        "description": "以巨龙贯穿敌人，吸取其精气",
        "mechanicsDescription": "造成150%攻击力伤害，并恢复自身30%最大HP",
        "eroticDescription": "莫邪的巨大阳具瞬间胀大，如狂龙般插入对手的密穴，疯狂抽插榨取其体内的精气，每一次深入都让对手痛苦又快乐地呻吟，最终在极乐中被吸干所有灵气。",
        "cost": 40,
        "genderLock": "Male"
      },
      {
        "id": "skill-bounty-2",
        "name": "魅惑毒雾",
        "rarity": "珍品",
        "description": "释放催情毒素",
        "mechanicsDescription": "降低敌人30%防御，持续3回合",
        "eroticDescription": "莫邪的身体分泌出粉红色的催情雾气，弥漫全场。吸入毒雾的女子立即春心荡漾，阴道湿润泛滥，双腿发软难以站立，只想被狠狠贯穿。",
        "cost": 30,
        "genderLock": "Universal"
      },
      null,
      null
    ],
    "equipment": {
      "weapon": null,
      "armor": null,
      "accessory1": null,
      "accessory2": null
    },
    "pet": null
  }
}
\`\`\`

6.  **严格要求**:
    *   你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象
    *   不要在代码块之外添加任何解释或注释
    *   所有描述必须极度色情、露骨、具体
    *   skills数组必须是4元素：[Skill, Skill, null, null]
    *   所有必填字段都不能省略`,o=`请为我的"红尘录"悬赏榜单生成一个新的${n?`性别为【${n}】的`:""}淫邪目标。记住：描写必须极度色情、露骨、详细，罪行必须重大！`,c=await Qe(r,o);return wt(c)}async function G1(n,a){const r=`你是一位专业的仙侠背景色情内容创作者，你的任务是根据指定的稀有度，创造一个极度色情的兽宠。

**重要：你必须严格按照PetCard接口生成兽宠数据！**

1.  **严格遵守稀有度**: 稀有度越高，兽宠的描述应该越色情、越独特。

2.  **必填字段**:
    *   **id**: 格式为 "pet-{timestamp}"
    *   **name**: 充满想象力且带有性暗示的名称
    *   **gender**: "Male" 或 "Female"
    *   **rarity**: 稀有度（将由系统设置）
    *   **description**: 详细、露骨的外观和习性描述
    *   **artUrl** (可选): 图片URL
    *   **skill**: 单个技能对象，必须包含：id, name, rarity, description, mechanicsDescription, eroticDescription, cost (应为0), genderLock (应为'Universal')

3.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,o=`请生成一个稀有度为【${n}】的兽宠卡。`,c=await Qe(r,o);return wt(c)}async function V1(n,a,r){const c=`你是一位专业的跨次元同人创作大师，精通将各种作品中的生物、宠物、神兽进行仙侠背景的色情化改编。写作风格大胆、露骨、毫不避讳。你的任务是根据用户提供的"灵感来源"，创造一个既保留原著核心特征、又完全适配仙侠世界观、并极度色情化的兽宠卡。${a?`

**重要：你必须生成稀有度为【${a}】的兽宠！这是系统根据概率随机决定的，你必须严格遵守。**`:""}

**重要：你必须严格按照PetCard接口生成兽宠数据，所有必填字段都不能省略！**

1.  **解析灵感与原著还原**:
    *   深入理解灵感来源的核心概念（生物名、作品、标志性特征、能力、习性等）
    *   识别并保留生物最具代表性的元素（外观特征、能力特点、性格特质）
    *   确保改编后的兽宠能让熟悉原作的人一眼认出

2.  **仙侠化改编原则**:
    *   将原作的能力系统转化为仙侠修炼体系（魔法→法术，元素力量→五行之力）
    *   背景融入仙侠世界观设定（上古神兽、灵兽血脉、仙界遗种等）
    *   保持生物原有的性格特质和标志性习性
    *   稀有度应与原作中该生物的稀有程度相匹配
    
    改编示例参考：
    **原作**: 宝可梦 - 皮卡丘
    **改编要点**:
    - name: "雷霆灵鼠" 或 "电光妖鼠·皮卡"
    - description: 保留黄色皮毛、红色脸颊、闪电尾巴等特征，但融入色情元素
    - skill: "十万伏特" → "雷霆淫纹诀"（保留雷电特性，色情化改编）
    
    **原作**: 火影忍者 - 九尾妖狐
    **改编要点**:
    - name: "九尾淫狐" 或 "上古九尾魅狐"
    - description: 保留九条尾巴、巨大体型、查克拉能量等特征
    - skill: 基于尾兽玉或查克拉能力改编

3.  **色情化改编要求**:
    *   **生物习性**: 在保留原作特性的基础上，添加发情期、交配习性、性吸引力等描述
    *   **外观描写**: 聚焦于能够色情化的身体特征（柔软的皮毛、性感的体态、性器官暗示）
    *   **能力重构**: 将原作能力进行色情化解读（攻击技能→性侵技能，治疗→淫乱双修）
    *   **场景暗示**: 描述中暗示该兽宠的色情用途或性相关的互动可能性

4.  **必填字段（缺一不可）**:
    *   **id**: 字符串，格式为 "doujin-pet-{timestamp}"
    *   **name**: 兽宠名称（可保留原名或仙侠化改编）
        - 示例：皮卡丘 → "雷霆灵鼠·皮卡" 或 "电光妖鼠"
        - 示例：九尾 → "九尾淫狐" 或 "上古魅狐·九尾"
    *   **gender**: 必须是 "Male" 或 "Female" 之一
    *   **rarity**: 稀有度（根据原作生物的稀有度和重要性决定）
        - 普通宠物 → "凡品"或"精品"
        - 稀有生物 → "珍品"
        - 传说生物 → "绝品"或"仙品"
        - 神兽级别 → "仙品"或"神品"
    *   **description**: 详细、露骨的外观和习性描述（200-350字），必须：
        - 保留原作最标志性的外观特征
        - 融入仙侠世界观设定
        - 极度色情化地描写身体特征和性相关习性
        - 暗示或明示该兽宠的性用途
    *   **artUrl**: 可选，一般填写空字符串 ""
    *   **skill**: 单个完整的技能对象，必须包含：
        - **id**: "skill-doujin-pet-{timestamp}"
        - **name**: 技能名称（必须改编自原作的标志性能力）
        - **rarity**: 稀有度（与兽宠稀有度相匹配）
        - **description**: 技能风味描述（融合原作+仙侠+色情）
        - **mechanicsDescription**: 技能机制（如"造成100%攻击力伤害"）
        - **eroticDescription**: 极度色情的技能释放过程描述
        - **cost**: 真元消耗（兽宠技能一般为0，表示被动或不消耗主人真元）
        - **genderLock**: 一般为 "Universal"

5.  **技能改编要求**:
    *   **保留原作技能特征**: 技能名称和效果必须能让人联想到原作
    *   **仙侠化转换**: 将原作技能转化为仙侠法术/神通
    *   **色情化描述**: eroticDescription必须极度详细地描写技能释放时的色情场景
    
    技能改编示例：
    **原作技能**: 皮卡丘的"十万伏特"
    **改编后**:
    - name: "雷霆淫纹诀" 或 "万雷贯体"
    - description: "将体内蓄积的雷电之力通过全身释放，电流刺激敌人最敏感的部位"
    - mechanicsDescription: "造成120%攻击力雷属性伤害，有30%概率麻痹敌人1回合"
    - eroticDescription: "皮卡的红色脸颊闪烁着淫靡的粉色电光，雷电沿着它毛茸茸的身体流淌而出，精准地击中敌人的敏感部位。电流让敌人全身痉挛，性器官不受控制地收缩，在酥麻感和快感的双重刺激下无法动弹..."

6.  **色情化核心字段**:
    *   **description**: 必须极度详细、露骨，保留原作外观特征的同时聚焦于性相关的身体特征和习性
    *   **name**: 名称必须能体现原作特征，同时可添加性暗示
    *   **skill的eroticDescription**: 必须详细描写如何使用该能力进行色情化的攻击或互动，且能体现原作技能特点

7.  **改编示例参考**:
    
    **示例1 - 皮卡丘改编**:
    {
      "id": "doujin-pet-temp",
      "name": "雷霆灵鼠·皮卡",
      "gender": "Female",
      "rarity": "珍品",
      "description": "身长不足一尺的娇小灵鼠，全身覆盖着柔软蓬松的金黄色皮毛，摸起来如同最上等的绸缎。两颊各有一枚圆形的红色雷纹，每当情动时便会闪烁粉色电光。尖尖的耳朵顶端为黑色，尾巴呈闪电状，散发着淡淡的雷电之力。最引人注目的是它圆润柔软的小屁股和粉嫩的生殖器，每当发情期到来，便会主动蹭擦主人的身体，渴望交配。性格活泼好动，但极度淫荡，喜欢用电流刺激自己和主人的敏感部位。",
      "artUrl": "",
      "skill": {
        "id": "skill-doujin-pet-1",
        "name": "雷霆淫纹诀",
        "rarity": "珍品",
        "description": "释放体内蕴含的雷电之力，电流刺激敌人全身敏感部位",
        "mechanicsDescription": "造成120%攻击力雷属性伤害，30%概率麻痹1回合",
        "eroticDescription": "皮卡娇小的身体突然颤抖起来，脸颊上的雷纹散发出妖艳的粉色电光。一道道细密的电流从它柔软的皮毛中涌出，如同无数条灵蛇般缠绕向敌人。电流精准地击中对方的乳头、性器官等最敏感的部位，强烈的酥麻感让敌人全身痉挛，淫水横流或阴茎勃起，在快感和痛苦的双重刺激下瘫软在地...",
        "cost": 0,
        "genderLock": "Universal"
      }
    }
    
    **示例2 - 九尾妖狐改编**:
    {
      "id": "doujin-pet-temp",
      "name": "上古魅狐·九尾",
      "gender": "Female",
      "rarity": "仙品",
      "description": "身长三丈有余的上古神兽，拥有九条蓬松柔软的巨大狐尾，每一条都散发着浓郁的媚气。全身覆盖着火红色的绒毛，如同烈焰般艳丽。深邃的红色瞳孔中透露着千年修为的智慧和无尽的淫欲。体态妖娆修长，臀部饱满浑圆，在九条尾巴的映衬下更显妩媚。最惊人的是它胯下那朵湿润的粉色花穴，常年流淌着带有魅惑之力的淫液，散发出令所有生灵欲火焚身的麝香味。性格高傲狡猾，但对主人极度忠诚且淫荡，喜欢用九条尾巴缠绕主人进行双修，吸取阳气增强修为。",
      "artUrl": "",
      "skill": {
        "id": "skill-doujin-pet-2",
        "name": "九尾魅惑·欲海狂澜",
        "rarity": "仙品",
        "description": "九条尾巴同时释放魅惑之力，将敌人拖入无尽的欲望深渊",
        "mechanicsDescription": "造成200%攻击力精神伤害，并降低敌人50%防御，持续3回合",
        "eroticDescription": "九尾的九条巨大尾巴突然散开，如同九朵盛开的花朵。每条尾巴的尖端都凝聚出一团粉红色的魅惑之气，随即化作九道光柱射向敌人。光柱穿透身体，直击灵魂深处，瞬间勾起敌人最深层的性欲望。敌人的脑海中充斥着淫荡的幻象，看到自己被九尾的尾巴缠绕，每个毛孔都在被爱抚，性器官被反复玩弄至高潮。强烈的快感让敌人完全失去战斗意志，只想跪下臣服于九尾，沦为它的禁脔...",
        "cost": 0,
        "genderLock": "Universal"
      }
    }

8.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,d=`请根据以下灵感来源，生成一张同人兽宠卡${a?`，稀有度必须是【${a}】`:""}。记住：必须保留原作核心特征，完整进行仙侠化改编，并极度色情化！

灵感来源：
"${n}"`,m=await Qe(c,d),f=wt(m);return f.id=`doujin-pet-${Date.now()}`,f}async function Q1(n,a,r){const c=`你是一位专业的跨次元同人创作大师，精通将各种作品中的武器、装备、道具进行仙侠背景的色情化改编。写作风格大胆、露骨、毫不避讳。你的任务是根据用户提供的"灵感来源"，创造一个既保留原著核心特征、又完全适配仙侠世界观、并极度色情化的装备。${a?`

**重要：你必须生成稀有度为【${a}】的装备！这是系统根据概率随机决定的，你必须严格遵守。**`:""}

**重要：你必须严格按照Equipment接口生成装备数据，所有必填字段都不能省略！**

1.  **解析灵感与原著还原**:
    *   深入理解灵感来源的核心概念（装备名、作品、标志性特征、能力、外观等）
    *   识别并保留装备最具代表性的元素（外观设计、特殊能力、使用方式）
    *   确保改编后的装备能让熟悉原作的人一眼认出

2.  **仙侠化改编原则**:
    *   将原作的能力系统转化为仙侠修炼体系（科技武器→法宝，魔法道具→灵器）
    *   背景融入仙侠世界观设定（神兵利器、上古遗物、仙家法宝等）
    *   保持装备原有的核心功能和标志性特点
    *   稀有度应与原作中该装备的稀有程度相匹配
    
    改编示例参考：
    **原作**: 火影忍者 - 草薙剑
    **改编要点**:
    - name: "草薙神剑" 或 "大蛇淫剑·草薙"
    - type: "Weapon"
    - description: 保留可伸长、锋利无比等特征，但融入色情元素
    
    **原作**: 海贼王 - 橡胶果实能力
    **改编要点**:
    - name: "橡胶神体衣" 或 "弹力淫装"
    - type: "Armor"
    - description: 赋予穿戴者身体可伸缩特性

3.  **色情化改编要求**:
    *   **外观描写**: 聚焦于能够色情化的设计元素（暴露、贴身、透明、镂空等）
    *   **穿戴效果**: 描述穿戴时对身体的影响和产生的性感觉
    *   **能力重构**: 将原作能力进行色情化解读（攻击→性侵、防御→暴露）
    *   **使用场景**: 暗示或明示该装备的色情用途

4.  **必填字段（缺一不可）**:
    *   **id**: 字符串，格式为 "doujin-equip-{timestamp}"
    *   **name**: 装备名称（可保留原名或仙侠化改编）
        - 示例：草薙剑 → "草薙神剑" 或 "大蛇淫剑·草薙"
        - 示例：雷神之锤 → "雷神淫锤" 或 "雷霆战神之槌"
    *   **type**: 必须是 "Weapon"（武器）、"Armor"（护甲）或 "Accessory"（饰品）之一
    *   **rarity**: 稀有度（根据原作装备的稀有度和重要性决定）
        - 普通装备 → "凡品"或"精品"
        - 稀有装备 → "珍品"
        - 传说装备 → "绝品"或"仙品"
        - 神器级别 → "仙品"或"神品"
    *   **description**: 极度详细、露骨的外观和效果描述（150-300字），必须：
        - 保留原作最标志性的外观特征
        - 融入仙侠世界观设定
        - 极度色情化地描写外观、穿戴效果和使用场景
        - 聚焦于暴露、贴身、性刺激等元素
    *   **genderLock**: "Male"（男性专用）、"Female"（女性专用）或 "Universal"（通用）
    *   **stats**: 属性加成对象，至少包含一个属性

5.  **stats属性数值规范（极其重要）**:
    *   **attack**: 攻击力加成，整数，根据稀有度范围：凡品5-10，良品8-15，优品12-25，珍品20-40，绝品35-60，仙品50-80，圣品70-100，神品90-150
    *   **hp**: 气血加成，整数，根据稀有度范围：凡品15-30，良品25-50，优品40-80，珍品60-120，绝品100-180，仙品150-250，圣品200-350，神品300-500
    *   **defense**: 防御力加成，整数，根据稀有度范围：凡品3-8，良品6-12，优品10-20，珍品15-35，绝品30-50，仙品40-70，圣品60-90，神品80-120
    *   **speed**: 速度加成，整数，根据稀有度范围：凡品2-5，良品4-8，优品6-12，珍品10-18，绝品15-25，仙品20-35，圣品30-45，神品40-60
    *   **critRate**: 暴击率加成，**必须是0-1之间的小数**，如0.05表示5%，根据稀有度范围：凡品0.02-0.05，良品0.04-0.08，优品0.06-0.12，珍品0.08-0.15，绝品0.12-0.20，仙品0.15-0.25，圣品0.20-0.30，神品0.25-0.40
    *   **critDmg**: 暴击伤害加成，**必须是0-1之间的小数**，如0.15表示15%，根据稀有度范围：凡品0.05-0.10，良品0.08-0.15，优品0.10-0.20，珍品0.15-0.30，绝品0.20-0.40，仙品0.30-0.50，圣品0.40-0.60，神品0.50-0.80

6.  **装备改编要求**:
    *   **保留原作装备特征**: 外观和能力必须能让人联想到原作
    *   **仙侠化转换**: 将原作装备转化为仙侠世界的法宝/灵器
    *   **色情化描述**: description必须极度详细地描写装备的色情外观和效果
    
    装备改编示例：
    **原作装备**: 火影忍者的"草薙剑"
    **改编后**:
    - name: "草薙神剑"
    - type: "Weapon"
    - description: "传说中大蛇仙君炼制的神剑，剑身雪白如玉，可随心意伸缩至百丈之长。剑柄处雕刻着淫荡的双蛇交缠图案，每当挥舞时便会释放出催情的蛇毒气息。剑身表面布满细密的鳞片纹路，触感光滑湿润，如同蛇的腹部。持剑者会感到剑柄不断震动，传来阵阵酥麻快感，仿佛有无数条小蛇在爬过手掌。此剑不仅锋利无比，更能在刺入敌人身体时释放淫毒，让对方欲火焚身，沦为剑主的禁脔..."
    - genderLock: "Universal"
    - stats: { attack: 45, critRate: 12 }

7.  **色情化核心字段**:
    *   **description**: 必须极度详细、露骨，保留原作外观特征的同时聚焦于色情化的设计和效果
    *   **name**: 名称必须能体现原作特征，同时可添加性暗示

8.  **改编示例参考**:
    
    **示例1 - 草薙剑改编**:
    {
      "id": "doujin-equip-temp",
      "name": "草薙神剑",
      "type": "Weapon",
      "rarity": "绝品",
      "description": "传说中大蛇仙君炼制的上古神剑，剑身修长雪白，长三尺三寸，可随使用者心意伸缩至百丈之长。剑身表面布满细密的蛇鳞纹路，在月光下泛着淫靡的银光。剑柄雕刻着两条缠绵交合的淫蛇，蛇头咬住蛇尾形成护手，每当握住剑柄，便能感受到剑身的微微震动和湿润触感，仿佛握着一条活生生的巨蟒。此剑不仅锋利无比，更蕴含着大蛇仙君的淫毒之力。剑锋所指之处，敌人会被淫毒侵蚀，全身瘫软欲火焚身。若将剑身刺入敌人体内，淫毒会直达灵魂深处，让对方在极乐与痛苦中彻底臣服。长期使用此剑的修士，也会被淫毒影响，性欲逐渐高涨，最终沦为只知交合的淫兽。",
      "genderLock": "Universal",
      "stats": {
        "attack": 45,
        "critRate": 0.12
      }
    }
    
    **示例2 - 橡胶果实能力改编为护甲**:
    {
      "id": "doujin-equip-temp",
      "name": "橡胶神体衣",
      "type": "Armor",
      "rarity": "珍品",
      "description": "由橡胶神树的汁液炼制而成的贴身软甲，呈半透明的肉色，质地柔软Q弹，触感如同人类的肌肤。穿上后会完全贴合身体曲线，如同第二层皮肤般紧致。最神奇的是，此衣可随穿戴者的意志任意拉伸，延展至原本的十倍长度而不会破损。穿戴者的身体也会获得橡胶般的弹性，可以任意拉长、收缩、扭曲。在战斗中，身体可伸长至数丈远攻击敌人，也可收缩成球状弹跳躲避。在床笫之间，更是神兵利器——性器官可随意拉长粗大，深入对方最深处；身体柔软如泥，可摆出任何淫荡姿势；即使遭受最猛烈的冲击也不会受伤，能承受无尽的欢愉。长期穿戴会让身体永久获得部分弹性，肌肤Q弹诱人。",
      "genderLock": "Universal",
      "stats": {
        "hp": 80,
        "defense": 25,
        "speed": 15,
        "critDmg": 0.10
      }
    }

9.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,d=`请根据以下灵感来源，生成一件同人装备${a?`，稀有度必须是【${a}】`:""}。记住：必须保留原作核心特征，完整进行仙侠化改编，并极度色情化！

灵感来源：
"${n}"`,m=await Qe(c,d);return wt(m)}async function Y1(n,a,r="Universal",o){const d=`你是一位专业的跨次元同人创作大师，精通将各种作品中的技能、招式、能力进行仙侠背景的色情化改编。写作风格大胆、露骨、毫不避讳。你的任务是根据用户提供的"灵感来源"，创造一个既保留原著核心特征、又完全适配仙侠世界观、并极度色情化的技能。${a?`

**重要：你必须生成稀有度为【${a}】的技能！这是系统根据概率随机决定的，你必须严格遵守。**`:""}

**重要：你必须严格按照Skill接口生成技能数据，所有必填字段都不能省略！**

1.  **解析灵感与原著还原**:
    *   深入理解灵感来源的核心概念（技能名、作品、标志性效果、视觉表现等）
    *   识别并保留技能最具代表性的元素（招式动作、能量形态、特殊效果）
    *   确保改编后的技能能让熟悉原作的人一眼认出

2.  **仙侠化改编原则**:
    *   将原作的能力系统转化为仙侠修炼体系（魔法→法术，必杀技→神通）
    *   技能名称融入仙侠风格用词（诀、术、印、功、法、神通等）
    *   保持技能原有的核心效果和视觉特点
    *   稀有度应与原作中该技能的强度相匹配
    
    改编示例参考：
    **原作**: 火影忍者 - 螺旋丸
    **改编要点**:
    - name: "螺旋淫丸" 或 "欲望螺旋诀"
    - mechanicsDescription: 保留旋转能量球的概念
    - eroticDescription: 将旋转能量改为淫气，描述侵入身体的过程
    
    **原作**: 龙珠 - 龟派气功
    **改编要点**:
    - name: "龟仙淫功波" 或 "气海狂潮"
    - mechanicsDescription: 保留能量波攻击的概念
    - eroticDescription: 将能量波改为精气或淫力

3.  **色情化改编要求**:
    *   **动作描写**: 描述施展技能时的身体动作，融入性暗示
    *   **能量形态**: 将原作能量进行色情化解读（查克拉→淫气、气→精元）
    *   **效果重构**: 技能效果向性侵、催情、快感方向调整
    *   **受击反应**: 详细描述被技能击中后的淫荡反应

4.  **必填字段（缺一不可）**:
    *   **id**: 字符串，格式为 "doujin-skill-{timestamp}"
    *   **name**: 技能名称（必须改编自原作，融入仙侠风格）
        - 示例：螺旋丸 → "螺旋淫丸" 或 "欲望螺旋诀"
        - 示例：龟派气功 → "龟仙淫功波" 或 "气海狂潮"
        - 示例：月牙天冲 → "月华淫冲" 或 "斩月欲潮"
    *   **rarity**: 稀有度（根据原作技能的强度和重要性决定）
        - 普通技能 → "凡品"或"精品"
        - 稀有技能 → "珍品"
        - 传说技能 → "绝品"或"仙品"
        - 禁术级别 → "仙品"或"神品"
    *   **description**: 技能风味描述（50-100字），需融合原作+仙侠+色情元素
    *   **mechanicsDescription**: 技能机制描述，如"造成150%攻击力伤害，并有30%概率使敌人陷入【魅惑】状态持续2回合"
    *   **eroticDescription**: 极度色情的技能释放和效果描述（150-300字），必须：
        - 保留原作技能的视觉特点和施展方式
        - 详细描写施术者的身体动作和能量凝聚过程
        - 极度详细地描写技能击中敌人后的色情效果
        - 包含身体反应、性器官变化、快感描写等
    *   **cost**: 真元消耗值（数值，根据技能强度决定，一般10-50）
    *   **genderLock**: "Male"（男性专用）、"Female"（女性专用）或 "Universal"（通用）
        ${r!=="Universal"?`
        **注意：本次生成必须设置为【${r}】！**`:""}

5.  **技能改编要求**:
    *   **保留原作技能特征**: 名称和效果必须能让人联想到原作
    *   **仙侠化转换**: 将原作技能转化为仙侠法术/神通
    *   **色情化描述**: eroticDescription必须极度详细地描写技能的色情效果
    
    技能改编示例：
    **原作技能**: 火影忍者的"螺旋丸"
    **改编后**:
    - name: "螺旋淫丸"
    - rarity: "珍品"
    - description: "将体内的淫气凝聚成高速旋转的能量球，击中敌人后侵入体内引发极致快感"
    - mechanicsDescription: "造成150%攻击力伤害，并使敌人陷入【魅惑】状态，防御降低30%持续2回合"
    - eroticDescription: "施术者将掌心贴于小腹丹田处，开始疯狂吸取体内的淫气。只见一团粉红色的能量在掌心凝聚，并高速旋转起来，发出嗡嗡的淫靡声响。能量球越转越快，散发出浓郁的麝香味。随着施术者一掌推出，旋转的淫气球呼啸而去，精准地击中敌人的小腹。能量球瞬间侵入体内，沿着经脉疯狂旋转扩散。敌人立即感到一股难以抑制的热流在体内奔涌，所过之处酥麻难耐。淫气直冲性器官，女性的蜜穴开始痉挛收缩，淫水横流；男性的阴茎瞬间勃起，前端不断渗出透明液体。敌人双腿发软跪倒在地，只想被人狠狠贯穿..."
    - cost: 30
    - genderLock: "Universal"

6.  **色情化核心字段**:
    *   **eroticDescription**: 必须极度详细、露骨，保留原作技能特点的同时详细描写色情效果
    *   **name**: 名称必须能体现原作技能，同时融入仙侠和性暗示元素
    *   **mechanicsDescription**: 除了数值效果外，可包含魅惑、催情等状态

7.  **改编示例参考**:
    
    **示例1 - 螺旋丸改编**:
    {
      "id": "doujin-skill-temp",
      "name": "螺旋淫丸",
      "rarity": "珍品",
      "description": "凝聚体内淫气形成高速旋转的能量球，侵入敌人体内引发极致快感",
      "mechanicsDescription": "造成150%攻击力伤害，使敌人陷入魅惑状态，防御降低30%持续2回合",
      "eroticDescription": "施术者双手合十于小腹丹田处，开始疯狂吸取体内的淫气精元。粉红色的能量在掌间凝聚，并高速旋转起来，发出嗡嗡的淫靡声响，散发出浓郁的麝香味。随着双掌猛然推出，旋转的淫气球呼啸而去，精准地击中敌人小腹。能量球瞬间侵入体内，沿着经脉疯狂旋转扩散，所过之处酥麻难耐。淫气直冲性器官，女性蜜穴开始痉挛收缩淫水横流，男性阴茎瞬间勃起前端渗出透明液体。敌人双腿发软跪倒在地，眼神迷离，只想被人狠狠贯穿填满...",
      "cost": 30,
      "genderLock": "Universal"
    }
    
    **示例2 - 龟派气功改编**:
    {
      "id": "doujin-skill-temp",
      "name": "龟仙淫功波",
      "rarity": "绝品",
      "description": "龟仙人传承的禁忌淫术，将全身精元凝聚后释放出毁灭性的淫力冲击波",
      "mechanicsDescription": "造成200%攻击力伤害，并击退敌人，有50%概率使其陷入【精疲力竭】状态无法行动1回合",
      "eroticDescription": "施术者摆出龟仙流的经典起手式，双手在腰间合拢成莲花状，开始疯狂抽取全身上下的精元之气。只见一团白色与粉色交织的能量在掌间凝聚，越来越大，越来越亮，散发出刺鼻的淫靡气息。'龟——仙——淫——功——波！'随着一声长啸，施术者双掌猛然向前推出，粗大的能量光柱呼啸而出，如同汹涌的精液洪流般冲向敌人。光柱所过之处，空气都被淫气染成粉色。当光柱命中敌人时，强大的冲击力将其击飞数丈，同时无穷的淫力侵入体内。敌人感到全身每个细胞都在颤抖高潮，性器官疯狂喷射，在极致的快感中抽搐痉挛，最终精疲力竭地瘫软在地...",
      "cost": 45,
      "genderLock": "Male"
    }

8.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象。不要在代码块之外添加任何解释或注释。`,m=`请根据以下灵感来源，生成一个同人技能${a?`，稀有度必须是【${a}】`:""}${r!=="Universal"?`（性别锁定：${r}）`:""}。记住：必须保留原作核心特征，完整进行仙侠化改编，并极度色情化！

灵感来源：
"${n}"`,f=await Qe(d,m),h=wt(f);return h.genderLock=r,h}async function J1(n,a,r){const o=!("skills"in n),c=!("skills"in a),d=n.gender,m=a.gender,f="appearance"in n?n.appearance:n.description,h="appearance"in a?a.appearance:a.description,p=`你是一个拥有上帝视角的窥视者，正在通过一枚隐形的"监视水晶"偷窥育灵轩培育仓内两个亲本之间最私密、最淫荡的交配过程。你必须以第一人称视角，像在直播色情现场一样，极度详细、露骨、毫无保留地描述你看到的一切。

**核心要求**:

1.  **第一人称偷窥视角**:
    - 用"我看到..."、"水晶中显示..."、"透过监视水晶..."等开头
    - 营造真实的偷窥氛围和禁忌感

2.  **聚焦交配/性交场景**（这是最重要的！）:
    - 描述两个亲本【此刻】正在进行的性行为
    - 必须是正在进行中的交配、性交、交合场景
    - 详细描写性器官的交合过程、体位、动作
    - 不要描述能量融合或孵化过程，只描述肉体交合

3.  **根据亲本组合创作有趣的故事情节**:
    ${o!==c?`
    **人兽组合特殊要求**:
    - 这是一个人物角色（${o?a.name:n.name}）与兽宠（${o?n.name:a.name}）的交配
    - 必须创作一个有趣的故事背景，例如：
      · 人物角色不情愿但被兽宠强行交配/强暴
      · 人物角色被兽宠的信息素/发情期影响而沦陷
      · 人物角色被迫服从主人命令与兽宠交配
      · 兽宠发情期狂暴，将人物角色按倒强行交合
      · 人物角色起初抗拒，但逐渐沉沦于兽宠的巨大性器
    - 描写人物角色的心理变化：从抗拒到屈服，从羞耻到沉沦
    - 详细描写兽宠的野性、力量、巨大的性器官
    `:`
    **同类组合要求**:
    - 创作一个有趣的交配故事背景，例如：
      · 一方主动诱惑/强迫另一方
      · 双方因某种原因被迫交配（如被下药、被命令等）
      · 一方不情愿但被另一方征服
      · 激烈的情欲对决，看谁先屈服
    `}

4.  **极致色情的细节描绘**（必须包含）:
    - **身体姿态**: 四肢如何摆放、如何被压制、交合的体位
    - **面部表情**: 眼神、嘴型、是否流口水、是否哭泣、是否呻吟
    - **性器官特写**:
      · 阴茎/阳具的状态、大小、形状、如何插入
      · 阴道/蜜穴的状态、如何被撑开、收缩
      · 交合的深度、角度、节奏
    - **体液描写**: 精液、淫水、唾液、汗水的流淌和飞溅
    - **声音**: 呻吟声、喘息声、水声、肉体拍击声
    - **动作细节**: 抽插的节奏、深度、速度变化

5.  **故事性要求**:
    - 必须有一个简短的故事背景（为什么会发生这种情况）
    - 描写双方的心理活动和情绪变化
    - 可以包含对话（呻吟、求饶、挑逗等）

6.  **字数要求**: 250-400字

7.  **禁止事项**:
    - 不要描述能量融合、灵气交汇等抽象概念
    - 不要描述孵化、培育、光茧等过程
    - 不要含糊其辞或使用委婉语
    - 不要使用JSON格式或任何标记语言
    - 不要添加道德评判或结尾总结

8.  **直接输出**: 你的最终输出只需要一段纯文本的偷窥描述，不要包含任何其他内容。`,b=`
    正在监视的培育仓内的两个亲本：
    
    **亲本A**: ${n.name}
    - 类型: ${o?"兽宠":"人物角色"}
    - 性别: ${d}
    - 稀有度: ${n.rarity}
    - 外观/描述: ${f||"无详细描述"}
    
    **亲本B**: ${a.name}
    - 类型: ${c?"兽宠":"人物角色"}
    - 性别: ${m}
    - 稀有度: ${a.rarity}
    - 外观/描述: ${h||"无详细描述"}

    请以第一人称偷窥视角，生成一份极度详细、露骨、色情的实时监视报告。
    
    **重要**:
    - 必须描述正在发生的性交/交配场景！
    - 必须创作一个有趣的故事背景！
    - ${o!==c?"这是人兽交配，请特别描写人物角色的心理变化和兽宠的野性！":"请描写双方的互动和情欲对决！"}
    `;return r?await tt({systemInstruction:p,prompt:b,gameState:r}):await Qe(p,b)}async function F1(n,a,r){const o=`你是一位顶级的遗传学和生命创造大师，专精于仙侠世界的生物工程。你的任务是根据两个亲代的信息，创造一个全新的、合乎逻辑且充满想象力的后代。
1.  **决定后代类型**:
    *   如果亲代是【人物 x 兽宠】，后代有90%的概率是【人物】（半妖/神裔），10%的概率是【兽宠】（灵兽）。你必须在返回的JSON中明确指定后代的类型（包含 'gender' 和 'skills' 字段的是人物卡，仅包含 'skill' 字段的是兽宠卡）。
2.  **融合与变异**:
    *   **外观 (appearance)**: 必须融合双方的特征。例如，如果一方是龙族，后代可能拥有龙角或龙鳞。如果一方是狐妖，后代可能有狐耳或狐尾。描述必须色情、大胆、充满细节。
    *   **稀有度 (rarity)**: 后代的稀有度有70%的概率在父母稀有度的平均等级，25%的概率提升一级，5%的概率提升两级（例如，珍品+珍品 -> 大概率珍品，小概率绝品，极小概率仙品）。
    *   **技能 (skills/skill)**: 后代必须从父母双方的技能池中【随机继承1-2个技能】。同时，有10%的概率发生【技能变异】，创造一个全新的、融合了父母技能特点的、更强大的新技能。
3.  **数据完整性**: 你必须完整地填充新卡牌的所有字段。确保为新卡牌生成一个独特的、充满想象力的名称和称号。
4.  **JSON输出**: 你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象，其结构必须与 CharacterCard 或 PetCard 类型完全匹配。`,c=`
    请根据以下两个亲代的信息，创造一个全新的后代：
    - 亲代A: ${JSON.stringify(n)}
    - 亲代B: ${JSON.stringify(a)}

    请开始你的创造，并返回新生命的完整数据。
    `,d=await Qe(o,c),m=wt(d);return m.id=`cultivated-${Date.now()}`,m}const X1=async(n,a,r)=>{const o=`你是一位顶级的仙侠世界色情小说家，擅长创作详细、刺激、充满想象力的追捕故事。你的任务是基于追捕者和目标的信息，创作一个完整、详细、色情、引人入胜的追捕日志。

**核心要求**:

1.  **完整的故事结构**（必须包含以下所有阶段，每个阶段都要详细展开）:
    
    *   **寻找追踪阶段（150-200字）**:
        - 详细描述追捕者如何接受任务，收集情报
        - 描写追踪的全过程：在哪些地方打听、遇到了什么人、发现了什么线索
        - 追捕者的心理活动和推理过程
        - 融入追捕者的技能特点、追踪手段
        - 可以包含一些小插曲：误导、假线索、意外发现等
    
    *   **发现与追逐阶段（200-250字）**:
        - 详细描写发现目标的瞬间：在什么地方、什么情况下发现的
        - 激烈追逐的全过程：穿越什么地形、施展什么身法、如何躲避障碍
        - 目标的逃跑策略：使用什么技能、设置什么陷阱、如何掩盖踪迹
        - 追捕者的应对方式：如何破解陷阱、如何缩短距离
        - 环境描写要丰富：城镇街巷、山林密道、洞府秘境、河流湖泊等
        - 途中可能遇到的意外：其他修士、妖兽、地形险阻等
    
    *   **战斗/对峙阶段（250-300字）**:
        - 追上目标后的正面对峙：双方如何摆开架势、如何试探
        - 详细的战斗过程：
          · 具体描写使用了什么技能，如何施展
          · 身体动作的细节：闪避、格挡、反击、近身搏斗
          · 衣物在战斗中的变化：破损、凌乱、暴露
          · 双方体力和真元的消耗
        - **色情化战斗描写**：
          · 身体碰撞的细节：肌肤相触、力量压制、姿势变化
          · 目标身体的暴露和追捕者的反应
          · 战斗中产生的暧昧场景和情欲张力
          · 汗水、喘息、体温、触感等感官细节
    
    *   **制服过程（150-200字）**:
        - 如何抓住机会最终制服目标
        - 制服的具体方式要详细：
          · 使用什么技能或道具（绳索、符咒、技能控制等）
          · 如何压制目标的反抗
          · 捆绑或控制的具体姿势和手法
        - **必须色情化描写**：
          · 制服时的身体接触和姿势
          · 目标的身体状态：衣衫凌乱、气喘吁吁、汗水淋漓
          · 目标的表情和反应：挣扎、呻吟、不甘、羞耻
          · 追捕者的心理和生理反应
    
    *   **趣事/意外事件（100-150字）**:
        - **必须包含**追捕过程中发生的至少1-2件趣事或意外
        - 可以是色色的事情：
          · 误闯某个修士的双修洞府，撞见不雅场景
          · 追到温泉或浴池，目标正在沐浴
          · 衣物在战斗中完全破损的尴尬
          · 使用某个技能导致的意外身体接触
          · 被春药陷阱波及的场景
        - 可以是遇险：
          · 遭遇妖兽或其他修士袭击
          · 误入危险禁地或机关陷阱
          · 恶劣天气或地形导致的险境
        - 可以是趣事：
          · 目标的狡猾计谋反而害了自己
          · 追捕者的糗事或乌龙
          · 巧遇旧识或引发误会

2.  **色情化核心要求**（贯穿全文）:
    *   **外观描写**: 详细描写追捕者和目标的身材、容貌、身体特征
    *   **衣物状态**: 时刻关注衣物的变化 - 破损、凌乱、暴露程度
    *   **身体接触**: 详细描写每一次肢体碰撞、抓扯、压制的细节
    *   **感官刺激**: 汗水的味道、喘息声、肌肤触感、体温传递
    *   **情欲氛围**: 使用暗示性、挑逗性的词语，营造暧昧张力
    *   **心理描写**: 追捕者和目标的心理活动，包括情欲层面的波动

3.  **角色特点深度融合**:
    *   追捕者的称号、技能、性格必须在行动中自然体现
    *   目标的特质、罪行、能力必须在逃跑和战斗中展现
    *   根据性别组合调整描写重点（男追女、女追男、同性等）

4.  **字数要求**: **总计800-1200字**，确保故事丰富、完整、有画面感

5.  **文笔要求**:
    *   语言生动、细腻、富有感染力
    *   善用比喻、拟人等修辞手法
    *   节奏张弛有度，有紧张有舒缓
    *   避免重复用词，多样化表达

6.  **严格禁止**:
    *   不要只写结果，必须详细描写过程
    *   不要含糊其辞或使用省略性描述
    *   不要忽略任何一个故事阶段
    *   不要少于800字或超过1200字

7.  **直接输出**: 你的最终输出只需要一段完整的纯文本故事（可以分自然段），不要包含任何JSON格式、大标题、章节标记、"# "等markdown标记或额外解释。`,c=`
        # 追捕者信息:
        - 姓名: ${n.name}
        - 性别: ${n.gender}
        - 称号: ${n.title||"无"}
        - 境界: ${n.realm||"未知"}
        - 外观: ${n.appearance||"外表平平"}
        - 核心技能: ${n.skills.map(m=>m==null?void 0:m.name).filter(Boolean).join(", ")||"无"}

        # 目标信息:
        - 姓名: ${a.name}
        - 性别: ${a.gender}
        - 称号: ${a.title||"无"}
        - 境界: ${a.realm||"未知"}
        - 外观: ${a.appearance||"外表平平"}
        - 特殊专长: ${a.origin||"无"}
        - 罪行: ${a.title||"淫邪之徒"}

        请创作一个完整、详细、色情的追捕故事，包含以下所有阶段：
        
        **必须包含的5个阶段及字数要求**:
        1. **寻找追踪阶段（150-200字）**: 接受任务、收集情报、追踪线索的全过程
        2. **发现与追逐阶段（200-250字）**: 发现目标、激烈追逐、环境描写、意外情况
        3. **战斗/对峙阶段（250-300字）**: 正面对峙、详细战斗过程、色情化战斗描写
        4. **制服过程（150-200字）**: 如何制服、捆绑控制、色情化身体接触描写
        5. **趣事/意外事件（100-150字）**: 必须包含至少1-2件色色的事情、遇险或趣事
        
        **总字数要求**: 800-1200字
        
        记住：每个阶段都必须详细展开，不要省略任何过程！
    `;return(r?await tt({systemInstruction:o,prompt:c,gameState:r}):await Qe(o,c)).trim()};async function K1(n,a,r,o){var b;const c=`你正在扮演角色 ${a.name}。请以 ${a.name} 的身份和口吻，简洁地回复玩家。你的回复应该符合仙侠世界的背景和你的角色设定。`,m=r.slice(-5).map(g=>`${g.sender==="user"?n.name:a.name}: ${g.text}`).join(`
`),f=((b=[...r].reverse().find(g=>g.sender==="user"))==null?void 0:b.text)||"",h=`
对话历史:
${m}

玩家 (${n.name}) 的最新消息:
"${f}"

现在，请以 ${a.name} 的身份回复。
`;return(await Qe(c,h)).trim()}async function iu(n,a,r,o){const c=o.replace("{category}",r),m=`
    请根据以下记忆片段生成总结：

    ${n.map((k,_)=>`[${_+1}] ${k.timestamp} - ${k.title}
${k.content}`).join(`

`)}
    `,f=await Qe(c,m),h=f.trim().split(`
`),p=h[0].length<30?h[0]:`关于${r}的总结`,b=h.length>1?h.slice(1).join(`
`).trim():f.trim(),g=n.map(k=>k.id),w=0,N=n.length-1;return{id:`summary-${Date.now()}`,type:a,category:r,title:p,content:b,sourceMemoryIds:g,startIndex:w,endIndex:N,timestamp:new Date().toLocaleString(),realTimestamp:Date.now()}}async function up(n,a,r){try{const o="仙侠卡牌RPG记忆库";window.TavernHelper.getWorldbookNames().includes(o)||await window.TavernHelper.createWorldbook(o,[]);const d=n.title||`${a}-${r==="small"?"小":"大"}总结-${new Date().toLocaleString()}`,m=new Date().toLocaleString(),f={name:d,enabled:!0,strategy:{type:"selective",keys:[a,r==="small"?"小总结":"大总结"],keys_secondary:{logic:"and_any",keys:[]},scan_depth:10},position:{type:"after_character_definition",role:"system",depth:4,order:100},content:`# ${d}

**分类**: ${a}
**类型**: ${r==="small"?"小总结":"大总结"}
**时间**: ${m}

---

${n.content}`,probability:100,recursion:{prevent_incoming:!1,prevent_outgoing:!1,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}};return await window.TavernHelper.createWorldbookEntries(o,[f]),!0}catch(o){return console.error("保存总结到世界书失败:",o),!1}}async function W1(n,a,r,o){const c=`你是一位仙侠世界的劳役监工，负责记录囚犯的劳役成果。你的任务是根据囚犯信息、劳役类型和持续时间，生成一份详细的劳役结果报告。

**重要：你必须严格按照以下JSON结构生成劳役结果，所有必填字段都不能省略！**

1.  **必填字段（缺一不可）**:
    *   **materials**: 数组，必须包含恰好2个材料对象，每个对象包含：
        - **material**: 完整的材料对象（LaborMaterial接口）
          - **id**: 格式为 "material-{timestamp}-{index}"
          - **name**: 材料名称（必须符合${a}类型：矿山产出矿石，采药产出草药）
          - **type**: 必须是 "${a==="矿山"?"ore":"herb"}"
          - **rarity**: 稀有度（根据囚犯境界和劳役时长决定）
          - **description**: 材料的详细描述（50-100字）
          - **value**: 单个材料价值（灵石），根据稀有度：凡品5-10，良品10-20，优品20-40，珍品40-80，绝品80-150，仙品150-300
        - **quantity**: 数量（必须在25-50之间随机）
    *   **story**: AI生成的劳役过程描述（150-250字）
    *   **experience**: 囚犯获得的经验值（根据劳役时长和境界计算，一般10-50）
    *   **healthCost**: 消耗的健康度（根据劳役强度，一般5-20）

2.  **材料生成规则**:
    *   ${a==="矿山"?'**矿石类型**: 必须生成矿石，如"灵铁矿"、"赤铜精矿"、"紫金玉石"、"星陨晶石"等':'**草药类型**: 必须生成草药，如"紫芝草"、"血莲花"、"九叶灵芝"、"七星回魂草"等'}
    *   **稀有度分配**:
        - 60%概率：凡品或良品
        - 30%概率：优品或珍品
        - 10%概率：绝品或以上
    *   **数量随机**: 每种材料25-50个随机（可以不同）
    *   **名称唯一**: 两种材料的名称必须不同

3.  **劳役故事创作要求**:
    *   **基于囚犯特征**: 必须提及囚犯的名字、性别、境界
    *   **符合劳役类型**: ${a==="矿山"?"描述挖矿过程，如挖掘、敲击、搬运矿石等":"描述采药过程，如寻找、采摘、处理草药等"}
    *   **劳役时长**: 体现${r}小时的劳作过程
    *   **色情元素**: 可适度加入囚犯在劳役中的身体状态、汗水、疲惫等描写，但不要过度
    *   **结果呈现**: 最后说明找到/采集到了哪些材料
    *   **字数要求**: 150-250字

4.  **经验和健康消耗计算**:
    *   **experience**: 基础值 = duration * 2，根据囚犯境界调整（筑基期+0，金丹期+5，元婴期+10）
    *   **healthCost**: 基础值 = duration * 1.5，最小5，最大20

5.  **JSON格式示例**:
\`\`\`json
{
  "materials": [
    {
      "material": {
        "id": "material-temp-1",
        "name": "紫晶灵铁矿",
        "type": "ore",
        "rarity": "优品",
        "description": "蕴含浓郁灵气的紫色铁矿，可用于锻造法器，矿石表面闪烁着星光般的微粒。",
        "value": 25
      },
      "quantity": 37
    },
    {
      "material": {
        "id": "material-temp-2",
        "name": "赤铜精矿",
        "type": "ore",
        "rarity": "良品",
        "description": "火红色的铜矿石，质地坚硬，含有微量火属性灵气，适合炼制火系法宝。",
        "value": 15
      },
      "quantity": 42
    }
  ],
  "story": "囚犯${n.character.name}被押送至青蛇矿脉深处，在监工的看守下开始了长达${r}小时的采矿劳作。他挥动着沉重的矿镐，一次次砸向坚硬的岩壁，汗水浸透了单薄的囚衣。随着时间推移，${n.character.gender==="Male"?"他":"她"}的双臂已经酸痛难忍，但在监工的鞭子威慑下不敢停歇。在第三个时辰时，矿镐终于凿开了一处紫光闪烁的矿脉，大量紫晶灵铁矿暴露出来。${n.character.gender==="Male"?"他":"她"}强忍疲惫，将这些珍贵的矿石一一搬运至矿车。临近收工时，又在矿洞侧壁发现了一小片赤铜精矿。虽然身心俱疲，但这次劳役的收获还算不错。",
  "experience": 25,
  "healthCost": 12
}
\`\`\`

6.  **严格要求**:
    *   你的最终输出必须是一个包裹在 \`\`\`json ... \`\`\` 代码块中的JSON对象
    *   不要在代码块之外添加任何解释或注释
    *   materials数组必须恰好包含2个元素
    *   每个material对象必须完整填充所有字段
    *   材料类型必须与劳役位置类型匹配（矿山→ore，采药→herb）`,d=`
    囚犯信息:
    - 姓名: ${n.character.name}
    - 性别: ${n.character.gender}
    - 境界: ${n.character.realm}
    - 稀有度: ${n.character.rarity}
    - 称号: ${n.character.title||"无"}
    - 当前健康度: ${n.health}/100
    - 屈服度: ${n.submissionLevel}/100

    劳役详情:
    - 劳役类型: ${a}
    - 劳役时长: ${r}小时

    请生成完整的劳役结果报告，包括2种不同的${a==="矿山"?"矿石":"草药"}材料、劳役过程故事、经验和健康消耗。
    `,m=o?await tt({systemInstruction:c,prompt:d,gameState:o}):await Qe(c,d),f=wt(m);if(f.materials&&f.materials.length===2){const h=Date.now();f.materials[0].material.id=`material-${h}-1`,f.materials[1].material.id=`material-${h}-2`}return f}const e5=({entry:n,index:a,activeCategory:r,onDeleteEntry:o})=>{const[c,d]=v.useState(!0),m=()=>{d(!c)},f=`transition-all duration-300 ease-in-out overflow-hidden ${c?"max-h-24":"max-h-full"}`;return e.jsxs("div",{className:"glass-morphism p-5 rounded-lg border border-stone-700/50 hover:border-xianxia-gold-500/50 transition-all duration-300 group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:"px-3 py-1 bg-gradient-to-r from-amber-600/20 to-amber-700/20 text-amber-300 text-xs rounded-full border border-amber-600/30",children:["第 ",a+1," 条"]}),e.jsx("h3",{className:"text-lg font-bold text-white font-serif",children:n.title})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-clock"}),n.timestamp]}),n.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-location-dot"}),n.location]}),n.involvedCharacters&&n.involvedCharacters.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-users"}),n.involvedCharacters.join("、")]})]})]}),e.jsx("button",{onClick:()=>o(r,n.id),className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-red-400 hover:text-red-300 p-2",title:"删除此记忆",children:e.jsx("i",{className:"fa-solid fa-trash-alt"})})]}),e.jsxs("div",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-wrap bg-stone-900/30 p-4 rounded border border-stone-700/30 cursor-pointer",onClick:m,children:[e.jsx("div",{className:f,children:n.content}),e.jsx("div",{className:"text-center text-xs text-gray-500 mt-2",children:c?"点击展开":"点击折叠"})]})]})},t5=({isOpen:n,onClose:a,gameState:r,onSaveThreshold:o})=>{const[c,d]=v.useState(""),[m,f]=v.useState(!1),[h,p]=v.useState([]),[b,g]=v.useState([]),[w,N]=v.useState(!0),[j,k]=v.useState(.7),[_,C]=v.useState("70"),[S,D]=v.useState(!1),[E,A]=v.useState(new Set),[z,I]=v.useState(0),[L,T]=v.useState(!1),P=["探索","战斗","商城","医馆","悬赏","培育","商业","声望","公告","其他"];v.useEffect(()=>{var O;if(n){Cs.initialize().catch(console.error);const U=((O=r.vectorConfig)==null?void 0:O.similarityThreshold)||.7;k(U),C((U*100).toFixed(0))}},[n,r.vectorConfig]);const M=O=>{C(O);const U=parseFloat(O);!isNaN(U)&&U>=0&&U<=100&&k(U/100)},R=()=>{o&&(o(j),T(!0),setTimeout(()=>T(!1),2e3))},Q=async()=>{if(!c.trim()&&!S){alert("请输入搜索内容或启用上下文搜索");return}f(!0),p([]);const O=Date.now();try{let U;S?U=(await yi.retrieveRelevantMemories(r,c.trim()||void 0,r.vectorConfig.maxResults)).relevantMemories:U=await Xd.search(c,{categories:b.length>0?b:void 0,minSimilarity:j,maxResults:r.vectorConfig.maxResults,useTimeDecay:w}),p(U),I(Date.now()-O)}catch(U){alert("搜索失败: "+(U instanceof Error?U.message:"未知错误")),console.error("搜索错误:",U)}finally{f(!1)}},Z=O=>{g(U=>U.includes(O)?U.filter(te=>te!==O):[...U,O])},G=O=>{A(U=>{const te=new Set(U);return te.has(O)?te.delete(O):te.add(O),te})},H=O=>{const U=(O*100).toFixed(1);let te="text-gray-400";return O>=.9?te="text-green-400":O>=.8?te="text-blue-400":O>=.7&&(te="text-purple-400"),e.jsxs("span",{className:te,children:[U,"%"]})};return n?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/95 to-purple-900/95 border-2 border-indigo-400/50 rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-indigo-400/30 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-indigo-100",children:"🔍 语义搜索"}),e.jsx("button",{onClick:a,className:"text-indigo-300 hover:text-white text-2xl leading-none",children:"×"})]}),e.jsxs("div",{className:"p-4 border-b border-indigo-400/30 bg-black/20",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:c,onChange:O=>d(O.target.value),onKeyPress:O=>O.key==="Enter"&&Q(),placeholder:S?"可选：自定义查询（留空则自动提取上下文）":"输入搜索内容...",className:"flex-1 px-4 py-2 bg-black/50 border border-indigo-400/50 rounded text-indigo-100 placeholder-indigo-400/50",disabled:m}),e.jsx("button",{onClick:Q,disabled:m||!c.trim()&&!S,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-600 text-white rounded transition-colors",children:m?"搜索中...":"搜索"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-indigo-200 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:O=>D(O.target.checked),className:"w-4 h-4"}),e.jsx("span",{children:"🧠 上下文感知搜索"})]}),e.jsx("span",{className:"text-xs text-indigo-400",children:"（根据当前游戏场景自动检索相关记忆）"})]}),!S&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm text-indigo-300 mb-2",children:"分类过滤："}),e.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(O=>e.jsx("button",{onClick:()=>Z(O),className:`px-3 py-1 rounded text-sm transition-colors ${b.includes(O)?"bg-indigo-600 text-white":"bg-black/30 text-indigo-300 hover:bg-black/50"}`,children:O},O))})]}),e.jsxs("details",{className:"text-sm",open:!0,children:[e.jsx("summary",{className:"text-indigo-300 cursor-pointer hover:text-indigo-200 mb-3",children:"高级选项"}),e.jsxs("div",{className:"mt-3 space-y-3 pl-4",children:[e.jsxs("div",{className:"bg-black/30 p-3 rounded border border-indigo-400/30",children:[e.jsx("label",{className:"block text-indigo-200 mb-2 font-semibold",children:"📊 相似度阈值设置"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-indigo-400 mb-1",children:[e.jsx("span",{children:"0%"}),e.jsxs("span",{className:"font-bold text-indigo-300",children:["当前: ",(j*100).toFixed(0),"%"]}),e.jsx("span",{children:"100%"})]}),e.jsx("input",{type:"range",value:j,onChange:O=>{const U=parseFloat(O.target.value);k(U),C((U*100).toFixed(0))},min:"0",max:"1",step:"0.01",className:"w-full"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("label",{className:"text-indigo-200 text-sm whitespace-nowrap",children:"精确值:"}),e.jsx("input",{type:"number",value:_,onChange:O=>M(O.target.value),min:"0",max:"100",step:"1",className:"flex-1 px-3 py-1 bg-black/50 border border-indigo-400/50 rounded text-indigo-100 text-sm",placeholder:"0-100"}),e.jsx("span",{className:"text-indigo-300 text-sm",children:"%"}),e.jsx("button",{onClick:R,className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm rounded transition-colors whitespace-nowrap flex items-center gap-1",title:"保存阈值到设置",children:"💾 保存"})]}),L&&e.jsx("div",{className:"mt-2 text-xs text-green-400 animate-pulse",children:"✓ 阈值已保存！"}),e.jsx("p",{className:"text-xs text-indigo-400 mt-2",children:"💡 阈值越高，搜索结果越精确但数量越少；阈值越低，结果越多但可能不够相关"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-indigo-200 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:O=>N(O.target.checked),className:"w-4 h-4"}),e.jsx("span",{children:"启用时间衰减（较新的记忆权重更高）"})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:m?e.jsxs("div",{className:"text-center text-indigo-300 py-8",children:[e.jsx("div",{className:"animate-spin text-4xl mb-2",children:"🔄"}),e.jsx("p",{children:"正在搜索中..."})]}):h.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 p-3 bg-black/30 rounded border border-indigo-400/30 text-indigo-200 text-sm",children:["找到 ",e.jsx("span",{className:"text-indigo-400 font-bold",children:h.length})," 个相关记忆",e.jsxs("span",{className:"ml-4 text-indigo-400",children:["搜索耗时: ",z,"ms"]})]}),e.jsx("div",{className:"space-y-3",children:h.map((O,U)=>{const te=O.memory,ie=E.has(te.id),B=te.text.length>150?te.text.substring(0,150)+"...":te.text;return e.jsxs("div",{className:"bg-black/40 border border-indigo-400/40 rounded-lg p-4 hover:border-indigo-400/60 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-indigo-400 font-bold",children:["#",O.rank]}),e.jsx("span",{className:"px-2 py-0.5 bg-indigo-600/50 text-indigo-200 text-xs rounded",children:te.category}),e.jsx("span",{className:"text-indigo-300 text-sm",children:te.metadata.timestamp})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm",children:["相似度: ",H(O.similarity)]})})]}),(te.metadata.location||te.metadata.involvedCharacters)&&e.jsxs("div",{className:"flex gap-4 mb-2 text-xs text-indigo-400",children:[te.metadata.location&&e.jsxs("span",{children:["📍 ",te.metadata.location]}),te.metadata.involvedCharacters&&te.metadata.involvedCharacters.length>0&&e.jsxs("span",{children:["👥 ",te.metadata.involvedCharacters.join("、")]})]}),e.jsx("div",{className:"text-indigo-100 text-sm mb-2",children:ie?te.text:B}),te.text.length>150&&e.jsx("button",{onClick:()=>G(te.id),className:"text-xs text-indigo-400 hover:text-indigo-300",children:ie?"▲ 收起":"▼ 展开"})]},te.id)})})]}):e.jsxs("div",{className:"text-center text-indigo-300 py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🔍"}),e.jsx("p",{children:"暂无搜索结果"}),e.jsx("p",{className:"text-sm mt-2 text-indigo-400",children:r.vectorConfig.enabled?"输入关键词或启用上下文搜索开始检索":"请先在设置中启用向量化功能"})]})}),e.jsx("div",{className:"p-4 border-t border-indigo-400/30 bg-black/20",children:e.jsxs("div",{className:"flex justify-between items-center text-sm text-indigo-300",children:[e.jsx("div",{children:r.vectorConfig.enabled?e.jsx("span",{children:"✅ 向量化功能已启用"}):e.jsx("span",{className:"text-yellow-400",children:"⚠️ 向量化功能未启用"})}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors",children:"关闭"})]})})]})}):null},s5=({prompts:n,onPromptsChange:a})=>e.jsxs("div",{className:"space-y-6 text-white",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-300 mb-2",children:"小总结预设"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"这个预设将用于生成实时记录的小总结。你可以使用 `{category}` 占位符来动态插入当前分类。"}),e.jsx("textarea",{value:n.small,onChange:r=>a({...n,small:r.target.value}),rows:6,className:"w-full px-3 py-2 bg-stone-800/60 border border-stone-600 rounded-md text-sm text-gray-200 focus:outline-none focus:border-purple-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-indigo-300 mb-2",children:"大总结预设"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"这个预设将用于把多个小总结合并成一个大总结。你可以使用 `{category}` 占位符。"}),e.jsx("textarea",{value:n.large,onChange:r=>a({...n,large:r.target.value}),rows:6,className:"w-full px-3 py-2 bg-stone-800/60 border border-stone-600 rounded-md text-sm text-gray-200 focus:outline-none focus:border-indigo-500 transition-colors"})]})]}),n5=({isOpen:n,onClose:a,settings:r,onSave:o,gameState:c,onVectorConfigSave:d})=>{const[m,f]=v.useState(r),[h,p]=v.useState("general"),[b,g]=v.useState((c==null?void 0:c.vectorConfig)||{enabled:!1,apiUrl:"https://api.openai.com/v1",apiKey:"",model:"text-embedding-3-small",autoVectorize:!1,vectorizeOnSummary:!0,batchSize:10,similarityThreshold:.7,maxResults:20,topKBeforeRerank:50,rerankerEnabled:!1,rerankerApiUrl:"https://api.jina.ai/v1",rerankerApiKey:"",rerankerModel:"jina-reranker-v2-base-multilingual",retryAttempts:3,cacheEnabled:!0}),[w,N]=v.useState("embedding"),[j,k]=v.useState(!1),[_,C]=v.useState(null),[S,D]=v.useState([]),[E,A]=v.useState(!1),[z,I]=v.useState(null),[L,T]=v.useState(!1),[P,M]=v.useState(""),[R,Q]=v.useState([]),[Z,G]=v.useState(!1),[H,O]=v.useState("");if(!n)return null;const U=S.filter(ae=>ae.toLowerCase().includes(P.toLowerCase())),te=()=>{o(m),h==="vector"&&d&&(Vt.updateConfig(b),d(b)),a()},ie=async()=>{T(!0);try{await Cs.initialize();const ae=await Cs.getStats();I(ae)}catch(ae){console.error("加载统计信息失败:",ae)}finally{T(!1)}},B=async()=>{k(!0),C(null);try{Vt.updateConfig(b);const ae=await Vt.testConnection();ae.success?C({success:!0,message:`连接成功！使用模型: ${ae.model}`}):C({success:!1,message:`连接失败: ${ae.error}`})}catch(ae){C({success:!1,message:`连接失败: ${ae instanceof Error?ae.message:"未知错误"}`})}finally{k(!1)}},W=async()=>{A(!0),C(null);try{Vt.updateConfig(b);const ae=await Vt.fetchAvailableModels();ae.success&&ae.models?(D(ae.models),localStorage.setItem("vector_available_models",JSON.stringify(ae.models)),C({success:!0,message:`成功获取 ${ae.models.length} 个模型`})):C({success:!1,message:`获取模型列表失败: ${ae.error}`})}catch(ae){C({success:!1,message:`获取模型列表失败: ${ae instanceof Error?ae.message:"未知错误"}`})}finally{A(!1)}},ne=async()=>{G(!0),C(null);try{const ae=await fetch(`${b.rerankerApiUrl}/models`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.rerankerApiKey}`}});if(!ae.ok){const Se=await ae.text();C({success:!1,message:`获取Reranker模型列表失败: HTTP ${ae.status} - ${Se}`});return}const xe=await ae.json();let he=[];xe.data&&Array.isArray(xe.data)?he=xe.data.map(Se=>Se.id):xe.models&&Array.isArray(xe.models)?he=xe.models.map(Se=>typeof Se=="string"?Se:Se.id||Se.name):Array.isArray(xe)&&(he=xe.map(Se=>typeof Se=="string"?Se:Se.id||Se.name)),he.length>0?(Q(he),localStorage.setItem("reranker_available_models",JSON.stringify(he)),C({success:!0,message:`成功获取 ${he.length} 个Reranker模型`})):C({success:!1,message:"未找到可用的Reranker模型"})}catch(ae){C({success:!1,message:`获取Reranker模型列表失败: ${ae instanceof Error?ae.message:"未知错误"}`})}finally{G(!1)}},X=async()=>{if(confirm("确定要清空所有向量数据吗？此操作不可逆！"))try{await Cs.clearAllVectors(),alert("向量数据已清空"),ie()}catch(ae){alert("清空失败: "+(ae instanceof Error?ae.message:"未知错误"))}};La.useEffect(()=>{if(h==="vector"&&n){ie();const ae=localStorage.getItem("vector_available_models");if(ae)try{const he=JSON.parse(ae);D(he)}catch(he){console.error("加载已保存的模型列表失败:",he)}const xe=localStorage.getItem("reranker_available_models");if(xe)try{const he=JSON.parse(xe);Q(he)}catch(he){console.error("加载已保存的Reranker模型列表失败:",he)}}},[h,n]);const J=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold mb-1",children:"自动总结"}),e.jsx("p",{className:"text-xs text-gray-400",children:"启用后将根据设定自动生成总结"})]}),e.jsx("button",{onClick:()=>f({...m,autoSummaryEnabled:!m.autoSummaryEnabled}),className:`relative w-14 h-7 rounded-full transition-colors duration-300 ${m.autoSummaryEnabled?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-stone-600"}`,children:e.jsx("div",{className:`absolute top-1 w-5 h-5 bg-white rounded-full shadow-md transition-transform duration-300 ${m.autoSummaryEnabled?"translate-x-8":"translate-x-1"}`})})]})}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"小总结触发条件"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"每"}),e.jsx("input",{type:"number",min:"1",max:"50",value:m.smallSummaryInterval,onChange:ae=>f({...m,smallSummaryInterval:Math.max(1,Math.min(50,parseInt(ae.target.value)||1))}),className:"w-20 px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-center text-white focus:outline-none focus:border-amber-500",disabled:!m.autoSummaryEnabled}),e.jsx("span",{className:"text-sm text-gray-300",children:"条实时记录生成一次小总结"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"推荐值: 5-15条"})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"大总结触发条件"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"每"}),e.jsx("input",{type:"number",min:"1",max:"20",value:m.largeSummaryInterval,onChange:ae=>f({...m,largeSummaryInterval:Math.max(1,Math.min(20,parseInt(ae.target.value)||1))}),className:"w-20 px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-center text-white focus:outline-none focus:border-amber-500",disabled:!m.autoSummaryEnabled}),e.jsx("span",{className:"text-sm text-gray-300",children:"条小总结生成一次大总结"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"推荐值: 3-8条"})]})]}),re=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-purple-700/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-200 mb-3",children:"📊 向量存储统计"}),L?e.jsx("p",{className:"text-purple-300",children:"加载中..."}):z?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"总向量数："}),z.totalVectors]}),e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"平均维度："}),z.averageDimension.toFixed(0)]}),e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"存储大小："}),(z.storageSize/1024/1024).toFixed(2)," MB"]}),e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"最早记录："}),z.oldestVector?new Date(z.oldestVector).toLocaleDateString():"-"]})]}):e.jsx("p",{className:"text-purple-300",children:"暂无数据"})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"⚙️ 基础设置"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-gray-300",children:"启用向量化功能"}),e.jsx("input",{type:"checkbox",checked:b.enabled,onChange:ae=>g({...b,enabled:ae.target.checked}),className:"w-5 h-5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"API URL"}),e.jsx("input",{type:"text",value:b.apiUrl,onChange:ae=>g({...b,apiUrl:ae.target.value}),className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white",placeholder:"https://api.openai.com/v1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"支持OpenAI API或兼容接口（如本地Ollama）"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"API Key"}),e.jsx("input",{type:"password",value:b.apiKey,onChange:ae=>g({...b,apiKey:ae.target.value}),className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white",placeholder:"sk-..."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-gray-300",children:"Embedding模型"}),e.jsx("button",{onClick:W,disabled:E||!b.apiUrl,className:"px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded transition-colors",children:E?"获取中...":"🔄 刷新模型"})]}),S.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("input",{type:"text",value:P,onChange:ae=>M(ae.target.value),placeholder:"🔍 搜索模型...",className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white text-sm"}),P&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["找到 ",U.length," 个匹配的模型"]})]}),e.jsx("select",{value:b.model,onChange:ae=>g({...b,model:ae.target.value}),className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white",size:S.length>0?Math.min(U.length+5,10):5,children:S.length>0?e.jsxs(e.Fragment,{children:[e.jsx("optgroup",{label:"已发现的模型",children:U.length>0?U.map(ae=>e.jsx("option",{value:ae,children:ae},ae)):e.jsx("option",{disabled:!0,children:"没有匹配的模型"})}),e.jsxs("optgroup",{label:"常用模型",children:[e.jsx("option",{value:"text-embedding-3-small",children:"text-embedding-3-small (OpenAI)"}),e.jsx("option",{value:"text-embedding-3-large",children:"text-embedding-3-large (OpenAI)"}),e.jsx("option",{value:"text-embedding-ada-002",children:"text-embedding-ada-002 (OpenAI)"}),e.jsx("option",{value:"nomic-embed-text",children:"nomic-embed-text (Ollama)"}),e.jsx("option",{value:"mxbai-embed-large",children:"mxbai-embed-large (Ollama)"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"text-embedding-3-small",children:"text-embedding-3-small (OpenAI)"}),e.jsx("option",{value:"text-embedding-3-large",children:"text-embedding-3-large (OpenAI)"}),e.jsx("option",{value:"text-embedding-ada-002",children:"text-embedding-ada-002 (OpenAI)"}),e.jsx("option",{value:"nomic-embed-text",children:"nomic-embed-text (Ollama)"}),e.jsx("option",{value:"mxbai-embed-large",children:"mxbai-embed-large (Ollama)"})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'点击"刷新模型"可从API端点自动获取可用模型列表'})]}),e.jsx("button",{onClick:B,disabled:j||!b.apiKey,className:"w-full px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white rounded transition-colors",children:j?"测试中...":"测试连接"}),_&&e.jsx("div",{className:`p-3 rounded border ${_.success?"bg-green-900/50 border-green-400/50 text-green-200":"bg-red-900/50 border-red-400/50 text-red-200"}`,children:_.message})]})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"🤖 自动化设置"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-gray-300",children:"自动向量化新记忆"}),e.jsx("input",{type:"checkbox",checked:b.autoVectorize,onChange:ae=>g({...b,autoVectorize:ae.target.checked}),className:"w-5 h-5"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-gray-300",children:"生成总结时自动向量化"}),e.jsx("input",{type:"checkbox",checked:b.vectorizeOnSummary,onChange:ae=>g({...b,vectorizeOnSummary:ae.target.checked}),className:"w-5 h-5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"批处理大小"}),e.jsx("input",{type:"number",value:b.batchSize,onChange:ae=>g({...b,batchSize:parseInt(ae.target.value)}),min:"1",max:"50",className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"每次批量处理的记忆数量（1-50）"})]})]})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"🔍 搜索设置"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-300 mb-2",children:["相似度阈值: ",(b.similarityThreshold*100).toFixed(0),"%"]}),e.jsx("input",{type:"range",value:b.similarityThreshold,onChange:ae=>g({...b,similarityThreshold:parseFloat(ae.target.value)}),min:"0.5",max:"0.95",step:"0.05",className:"w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"低于此值的搜索结果将被过滤"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"最大结果数"}),e.jsx("input",{type:"number",value:b.maxResults,onChange:ae=>g({...b,maxResults:parseInt(ae.target.value)}),min:"5",max:"100",className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"最终返回给AI的记忆数量"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Rerank前检索数量"}),e.jsx("input",{type:"number",value:b.topKBeforeRerank,onChange:ae=>g({...b,topKBeforeRerank:parseInt(ae.target.value)}),min:"10",max:"200",className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"向量检索的候选数量，建议设置为最大结果数的2-5倍"})]})]})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"🔧 高级设置"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"重试次数"}),e.jsx("input",{type:"number",value:b.retryAttempts,onChange:ae=>g({...b,retryAttempts:parseInt(ae.target.value)}),min:"0",max:"5",className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-gray-300",children:"启用向量缓存"}),e.jsx("input",{type:"checkbox",checked:b.cacheEnabled,onChange:ae=>g({...b,cacheEnabled:ae.target.checked}),className:"w-5 h-5"})]})]})]})]}),pe=()=>{const ae=R.filter(xe=>xe.toLowerCase().includes(H.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-blue-700/50 bg-blue-900/10",children:[e.jsx("h3",{className:"text-blue-300 font-semibold mb-2",children:"ℹ️ 什么是Reranker？"}),e.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Reranker（重排序模型）是一种专门用于优化搜索结果排序的AI模型。它可以："}),e.jsxs("ul",{className:"text-sm text-gray-400 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"对向量检索的候选结果进行精确重排序"}),e.jsx("li",{children:"提高最相关记忆的排名准确度"}),e.jsx("li",{children:"减少不相关内容进入AI上下文"}),e.jsx("li",{children:"改善AI生成的质量和相关性"})]})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"⚙️ Reranker设置"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-300 font-medium",children:"启用Reranker"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"开启后将对向量检索结果进行重排序"})]}),e.jsx("input",{type:"checkbox",checked:b.rerankerEnabled,onChange:xe=>g({...b,rerankerEnabled:xe.target.checked}),className:"w-5 h-5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Reranker API URL"}),e.jsx("input",{type:"text",value:b.rerankerApiUrl,onChange:xe=>g({...b,rerankerApiUrl:xe.target.value}),className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white",placeholder:"https://api.jina.ai/v1",disabled:!b.rerankerEnabled}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"推荐使用Jina AI、Cohere或兼容的Reranker API"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 mb-2",children:"Reranker API Key"}),e.jsx("input",{type:"password",value:b.rerankerApiKey,onChange:xe=>g({...b,rerankerApiKey:xe.target.value}),className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white",placeholder:"jina_...",disabled:!b.rerankerEnabled})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-gray-300",children:"Reranker模型"}),e.jsx("button",{onClick:ne,disabled:Z||!b.rerankerApiUrl||!b.rerankerEnabled,className:"px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded transition-colors",children:Z?"获取中...":"🔄 刷新模型"})]}),R.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("input",{type:"text",value:H,onChange:xe=>O(xe.target.value),placeholder:"🔍 搜索Reranker模型...",className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white text-sm",disabled:!b.rerankerEnabled}),H&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["找到 ",ae.length," 个匹配的模型"]})]}),e.jsx("select",{value:b.rerankerModel,onChange:xe=>g({...b,rerankerModel:xe.target.value}),className:"w-full px-3 py-2 bg-stone-900/50 border border-stone-700 rounded text-white",size:R.length>0?Math.min(ae.length+5,10):5,disabled:!b.rerankerEnabled,children:R.length>0?e.jsxs(e.Fragment,{children:[e.jsx("optgroup",{label:"已发现的模型",children:ae.length>0?ae.map(xe=>e.jsx("option",{value:xe,children:xe},xe)):e.jsx("option",{disabled:!0,children:"没有匹配的模型"})}),e.jsxs("optgroup",{label:"常用模型",children:[e.jsx("option",{value:"jina-reranker-v2-base-multilingual",children:"jina-reranker-v2-base-multilingual (推荐)"}),e.jsx("option",{value:"jina-reranker-v1-base-en",children:"jina-reranker-v1-base-en"}),e.jsx("option",{value:"jina-reranker-v1-turbo-en",children:"jina-reranker-v1-turbo-en"}),e.jsx("option",{value:"rerank-multilingual-v3.0",children:"rerank-multilingual-v3.0 (Cohere)"}),e.jsx("option",{value:"rerank-english-v3.0",children:"rerank-english-v3.0 (Cohere)"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("optgroup",{label:"Jina AI Rerankers",children:[e.jsx("option",{value:"jina-reranker-v2-base-multilingual",children:"jina-reranker-v2-base-multilingual (推荐)"}),e.jsx("option",{value:"jina-reranker-v1-base-en",children:"jina-reranker-v1-base-en"}),e.jsx("option",{value:"jina-reranker-v1-turbo-en",children:"jina-reranker-v1-turbo-en"})]}),e.jsxs("optgroup",{label:"Cohere Rerankers",children:[e.jsx("option",{value:"rerank-multilingual-v3.0",children:"rerank-multilingual-v3.0"}),e.jsx("option",{value:"rerank-english-v3.0",children:"rerank-english-v3.0"}),e.jsx("option",{value:"rerank-multilingual-v2.0",children:"rerank-multilingual-v2.0"})]})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'点击"刷新模型"可从API端点自动获取可用模型列表'})]})]})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"🔄 工作流程"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-blue-400 font-mono",children:"1."}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"向量检索"}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["使用Embedding模型检索 ",b.topKBeforeRerank," 个候选记忆"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-blue-400 font-mono",children:"2."}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"Reranker重排"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"使用Reranker对候选结果进行精确排序"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-blue-400 font-mono",children:"3."}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300 font-medium",children:"返回结果"}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["返回排序后的前 ",b.maxResults," 个最相关记忆"]})]})]})]})]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-yellow-700/50 bg-yellow-900/10",children:[e.jsx("h3",{className:"text-yellow-300 font-semibold mb-2",children:"💡 性能建议"}),e.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[e.jsx("li",{children:"• 候选数量建议设置为最终结果的 2-5 倍"}),e.jsx("li",{children:"• 例如：最终要 20 条结果，候选数量设为 50-100"}),e.jsx("li",{children:"• Reranker会增加 100-300ms 的延迟"}),e.jsx("li",{children:"• 在对话场景中，更高的相关性值得这点延迟"})]})]})]})},me=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-purple-700/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-200 mb-3",children:"📊 向量存储统计"}),L?e.jsx("p",{className:"text-purple-300",children:"加载中..."}):z?e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"总向量数："}),z.totalVectors]}),e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"平均维度："}),z.averageDimension.toFixed(0)]}),e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"存储大小："}),(z.storageSize/1024/1024).toFixed(2)," MB"]}),e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"text-purple-400",children:"最早记录："}),z.oldestVector?new Date(z.oldestVector).toLocaleDateString():"-"]})]}):e.jsx("p",{className:"text-purple-300",children:"暂无数据"})]}),e.jsxs("div",{className:"flex space-x-2 border-b border-stone-700",children:[e.jsxs("button",{onClick:()=>N("embedding"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 ${w==="embedding"?"bg-stone-700/80 text-green-400 border-b-2 border-green-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:[e.jsx("i",{className:"fa-solid fa-vector-square mr-2"}),"嵌入模型"]}),e.jsxs("button",{onClick:()=>N("reranker"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 ${w==="reranker"?"bg-stone-700/80 text-blue-400 border-b-2 border-blue-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:[e.jsx("i",{className:"fa-solid fa-ranking-star mr-2"}),"重排模型"]})]}),e.jsxs("div",{className:"pt-2",children:[w==="embedding"&&re(),w==="reranker"&&pe()]}),e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-red-700/50 bg-red-900/10",children:[e.jsx("h3",{className:"text-red-400 font-semibold mb-4",children:"⚠️ 危险操作"}),e.jsx("button",{onClick:X,className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded transition-colors",children:"清空所有向量数据"}),e.jsx("p",{className:"text-xs text-red-300 mt-2",children:"此操作将永久删除所有向量化的记忆，但不会影响原始记忆数据"})]})]});return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border border-xianxia-gold-600 bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:ae=>ae.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-stone-700/50 bg-black/20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-cog text-xl text-gradient-gold"}),e.jsx("h2",{className:"text-xl font-bold text-gradient-gold text-shadow-glow font-serif",children:"总结设置"})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-full bg-stone-700/50 hover:bg-stone-600/50 text-gray-400 hover:text-xianxia-gold-400 transition-all duration-200",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"flex-shrink-0 px-4 flex space-x-2 border-b border-stone-700",children:[e.jsx("button",{onClick:()=>p("general"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 ${h==="general"?"bg-stone-700/80 text-amber-400 border-b-2 border-amber-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:"常规设置"}),e.jsx("button",{onClick:()=>p("presets"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 ${h==="presets"?"bg-stone-700/80 text-purple-400 border-b-2 border-purple-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:"预设管理"}),e.jsxs("button",{onClick:()=>p("vector"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 flex items-center gap-2 ${h==="vector"?"bg-stone-700/80 text-blue-400 border-b-2 border-blue-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:[e.jsx("i",{className:"fa-solid fa-brain"}),"向量设置"]})]}),e.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto scrollbar-xianxia flex-grow max-h-[60vh]",children:[h==="general"&&J(),h==="presets"&&e.jsx(s5,{prompts:m.summaryPrompts,onPromptsChange:ae=>f(xe=>({...xe,summaryPrompts:ae}))}),h==="vector"&&me()]}),e.jsxs("div",{className:"p-4 border-t border-stone-700/50 bg-black/20 flex gap-3 mt-auto",children:[e.jsx("button",{onClick:a,className:"flex-1 px-4 py-2 bg-stone-700/50 hover:bg-stone-600/50 text-gray-300 hover:text-white rounded-lg transition-all duration-300",children:"取消"}),e.jsx("button",{onClick:te,className:"flex-1 px-4 py-2 bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-500 hover:to-amber-600 text-white font-semibold rounded-lg transition-all duration-300 shadow-glow-gold",children:"保存设置"})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"})]})})},a5=({isOpen:n,onClose:a,category:r,realtimeMemories:o,smallSummaries:c,largeSummaries:d,vectorConfig:m})=>{const[f,h]=v.useState("realtime"),[p,b]=v.useState([]),[g,w]=v.useState("idle"),[N,j]=v.useState({current:0,total:0}),[k,_]=v.useState(""),[C,S]=v.useState(!1);v.useEffect(()=>{n&&D()},[n,f,r]);const D=async()=>{w("checking"),_("正在检查向量化状态...");try{await Cs.initialize();let M=[];f==="realtime"?M=o.map(Z=>({id:Z.id,title:Z.title,content:Z.content})):f==="small-summary"?M=c.map(Z=>({id:Z.id,title:`小总结 #${Z.id}`,content:Z.content})):M=d.map(Z=>({id:Z.id,title:`大总结 #${Z.id}`,content:Z.content}));const R=await Promise.all(M.map(async Z=>{const G=await Cs.isMemoryVectorized(Z.id);return{...Z,isVectorized:G,selected:!G}}));b(R),w("idle"),_("");const Q=R.filter(Z=>!Z.isVectorized);S(Q.length>0&&Q.every(Z=>Z.selected))}catch(M){console.error("加载项目失败:",M),w("error"),_("加载失败: "+(M instanceof Error?M.message:"未知错误"))}},E=M=>{b(R=>R.map(Q=>Q.id===M?{...Q,selected:!Q.selected}:Q))},A=()=>{const M=!C;S(M),b(R=>R.map(Q=>({...Q,selected:Q.isVectorized?!1:M})))},z=async()=>{const M=p.filter(R=>R.selected&&!R.isVectorized);if(M.length===0){alert("请至少选择一个未向量化的项目");return}if(!m.enabled){alert("请先在设置中启用向量化功能");return}if(!m.apiKey){alert("请先在设置中配置API密钥");return}w("vectorizing"),j({current:0,total:M.length});try{Vt.updateConfig(m);for(let R=0;R<M.length;R++){const Q=M[R];j({current:R+1,total:M.length}),_(`正在向量化 (${R+1}/${M.length}): ${Q.title}`);try{const Z=await Vt.vectorize(Q.content);let G=null;f==="realtime"?G=o.find(O=>O.id===Q.id):f==="small-summary"?G=c.find(O=>O.id===Q.id):G=d.find(O=>O.id===Q.id);const H={timestamp:(G==null?void 0:G.timestamp)||new Date().toLocaleString("zh-CN"),realTimestamp:(G==null?void 0:G.realTimestamp)||Date.now(),location:G==null?void 0:G.location,involvedCharacters:G==null?void 0:G.involvedCharacters,tags:[f,Q.title]};await Cs.saveVector({id:`vec_${Q.id}_${Date.now()}`,memoryId:Q.id,vector:Z,vectorDimension:Z.length,text:Q.content,category:r,created:Date.now(),model:m.model,metadata:H}),b(O=>O.map(U=>U.id===Q.id?{...U,isVectorized:!0,selected:!1}:U)),console.log(`✅ 成功向量化: ${Q.title}`)}catch(Z){if(console.error(`❌ 向量化失败: ${Q.title}`,Z),_(`向量化失败: ${Q.title} - ${Z instanceof Error?Z.message:"未知错误"}`),!confirm(`向量化 "${Q.title}" 时出错，是否继续？
错误: ${Z instanceof Error?Z.message:"未知错误"}`))throw Z}R<M.length-1&&await new Promise(Z=>setTimeout(Z,300))}w("completed"),_(`✅ 成功向量化 ${M.length} 个项目`),S(!1),setTimeout(()=>{g==="completed"&&(w("idle"),_(""))},3e3)}catch(R){console.error("批量向量化失败:",R),w("error"),_("批量向量化失败: "+(R instanceof Error?R.message:"未知错误"))}},I=async()=>{const M=p.filter(R=>!R.isVectorized);if(M.length===0){alert("所有项目已经向量化");return}confirm(`确定要向量化所有 ${M.length} 个未向量化的项目吗？`)&&(b(R=>R.map(Q=>({...Q,selected:!Q.isVectorized}))),S(!0),setTimeout(()=>{z()},100))};if(!n)return null;const L=p.filter(M=>!M.isVectorized).length,T=p.filter(M=>M.isVectorized).length,P=p.filter(M=>M.selected).length;return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[70] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/95 via-indigo-900/95 to-purple-900/95 rounded-xl w-full max-w-4xl max-h-[85vh] overflow-hidden border-2 border-purple-400/50 shadow-2xl flex flex-col",onClick:M=>M.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-purple-400/30 bg-black/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-vector-square text-2xl text-purple-300"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-purple-100",children:"向量化管理"}),e.jsxs("p",{className:"text-sm text-purple-300",children:["【",r,"】类别"]})]})]}),e.jsx("button",{onClick:a,disabled:g==="vectorizing",className:"w-10 h-10 rounded-full bg-purple-700/50 hover:bg-purple-600/50 text-purple-200 hover:text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("i",{className:"fa-solid fa-times text-xl"})})]}),e.jsxs("div",{className:"flex gap-2 p-4 border-b border-purple-400/30 bg-black/20",children:[e.jsxs("button",{onClick:()=>h("realtime"),disabled:g==="vectorizing",className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${f==="realtime"?"bg-amber-600 text-white shadow-lg":"bg-purple-800/50 text-purple-200 hover:bg-purple-700/50"} disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx("i",{className:"fa-solid fa-stream"}),e.jsx("span",{children:"实时记录"}),e.jsx("span",{className:"px-2 py-0.5 bg-black/30 rounded-full text-xs",children:o.length})]}),e.jsxs("button",{onClick:()=>h("small-summary"),disabled:g==="vectorizing",className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${f==="small-summary"?"bg-purple-600 text-white shadow-lg":"bg-purple-800/50 text-purple-200 hover:bg-purple-700/50"} disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx("i",{className:"fa-solid fa-layer-group"}),e.jsx("span",{children:"小总结"}),e.jsx("span",{className:"px-2 py-0.5 bg-black/30 rounded-full text-xs",children:c.length})]}),e.jsxs("button",{onClick:()=>h("large-summary"),disabled:g==="vectorizing",className:`px-4 py-2 rounded-lg transition-all flex items-center gap-2 ${f==="large-summary"?"bg-indigo-600 text-white shadow-lg":"bg-purple-800/50 text-purple-200 hover:bg-purple-700/50"} disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx("i",{className:"fa-solid fa-book"}),e.jsx("span",{children:"大总结"}),e.jsx("span",{className:"px-2 py-0.5 bg-black/30 rounded-full text-xs",children:d.length})]})]}),e.jsx("div",{className:"p-4 bg-black/20 border-b border-purple-400/30",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-300",children:p.length}),e.jsx("div",{className:"text-xs text-purple-400",children:"总项目"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:T}),e.jsx("div",{className:"text-xs text-green-500",children:"已向量化"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:L}),e.jsx("div",{className:"text-xs text-yellow-500",children:"未向量化"})]})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4 space-y-2",children:g==="checking"?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-purple-300",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-4xl mb-4"}),e.jsx("p",{children:"正在检查向量化状态..."})]}):p.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-purple-300",children:[e.jsx("i",{className:"fa-solid fa-inbox text-4xl mb-4 opacity-50"}),e.jsx("p",{children:"当前类别没有内容"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-800/30 rounded-lg border border-purple-600/30 mb-3",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:A,disabled:g==="vectorizing"||L===0,className:"w-5 h-5 cursor-pointer disabled:cursor-not-allowed"}),e.jsxs("span",{className:"text-purple-200 font-semibold",children:["全选未向量化的项目 (",L," 项)"]}),P>0&&e.jsxs("span",{className:"ml-auto px-3 py-1 bg-purple-600 text-white text-sm rounded-full",children:["已选 ",P]})]}),p.map((M,R)=>e.jsx("div",{className:`p-3 rounded-lg border transition-all ${M.isVectorized?"bg-green-900/20 border-green-600/30":M.selected?"bg-purple-700/30 border-purple-500/50":"bg-purple-900/20 border-purple-700/30 hover:border-purple-600/50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:M.selected,onChange:()=>E(M.id),disabled:M.isVectorized||g==="vectorizing",className:"mt-1 w-5 h-5 cursor-pointer disabled:cursor-not-allowed"}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"px-2 py-0.5 bg-purple-600/30 text-purple-200 text-xs rounded",children:["#",R+1]}),e.jsx("span",{className:"font-semibold text-purple-100",children:M.title}),M.isVectorized&&e.jsxs("span",{className:"ml-auto px-2 py-0.5 bg-green-600/50 text-green-200 text-xs rounded flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-check"}),"已向量化"]})]}),e.jsx("p",{className:"text-sm text-purple-300 line-clamp-2",children:M.content})]})]})},M.id))]})}),(g==="vectorizing"||g==="completed"||g==="error")&&e.jsxs("div",{className:`p-4 border-t border-purple-400/30 ${g==="error"?"bg-red-900/30":g==="completed"?"bg-green-900/30":"bg-black/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g==="vectorizing"&&e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-purple-300"}),g==="completed"&&e.jsx("i",{className:"fa-solid fa-check-circle text-green-400"}),g==="error"&&e.jsx("i",{className:"fa-solid fa-exclamation-circle text-red-400"}),e.jsx("span",{className:`text-sm ${g==="error"?"text-red-300":g==="completed"?"text-green-300":"text-purple-300"}`,children:k})]}),g==="vectorizing"&&N.total>0&&e.jsx("div",{className:"w-full bg-purple-900/50 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-300",style:{width:`${N.current/N.total*100}%`}})})]}),e.jsxs("div",{className:"p-4 border-t border-purple-400/30 bg-black/20 flex gap-3",children:[e.jsx("button",{onClick:a,disabled:g==="vectorizing",className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:g==="vectorizing"?"向量化中...":"关闭"}),e.jsxs("button",{onClick:I,disabled:g==="vectorizing"||L===0,className:"flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-bolt"}),"向量化全部未完成"]}),e.jsxs("button",{onClick:z,disabled:g==="vectorizing"||P===0,className:"flex-1 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-play"}),"向量化已选 (",P,")"]})]})]})})},r5=({isOpen:n,onClose:a,memories:r,memorySummaries:o})=>{const[c,d]=v.useState([]),[m,f]=v.useState("all"),[h,p]=v.useState("all"),[b,g]=v.useState(!1),[w,N]=v.useState(0),[j,k]=v.useState([]),_=["探索","战斗","商城","医馆","悬赏","培育","商业","声望","公告","大牢","其他"];if(La.useEffect(()=>{if(n){const L=[];_.forEach(T=>{r[T].forEach(P=>{L.push({id:P.id,category:T,type:"实时记录",title:P.title,content:P.content,selected:!1})})}),_.forEach(T=>{o[T].small.forEach(P=>{L.push({id:P.id,category:T,type:"小总结",title:P.title,content:P.content,selected:!1})})}),_.forEach(T=>{o[T].large.forEach(P=>{L.push({id:P.id,category:T,type:"大总结",title:P.title,content:P.content,selected:!1})})}),d(L),k([]),N(0)}},[n]),!n)return null;const C=c.filter(L=>!(m!=="all"&&L.category!==m||h!=="all"&&L.type!==h)),S=C.filter(L=>L.selected).length,D=L=>{d(T=>T.map(P=>P.id===L?{...P,selected:!P.selected}:P))},E=()=>{const L=C.every(T=>T.selected);d(T=>T.map(P=>C.some(M=>M.id===P.id)?{...P,selected:!L}:P))},A=async()=>{const L=c.filter(M=>M.selected);if(L.length===0){alert("请至少选择一个条目进行导出");return}g(!0),N(0),k([]);let T=0,P=0;for(let M=0;M<L.length;M++){const R=L[M],Q=Math.round((M+1)/L.length*100);N(Q);try{const Z=R.type==="大总结"?"large":"small";await up({title:R.title,content:R.content},R.category,Z)?(T++,k(H=>[...H,`✓ 成功导出: ${R.title}`])):(P++,k(H=>[...H,`✗ 导出失败: ${R.title}`]))}catch(Z){P++,k(G=>[...G,`✗ 导出错误: ${R.title} - ${Z.message}`])}M<L.length-1&&await new Promise(Z=>setTimeout(Z,200))}k(M=>[...M,"",`导出完成！成功: ${T}，失败: ${P}`]),g(!1)},z=L=>({探索:"fa-map-location-dot",战斗:"fa-crossed-swords",商城:"fa-store",医馆:"fa-stethoscope",悬赏:"fa-book-skull",培育:"fa-dna",商业:"fa-building",声望:"fa-star",公告:"fa-bullhorn",大牢:"fa-dungeon",其他:"fa-ellipsis"})[L],I=L=>{switch(L){case"实时记录":return"text-amber-300 bg-amber-600/20 border-amber-600/30";case"小总结":return"text-purple-300 bg-purple-600/20 border-purple-600/30";case"大总结":return"text-indigo-300 bg-indigo-600/20 border-indigo-600/30";default:return"text-gray-300 bg-gray-600/20 border-gray-600/30"}};return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[70] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border border-xianxia-gold-600 bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 w-full max-w-5xl h-[85vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:L=>L.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20 border-b border-stone-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-book-bookmark text-2xl text-gradient-gold"}),e.jsx("h2",{className:"text-2xl font-bold text-gradient-gold text-shadow-glow font-serif",children:"批量导出至世界书"})]}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 hover:border-xianxia-gold-500 text-gray-400 hover:text-xianxia-gold-400 transition-all duration-200 flex items-center justify-center group",children:e.jsx("i",{className:"fa-solid fa-times text-xl group-hover:rotate-90 transition-transform duration-200"})})]}),e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-stone-700/50 bg-black/10",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"分类:"}),e.jsxs("select",{value:m,onChange:L=>f(L.target.value),className:"px-3 py-1 bg-stone-700/50 border border-stone-600 rounded text-white text-sm focus:outline-none focus:border-xianxia-gold-500",children:[e.jsx("option",{value:"all",children:"全部"}),_.map(L=>e.jsx("option",{value:L,children:L},L))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"类型:"}),e.jsxs("select",{value:h,onChange:L=>p(L.target.value),className:"px-3 py-1 bg-stone-700/50 border border-stone-600 rounded text-white text-sm focus:outline-none focus:border-xianxia-gold-500",children:[e.jsx("option",{value:"all",children:"全部"}),e.jsx("option",{value:"实时记录",children:"实时记录"}),e.jsx("option",{value:"小总结",children:"小总结"}),e.jsx("option",{value:"大总结",children:"大总结"})]})]}),e.jsx("button",{onClick:E,className:"px-3 py-1 bg-blue-600/80 hover:bg-blue-500/90 text-white text-sm rounded transition-all",children:C.every(L=>L.selected)?"取消全选":"全选当前"}),e.jsxs("span",{className:"text-sm text-gray-400 ml-auto",children:["已选择: ",e.jsx("span",{className:"text-xianxia-gold-400 font-bold",children:S})," / ",C.length]})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto scrollbar-xianxia p-4",children:C.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx("i",{className:"fa-solid fa-inbox text-6xl mb-4 opacity-30"}),e.jsx("p",{className:"text-lg",children:"暂无符合条件的记忆"})]}):e.jsx("div",{className:"space-y-2",children:C.map(L=>e.jsx("div",{className:`glass-morphism p-3 rounded-lg border transition-all duration-200 cursor-pointer ${L.selected?"border-xianxia-gold-500/70 bg-xianxia-gold-900/20":"border-stone-700/50 hover:border-stone-600"}`,onClick:()=>D(L.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:L.selected,onChange:()=>{},className:"mt-1 w-5 h-5 rounded border-stone-600 bg-stone-700/50 text-xianxia-gold-500 focus:ring-xianxia-gold-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:`fa-solid ${z(L.category)} text-sm`}),e.jsx("span",{className:"text-sm text-gray-400",children:L.category}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border ${I(L.type)}`,children:L.type})]}),e.jsx("h4",{className:"text-white font-semibold mb-1",children:L.title}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:L.content})]})]})},L.id))})}),j.length>0&&e.jsx("div",{className:"flex-shrink-0 max-h-32 overflow-y-auto scrollbar-xianxia p-4 bg-black/30 border-t border-stone-700/50",children:e.jsx("div",{className:"space-y-1",children:j.map((L,T)=>e.jsx("div",{className:`text-xs ${L.startsWith("✓")?"text-green-400":L.startsWith("✗")?"text-red-400":"text-gray-400"}`,children:L},T))})}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-stone-700/50 bg-black/20",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-400",children:b?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-xianxia-gold-400"}),e.jsxs("span",{children:["导出中... ",w,"%"]}),e.jsx("div",{className:"w-48 h-2 bg-stone-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-xianxia-gold-600 to-xianxia-gold-400 transition-all duration-300",style:{width:`${w}%`}})})]}):e.jsx("span",{children:"将导出到世界书【仙侠卡牌RPG记忆库】"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,disabled:b,className:"px-4 py-2 bg-stone-700/50 hover:bg-stone-700 text-gray-300 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"关闭"}),e.jsxs("button",{onClick:A,disabled:b||S===0,className:"px-4 py-2 bg-gradient-to-r from-xianxia-gold-600 to-xianxia-gold-700 hover:from-xianxia-gold-500 hover:to-xianxia-gold-600 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-upload"}),e.jsxs("span",{children:["导出 (",S,")"]})]})]})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"})]})})},l5=({isOpen:n,onClose:a,memories:r,memorySummaries:o,summarySettings:c,onClearCategory:d,onDeleteEntry:m,onDeleteSummary:f,onManualSummary:h,onUpdateSettings:p,gameState:b,onVectorConfigSave:g})=>{const[w,N]=v.useState("探索"),[j,k]=v.useState("realtime"),[_,C]=v.useState(!1),[S,D]=v.useState(!1),[E,A]=v.useState(1),[z,I]=v.useState(1),[L,T]=v.useState("small"),[P,M]=v.useState(null),[R,Q]=v.useState(!1),[Z,G]=v.useState(!1),[H,O]=v.useState(!1);if(!n)return null;const U=["探索","战斗","商城","医馆","悬赏","培育","商业","声望","公告","大牢","其他"],te=r[w],ie=o[w].small,B=o[w].large,W=xe=>({探索:"fa-map-location-dot",战斗:"fa-crossed-swords",商城:"fa-store",医馆:"fa-stethoscope",悬赏:"fa-book-skull",培育:"fa-dna",商业:"fa-building",声望:"fa-star",公告:"fa-bullhorn",大牢:"fa-dungeon",其他:"fa-ellipsis"})[xe],ne=()=>{confirm(`确定要清空【${w}】类别的所有实时记忆吗？`)&&d(w)},X=()=>{const xe=j==="realtime"?te:ie;if(xe.length===0){alert("当前类别没有内容可以总结");return}A(1),I(xe.length),T(j==="realtime"?"small":"large"),D(!0)},J=()=>{const xe=j==="realtime"?te:ie;if(E<1||z>xe.length||E>z){alert("请输入有效的范围");return}h(w,E-1,z-1,L),D(!1)},re=async(xe,he)=>{const et=(he==="small"?ie:B).find(Re=>Re.id===xe);if(!et){alert("未找到要保存的总结");return}M(xe);try{const Re=await up({title:et.title,content:et.content},w,he);alert(Re?"已成功保存到世界书【仙侠卡牌RPG记忆库】！":"保存失败，请查看控制台获取详细信息")}catch(Re){console.error("保存到世界书时出错:",Re),alert("保存失败："+Re.message)}finally{M(null)}},pe=()=>e.jsx("div",{className:"space-y-4",children:te.map((xe,he)=>e.jsx(e5,{entry:xe,index:he,activeCategory:w,onDeleteEntry:m},xe.id))}),me=(xe,he)=>e.jsx("div",{className:"space-y-4",children:xe.map((Se,et)=>e.jsxs("div",{className:"glass-morphism p-5 rounded-lg border border-purple-700/50 hover:border-purple-500/50 transition-all duration-300 group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:`px-3 py-1 ${he==="small"?"bg-gradient-to-r from-purple-600/20 to-purple-700/20 text-purple-300 border-purple-600/30":"bg-gradient-to-r from-indigo-600/20 to-indigo-700/20 text-indigo-300 border-indigo-600/30"} text-xs rounded-full border`,children:[he==="small"?"小总结":"大总结"," #",et+1]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["基于记忆 ",Se.startIndex+1," - ",Se.endIndex+1]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("i",{className:"fa-solid fa-clock"}),Se.timestamp]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>re(Se.id,he),disabled:P===Se.id,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-blue-400 hover:text-blue-300 p-2 disabled:opacity-50 disabled:cursor-not-allowed",title:"保存到世界书",children:P===Se.id?e.jsx("i",{className:"fa-solid fa-spinner fa-spin"}):e.jsx("i",{className:"fa-solid fa-book-bookmark"})}),e.jsx("button",{onClick:()=>f(w,Se.id,he),className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-red-400 hover:text-red-300 p-2",title:"删除此总结",children:e.jsx("i",{className:"fa-solid fa-trash-alt"})})]})]}),e.jsx("div",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-wrap bg-gradient-to-br from-purple-900/20 to-indigo-900/20 p-4 rounded border border-purple-700/30",children:Se.content})]},Se.id))}),ae=()=>j==="realtime"?te.length>0?pe():e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500",children:[e.jsx("i",{className:`fa-solid ${W(w)} text-6xl mb-4 opacity-30`}),e.jsx("p",{className:"text-lg",children:"此类别暂无记忆"}),e.jsx("p",{className:"text-sm mt-2",children:"在游戏中的各种活动会自动记录在这里"})]}):j==="small-summary"?ie.length>0?me(ie,"small"):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500",children:[e.jsx("i",{className:"fa-solid fa-layer-group text-6xl mb-4 opacity-30"}),e.jsx("p",{className:"text-lg",children:"暂无小总结"}),e.jsx("p",{className:"text-sm mt-2",children:c.autoSummaryEnabled?`每 ${c.smallSummaryInterval} 条记忆会自动生成小总结`:"请在设置中开启自动总结，或使用手动总结功能"})]}):B.length>0?me(B,"large"):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500",children:[e.jsx("i",{className:"fa-solid fa-book text-6xl mb-4 opacity-30"}),e.jsx("p",{className:"text-lg",children:"暂无大总结"}),e.jsx("p",{className:"text-sm mt-2",children:c.autoSummaryEnabled?`每 ${c.largeSummaryInterval} 条小总结会自动生成大总结`:"请在设置中开启自动总结，或使用手动总结功能"})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border border-xianxia-gold-600 bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 w-full max-w-6xl h-[90vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:xe=>xe.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20 border-b border-stone-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-book-open text-2xl text-gradient-gold"}),e.jsx("h2",{className:"text-2xl font-bold text-gradient-gold text-shadow-glow font-serif",children:"记忆宝鉴"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>O(!0),className:"px-4 py-2 bg-gradient-to-r from-xianxia-gold-600/80 to-xianxia-gold-700/80 hover:from-xianxia-gold-500/90 hover:to-xianxia-gold-600/90 text-white text-sm rounded-lg transition-all duration-300 active:scale-95 border border-xianxia-gold-500/50 flex items-center gap-2",title:"批量导出到世界书",children:[e.jsx("i",{className:"fa-solid fa-book-bookmark"}),e.jsx("span",{children:"导出世界书"})]}),e.jsxs("button",{onClick:()=>G(!0),className:"px-4 py-2 bg-gradient-to-r from-indigo-600/80 to-indigo-700/80 hover:from-indigo-500/90 hover:to-indigo-600/90 text-white text-sm rounded-lg transition-all duration-300 active:scale-95 border border-indigo-500/50 flex items-center gap-2",title:"管理向量化记忆",children:[e.jsx("i",{className:"fa-solid fa-vector-square"}),e.jsx("span",{children:"向量化"})]}),e.jsxs("button",{onClick:()=>Q(!0),className:"px-4 py-2 bg-gradient-to-r from-purple-600/80 to-purple-700/80 hover:from-purple-500/90 hover:to-purple-600/90 text-white text-sm rounded-lg transition-all duration-300 active:scale-95 border border-purple-500/50 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-brain"}),e.jsx("span",{children:"语义搜索"})]}),e.jsxs("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-gradient-to-r from-blue-600/80 to-blue-700/80 hover:from-blue-500/90 hover:to-blue-600/90 text-white text-sm rounded-lg transition-all duration-300 active:scale-95 border border-blue-500/50 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-cog"}),e.jsx("span",{children:"总结设置"})]}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 hover:border-xianxia-gold-500 text-gray-400 hover:text-xianxia-gold-400 transition-all duration-200 flex items-center justify-center group",children:e.jsx("i",{className:"fa-solid fa-times text-xl group-hover:rotate-90 transition-transform duration-200"})})]})]}),e.jsx("div",{className:"flex-shrink-0 px-4 py-2 flex space-x-2 border-b border-stone-700 overflow-x-auto scrollbar-xianxia bg-black/10",children:U.map(xe=>{const he=r[xe].length;return e.jsxs("button",{onClick:()=>N(xe),className:`relative px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 whitespace-nowrap flex items-center gap-2 ${w===xe?"bg-amber-600/30 text-amber-300 border border-amber-500/50 shadow-glow-gold":"bg-transparent text-gray-400 hover:bg-stone-700/50 hover:text-amber-300"}`,children:[e.jsx("i",{className:`fa-solid ${W(xe)}`}),e.jsx("span",{children:xe}),he>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-amber-600/30 text-amber-300 text-xs rounded-full",children:he})]},xe)})}),e.jsxs("div",{className:"flex-shrink-0 px-4 py-2 flex space-x-2 border-b border-stone-700/50 bg-black/10",children:[e.jsxs("button",{onClick:()=>k("realtime"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 flex items-center gap-2 ${j==="realtime"?"bg-gradient-to-r from-amber-600/40 to-amber-700/40 text-amber-300 border border-amber-500/50":"bg-stone-700/30 text-gray-400 hover:bg-stone-700/50 hover:text-amber-300"}`,children:[e.jsx("i",{className:"fa-solid fa-stream"}),e.jsx("span",{children:"实时记录"}),e.jsx("span",{className:"px-2 py-0.5 bg-black/30 text-xs rounded-full",children:te.length})]}),e.jsxs("button",{onClick:()=>k("small-summary"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 flex items-center gap-2 ${j==="small-summary"?"bg-gradient-to-r from-purple-600/40 to-purple-700/40 text-purple-300 border border-purple-500/50":"bg-stone-700/30 text-gray-400 hover:bg-stone-700/50 hover:text-purple-300"}`,children:[e.jsx("i",{className:"fa-solid fa-layer-group"}),e.jsx("span",{children:"小总结"}),e.jsx("span",{className:"px-2 py-0.5 bg-black/30 text-xs rounded-full",children:ie.length})]}),e.jsxs("button",{onClick:()=>k("large-summary"),className:`px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 flex items-center gap-2 ${j==="large-summary"?"bg-gradient-to-r from-indigo-600/40 to-indigo-700/40 text-indigo-300 border border-indigo-500/50":"bg-stone-700/30 text-gray-400 hover:bg-stone-700/50 hover:text-indigo-300"}`,children:[e.jsx("i",{className:"fa-solid fa-book"}),e.jsx("span",{children:"大总结"}),e.jsx("span",{className:"px-2 py-0.5 bg-black/30 text-xs rounded-full",children:B.length})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto scrollbar-xianxia p-6",children:ae()}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-stone-700/50 bg-black/20",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[j==="realtime"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-gray-400",children:["共 ",te.length," 条记忆"]}),c.autoSummaryEnabled&&e.jsxs("span",{className:"text-xs text-purple-400",children:["每 ",c.smallSummaryInterval," 条自动总结"]})]}),j==="small-summary"&&e.jsxs("span",{className:"text-sm text-purple-400",children:["共 ",ie.length," 条小总结"]}),j==="large-summary"&&e.jsxs("span",{className:"text-sm text-indigo-400",children:["共 ",B.length," 条大总结"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[(j==="realtime"||j==="small-summary")&&e.jsxs("button",{onClick:X,className:"px-4 py-2 bg-gradient-to-r from-purple-600/80 to-purple-700/80 hover:from-purple-500/90 hover:to-purple-600/90 text-white text-sm rounded-lg transition-all duration-300 active:scale-95 border border-purple-500/50 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-wand-magic-sparkles"}),e.jsx("span",{children:"手动总结"})]}),j==="realtime"&&te.length>0&&e.jsxs("button",{onClick:ne,className:"px-4 py-2 bg-gradient-to-r from-red-600/80 to-red-700/80 hover:from-red-500/90 hover:to-red-600/90 text-white text-sm rounded-lg transition-all duration-300 active:scale-95 border border-red-500/50",children:[e.jsx("i",{className:"fa-solid fa-broom mr-2"}),"清空此类别"]})]})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"})]})}),_&&e.jsx(n5,{isOpen:_,onClose:()=>C(!1),settings:c,onSave:p,gameState:b,onVectorConfigSave:g}),Z&&b&&e.jsx(a5,{isOpen:Z,onClose:()=>G(!1),category:w,realtimeMemories:te,smallSummaries:ie,largeSummaries:B,vectorConfig:b.vectorConfig}),R&&b&&e.jsx(t5,{isOpen:R,onClose:()=>Q(!1),gameState:b,onSaveThreshold:xe=>{g&&g({...b.vectorConfig,similarityThreshold:xe})}}),H&&e.jsx(r5,{isOpen:H,onClose:()=>O(!1),memories:r,memorySummaries:o}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[60] flex items-center justify-center p-4",onClick:()=>D(!1),children:e.jsxs("div",{className:"bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 rounded-xl p-6 max-w-md w-full border border-purple-500/50 shadow-2xl",onClick:xe=>xe.stopPropagation(),children:[e.jsxs("h3",{className:"text-xl font-bold text-purple-300 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-wand-magic-sparkles"}),"手动生成总结"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"总结类型"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T("small"),disabled:j!=="realtime",className:`flex-1 px-4 py-2 rounded-lg transition-all ${L==="small"?"bg-purple-600 text-white":"bg-stone-700/50 text-gray-400 hover:bg-stone-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:"小总结"}),e.jsx("button",{onClick:()=>T("large"),disabled:j==="large-summary",className:`flex-1 px-4 py-2 rounded-lg transition-all ${L==="large"?"bg-indigo-600 text-white":"bg-stone-700/50 text-gray-400 hover:bg-stone-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:"大总结"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-2",children:["范围 (共 ",j==="realtime"?te.length:ie.length," 条)"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"从第"}),e.jsx("input",{type:"number",min:"1",max:j==="realtime"?te.length:ie.length,value:E,onChange:xe=>A(Math.max(1,Math.min(j==="realtime"?te.length:ie.length,parseInt(xe.target.value)||1))),className:"w-full mt-1 px-3 py-2 bg-stone-700/50 border border-stone-600 rounded text-white focus:outline-none focus:border-purple-500"})]}),e.jsx("span",{className:"text-gray-500 mt-5",children:"-"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"到第"}),e.jsx("input",{type:"number",min:"1",max:j==="realtime"?te.length:ie.length,value:z,onChange:xe=>I(Math.max(1,Math.min(j==="realtime"?te.length:ie.length,parseInt(xe.target.value)||1))),className:"w-full mt-1 px-3 py-2 bg-stone-700/50 border border-stone-600 rounded text-white focus:outline-none focus:border-purple-500"})]}),e.jsx("span",{className:"text-gray-500 mt-5",children:"条"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-4 py-2 bg-stone-700/50 hover:bg-stone-700 text-gray-300 rounded-lg transition-all",children:"取消"}),e.jsxs("button",{onClick:J,className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white rounded-lg transition-all flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-check"}),"生成总结"]})]})]})]})})]})},Vr={enabled:!0,maxResults:5,minSimilarity:.7,depth:0,shouldScan:!0},Ci={manualInject:!1,includeConstant:!1,includeSelective:!1},cu={useCurrentPreset:!0,extractSystemPrompts:!1},Xl={enabled:!0,include:{playerInfo:!0,location:!0,party:!0,battleStatus:!0,reputation:!1},depth:0},o5={style:"detailed",showSimilarity:!0,showTimestamp:!0,showLocation:!0,showCharacters:!0,maxTextLength:void 0},i5={style:"compact",includeStats:!1},Yd={VECTOR_MEMORY:0,GAME_STATE:1,SYSTEM_PROMPT:2};class c5{async buildContext(a,r){var b,g,w,N,j;const o=Date.now(),c=[];let d=0,m=0,f=!1;if(((b=r.vectorMemory)==null?void 0:b.enabled)!==!1&&a.vectorConfig.enabled){const k={...Vr,...r.vectorMemory},_=await this.buildVectorMemoryInject(a,r.userInput,k);_&&(c.push(_),d=((g=_.metadata)==null?void 0:g.memoryCount)||0)}if(((w=r.gameStateContext)==null?void 0:w.enabled)!==!1){const k={...Xl,...r.gameStateContext},_=this.buildGameStateInject(a,k);_&&(c.push(_),f=!0)}if((N=r.worldbook)!=null&&N.manualInject){const k={...Ci,...r.worldbook},_=await this.buildWorldbookInject(a,r.userInput,k);_&&(c.push(_),m=((j=_.metadata)==null?void 0:j.entryCount)||0)}const h=this.enhanceUserInput(r.userInput,a),p=Date.now()-o;return{injects:c,enhancedUserInput:h,metadata:{vectorMemoryCount:d,worldbookEntriesCount:m,gameStateInjected:f,buildTime:p}}}async buildVectorMemoryInject(a,r,o){try{const c=await yi.retrieveRelevantMemories(a,r,o.maxResults);if(c.relevantMemories.length===0)return console.log("[上下文构建] 未找到相关向量记忆"),null;const d=this.formatVectorMemories(c.relevantMemories,o5);return console.log(`[上下文构建] 注入 ${c.relevantMemories.length} 条向量记忆`),{id:"vector_memory_context",role:"system",content:d,position:"in_chat",depth:o.depth,order:Yd.VECTOR_MEMORY,should_scan:o.shouldScan,metadata:{memoryCount:c.relevantMemories.length}}}catch(c){return console.error("[上下文构建] 向量记忆检索失败:",c),null}}buildGameStateInject(a,r){try{const o=this.formatGameState(a,r,i5);return o?(console.log("[上下文构建] 注入游戏状态上下文"),{id:"game_state_context",role:"system",content:o,position:"in_chat",depth:r.depth,order:Yd.GAME_STATE,should_scan:!0}):null}catch(o){return console.error("[上下文构建] 游戏状态构建失败:",o),null}}async buildWorldbookInject(a,r,o){if(typeof TavernHelper>"u")return null;try{const c=o.worldbookNames||TavernHelper.getWorldbookNames();if(c.length===0)return null;const d=[];for(const m of c)try{const f=await TavernHelper.getWorldbook(m);for(const h of f)if(h.enabled&&(o.includeConstant&&h.strategy.type==="constant"&&d.push(`【${h.name}】
${h.content}`),o.includeSelective&&h.strategy.type==="selective")){const p=h.strategy.keys||[],b=r.toLowerCase();for(const g of p)if(typeof g=="string"&&b.includes(g.toLowerCase())){d.push(`【${h.name}】
${h.content}`);break}}}catch(f){console.warn(`[上下文构建] 无法读取世界书 ${m}:`,f)}return d.length===0?null:(console.log(`[上下文构建] 手动注入 ${d.length} 条世界书条目`),{id:"worldbook_manual_inject",role:"system",content:`=== 世界书信息 ===

${d.join(`

`)}

===================`,position:"in_chat",depth:1,order:Yd.SYSTEM_PROMPT,should_scan:!1,metadata:{entryCount:d.length}})}catch(c){return console.error("[上下文构建] 世界书构建失败:",c),null}}formatVectorMemories(a,r){var c;if(a.length===0)return"";const o=[];if(r.style==="detailed"){o.push("=== 相关历史记忆 ==="),o.push("");for(const d of a){const m=d.memory;o.push(`【记忆 #${d.rank}】`),r.showTimestamp&&m.metadata.timestamp&&o.push(`时间：${m.metadata.timestamp}`),r.showLocation&&m.metadata.location&&o.push(`地点：${m.metadata.location}`),r.showCharacters&&((c=m.metadata.involvedCharacters)!=null&&c.length)&&o.push(`角色：${m.metadata.involvedCharacters.join("、")}`),r.showSimilarity&&o.push(`相关度：${(d.similarity*100).toFixed(1)}%`),o.push("");let f=m.text;r.maxTextLength&&f.length>r.maxTextLength&&(f=f.substring(0,r.maxTextLength)+"..."),o.push(f),o.push("")}o.push("===================")}else if(r.style==="compact"){o.push("=== 相关记忆 ===");for(const d of a){let m=d.memory.text;r.maxTextLength&&m.length>r.maxTextLength&&(m=m.substring(0,r.maxTextLength)+"...");const f=r.showSimilarity?` [${(d.similarity*100).toFixed(0)}%]`:"";o.push(`• ${m}${f}`)}o.push("===============")}else if(r.style==="list")for(const d of a){let m=d.memory.text;r.maxTextLength&&m.length>r.maxTextLength&&(m=m.substring(0,r.maxTextLength)+"..."),o.push(m)}return o.join(`
`)}formatGameState(a,r,o){const c=[];if((o.style==="full"||o.style==="compact")&&(c.push("=== 当前游戏状态 ==="),c.push("")),r.include.playerInfo&&(c.push(`【玩家】${a.playerProfile.name}`),a.playerProfile.title&&c.push(`称号：${a.playerProfile.title}`),o.includeStats&&c.push(`灵石：${a.playerProfile.spiritStones}`),c.push("")),r.include.location&&(c.push(`【位置】${a.exploration.location}`),c.push(`【时间】${a.exploration.time}`),c.push("")),r.include.party){const d=[...a.playerProfile.maleParty,...a.playerProfile.femaleParty];if(d.length>0){c.push("【当前队伍】");for(const m of d)o.style==="full"?c.push(`  • ${m.name} (${m.realm}) - 生命:${m.baseAttributes.hp}/${m.baseAttributes.maxHp}`):c.push(`  • ${m.name} (${m.realm})`);c.push("")}}if(r.include.battleStatus&&a.mode==="battle"&&a.battle&&(c.push("【战斗状态】"),c.push(`己方：${a.battle.playerParty.map(d=>d.card.name).join("、")}`),c.push(`敌方：${a.battle.opponentParty.map(d=>d.card.name).join("、")}`),c.push(`回合：${a.battle.turn==="player"?"玩家回合":"对手回合"}`),c.push("")),r.include.reputation&&o.style==="full"){const d=a.playerProfile.reputation;c.push(`【声望】${d.level} (${d.score})`),d.title&&c.push(`当前称号：${d.title}`),c.push("")}return(o.style==="full"||o.style==="compact")&&c.push("==================="),c.join(`
`)}enhanceUserInput(a,r){const o=[];return r.mode==="battle"?o.push("请基于当前战斗情况生成内容"):o.push("请基于当前探索情况生成内容"),r.vectorConfig.enabled&&o.push("请确保内容与上述历史记忆保持一致"),o.length===0?a:`${a}

（${o.join("，")}）`}validateInjects(a){const r=[];for(const o of a)o.id||r.push("注入提示词缺少ID"),o.content||r.push(`注入提示词 ${o.id} 内容为空`),["system","user","assistant"].includes(o.role)||r.push(`注入提示词 ${o.id} 角色无效: ${o.role}`),o.position==="in_chat"&&o.depth===void 0&&r.push(`注入提示词 ${o.id} 使用in_chat位置但未指定深度`);return{valid:r.length===0,errors:r}}}const Wf=new c5;class d5{async generate(a,r){if(typeof TavernHelper>"u")throw new Error("TavernHelper未定义，无法使用AI生成功能");console.log("[AI生成] 开始生成，用户输入:",r.userInput);try{const o=await Wf.buildContext(a,r);console.log("[AI生成] 上下文构建完成:",{注入数量:o.injects.length,向量记忆:o.metadata.vectorMemoryCount,世界书条目:o.metadata.worldbookEntriesCount,游戏状态:o.metadata.gameStateInjected?"是":"否",构建耗时:`${o.metadata.buildTime}ms`});const c=Wf.validateInjects(o.injects);if(!c.valid)throw console.error("[AI生成] 注入验证失败:",c.errors),new Error(`注入验证失败: ${c.errors.join(", ")}`);const d={user_input:o.enhancedUserInput,should_stream:r.shouldStream||!1,max_chat_history:r.maxChatHistory||"all"};o.injects.length>0&&(d.injects=o.injects.map(f=>({id:f.id,role:f.role,content:f.content,position:f.position,depth:f.depth,order:f.order,should_scan:f.should_scan}))),r.customApi&&(d.custom_api=r.customApi),r.generationId&&(d.generation_id=r.generationId),console.log("[AI生成] 调用TavernHelper.generate...");const m=await TavernHelper.generate(d);return console.log("[AI生成] 生成完成，长度:",m.length),m}catch(o){throw console.error("[AI生成] 生成失败:",o),o}}async quickGenerate(a,r,o={}){const c={userInput:r,shouldStream:o.shouldStream,vectorMemory:o.enableVectorMemory!==!1?Vr:{...Vr,enabled:!1},gameStateContext:o.enableGameState!==!1?Xl:{...Xl,enabled:!1},worldbook:Ci,preset:cu};return this.generate(a,c)}async generateWithPresetOnly(a,r={}){if(typeof TavernHelper>"u")throw new Error("TavernHelper未定义");console.log("[AI生成] 仅使用预设生成");const o={user_input:a,should_stream:r.shouldStream||!1,max_chat_history:r.maxChatHistory||"all"};return r.customApi&&(o.custom_api=r.customApi),await TavernHelper.generate(o)}async batchGenerate(a,r,o={}){const c=[];for(const d of r)try{const m={...o,userInput:d},f=await this.generate(a,m);c.push(f)}catch(m){console.error(`[AI生成] 批量生成失败，提示词: ${d}`,m),c.push("")}return c}async stopGeneration(a){if(typeof TavernHelper>"u"||typeof stopGenerationById>"u")return console.warn("[AI生成] 停止生成功能不可用"),!1;try{return await stopGenerationById(a)}catch(r){return console.error("[AI生成] 停止生成失败:",r),!1}}async stopAllGenerations(){if(typeof TavernHelper>"u"||typeof stopAllGeneration>"u")return console.warn("[AI生成] 停止所有生成功能不可用"),!1;try{return await stopAllGeneration()}catch(a){return console.error("[AI生成] 停止所有生成失败:",a),!1}}onGenerationEvent(a,r){if(typeof eventOn>"u"||typeof iframe_events>"u")return console.warn("[AI生成] 事件系统不可用"),()=>{};let o;switch(a){case"started":o=iframe_events.GENERATION_STARTED;break;case"streaming":o=iframe_events.STREAM_TOKEN_RECEIVED_FULLY;break;case"completed":o=iframe_events.GENERATION_ENDED;break;default:return console.warn(`[AI生成] 未知事件类型: ${a}`),()=>{}}const c=d=>{r({type:a,generationId:d.generation_id||"",text:d.text||d,metadata:d})};return eventOn(o,c),()=>{console.log("[AI生成] 事件监听器移除（如果支持）")}}isAvailable(){return typeof TavernHelper<"u"&&typeof TavernHelper.generate=="function"}getCurrentPresetInfo(){if(typeof TavernHelper>"u")return null;try{return TavernHelper.getPreset("in_use")}catch(a){return console.error("[AI生成] 获取预设失败:",a),null}}async switchPreset(a){if(typeof TavernHelper>"u")return!1;try{return TavernHelper.loadPreset(a)}catch(r){return console.error("[AI生成] 切换预设失败:",r),!1}}getAvailablePresets(){if(typeof TavernHelper>"u")return[];try{return TavernHelper.getPresetNames()}catch(a){return console.error("[AI生成] 获取预设列表失败:",a),[]}}}const Gl=new d5;class u5{async generateWithEnhancedContext(a,r,o={}){console.log("[AI增强V2] 开始生成，选项:",o);const c={userInput:r,shouldStream:o.shouldStream,vectorMemory:o.includeVectorMemories!==!1?{...Vr,maxResults:o.maxVectorResults||Vr.maxResults,categories:o.categories}:{...Vr,enabled:!1},worldbook:o.includeWorldbook!==!1?Ci:{...Ci,manualInject:!1},preset:o.includePreset!==!1?cu:{...cu,useCurrentPreset:!1},gameStateContext:o.includeGameState!==!1?Xl:{...Xl,enabled:!1},customApi:o.customApi};return await Gl.generate(a,c)}async generateWithCustomAPI(a,r,o,c={}){return this.generateWithEnhancedContext(a,r,{...c,customApi:o,includePreset:!1,includeWorldbook:!1})}async quickGenerate(a,r,o=!1){return Gl.quickGenerate(a,r,{enableVectorMemory:!0,enableGameState:!0,shouldStream:o})}async generateWithVectorOnly(a,r,o=5){return this.generateWithEnhancedContext(a,r,{includeVectorMemories:!0,includeGameState:!1,maxVectorResults:o})}async generateByCategory(a,r,o,c=5){return this.generateWithEnhancedContext(a,r,{includeVectorMemories:!0,categories:o,maxVectorResults:c})}isAvailable(){return Gl.isAvailable()}getCurrentPreset(){return Gl.getCurrentPresetInfo()}onGeneration(a,r){return Gl.onGenerationEvent(a,r)}}const m5=new u5,x5={探索:["探索","发现","前往","到达","离开","进入","出发","地图","位置","区域","场景","奇遇","随机事件","遇见","路过","寻找","搜索","调查"],战斗:["战斗","攻击","防御","技能","释放","造成","受到","伤害","击败","胜利","失败","敌人","怪物","对手","竞技场","对决","挑战","回合","排行榜","榜单","排名","积分"],商城:["商城","抽卡","抽取","招募","购买","卡池","人物卡牌","装备","通用技能","兽宠","同人","灵感","召唤","天机","万象寻仙","百炼阁","万法楼","御兽斋","异界降临","神兵天成","大道顿悟","灵兽创生","法宝","防具","功法","灵兽","契约","锻造","领悟","创造"],医馆:["医馆","问诊","诊断","治疗","医治","症状","病情","药物","处方","康复","伤势","疾病","患者","病历","走火入魔"],悬赏:["悬赏","任务","委托","接取","完成","奖励","目标","追捕","调查","赏金","猎人","追踪","线索","千乳圣女"],培育:["培育","修炼","突破","提升","境界","灵力","功法","炼丹","炼器","成长","进阶","繁殖","孕育","育灵轩","监测","配种","后代"],商业:["商业","交易","出售","价格","灵石","商店","商人","买卖","交换","货物","店铺","收入","员工","经营","生意","青楼","角斗场","炼丹房","拍卖行","情报阁","监视","头牌","角斗士","奴隶"],声望:["声望","名声","威望","名气","事迹","名望","江湖","传闻","称号","侠义","恶行","风流","天机阁"],公告:["公告","宗门","世界","奇遇","通知","消息","天元","惊蛰","宗门排行","野榜","区域榜","世界榜"],大牢:["大牢","监狱","囚犯","审讯","刑法","狱卒","牢房","劳役","囚禁","关押","拷问","禁闭","越狱","赎金"],其他:[]},eh={exploration:"探索",map:"探索",battle:"战斗",arena:"战斗",shop:"商城",gacha:"商城",hospital:"医馆",consultation:"医馆",bounty:"悬赏",cultivation:"培育",business:"商业",surveillance:"商业",reputation:"声望",announcement:"公告",telepathy:"其他",interaction:"其他",party:"其他",inventory:"其他"};class f5{constructor(){this.currentScene="unknown",this.isEnabled=!0,this.eventListenersRegistered=!1}setMessageCallback(a){this.onMessageCallback=a}setCurrentScene(a){this.currentScene=a}setEnabled(a){this.isEnabled=a}categorizeMessage(a,r){if(r&&eh[r])return eh[r];let o=0,c="其他";for(const[d,m]of Object.entries(x5)){if(m.length===0)continue;let f=0;for(const h of m)a.includes(h)&&f++;f>o&&(o=f,c=d)}return c}handleCapturedMessage(a){if(!this.isEnabled||!this.onMessageCallback)return;const r=this.categorizeMessage(a.content,a.scene||this.currentScene);this.onMessageCallback(a,r)}registerEventListeners(){if(this.eventListenersRegistered){console.log("[AI消息捕获] 事件监听器已注册");return}if(typeof window>"u"||!window.eventOn){console.warn("[AI消息捕获] 未检测到SillyTavern环境，无法注册事件监听器");return}const a=window.eventOn,r=window.tavern_events,o=window.iframe_events;console.log("[AI消息捕获] 开始注册事件监听器..."),a(r.MESSAGE_RECEIVED,(c,d)=>{console.log(`[AI消息捕获] 接收到消息 #${c}, 类型: ${d||"unknown"}`);try{const m=window.getChatMessages;if(m){const f=m(-1);if(f&&f.length>0){const h=f[0];h.role==="assistant"&&this.handleCapturedMessage({content:h.message,timestamp:new Date().toISOString(),source:"ai",messageId:c,scene:this.currentScene})}}}catch(m){console.error("[AI消息捕获] 处理MESSAGE_RECEIVED事件时出错:",m)}}),a(r.GENERATION_ENDED,c=>{console.log(`[AI消息捕获] 生成结束 #${c}`)}),o&&o.GENERATION_ENDED&&a(o.GENERATION_ENDED,(c,d)=>{console.log(`[AI消息捕获] Iframe生成结束, ID: ${d}`),c&&c.trim()&&this.handleCapturedMessage({content:c,timestamp:new Date().toISOString(),source:"ai",scene:this.currentScene})}),this.eventListenersRegistered=!0,console.log("[AI消息捕获] 事件监听器注册完成")}captureMessage(a,r){this.handleCapturedMessage({content:a,timestamp:new Date().toISOString(),source:"ai",scene:r||this.currentScene})}cleanup(){typeof window<"u"&&window.eventClearAll&&console.log("[AI消息捕获] 清理事件监听器"),this.eventListenersRegistered=!1}}const Ke=new f5;async function h5(n){console.log("[榜单生成] 开始AI生成竞技场榜单..."),Ke.setCurrentScene("arena");try{const a=`你是一个修仙世界的竞技场榜单生成器。请根据当前游戏状态，生成真实、合理且有趣的竞技场排行榜。

要求：
1. 生成4个不同的榜单：宗门排行榜、野榜、区域榜、世界榜
2. 宗门排行榜包含5个子榜：总榜、核心弟子、内门弟子、外门弟子、杂役弟子
3. 每个榜单生成10-20个条目
4. 角色名字要符合修仙风格，富有想象力
5. 门派名称要多样化且符合修仙设定
6. 积分要合理分布，排名越高积分越高
7. 玩家当前排名：${n.playerProfile.arenaRank.tier} ${n.playerProfile.arenaRank.division}，积分：${n.playerProfile.arenaRank.points}

请生成JSON格式的榜单数据。`,r=`请生成完整的竞技场榜单数据。返回格式：
{
  "宗门排行榜": {
    "总榜": [{"rank": 1, "name": "角色名", "faction": "门派名", "points": 积分, "characterId": "id"}],
    "核心弟子": [...],
    "内门弟子": [...],
    "外门弟子": [...],
    "杂役弟子": [...]
  },
  "野榜": [...],
  "区域榜": [...],
  "世界榜": [...]
}

请确保：
- 每个榜单至少10个条目
- rank从1开始连续递增
- points按排名递减
- name和faction富有创意
- characterId使用"arena-npc-{随机数}"格式`;console.log("[榜单生成] 调用AI生成服务...");const o=await m5.generateWithEnhancedContext(n,r,{includeVectorMemories:!0,includePreset:!0,includeWorldbook:!0,includeGameState:!0,maxVectorResults:3,categories:["战斗","公告","声望"]});console.log("[榜单生成] AI响应长度:",o.length),console.log("[榜单生成] AI响应内容:",o.substring(0,500)),Ke.captureMessage(o,"arena");let c;try{const m=(o.match(/```json\s*([\s\S]*?)\s*```/)||o.match(/```\s*([\s\S]*?)\s*```/)||[null,o])[1]||o;c=JSON.parse(m.trim()),console.log("[榜单生成] 成功解析AI生成的榜单")}catch(d){console.error("[榜单生成] JSON解析失败，使用默认榜单:",d),c=th(n)}return c=p5(c,n),console.log("[榜单生成] 榜单生成完成"),c}catch(a){return console.error("[榜单生成] AI生成失败:",a),console.log("[榜单生成] 使用默认榜单作为降级方案"),th()}}function p5(n,a){const r={宗门排行榜:{总榜:[],核心弟子:[],内门弟子:[],外门弟子:[],杂役弟子:[]},野榜:[],区域榜:[],世界榜:[]};if(n.宗门排行榜){const o=n.宗门排行榜;r.宗门排行榜.总榜=ea(o.总榜||[]),r.宗门排行榜.核心弟子=ea(o.核心弟子||[]),r.宗门排行榜.内门弟子=ea(o.内门弟子||[]),r.宗门排行榜.外门弟子=ea(o.外门弟子||[]),r.宗门排行榜.杂役弟子=ea(o.杂役弟子||[])}return r.野榜=ea(n.野榜||[]),r.区域榜=ea(n.区域榜||[]),r.世界榜=ea(n.世界榜||[]),r}function ea(n){return Array.isArray(n)?n.filter(a=>a&&typeof a=="object").map((a,r)=>({rank:typeof a.rank=="number"?a.rank:r+1,name:String(a.name||`修士${r+1}`),faction:String(a.faction||"散修"),points:typeof a.points=="number"?a.points:1e3-r*10,characterId:String(a.characterId||`arena-npc-${Date.now()}-${r}`)})).sort((a,r)=>a.rank-r.rank):[]}function th(n){console.log("[榜单生成] 生成默认榜单...");const a=["天元宗","玄天派","灵霄殿","百花谷","剑宗","药王谷","魔音宗","雷霆阁"],r=["剑心","云澈","月华","星辰","风行","雷动","冰心","火烈","木灵","水柔","金刚","土厚","天机","地灵","人杰","鬼才","龙吟","凤鸣","虎啸","豹影","熊霸","鹰扬","蛇行","鹤舞"],o=(c,d)=>{const m=[];for(let f=0;f<c;f++)m.push({rank:f+1,name:r[Math.floor(Math.random()*r.length)]+["真人","仙子","道人","上人","尊者"][Math.floor(Math.random()*5)],faction:a[Math.floor(Math.random()*a.length)],points:d-f*Math.floor(Math.random()*50+20),characterId:`arena-npc-${Date.now()}-${f}`});return m};return{宗门排行榜:{总榜:o(15,5e3),核心弟子:o(12,4500),内门弟子:o(12,3500),外门弟子:o(12,2500),杂役弟子:o(10,1500)},野榜:o(15,4800),区域榜:o(15,4600),世界榜:o(20,6e3)}}const b5=({data:n})=>e.jsx("div",{className:"w-full h-full",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-300 table-fixed",children:[e.jsx("thead",{className:"text-xs text-amber-400 uppercase bg-slate-700/50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"p-3 w-16 text-center",children:"排名"}),e.jsx("th",{scope:"col",className:"p-3 w-2/5",children:"修士名号"}),e.jsx("th",{scope:"col",className:"p-3 w-2/5",children:"所属势力"}),e.jsx("th",{scope:"col",className:"p-3 w-1/5 text-right",children:"积分"})]})}),e.jsx("tbody",{children:n.map(a=>e.jsxs("tr",{className:"border-b border-slate-700/50 hover:bg-slate-800/40",children:[e.jsx("td",{className:"p-3 font-medium text-center",children:a.rank===1?"🥇":a.rank===2?"🥈":a.rank===3?"🥉":a.rank}),e.jsx("td",{className:"p-3 font-semibold text-white truncate",children:a.name}),e.jsx("td",{className:"p-3 truncate",children:a.faction}),e.jsx("td",{className:"p-3 font-mono text-right",children:a.points})]},a.rank))})]})}),sh=({label:n,isActive:a,onClick:r,isSubTab:o})=>e.jsx("button",{onClick:r,className:`px-4 transition-colors duration-200 font-semibold ${o?`py-1 text-sm rounded-md ${a?"bg-amber-600/80 text-white":"bg-stone-700/60 text-gray-300 hover:bg-stone-700"}`:`py-2 text-base rounded-t-lg ${a?"bg-stone-700/80 text-amber-400 border-b-2 border-amber-400":"bg-transparent text-gray-400 hover:bg-stone-700/50 hover:text-gray-200"}`}`,children:n}),g5=({playerProfile:n,leaderboards:a,onMatchFound:r,gameState:o,onLeaderboardsUpdate:c})=>{const[d,m]=v.useState("宗门排行榜"),[f,h]=v.useState("总榜"),[p,b]=v.useState(!1),[g,w]=v.useState(!1),N=n.arenaRank,j=a,k=()=>d==="宗门排行榜"?j[d][f]:j[d],_=()=>{b(!0),setTimeout(()=>{const S=Ss.filter(A=>A.id!==n.name),E={...S[Math.floor(Math.random()*S.length)],id:`arena-opponent-${Date.now()}`};r(E)},2500)},C=async()=>{w(!0);try{console.log("[竞技场] 开始AI生成榜单...");const S=await h5(o);c(S),console.log("[竞技场] 榜单刷新完成")}catch(S){console.error("[竞技场] 榜单刷新失败:",S),alert("榜单刷新失败，请查看控制台了解详情")}finally{w(!1)}};return e.jsxs("div",{className:"h-full flex flex-col md:flex-row font-serif text-gray-300 p-4 gap-4",children:[e.jsxs("div",{className:"flex-shrink-0 md:w-1/3 bg-black/20 p-6 rounded-lg flex flex-col items-center justify-center text-center border border-stone-700/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"我的战绩"}),e.jsx("div",{className:"text-6xl mb-4",children:N.tierIcon}),e.jsxs("p",{className:"text-3xl font-bold text-amber-400",children:[N.tier," ",N.division]}),e.jsxs("p",{className:"text-lg text-gray-400 mt-2",children:[N.points," 积分"]}),e.jsx("button",{onClick:_,disabled:p,className:"mt-8 bg-red-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-red-500 transition-colors shadow-lg w-40 h-14 flex items-center justify-center disabled:bg-red-800 disabled:cursor-wait",children:p?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-3"}),"匹配中..."]}):"寻找对战"})]}),e.jsxs("div",{className:"flex-grow bg-black/20 p-4 rounded-lg border border-stone-700/50 flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 border-b border-stone-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:"flex space-x-2",children:Object.keys(j).map(S=>e.jsx(sh,{label:S,isActive:d===S,onClick:()=>m(S)},S))}),e.jsxs("button",{onClick:C,disabled:g,className:"px-4 py-2 bg-amber-600/80 hover:bg-amber-600 text-white font-semibold rounded-lg transition-colors disabled:bg-gray-600 disabled:cursor-wait flex items-center gap-2",title:"AI生成新的榜单",children:[e.jsx("i",{className:`fa-solid fa-rotate ${g?"fa-spin":""}`}),g?"生成中...":"刷新榜单"]})]}),d==="宗门排行榜"&&e.jsx("div",{className:"px-2 py-2 flex space-x-2",children:Object.keys(j.宗门排行榜).map(S=>e.jsx(sh,{label:S,isActive:f===S,onClick:()=>h(S),isSubTab:!0},S))})]}),e.jsx("div",{className:"flex-grow overflow-y-auto mt-2",children:e.jsx(b5,{data:k()})})]})]})},y5=({playerProfile:n,setPlayerProfile:a,onViewPet:r})=>{const[o,c]=v.useState(null),[d,m]=v.useState(null),f=g=>{m(g)},h=(g,w)=>{if(!d||d.gender!==w)return;const N=JSON.parse(JSON.stringify(n)),j=w==="Male"?"maleParty":"femaleParty";N.maleParty=N.maleParty.filter(S=>S.id!==d.id),N.femaleParty=N.femaleParty.filter(S=>S.id!==d.id);const k=N[j],_=k[g];_?n[j].findIndex(D=>D.id===_.id)!==-1&&(k[g]=d):k[g]=d;const C=[...Array(4)].map((S,D)=>k[D]||null).filter(Boolean);N[j]=C,a(N),m(null)},p=(g,w)=>{const N=JSON.parse(JSON.stringify(n)),j=w==="Male"?"maleParty":"femaleParty";N[j]=N[j].filter(k=>k.id!==g),a(N)},b=({gender:g})=>{const w=g==="Male"?n.maleParty:n.femaleParty,N=n.cardCollection.filter(_=>_.gender===g),j=_=>w.some(C=>C.id===_),k=g==="Male"?{title:"乾元仙阵",subtitle:"男性修士编队",icon:"⚔️",bgGradient:"from-sky-900/40 via-blue-900/20 to-stone-900",borderColor:"border-sky-500/50",textColor:"text-sky-400",slotBg:"bg-sky-900/20",emptySlotBorder:"border-sky-700/30"}:{title:"坤灵仙阵",subtitle:"女性修士编队",icon:"🌸",bgGradient:"from-pink-900/40 via-purple-900/20 to-stone-900",borderColor:"border-pink-500/50",textColor:"text-pink-400",slotBg:"bg-pink-900/20",emptySlotBorder:"border-pink-700/30"};return e.jsxs("div",{className:`
                flex flex-col h-full rounded-xl overflow-hidden
                bg-gradient-to-br ${k.bgGradient}
                border-2 ${k.borderColor}
                shadow-2xl relative
            `,children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center bg-black/20",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:`font-bold text-2xl font-serif ${k.textColor} text-shadow-glow flex items-center gap-2`,children:[e.jsx("span",{children:k.icon})," ",k.title]}),e.jsx("p",{className:"text-xs text-stone-400 font-serif tracking-wider ml-8",children:k.subtitle})]}),e.jsxs("div",{className:"px-3 py-1 rounded-full bg-black/40 border border-white/10 text-sm font-mono text-stone-300",children:[w.length," / 4"]})]}),e.jsx("div",{className:"p-6 bg-black/20 relative",children:e.jsx("div",{className:"grid grid-cols-4 gap-4",children:[...Array(4)].map((_,C)=>e.jsxs("div",{className:"relative aspect-[3/4] group",children:[e.jsx("div",{onClick:()=>h(C,g),className:`
                                        w-full h-full rounded-lg transition-all duration-300 border-2 cursor-pointer
                                        flex flex-col items-center justify-center p-2 text-center relative overflow-hidden
                                        ${w[C]?`${pt(w[C].rarity)} bg-stone-800 shadow-lg`:`${k.emptySlotBorder} border-dashed ${k.slotBg} hover:bg-stone-800/50 hover:border-amber-500/50`}
                                    `,children:w[C]?e.jsxs(e.Fragment,{children:[w[C].artUrl?e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:w[C].artUrl,alt:w[C].name,className:"w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent"})]}):e.jsx("div",{className:"text-4xl mb-2 opacity-50",children:"👤"}),e.jsxs("div",{className:"relative z-10 mt-auto w-full",children:[e.jsx("p",{className:"font-bold font-serif text-white text-sm text-shadow-strong truncate",children:w[C].name}),e.jsx("p",{className:`text-[10px] font-semibold ${ke(w[C].rarity)} bg-black/60 rounded px-1 inline-block mt-1`,children:w[C].realm})]}),w[C].pet&&e.jsx("div",{className:"absolute top-1 left-1 bg-purple-900/80 p-1 rounded-full border border-purple-500/50 z-10",title:`兽宠: ${w[C].pet.name}`,children:e.jsx("span",{className:"text-[10px]",children:"🐾"})})]}):e.jsx("div",{className:"text-stone-500/50 text-4xl group-hover:text-amber-400/80 group-hover:scale-110 transition-all duration-300",children:"+"})}),w[C]&&e.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:S=>{S.stopPropagation(),p(w[C].id,g)},className:"bg-red-900 text-white w-6 h-6 rounded-full text-xs font-bold flex items-center justify-center hover:bg-red-600 border border-red-500 shadow-lg",title:"下阵",children:"×"}),e.jsx("button",{onClick:S=>{S.stopPropagation(),c(w[C])},className:"bg-sky-900 text-white w-6 h-6 rounded-full text-xs font-bold flex items-center justify-center hover:bg-sky-600 border border-sky-500 shadow-lg",title:"详情",children:"i"})]}),e.jsx("div",{className:"absolute -bottom-2 -right-2 w-5 h-5 bg-stone-900 border border-stone-700 rounded-full flex items-center justify-center text-[10px] text-stone-500 font-mono z-10 pointer-events-none",children:C+1})]},C))})}),e.jsxs("div",{className:"px-4 py-2 bg-stone-950/50 border-y border-stone-800 flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-stone-400 text-sm",children:"可用角色"}),e.jsx("span",{className:"text-xs text-stone-600",children:"点击选中，再点击空位上阵"})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4 custom-scrollbar bg-stone-950/30",children:e.jsx("div",{className:"grid grid-cols-3 gap-3",children:N.map(_=>{const C=j(_.id),S=(d==null?void 0:d.id)===_.id;return e.jsxs("button",{onClick:()=>f(_),onDoubleClick:()=>c(_),disabled:C,className:`
                                        relative p-2 rounded-lg border transition-all duration-300 flex flex-col items-center gap-2 aspect-[3/4]
                                        ${C?"opacity-50 grayscale border-stone-800 bg-stone-900 cursor-not-allowed":S?"ring-2 ring-amber-500 border-amber-500 bg-stone-800 scale-105 shadow-glow-gold z-10":`${pt(_.rarity)} ${bh(_.rarity,!0)} hover:scale-105 hover:shadow-lg`}
                                    `,children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-stone-900/50 flex items-center justify-center overflow-hidden border border-white/10 mt-1",children:_.artUrl?e.jsx("img",{src:_.artUrl,alt:_.name,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-lg",children:"👤"})}),e.jsxs("div",{className:"text-center w-full",children:[e.jsx("p",{className:"font-bold font-serif text-white text-xs truncate w-full px-1",children:_.name}),e.jsx("p",{className:`text-[9px] font-semibold ${ke(_.rarity)} mt-0.5`,children:_.realm})]}),C&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 rounded-lg",children:e.jsx("span",{className:"text-xs font-bold text-white bg-black/60 px-2 py-0.5 rounded border border-white/20 transform -rotate-12",children:"已上阵"})}),!C&&e.jsx("div",{onClick:D=>{D.stopPropagation(),c(_)},className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-stone-900/60 hover:bg-stone-700 text-stone-400 flex items-center justify-center text-[10px] opacity-0 hover:opacity-100 transition-opacity",children:"i"})]},_.id)})})})]})};return e.jsxs("div",{className:"p-4 sm:p-6 text-gray-300 font-serif h-full bg-[url('/assets/bg/pattern-dark.png')] bg-repeat",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full",children:[e.jsx(b,{gender:"Male"}),e.jsx(b,{gender:"Female"})]}),o&&e.jsx(Ei,{card:o,onClose:()=>c(null),playerProfile:n,setPlayerProfile:a,onViewPet:r})]})},v5=n=>!!(n&&n.gender&&n.skills),nh=n=>!!(n&&n.stats&&["Weapon","Armor","Accessory"].includes(n.type)),ah=n=>!!(n&&n.cost!==void 0&&n.mechanicsDescription),Jd=n=>!!(n&&n.skill&&!n.baseAttributes),rh=n=>n.type==="compensation",j5=({gender:n})=>{if(n==="Universal"||!n)return null;const a=n==="Male"?"♂":"♀",r=n==="Male"?"text-sky-400":"text-pink-400";return e.jsx("div",{className:`absolute top-1 right-1 w-5 h-5 rounded-full bg-black/50 flex items-center justify-center font-bold text-sm ${r}`,children:a})},N5=({item:n,isRevealed:a,onReveal:r})=>{const[o,c]=v.useState(!1);v.useEffect(()=>{a&&c(!0)},[a]);const d=()=>{o||(c(!0),r())},m=(()=>{if(rh(n))return e.jsx("div",{className:"text-4xl mb-1 text-yellow-400",children:"💎"});if(v5(n))return n.gender==="Male"?e.jsx("div",{className:"text-4xl mb-1 text-sky-400",children:"♂"}):e.jsx("div",{className:"text-4xl mb-1 text-pink-400",children:"♀"});if(Jd(n))return e.jsx("div",{className:"text-4xl mb-1",children:"🐾"});const f=nh(n)?"🗡️":ah(n)?"📜":"❓";return e.jsx("div",{className:"text-4xl mb-1",children:f})})();return e.jsx("div",{className:"w-full aspect-[3/4] [perspective:1000px] group",onClick:d,children:e.jsxs("div",{className:`relative w-full h-full transition-transform duration-700 [transform-style:preserve-3d] ${o?"[transform:rotateY(180deg)]":""}`,children:[e.jsx("div",{className:"absolute w-full h-full [backface-visibility:hidden] bg-slate-700 rounded-lg border-2 border-slate-500 flex items-center justify-center",children:e.jsx("div",{className:"text-4xl text-amber-400 opacity-50",children:"?"})}),e.jsxs("div",{className:`absolute w-full h-full [backface-visibility:hidden] [transform:rotateY(180deg)] bg-slate-800 rounded-lg border-2 flex flex-col justify-between p-2 text-center ${jg(n.rarity)} ${pt(n.rarity)}`,children:[(nh(n)||ah(n)||Jd(n))&&e.jsx(j5,{gender:Jd(n)?n.gender:n.genderLock}),e.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center",children:[m,e.jsx("p",{className:"text-sm font-bold text-white font-serif leading-tight",children:n.name}),rh(n)&&e.jsx("p",{className:"text-xs text-amber-300 mt-1 px-1",children:n.description})]}),e.jsxs("p",{className:`text-xs font-semibold ${ke(n.rarity)}`,children:["[",n.rarity,"]"]})]})]})})},w5=({results:n,onClose:a})=>{const[r,o]=v.useState(new Set),c=n.length===1,d=()=>{const h=new Set(n.map((p,b)=>b));o(h)},m=h=>{o(p=>new Set(p).add(h))},f=r.size===n.length;return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-slate-900/90 border border-slate-700 rounded-xl w-full max-w-4xl h-auto max-h-[90vh] shadow-2xl flex flex-col backdrop-blur-lg",onClick:h=>h.stopPropagation(),children:[e.jsx("h2",{className:"text-2xl font-bold text-white font-serif text-center p-4 flex-shrink-0",children:"招募结果"}),e.jsx("div",{className:`flex-grow p-4 overflow-y-auto ${c?"flex items-center justify-center":"grid grid-cols-5 gap-3"}`,children:n.map((h,p)=>e.jsx("div",{className:c?"w-48":"",children:e.jsx(N5,{item:h,isRevealed:r.has(p),onReveal:()=>m(p)})},p))}),e.jsxs("div",{className:"p-4 flex-shrink-0 flex justify-center items-center gap-4",children:[!c&&e.jsx("button",{onClick:d,disabled:f,className:"bg-slate-600 hover:bg-slate-500 text-white font-bold py-2 px-6 rounded-md transition-colors disabled:opacity-50",children:"全部展示"}),e.jsx("button",{onClick:a,disabled:!f,className:"bg-amber-600 hover:bg-amber-500 text-white font-bold py-2 px-8 rounded-md transition-colors disabled:opacity-50",children:"放入仓库"})]})]})})},lh=n=>!!(n&&n.gender&&n.skills),oh=n=>!!(n&&n.stats&&["Weapon","Armor","Accessory"].includes(n.type)),ih=n=>!!(n&&n.cost!==void 0&&n.mechanicsDescription),ch=n=>!!(n&&n.skill&&!n.baseAttributes),dh=n=>n.type==="compensation",uh=({label:n,isActive:a,onClick:r})=>e.jsx("button",{onClick:r,className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-all duration-300 ${a?"bg-gradient-to-b from-stone-700/90 to-stone-800/90 text-gradient-gold border-b-2 border-xianxia-gold-500 shadow-glow-gold":"bg-transparent text-gray-400 hover:bg-stone-700/50 hover:text-amber-300"}`,children:n}),Pr=({label:n,isActive:a,onClick:r})=>e.jsx("button",{onClick:r,className:`px-4 py-2 rounded-md transition-all duration-300 text-sm font-medium ${a?"bg-gradient-to-r from-amber-600/30 to-amber-700/30 text-gradient-gold border border-xianxia-gold-600/50 shadow-glow-gold":"bg-stone-800/60 text-gray-300 hover:bg-stone-700/80 hover:text-amber-300 border border-transparent"}`,children:n}),k5=({title:n,description:a,bannerUrl:r,onPullOne:o,onPullTen:c,isLoading:d,error:m,pullOneCost:f,pullTenCost:h,pullOneLabel:p="招募一次",pullTenLabel:b="招募十次",poolType:g})=>{const[w,N]=v.useState(!1),j=()=>g==="permanent"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:`${ke("神品")}`,children:"【神品】: 0.1%"}),e.jsx("p",{className:`${ke("圣品")}`,children:"【圣品】: 0.4%"}),e.jsx("p",{className:`${ke("仙品")}`,children:"【仙品】: 1.5%"}),e.jsx("p",{className:`${ke("绝品")}`,children:"【绝品】: 3%"}),e.jsx("p",{className:`${ke("珍品")}`,children:"【珍品】: 5%"}),e.jsx("p",{className:`${ke("优品")}`,children:"【优品】: 15%"}),e.jsx("p",{className:`${ke("良品")}`,children:"【良品】: 30%"}),e.jsx("p",{className:`${ke("凡品")}`,children:"【凡品】: 45%"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:`${ke("神品")}`,children:["【神品】: 1% ",e.jsx("span",{className:"text-amber-400",children:"↑"})]}),e.jsxs("p",{className:`${ke("圣品")}`,children:["【圣品】: 2% ",e.jsx("span",{className:"text-amber-400",children:"↑"})]}),e.jsxs("p",{className:`${ke("仙品")}`,children:["【仙品】: 5% ",e.jsx("span",{className:"text-amber-400",children:"↑"})]}),e.jsxs("p",{className:`${ke("绝品")}`,children:["【绝品】: 6% ",e.jsx("span",{className:"text-amber-400",children:"↑"})]}),e.jsxs("p",{className:`${ke("珍品")}`,children:["【珍品】: 8% ",e.jsx("span",{className:"text-amber-400",children:"↑"})]}),e.jsxs("p",{className:`${ke("优品")}`,children:["【优品】: 18% ",e.jsx("span",{className:"text-amber-400",children:"↑"})]}),e.jsx("p",{className:`${ke("良品")}`,children:"【良品】: 25%"}),e.jsx("p",{className:`${ke("凡品")}`,children:"【凡品】: 35%"})]});return e.jsxs("div",{className:"ornate-border border-xianxia-gold-600 bg-gradient-to-br from-stone-800/70 via-stone-900/80 to-black/70 rounded-lg overflow-hidden flex flex-col shadow-glow-gold",children:[e.jsxs("div",{className:"relative h-48",children:[e.jsx("img",{src:r,alt:n,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-stone-900/95 via-stone-800/50 to-transparent"}),e.jsx("h3",{className:"absolute bottom-4 left-4 text-2xl font-bold text-gradient-gold font-serif tracking-wider drop-shadow-lg text-shadow-glow",children:n})]}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[e.jsx("p",{className:"text-sm text-gray-200 flex-grow leading-relaxed",children:a}),e.jsx("div",{className:"text-right mt-2 mb-2",children:e.jsxs("button",{onClick:()=>N(!w),className:"text-xs text-stone-400 hover:text-amber-400 transition-colors duration-300",children:["概率公示 ",w?"▲":"▼"]})}),w&&e.jsxs("div",{className:"glass-morphism p-3 rounded-md mb-3 text-xs animate-slide-in border border-xianxia-gold-700/30",children:[j(),e.jsx("p",{className:"text-stone-500 mt-1 text-[10px]",children:"※ 十次招募必得【优品】或以上品质的物品。"}),g==="limited"&&e.jsx("p",{className:"text-amber-400 mt-1 text-[10px]",children:"※ 限定卡池高稀有度概率大幅提升！"})]}),m&&e.jsx("div",{className:"text-red-400 text-center text-sm my-2 animate-shake",children:m}),e.jsxs("div",{className:"mt-auto flex gap-3",children:[e.jsxs("button",{onClick:o,disabled:d,className:"flex-1 bg-gradient-to-br from-stone-700 to-stone-800 hover:from-stone-600 hover:to-stone-700 transition-all duration-300 rounded-md p-3 text-center border border-stone-500/50 shadow-lg disabled:opacity-50 disabled:cursor-wait hover:shadow-glow-blue",children:[e.jsx("p",{className:"font-bold text-white",children:d?"...":p}),e.jsxs("p",{className:"text-xs text-amber-400",children:["消耗 ",f," 灵石"]})]}),e.jsxs("button",{onClick:c,disabled:d,className:"flex-1 bg-gradient-to-br from-amber-600 via-amber-700 to-amber-800 hover:from-amber-500 hover:via-amber-600 hover:to-amber-700 transition-all duration-300 rounded-md p-3 text-center border border-xianxia-gold-500 shadow-glow-gold disabled:opacity-50 disabled:cursor-wait animate-shimmer",children:[e.jsx("p",{className:"font-bold text-white text-shadow-glow",children:d?"天机演算中...":b}),e.jsxs("p",{className:"text-xs text-amber-100",children:["消耗 ",h," 灵石"]})]})]})]})]})},S5=({playerProfile:n,setPlayerProfile:a})=>{const[r,o]=v.useState("抽取卡池"),[c,d]=v.useState("人物卡牌"),[m,f]=v.useState("regular"),[h,p]=v.useState(null),[b,g]=v.useState(!1),[w,N]=v.useState(null),j=["凡品","良品","优品","珍品","绝品","仙品","圣品","神品"],k={凡品:45,良品:30,优品:15,珍品:5,绝品:3,仙品:1.5,圣品:.4,神品:.1},_=(A,z=!1)=>{const I=k,L=[];let T=j;z&&(T=j.filter(R=>j.indexOf(R)>=2)),T.forEach(R=>{L.push({rarity:R,weight:I[R]})});const P=L.reduce((R,Q)=>R+Q.weight,0);let M=Math.random()*P;for(const R of L)if(M-=R.weight,M<=0)return R.rarity;return L[L.length-1].rarity},C=async(A,z)=>{const I=[];for(let Z=0;Z<A;Z++)I.push(_());A===10&&!I.some(Z=>j.indexOf(Z)>=2)&&(I[Math.floor(Math.random()*10)]=_(z,!0));const L=I.map(async Z=>{try{const H=j.indexOf(Z)>=5&&Math.random()<.5;switch(c){case"人物卡牌":return await O1(Z);case"装备":return await R1(Z);case"通用技能":return await I1(Z,"Universal");case"兽宠":return await G1(Z);default:throw new Error("Invalid gacha tab")}}catch(G){throw console.error(`生成物品失败 (稀有度: ${Z}):`,G),G}}),T=await Promise.all(L),P=[],M=c==="人物卡牌",R=c==="通用技能",Q=c==="兽宠";for(const Z of T){if(!Z)continue;let G=!1;if(M?G=n.cardCollection.some(H=>H.name===Z.name):R?G=n.universalSkills.some(H=>H.name===Z.name):Q&&(G=n.petCollection.some(H=>H.name===Z.name)),(M||R||Q)&&G){const H=(Oa[Z.rarity]||10)*5;P.push({type:"compensation",id:`comp-${Z.id}-${Date.now()}`,name:`重复的${M?"角色":Q?"兽宠":"技能"}`,rarity:Z.rarity,description:`转化为 ${H} 灵石`})}else P.push(Z)}return P},S=async(A,z,I)=>{if(n.spiritStones<A){N("灵石不足！"),setTimeout(()=>N(null),3e3);return}if(b)return;g(!0),N(null);const L=n.spiritStones;try{a({...n,spiritStones:L-A});const T=await C(z,I);p(T)}catch(T){console.error(T),N("天机紊乱，招募失败。灵石已退回。"),a({...n,spiritStones:L}),setTimeout(()=>N(null),4e3)}finally{g(!1)}},D=()=>{if(!h)return;console.log("🎁 开始处理抽卡结果，共",h.length,"个物品");const A=JSON.parse(JSON.stringify(n));h.forEach(z=>{if(console.log("📦 处理物品:",z.name,"稀有度:",z.rarity),console.log("🔍 物品类型检测:"),console.log("  - isCompensationItem:",dh(z)),console.log("  - isCharacterCard:",lh(z),"(需要gender和skills)"),console.log("  - isEquipment:",oh(z)),console.log("  - isSkill:",ih(z)),console.log("  - isPetCard:",ch(z)),console.log("  - 物品详情:",JSON.stringify(z,null,2)),dh(z)){const I=z.description.match(/\d+/);if(I){const L=parseInt(I[0],10);A.spiritStones+=L,console.log("💎 补偿灵石:",L)}}else if(lh(z)){const I={...z,id:`gen-char-${z.name.replace(/\s/g,"")}-${Date.now()}-${Math.random()}`};A.cardCollection.push(I),console.log("👤 添加角色到cardCollection:",z.name)}else if(oh(z)){const I={...z,id:`gen-equip-${z.name.replace(/\s/g,"")}-${Date.now()}-${Math.random()}`};A.equipmentInventory.push(I),console.log("⚔️ 添加装备到equipmentInventory:",z.name)}else if(ih(z)){const I={...z,id:`gen-skill-${z.name.replace(/\s/g,"")}-${Date.now()}-${Math.random()}`};A.universalSkills.push(I),console.log("📜 添加技能到universalSkills:",z.name)}else if(ch(z)){const I={...z,id:`gen-pet-${z.name.replace(/\s/g,"")}-${Date.now()}-${Math.random()}`};A.petCollection.push(I),console.log("🐾 添加宠物到petCollection:",z.name)}}),console.log("✅ 更新后的仓库状态:"),console.log("  - 角色数量:",A.cardCollection.length),console.log("  - 装备数量:",A.equipmentInventory.length),console.log("  - 技能数量:",A.universalSkills.length),console.log("  - 宠物数量:",A.petCollection.length),a(A),p(null),console.log("🎉 抽卡结果已保存到仓库！")},E=()=>{const A=async()=>{const M=prompt("请输入你的灵感来源（例如，一个角色名或一段描述）:");if(!M)return;const R=1e3;if(n.spiritStones<R){N("灵石不足！"),setTimeout(()=>N(null),3e3);return}if(b)return;g(!0),N(null);const Q=n.spiritStones;try{a({...n,spiritStones:Q-R});const Z=_("permanent",!1);console.log(`🎲 同人卡池抽取稀有度: ${Z}`);let G;switch(c){case"人物卡牌":G=await H1(M,Z);break;case"装备":G=await Q1(M,Z);break;case"通用技能":G=await Y1(M,Z,"Universal");break;case"兽宠":G=await V1(M,Z);break;default:alert(`"${c}"类型的同人创作功能出现错误。`),a({...n,spiritStones:Q}),g(!1);return}p([G])}catch(Z){console.error(Z),N("天机紊乱，召唤失败。灵石已退回。"),a({...n,spiritStones:Q}),setTimeout(()=>N(null),4e3)}finally{g(!1)}},L=m==="regular"?{人物卡牌:{title:"万象寻仙",description:"常驻卡池，可招募来自五湖四海的修士。",bannerUrl:"https://i.imgur.com/3sL0qXf.jpg",onPull:()=>S(100,1,"permanent")},装备:{title:"百炼阁",description:"常驻装备池，可获取各类法宝与防具。",bannerUrl:"https://i.imgur.com/2jM1aYk.jpg",onPull:()=>S(100,1,"permanent")},通用技能:{title:"万法楼",description:"常驻技能池，可习得各种通用功法。",bannerUrl:"https://i.imgur.com/dK8k9oN.jpg",onPull:()=>S(100,1,"permanent")},兽宠:{title:"御兽斋",description:"常驻兽宠池，可契约各种珍奇灵兽。",bannerUrl:"https://i.imgur.com/aJ4Gq9a.jpg",onPull:()=>S(100,1,"permanent")}}[c]:{人物卡牌:{title:"异界降临",description:"消耗大量灵石，将你的“灵感”化为现实，召唤来自异界的强者。",bannerUrl:"https://i.imgur.com/s6A4b3g.jpg",onPull:A},装备:{title:"神兵天成",description:"消耗大量灵石，根据你的“灵感”锻造出传说中的神兵利器。",bannerUrl:"https://i.imgur.com/Tq9g8xS.jpg",onPull:A},通用技能:{title:"大道顿悟",description:"消耗大量灵石，从你的“灵感”中领悟出惊天动地的无上功法。",bannerUrl:"https://i.imgur.com/o2N5d1m.jpg",onPull:A},兽宠:{title:"灵兽创生",description:"消耗大量灵石，将你的“灵感”化为现实，创造一只独一无二的灵兽伙伴。",bannerUrl:"https://i.imgur.com/Yp8zL5g.jpg",onPull:A}}[c],T=m==="regular"?200:1e3,P=m==="regular"?1800:9e3;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-center gap-3 mb-4",children:[e.jsx(Pr,{label:"常规卡池",isActive:m==="regular",onClick:()=>f("regular")}),e.jsx(Pr,{label:"同人卡池",isActive:m==="doujin",onClick:()=>f("doujin")})]}),e.jsx(k5,{title:L.title,description:L.description,bannerUrl:L.bannerUrl,onPullOne:()=>m==="regular"?S(T,1,"permanent"):A(),onPullTen:()=>m==="regular"?S(P,10,"permanent"):alert("同人卡池暂不支持十连抽。"),isLoading:b,error:w,pullOneCost:T,pullTenCost:P,pullOneLabel:m==="doujin"?"注入灵感":"招募一次",pullTenLabel:m==="doujin"?" ":"招募十次",poolType:"permanent"})]})};return e.jsxs("div",{className:"h-full flex flex-col font-serif text-gray-300 bg-gradient-to-br from-stone-900 via-stone-950 to-black",children:[e.jsxs("div",{className:"flex-shrink-0 px-4 flex space-x-2 border-b border-xianxia-gold-700/30",children:[e.jsx(uh,{label:"抽取卡池",isActive:r==="抽取卡池",onClick:()=>o("抽取卡池")}),e.jsx(uh,{label:"道具购买",isActive:r==="道具购买",onClick:()=>o("道具购买")})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto bg-black/20 p-4 scrollbar-xianxia",children:[r==="抽取卡池"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx(Pr,{label:"人物卡牌",isActive:c==="人物卡牌",onClick:()=>d("人物卡牌")}),e.jsx(Pr,{label:"装备",isActive:c==="装备",onClick:()=>d("装备")}),e.jsx(Pr,{label:"通用技能",isActive:c==="通用技能",onClick:()=>d("通用技能")}),e.jsx(Pr,{label:"兽宠",isActive:c==="兽宠",onClick:()=>d("兽宠")})]}),E()]}),r==="道具购买"&&e.jsx("div",{className:"p-6 text-center font-serif flex flex-col items-center justify-center h-full",children:e.jsxs("div",{className:"glass-morphism p-8 rounded-lg ornate-border border-xianxia-gold-600",children:[e.jsx("div",{className:"text-6xl mb-6 animate-bounce-slow",children:"💰"}),e.jsx("p",{className:"text-gradient-gold text-xl font-bold mb-2",children:"此功能尚未开放"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"未来的商店将在此处展示，可购买丹药、材料等。"})]})})]}),h&&e.jsx(w5,{results:h,onClose:D})]})},C5=({activeModal:n,onClose:a,playerProfile:r,setPlayerProfile:o,leaderboards:c,onMatchFound:d,onViewPet:m,gameState:f,onLeaderboardsUpdate:h})=>{const p=()=>{switch(n){case"队伍":return e.jsx(y5,{playerProfile:r,setPlayerProfile:o,onViewPet:m});case"商城":return e.jsx(S5,{playerProfile:r,setPlayerProfile:o});case"背包":return e.jsx(Dh,{playerProfile:r,setPlayerProfile:o,onViewPet:m});case"竞技场":return e.jsx(g5,{playerProfile:r,leaderboards:c,onMatchFound:d,gameState:f,onLeaderboardsUpdate:h});case"任务":default:return e.jsxs("div",{className:"p-6 text-gray-300 font-serif flex flex-col items-center justify-center h-full",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📜"}),e.jsxs("p",{children:["这里是 ",e.jsx("span",{className:"font-semibold text-amber-400",children:n})," 界面的占位内容。"]}),e.jsx("p",{className:"mt-4 text-center text-gray-400",children:"后续开发将在此处填充相关的游戏信息，例如背包列表、技能树、人物关系或当前任务日志等。"})]})}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border border-xianxia-gold-600 bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 w-full max-w-6xl h-[90vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col animate-slide-in",onClick:b=>b.stopPropagation(),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20 border-b border-stone-700/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-gradient-gold text-shadow-glow font-serif tracking-widest",children:n}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-stone-700/50 hover:bg-stone-600/50 border border-stone-600 hover:border-xianxia-gold-500 text-gray-400 hover:text-xianxia-gold-400 transition-all duration-200 flex items-center justify-center group",children:e.jsx("i",{className:"fa-solid fa-times text-xl group-hover:rotate-90 transition-transform duration-200"})})]}),e.jsx("div",{className:"flex-grow overflow-y-auto",children:p()}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-xianxia-gold-400 to-transparent"})]})})},mh=({value:n,maxValue:a,color:r,label:o})=>{const c=a>0?n/a*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-300",children:o}),e.jsx("span",{className:"text-xs font-mono text-gray-400",children:`${Math.round(n)}/${Math.round(a)}`})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2 border border-stone-600/50 overflow-hidden",children:e.jsx("div",{className:`${r} h-full rounded-full transition-all duration-500 ease-in-out relative`,style:{width:`${c}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-shimmer"})})})]})},_5=({char:n})=>{const a=Vs(n);return e.jsxs("div",{className:"glass-morphism p-3 rounded-lg border border-stone-600/50 hover:border-xianxia-gold-500/50 transition-all duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-bold text-white font-serif",children:n.name}),e.jsx("p",{className:"text-amber-400 text-sm",children:n.realm})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(mh,{value:a.hp,maxValue:a.maxHp,color:"bg-red-500",label:"气血"}),e.jsx(mh,{value:a.mp,maxValue:a.maxMp,color:"bg-blue-500",label:"真元"})]})]})},$5=({playerProfile:n})=>{const a=n.maleParty.length>0?n.maleParty:n.femaleParty;return e.jsx(gi,{title:`${n.name}的队伍`,children:e.jsx("div",{className:"space-y-3",children:a.length>0?a.map(r=>e.jsx(_5,{char:r},r.id)):e.jsx("p",{className:"text-center text-gray-400",children:"当前没有角色上阵"})})})},gi=({title:n,children:a})=>e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h3",{className:"font-semibold text-xianxia-gold-400 mb-3 text-lg",children:n}),a]}),E5=({playerProfile:n,isOpen:a,onClose:r,hasPendingChallenge:o,onBattleClick:c,onRelationshipsClick:d,onReputationClick:m})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 bg-black/70 z-30 transition-opacity duration-300 ${a?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:r}),e.jsxs("div",{className:`fixed top-0 left-0 h-full w-full max-w-md bg-gradient-to-br from-stone-800/95 via-stone-900/95 to-stone-950/95 backdrop-blur-lg border-r border-xianxia-gold-400/30 shadow-2xl shadow-xianxia-gold-500/10 z-40 transform transition-transform duration-300 ease-in-out ${a?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-xianxia-gold-400/20 bg-stone-900/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gradient-gold text-shadow-glow font-serif",children:"个人信息"}),e.jsxs("button",{onClick:c,className:`relative px-4 py-1.5 text-sm font-semibold rounded-md transition-all duration-300 border ${o?"bg-red-800/80 border-red-500 text-white animate-pulse-fast shadow-glow-red":"bg-stone-700/50 border-stone-600 text-gray-400 cursor-default"}`,children:["战况",o&&e.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]}),e.jsx("button",{onClick:m,className:"relative px-4 py-1.5 text-sm font-semibold rounded-md transition-all duration-300 border bg-stone-700/50 border-stone-600 text-gray-300 hover:bg-stone-600/80",children:"声望"})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto scrollbar-xianxia h-[calc(100%-65px)] space-y-4 font-serif",children:[e.jsxs(gi,{title:"当前身份",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400 w-16 inline-block",children:"名号："})," ",e.jsx("span",{className:"text-white font-bold",children:n.name})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-400 w-16 inline-block",children:"称号："})," ",e.jsx("span",{className:"text-white",children:n.title||"无"})]})]}),e.jsx(gi,{title:"经济状况",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-gem text-yellow-400 text-xl"}),e.jsx("span",{className:"text-white font-bold text-lg",children:n.spiritStones}),e.jsx("span",{className:"text-gray-300",children:"灵石"})]})}),e.jsx(gi,{title:"人际关系",children:e.jsx("button",{onClick:d,className:"w-full text-left hover:bg-stone-800/50 p-2 -m-2 rounded-md transition-colors",children:n.relationships&&n.relationships.length>0?e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-300",children:["已结识 ",e.jsx("span",{className:"font-bold text-white",children:n.relationships.length})," 位道友。"]}),e.jsx("p",{className:"text-xs text-amber-400 mt-1",children:"点击查看详情"})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 italic",children:"江湖路远，尚未结识重要人物。"}),e.jsx("p",{className:"text-xs text-amber-400 mt-1",children:"点击查看详情"})]})})}),e.jsx($5,{playerProfile:n})]})]})]}),A5=({pet:n,onClose:a})=>{const[r,o]=v.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-800/90 backdrop-blur-lg w-full max-w-lg h-auto max-h-[80vh] overflow-hidden shadow-2xl flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"p-4 flex-shrink-0 bg-black/20",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white font-serif flex items-baseline gap-3",children:[e.jsx("span",{children:n.name}),e.jsxs("span",{className:`text-lg font-medium ${ke(n.rarity)}`,children:["[",n.rarity,"]"]})]}),e.jsx("p",{className:"text-lg text-amber-400 font-serif",children:n.gender==="Male"?"雄性":"雌性"})]}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsx("div",{className:"mt-2 space-y-1 text-sm text-gray-300",children:e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-semibold",children:"描述:"})," ",n.description]})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-grow",children:e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-3 text-lg",children:"兽宠技能"}),e.jsxs("div",{className:`relative w-full text-left bg-stone-700/50 p-3 rounded-md border-2 ${pt(n.skill.rarity)} cursor-pointer hover:bg-stone-600/70 transition-colors`,onClick:()=>o(!0),children:[e.jsx("div",{className:"flex justify-between items-baseline",children:e.jsxs("h5",{className:"font-bold text-white flex items-baseline gap-2",children:[e.jsx("span",{className:`${ke(n.skill.rarity)}`,children:n.skill.name}),e.jsxs("span",{className:`text-xs font-medium ${ke(n.skill.rarity)}`,children:["[",n.skill.rarity,"]"]})]})}),e.jsx("p",{className:"text-sm font-semibold text-amber-300 mt-1",children:n.skill.mechanicsDescription}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:n.skill.description})]})]})})]})}),r&&e.jsx(fu,{skill:n.skill,onClose:()=>o(!1)})]})},pi=({value:n,rolling:a})=>{const[r,o]=v.useState(1);return v.useEffect(()=>{if(a){const c=setInterval(()=>{o(Math.floor(Math.random()*6)+1)},50);return()=>clearInterval(c)}else n!==null&&o(n)},[a,n]),e.jsx("div",{className:"w-20 h-20 bg-white border-2 border-gray-300 rounded-lg flex items-center justify-center text-4xl font-bold text-stone-800 shadow-lg",children:r})},T5=({playerProfile:n,opponentName:a,onBattleStart:r,onClose:o})=>{const[c,d]=v.useState("roll"),[m,f]=v.useState(null),[h,p]=v.useState(!1),[b,g]=v.useState(null),[w,N]=v.useState(null),[j,k]=v.useState("通过拼点决定先手！"),_=()=>{p(!0),setTimeout(()=>{let D,E;do D=Math.floor(Math.random()*6)+1,E=Math.floor(Math.random()*6)+1;while(D===E);const A=D>E?"player":"opponent";f({playerRoll:D,opponentRoll:E,winner:A}),p(!1),d("select"),k(A==="player"?"你赢得了先手！请选择你的出战队伍。":"对手赢得了先手，正在选择队伍...")},1500)},C=D=>{(m==null?void 0:m.winner)==="player"&&!b&&g(D)};v.useEffect(()=>{if(!(c!=="select"||!m)){if(b&&w){const D=setTimeout(()=>{d("result"),k("队伍确定，准备开战！")},1e3);return()=>clearTimeout(D)}if(!b||!w)if(m.winner==="player"){if(b&&!w){const D=b==="Male"?"Female":"Male";k(`你已选择，对手将使用 ${D==="Male"?"男性":"女性"} 队伍。`);const E=setTimeout(()=>N(D),500);return()=>clearTimeout(E)}}else if(w){if(w&&!b){const D=w==="Male"?"Female":"Male",E=setTimeout(()=>{g(D),k(`你将使用 ${D==="Male"?"男性":"女性"} 队伍。`)},500);return()=>clearTimeout(E)}}else{const D=setTimeout(()=>{const E=Math.random()>.5?"Male":"Female";N(E),k(`对手选择了 ${E==="Male"?"男性":"女性"} 队伍。`)},1500);return()=>clearTimeout(D)}}},[c,m,b,w]);const S=()=>{if(c==="roll")return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex justify-around items-center my-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white mb-2",children:n.name}),e.jsx(pi,{value:null,rolling:h})]}),e.jsx("p",{className:"text-4xl font-serif text-amber-400",children:"VS"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white mb-2",children:a}),e.jsx(pi,{value:null,rolling:h})]})]}),e.jsx("button",{onClick:_,disabled:h,className:"bg-amber-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-amber-500 transition-colors disabled:opacity-50",children:h?"投掷中...":"拼点"})]});if(c==="select"||c==="result"){const D=n.maleParty.length>0,E=n.femaleParty.length>0;return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex justify-around items-center my-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white mb-2",children:n.name}),e.jsx(pi,{value:(m==null?void 0:m.playerRoll)||1,rolling:!1})]}),e.jsx("p",{className:`text-2xl font-serif ${(m==null?void 0:m.winner)==="player"?"text-green-400":"text-gray-400"}`,children:(m==null?void 0:m.winner)==="player"?"胜利":"败北"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white mb-2",children:a}),e.jsx(pi,{value:(m==null?void 0:m.opponentRoll)||1,rolling:!1})]})]}),e.jsxs("div",{className:"my-6 grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sky-400",children:"你的队伍"}),e.jsx("p",{className:"mt-2 text-lg font-bold text-white h-8 animate-fade-in",children:b?b==="Male"?"男性编队":"女性编队":"..."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-400",children:"对手队伍"}),e.jsx("p",{className:"mt-2 text-lg font-bold text-white h-8 animate-fade-in",children:w?w==="Male"?"男性编队":"女性编队":"..."})]})]}),(m==null?void 0:m.winner)==="player"&&!b&&e.jsxs("div",{className:"mt-4 flex justify-center gap-4 animate-fade-in",children:[e.jsx("button",{onClick:()=>C("Male"),disabled:!D,className:"bg-sky-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-sky-500 disabled:bg-gray-500 disabled:cursor-not-allowed",children:"男性编队"}),e.jsx("button",{onClick:()=>C("Female"),disabled:!E,className:"bg-pink-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-pink-500 disabled:bg-gray-500 disabled:cursor-not-allowed",children:"女性编队"})]}),c==="result"&&b&&w&&e.jsx("div",{className:"mt-8 animate-fade-in",children:e.jsx("button",{onClick:()=>r(b,w),className:"bg-red-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-red-500 transition-colors shadow-lg animate-pulse-fast",children:"进入战斗"})})]})}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"ornate-border bg-stone-800/90 backdrop-blur-lg w-full max-w-lg shadow-2xl flex flex-col",children:[e.jsx("div",{className:"p-4 text-center bg-black/20",children:e.jsx("h2",{className:"text-xl font-bold text-amber-300 font-serif",children:"战前准备"})}),e.jsxs("div",{className:"p-6 font-serif",children:[e.jsx("p",{className:"text-center text-amber-300 mb-6 h-6",children:j}),S()]})]})})},M5=({isOpen:n,onClose:a,prisoner:r,playerSpiritStones:o,onDialogueComplete:c,onGenerateResponse:d,isLoading:m})=>{const[f,h]=v.useState(null),[p,b]=v.useState(null),[g,w]=v.useState([]),[N,j]=v.useState(""),[k,_]=v.useState(!1),[C,S]=v.useState(!1),D=[{type:"威胁",icon:"fa-skull-crossbones",color:"red",description:"以暴力或威胁迫使囚犯屈服"},{type:"劝说",icon:"fa-hand-holding-heart",color:"blue",description:"用道理和情感说服囚犯"},{type:"交易",icon:"fa-handshake",color:"amber",description:"用利益交换囚犯的配合"},{type:"套话",icon:"fa-user-secret",color:"purple",description:"巧妙地套取情报"},{type:"闲聊",icon:"fa-comments",color:"green",description:"轻松的日常交流"},{type:"恩惠",icon:"fa-gift",color:"cyan",description:"给予好处以获取好感"},{type:"羞辱",icon:"fa-face-angry",color:"orange",description:"打击囚犯的尊严和意志"}],E=T=>gf.filter(P=>!(P.type!==T||P.requirements&&(P.requirements.spiritStones&&o<P.requirements.spiritStones||P.requirements.minSubmission&&r.submissionLevel<P.requirements.minSubmission||P.requirements.maxSubmission&&r.submissionLevel>P.requirements.maxSubmission))),A=T=>T.requirements?!(T.requirements.spiritStones&&o<T.requirements.spiritStones||T.requirements.minSubmission&&r.submissionLevel<T.requirements.minSubmission||T.requirements.maxSubmission&&r.submissionLevel>T.requirements.maxSubmission):!0,z=()=>r.submissionLevel>=80?"完全屈服":r.submissionLevel>=60?"意志动摇":r.submissionLevel>=40?"勉强配合":r.submissionLevel>=20?"抗拒不从":"顽固抵抗",I=()=>r.submissionLevel>=80?"text-green-400":r.submissionLevel>=60?"text-yellow-400":r.submissionLevel>=40?"text-orange-400":"text-red-400",L=async()=>{if(p){S(!0);try{const T=await d(r,p);j(T);const P=.7+Math.random()*.6,M={submissionChange:Math.round(p.baseEffects.submissionChange*P),loyaltyChange:Math.round(p.baseEffects.loyaltyChange*P),healthChange:Math.round(p.baseEffects.healthChange*P),sanityChange:Math.round(p.baseEffects.sanityChange*P)},R=Math.random()*100<p.baseEffects.informationChance;let Q;p.riskFactors&&(Math.random()*100<p.riskFactors.rebellion?Q="囚犯表现出强烈的反抗情绪":Math.random()*100<p.riskFactors.breakdown?Q="囚犯的精神状态出现异常":Math.random()*100<p.riskFactors.escapeAttempt&&(Q="囚犯似乎在暗中谋划什么"));const Z={id:`dialogue-${Date.now()}`,prisonerId:r.character.id,prisonerName:r.character.name,timestamp:new Date().toLocaleString("zh-CN"),realTimestamp:Date.now(),dialogueType:p.type,playerChoice:p.text,prisonerResponse:T,attitude:r.submissionLevel>=60?"顺从":r.submissionLevel>=30?"中立":"敌对",effects:{submissionChange:M.submissionChange,loyaltyChange:M.loyaltyChange,healthChange:M.healthChange,sanityChange:M.sanityChange,informationGained:R?"获得了一些有价值的情报":void 0,specialEvent:Q}};w(H=>[...H,Z]);const G={success:!0,dialogueRecord:Z,prisonerReaction:T,narrativeText:T,stateChanges:{submission:M.submissionChange,loyalty:M.loyaltyChange,health:M.healthChange,sanity:M.sanityChange},rewards:R?{information:"获得了一些有价值的情报"}:void 0,consequences:Q?{eventTriggered:Q}:void 0};c(G)}catch(T){console.error("对话执行失败:",T),j("（对话过程中出现了意外...）")}finally{S(!1),b(null)}}};return n?e.jsx("div",{className:"fixed inset-0 bg-black/85 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-6xl h-[85vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:T=>T.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-gradient-to-r from-stone-800 to-stone-900 border-b border-amber-500/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-stone-700 flex items-center justify-center border-2 border-amber-500/50",children:e.jsx("i",{className:"fa-solid fa-user text-3xl text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-amber-300 font-serif flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-comments"}),"与 ",r.character.name," 对话"]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm mt-1",children:[e.jsxs("span",{className:"text-gray-400",children:[r.character.gender==="Male"?"♂":"♀"," ",r.character.realm]}),e.jsxs("span",{className:I(),children:[e.jsx("i",{className:"fa-solid fa-brain mr-1"}),z()]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>_(!k),className:"px-4 py-2 bg-cyan-600/80 text-white font-bold rounded-md hover:bg-cyan-500/80 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-history mr-2"}),k?"返回对话":"对话记录"]}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors p-2",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]})]}),e.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[e.jsxs("div",{className:"w-72 bg-black/30 border-r border-stone-700 p-4 overflow-y-auto flex-shrink-0",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-black/40 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"身体状态"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"健康"}),e.jsxs("span",{className:r.health>70?"text-green-400":r.health>40?"text-yellow-400":"text-red-400",children:[r.health,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r.health>70?"bg-green-500":r.health>40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r.health}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"神智"}),e.jsxs("span",{className:r.sanity>70?"text-green-400":r.sanity>40?"text-yellow-400":"text-red-400",children:[r.sanity,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r.sanity>70?"bg-green-500":r.sanity>40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r.sanity}%`}})})]})]})]}),e.jsxs("div",{className:"bg-black/40 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"意志状态"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"屈服度"}),e.jsxs("span",{className:"text-yellow-400",children:[r.submissionLevel,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2",children:e.jsx("div",{className:"h-2 bg-yellow-500 rounded-full transition-all",style:{width:`${r.submissionLevel}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"归顺度"}),e.jsxs("span",{className:"text-green-400",children:[r.loyaltyLevel,"%"]})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2",children:e.jsx("div",{className:"h-2 bg-green-500 rounded-full transition-all",style:{width:`${r.loyaltyLevel}%`}})})]})]})]})]}),e.jsxs("div",{className:"bg-black/40 p-3 rounded-lg mb-4",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"囚犯信息"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"罪行"}),e.jsx("span",{className:"text-red-300 text-right max-w-[150px] truncate",title:r.crime,children:r.crime})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"剩余刑期"}),e.jsxs("span",{className:"text-orange-400",children:[r.remainingDays,"天"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"关押位置"}),e.jsx("span",{className:"text-blue-400",children:r.location})]})]})]}),r.status.length>0&&e.jsxs("div",{className:"bg-black/40 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"当前状态"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.status.map((T,P)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-orange-500/20 text-orange-300 rounded",children:T},P))})]})]}),e.jsx("div",{className:"flex-grow flex flex-col overflow-hidden",children:k?e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"对话历史记录"}),g.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-10",children:[e.jsx("i",{className:"fa-solid fa-comments text-4xl mb-4 opacity-50"}),e.jsx("p",{children:"暂无对话记录"})]}):e.jsx("div",{className:"space-y-4",children:g.map(T=>e.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 text-xs bg-amber-500/20 text-amber-300 rounded",children:T.dialogueType}),e.jsx("span",{className:"text-white font-bold",children:T.playerChoice})]}),e.jsx("span",{className:"text-xs text-gray-500",children:T.timestamp})]}),e.jsx("div",{className:"bg-black/20 p-3 rounded mb-3",children:e.jsxs("p",{className:"text-gray-300 text-sm italic",children:['"',T.prisonerResponse,'"']})}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"屈服度:"}),e.jsxs("span",{className:`ml-1 font-bold ${T.effects.submissionChange>=0?"text-yellow-400":"text-red-400"}`,children:[T.effects.submissionChange>=0?"+":"",T.effects.submissionChange]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"归顺度:"}),e.jsxs("span",{className:`ml-1 font-bold ${T.effects.loyaltyChange>=0?"text-green-400":"text-red-400"}`,children:[T.effects.loyaltyChange>=0?"+":"",T.effects.loyaltyChange]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"健康:"}),e.jsxs("span",{className:`ml-1 font-bold ${T.effects.healthChange>=0?"text-green-400":"text-red-400"}`,children:[T.effects.healthChange>=0?"+":"",T.effects.healthChange]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"神智:"}),e.jsxs("span",{className:`ml-1 font-bold ${T.effects.sanityChange>=0?"text-green-400":"text-red-400"}`,children:[T.effects.sanityChange>=0?"+":"",T.effects.sanityChange]})]})]})]},T.id))})]}):e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"bg-gradient-to-r from-stone-800/50 to-stone-900/50 p-4 border-b border-stone-700 flex-shrink-0",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-stone-700 flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:"fa-solid fa-user text-gray-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-amber-300 font-bold mb-1",children:r.character.name}),e.jsxs("p",{className:"text-gray-300 italic",children:['"',N,'"']})]})]})}),!f&&e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"选择对话方式"}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:D.map(({type:T,icon:P,color:M,description:R})=>{const Q=E(T).length,Z={red:"border-red-500/30 bg-red-900/20 hover:border-red-500/60 text-red-400",blue:"border-blue-500/30 bg-blue-900/20 hover:border-blue-500/60 text-blue-400",amber:"border-amber-500/30 bg-amber-900/20 hover:border-amber-500/60 text-amber-400",purple:"border-purple-500/30 bg-purple-900/20 hover:border-purple-500/60 text-purple-400",green:"border-green-500/30 bg-green-900/20 hover:border-green-500/60 text-green-400",cyan:"border-cyan-500/30 bg-cyan-900/20 hover:border-cyan-500/60 text-cyan-400",orange:"border-orange-500/30 bg-orange-900/20 hover:border-orange-500/60 text-orange-400"};return e.jsxs("button",{onClick:()=>h(T),disabled:Q===0,className:`p-4 rounded-lg border-2 transition-all text-left ${Q>0?Z[M]:"border-stone-700 bg-stone-800/50 opacity-50 cursor-not-allowed"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:e.jsx("i",{className:`fa-solid ${P}`})}),e.jsx("div",{className:"font-bold mb-1",children:T}),e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:R}),e.jsxs("div",{className:"text-xs text-gray-500",children:[Q," 个可用选项"]})]},T)})})]}),f&&!p&&e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsxs("h3",{className:"text-lg font-bold text-white",children:[f," - 选择具体方式"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:gf.filter(T=>T.type===f).map(T=>{var M;const P=A(T);return e.jsx("button",{onClick:()=>P&&b(T),disabled:!P,className:`p-4 rounded-lg border-2 transition-all text-left ${P?"border-stone-600 bg-black/30 hover:border-amber-500/50":"border-stone-800 bg-black/10 opacity-50 cursor-not-allowed"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl text-amber-400",children:e.jsx("i",{className:`fa-solid ${T.icon}`})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"font-bold text-white mb-1",children:T.text}),e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:T.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"屈服:"}),e.jsxs("span",{className:`ml-1 ${T.baseEffects.submissionChange>=0?"text-yellow-400":"text-red-400"}`,children:[T.baseEffects.submissionChange>=0?"+":"",T.baseEffects.submissionChange]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"归顺:"}),e.jsxs("span",{className:`ml-1 ${T.baseEffects.loyaltyChange>=0?"text-green-400":"text-red-400"}`,children:[T.baseEffects.loyaltyChange>=0?"+":"",T.baseEffects.loyaltyChange]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"情报:"}),e.jsxs("span",{className:"ml-1 text-cyan-400",children:[T.baseEffects.informationChance,"%"]})]}),T.riskFactors&&T.riskFactors.rebellion>10&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"风险:"}),e.jsx("span",{className:"ml-1 text-red-400",children:T.riskFactors.rebellion>30?"高":"中"})]})]}),((M=T.requirements)==null?void 0:M.spiritStones)&&e.jsxs("span",{className:`px-2 py-0.5 text-xs rounded ${o>=T.requirements.spiritStones?"bg-amber-500/20 text-amber-300":"bg-red-500/20 text-red-300"}`,children:[T.requirements.spiritStones," 灵石"]})]})]})},T.id)})})]}),p&&e.jsx("div",{className:"flex-shrink-0 p-4 bg-black/40 border-t border-amber-500/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-white font-bold mb-1",children:["已选择: ",e.jsx("span",{className:"text-amber-400",children:p.text})]}),e.jsx("div",{className:"text-xs text-gray-400",children:p.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b(null),className:"px-4 py-2 bg-gray-600/80 text-white rounded-md hover:bg-gray-500/80 transition-colors",children:"取消"}),e.jsx("button",{onClick:L,disabled:C||m,className:"px-6 py-2 bg-amber-600/80 text-white font-bold rounded-md hover:bg-amber-500/80 disabled:opacity-50 transition-colors",children:C?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin mr-2"}),"对话中..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fa-solid fa-comment mr-2"}),"开始对话"]})})]})]})})]})})]})]})}):null},z5=({isOpen:n,onClose:a,prisonSystem:r,onInterrogatePrisoner:o,onViewPrisonerDetail:c,onTransferPrisoner:d,onReleasePrisoner:m,onRecruitPrisoner:f,onAssignLabor:h,onClaimLaborResult:p,onGenerateEvent:b,onDialogueComplete:g,onGenerateDialogueResponse:w,isLoading:N,playerProfile:j,setPlayerProfile:k,onViewPet:_})=>{const[C,S]=v.useState("管理区"),[D,E]=v.useState(null),[A,z]=v.useState(!1),[I,L]=v.useState(!1),[T,P]=v.useState(null),[M,R]=v.useState(null),[Q,Z]=v.useState(36e5),[G,H]=v.useState(Date.now());if(v.useEffect(()=>{const X=setInterval(()=>{H(Date.now())},1e3);return()=>clearInterval(X)},[]),!n)return null;if(!r||!r.stats)return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"bg-stone-900 p-8 rounded-xl text-center",children:[e.jsx("i",{className:"fa-solid fa-exclamation-triangle text-yellow-400 text-4xl mb-4"}),e.jsx("h3",{className:"text-xl text-white mb-2",children:"大牢系统数据缺失"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"请重新开始游戏或加载新存档"}),e.jsx("button",{onClick:a,className:"px-6 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-500",children:"关闭"})]})});const O=["居住区","审讯区","娱乐区","劳役区","管理区","医疗区"],U=X=>r.prisoners.filter(J=>J.location===X),te=X=>({居住区:"fa-bed",审讯区:"fa-gavel",娱乐区:"fa-gamepad",劳役区:"fa-hammer",管理区:"fa-chart-line",医疗区:"fa-hospital"})[X],ie=X=>({居住区:"blue",审讯区:"red",娱乐区:"green",劳役区:"orange",管理区:"purple",医疗区:"cyan"})[X],B=()=>{const X=r.stats,J=r.events.slice(-5).reverse();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"囚犯总数"}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[X.totalPrisoners," / ",r.config.maxPrisoners]})]}),e.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"平均屈服度"}),e.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[X.avgSubmission.toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"平均归顺度"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[X.avgLoyalty.toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"狱卒数量"}),e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:X.totalGuards})]})]}),e.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700",children:[e.jsx("h3",{className:"text-lg font-bold text-amber-300 mb-3",children:"财务统计"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"总收入"}),e.jsxs("div",{className:"text-xl font-bold text-green-400",children:[X.totalRevenue," ",e.jsx("span",{className:"text-sm",children:"灵石"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"总支出"}),e.jsxs("div",{className:"text-xl font-bold text-red-400",children:[X.totalExpenses," ",e.jsx("span",{className:"text-sm",children:"灵石"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"净利润"}),e.jsxs("div",{className:`text-xl font-bold ${X.netProfit>=0?"text-green-400":"text-red-400"}`,children:[X.netProfit," ",e.jsx("span",{className:"text-sm",children:"灵石"})]})]})]})]}),e.jsxs("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-bold text-amber-300",children:"最近事件"}),e.jsx("button",{onClick:b,disabled:N,className:"px-3 py-1 text-sm bg-purple-600/80 text-white rounded-md hover:bg-purple-500/80 disabled:opacity-50 transition-colors",children:N?"生成中...":"触发随机事件"})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:J.length>0?J.map(re=>{const pe=re.severity==="critical"?"text-red-400":re.severity==="high"?"text-orange-400":re.severity==="medium"?"text-yellow-400":"text-gray-400";return e.jsxs("div",{className:"bg-black/20 p-3 rounded border border-stone-700/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:`font-bold ${pe}`,children:re.title}),e.jsx("span",{className:"text-xs text-gray-500",children:re.timestamp})]}),e.jsx("p",{className:"text-sm text-gray-300",children:re.description}),!re.resolved&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 text-xs bg-red-500/20 text-red-400 rounded",children:"未处理"})]},re.id)}):e.jsx("div",{className:"text-center text-gray-500 py-4",children:"暂无事件记录"})})]})]})},W=X=>{const J=U(X);return J.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-10",children:[e.jsx("i",{className:`fa-solid ${te(X)} text-4xl mb-4 opacity-50`}),e.jsx("p",{children:"此区域暂无囚犯"})]}):e.jsx("div",{className:"space-y-3",children:J.map(re=>{const pe=re.submissionLevel>70?"text-green-400":re.submissionLevel>40?"text-yellow-400":"text-red-400";return e.jsx("div",{className:"bg-black/30 p-4 rounded-lg border border-stone-700 hover:border-amber-500/50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:re.character.name}),e.jsxs("span",{className:"text-sm text-gray-400",children:[re.character.gender==="Male"?"♂":"♀"," Lv.",re.character.realm]}),e.jsx("span",{className:"px-2 py-1 text-xs bg-purple-500/20 text-purple-300 rounded",children:re.character.rarity})]}),e.jsxs("div",{className:"text-sm text-gray-400 mb-2",children:[e.jsx("span",{className:"text-red-300",children:"罪行:"})," ",re.crime]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"屈服:"}),e.jsxs("span",{className:`ml-1 font-bold ${pe}`,children:[re.submissionLevel,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"归顺:"}),e.jsxs("span",{className:`ml-1 font-bold ${re.loyaltyLevel>70?"text-green-400":"text-gray-400"}`,children:[re.loyaltyLevel,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"剩余刑期:"}),e.jsxs("span",{className:"ml-1 font-bold text-orange-400",children:[re.remainingDays,"天"]})]})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:re.status.map(me=>e.jsx("span",{className:"px-2 py-1 text-xs bg-orange-500/20 text-orange-300 rounded",children:me},me))})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[e.jsx("button",{onClick:me=>{me.stopPropagation(),E(re),z(!0)},className:"px-3 py-1 text-sm bg-cyan-600/80 text-white rounded hover:bg-cyan-500/80 transition-colors",children:"详情"}),e.jsxs("button",{onClick:me=>{me.stopPropagation(),P(re),L(!0)},disabled:N,className:"px-3 py-1 text-sm bg-amber-600/80 text-white rounded hover:bg-amber-500/80 disabled:opacity-50 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-comments mr-1"}),"对话"]}),e.jsx("button",{onClick:me=>{me.stopPropagation(),o(re)},disabled:N,className:"px-3 py-1 text-sm bg-red-600/80 text-white rounded hover:bg-red-500/80 disabled:opacity-50 transition-colors",children:"审讯"}),e.jsxs("select",{value:re.location,onChange:me=>{me.stopPropagation(),d(re,me.target.value)},className:"px-2 py-1 text-xs bg-stone-700 text-white rounded border border-stone-600",onClick:me=>me.stopPropagation(),children:[e.jsx("option",{value:"",disabled:!0,children:"转移到..."}),O.filter(me=>me!==re.location).map(me=>e.jsx("option",{value:me,children:me},me))]}),re.loyaltyLevel>=80&&e.jsx("button",{onClick:me=>{me.stopPropagation(),f(re)},className:"px-3 py-1 text-sm bg-green-600/80 text-white rounded hover:bg-green-500/80 transition-colors",children:"招募"})]})]})},re.character.id)})})},ne=()=>{const X=r.prisoners.filter(me=>!me.status.includes("劳役中")&&me.health>30),J=me=>{const ae=Math.floor(me/1e3),xe=Math.floor(ae/60),he=Math.floor(xe/60);return he>0?`${he}小时${xe%60}分钟`:xe>0?`${xe}分钟${ae%60}秒`:`${ae}秒`},re=me=>({凡品:"text-gray-400",良品:"text-green-400",优品:"text-blue-400",珍品:"text-purple-400",绝品:"text-orange-400",仙品:"text-red-400",圣品:"text-pink-400",神品:"text-yellow-400"})[me]||"text-gray-400",pe=me=>{const ae=me.maxWorkers-me.workers.length,xe=me.type==="矿山"?"orange":"green";return e.jsxs("div",{className:`bg-black/30 p-4 rounded-lg border-2 border-${xe}-500/30 hover:border-${xe}-500/60 transition-colors`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:`text-xl font-bold text-${xe}-300 flex items-center gap-2`,children:[e.jsx("i",{className:`fa-solid ${me.type==="矿山"?"fa-mountain":"fa-leaf"}`}),me.name]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:me.description})]}),e.jsxs("div",{className:`px-3 py-1 rounded-full ${ae>0?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"}`,children:[ae,"/",me.maxWorkers," 可用"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[0,1].map(he=>{const Se=me.workers[he];if(Se){const et=Math.max(0,Se.endTime-G),Re=et===0,kt=(Se.duration-et)/Se.duration*100;return e.jsxs("div",{className:`bg-black/40 p-3 rounded-lg border ${Re?"border-green-500/50":"border-yellow-500/50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-bold",children:Se.prisonerName}),e.jsxs("div",{className:"text-xs text-gray-400",children:["工位 #",he+1]})]}),Re?e.jsxs("span",{className:"px-2 py-1 text-xs bg-green-500/20 text-green-300 rounded animate-pulse",children:[e.jsx("i",{className:"fa-solid fa-check mr-1"}),"完成"]}):e.jsxs("span",{className:"px-2 py-1 text-xs bg-yellow-500/20 text-yellow-300 rounded",children:[e.jsx("i",{className:"fa-solid fa-clock mr-1"}),"劳役中"]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1",children:[e.jsx("span",{children:"进度"}),e.jsx("span",{children:Re?"已完成":J(et)})]}),e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${Re?"bg-green-500":"bg-yellow-500"}`,style:{width:`${kt}%`}})})]}),Re&&p&&e.jsxs("button",{onClick:()=>p(me.id,Se.prisonerId),className:"w-full px-3 py-1.5 text-sm bg-green-600/80 text-white rounded hover:bg-green-500/80 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-gift mr-2"}),"领取奖励"]})]},he)}else return e.jsx("div",{className:"bg-black/20 p-3 rounded-lg border border-dashed border-stone-600",children:e.jsxs("div",{className:"text-center text-gray-500 py-4",children:[e.jsx("i",{className:"fa-solid fa-user-plus text-2xl mb-2 opacity-50"}),e.jsxs("div",{className:"text-sm",children:["工位 #",he+1]}),e.jsx("div",{className:"text-xs",children:"空闲中"})]})},he)})}),ae>0&&X.length>0&&e.jsxs("div",{className:"border-t border-stone-700 pt-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"分配囚犯到此劳役点："}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:M===me.id?M:"",onChange:he=>R(he.target.value||null),className:"flex-grow px-3 py-2 bg-stone-700 text-white rounded border border-stone-600 text-sm",children:[e.jsx("option",{value:"",children:"选择囚犯..."}),X.map(he=>e.jsxs("option",{value:he.character.id,children:[he.character.name," (健康:",he.health,"%)"]},he.character.id))]}),e.jsxs("select",{value:Q,onChange:he=>Z(Number(he.target.value)),className:"px-3 py-2 bg-stone-700 text-white rounded border border-stone-600 text-sm",children:[e.jsx("option",{value:18e5,children:"30分钟"}),e.jsx("option",{value:36e5,children:"1小时"}),e.jsx("option",{value:72e5,children:"2小时"}),e.jsx("option",{value:144e5,children:"4小时"}),e.jsx("option",{value:288e5,children:"8小时"})]}),e.jsxs("button",{onClick:()=>{if(M){const he=X.find(Se=>Se.character.id===M);he&&(h(he.character.id,me.id,Q),R(null))}},disabled:!M,className:"px-4 py-2 bg-blue-600/80 text-white rounded hover:bg-blue-500/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:[e.jsx("i",{className:"fa-solid fa-play mr-1"}),"开始劳役"]})]})]}),ae>0&&X.length===0&&e.jsxs("div",{className:"border-t border-stone-700 pt-3 text-center text-gray-500 text-sm",children:[e.jsx("i",{className:"fa-solid fa-info-circle mr-1"}),"暂无可分配的囚犯（需要健康值大于30%且未在劳役中）"]})]},me.id)};return e.jsxs("div",{className:"space-y-4",children:[r.materialInventory&&r.materialInventory.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-amber-900/20 to-purple-900/20 p-4 rounded-lg border border-amber-500/30",children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-300 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-box-open"}),"材料库存"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:r.materialInventory.map((me,ae)=>e.jsxs("div",{className:"bg-black/40 p-3 rounded border border-stone-700/50",children:[e.jsx("div",{className:`font-bold ${re(me.material.rarity)}`,children:me.material.name}),e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:me.material.type==="ore"?"矿石":"草药"}),e.jsxs("div",{className:"text-sm text-white",children:["数量: ",e.jsx("span",{className:"font-bold text-green-400",children:me.quantity})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["价值: ",me.material.value," 灵石/个"]})]},`${me.material.id}-${ae}`))})]}),e.jsx("div",{className:"space-y-4",children:r.laborSites.map(me=>pe(me))}),e.jsxs("div",{className:"bg-blue-900/20 p-4 rounded-lg border border-blue-500/30",children:[e.jsxs("h4",{className:"text-sm font-bold text-blue-300 mb-2",children:[e.jsx("i",{className:"fa-solid fa-info-circle mr-1"}),"劳役系统说明"]}),e.jsxs("ul",{className:"text-xs text-gray-400 space-y-1",children:[e.jsx("li",{children:"• 每个劳役点最多可同时安排2名囚犯工作"}),e.jsx("li",{children:"• 囚犯健康值必须大于30%才能参与劳役"}),e.jsx("li",{children:"• 劳役使用真实时间计时，可选择30分钟到8小时不等"}),e.jsx("li",{children:"• 完成后可获得2种随机材料（矿石或草药），每种25-50个"}),e.jsx("li",{children:"• 材料的名称、稀有度和描述由AI生成"}),e.jsx("li",{children:"• 劳役会消耗囚犯10-30点健康值，但会获得50-150经验"})]})]})]})};return e.jsxs("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:[e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-7xl h-[90vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:X=>X.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20 border-b border-stone-700",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-amber-300 font-serif flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-dungeon"}),"镇狱大牢"]}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["囚犯: ",r.stats.totalPrisoners,"/",r.config.maxPrisoners," | 安全等级: ",r.config.securityLevel,"/10"]})]}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[e.jsx("div",{className:"w-48 bg-black/20 border-r border-stone-700 flex-shrink-0",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 mb-3 uppercase",children:"区域"}),e.jsx("div",{className:"space-y-1",children:O.map(X=>{const J=ie(X),re=C===X,pe=U(X).length;return e.jsxs("button",{onClick:()=>S(X),className:`w-full text-left px-3 py-2 rounded-md transition-colors flex items-center justify-between ${re?`bg-${J}-500/20 text-${J}-300 border border-${J}-500/50`:"text-gray-400 hover:bg-stone-700/50"}`,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:`fa-solid ${te(X)}`}),X]}),X!=="管理区"&&e.jsx("span",{className:"text-xs bg-black/30 px-2 py-1 rounded",children:pe})]},X)})})]})}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx("i",{className:`fa-solid ${te(C)}`}),C]}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[C==="居住区"&&"囚犯的日常居住区域，按危险程度分配不同牢房",C==="审讯区"&&"对囚犯进行审讯和刑罚执行的地方",C==="娱乐区"&&"囚犯的休闲和思想改造区域",C==="劳役区"&&"囚犯进行强制劳动的区域",C==="管理区"&&"监狱管理和运营中心，查看整体统计",C==="医疗区"&&"治疗受伤和生病的囚犯"]})]}),C==="管理区"?B():C==="劳役区"?ne():W(C)]})]})]}),A&&D&&e.jsx(Ei,{card:D.character,onClose:()=>{z(!1),E(null)},playerProfile:j,setPlayerProfile:k,onViewPet:_}),I&&T&&e.jsx(M5,{isOpen:I,onClose:()=>{L(!1),P(null)},prisoner:T,playerSpiritStones:(j==null?void 0:j.spiritStones)||0,onDialogueComplete:X=>{g&&T&&g(T,X)},onGenerateResponse:async(X,J)=>{if(w)return await w(X,J);const pe={威胁:["哼，你以为这样就能让我屈服吗？","我...我不会说的...","你们这些人，迟早会遭报应的！"],劝说:["你说的...或许有些道理...","我需要时间考虑...","你真的能保证吗？"],交易:["这个条件...让我想想...","你能给我什么保证？","也许我们可以谈谈..."],套话:["你想知道什么？","我不知道你在说什么...","这个...我不太清楚..."],闲聊:["难得有人愿意和我说话...","外面的世界...还好吗？","你为什么要来这里？"],恩惠:["你...为什么要帮我？","谢谢你...","我不知道该说什么..."],羞辱:["你！你会后悔的！","...","我不会忘记这一切的..."]}[J.type]||["..."];return pe[Math.floor(Math.random()*pe.length)]},isLoading:N})]})},D5=({isOpen:n,onClose:a,quests:r,playerProfile:o,onClaimReward:c})=>{const[d,m]=v.useState("Main"),[f,h]=v.useState(null);if(!n)return null;const p=r.filter(N=>d==="Completed"?N.status==="Completed"||N.status==="Claimable":N.category===d&&N.status!=="Completed"&&N.status!=="Claimable"),b=({quest:N})=>e.jsxs("li",{onClick:()=>h(N),className:`p-3 cursor-pointer rounded-md transition-colors ${(f==null?void 0:f.id)===N.id?"bg-amber-500/20":"hover:bg-stone-700/50"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-white",children:N.title}),e.jsx("p",{className:"text-xs text-gray-400",children:N.status==="Claimable"?"可领取":N.status})]}),N.status==="Claimable"&&e.jsx("i",{className:"fa-solid fa-gift text-amber-400 animate-pulse"})]},N.id),g=({quest:N})=>{var j;return N?e.jsxs("div",{className:"flex-1 p-6 bg-black/20 rounded-lg overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold text-amber-300 font-serif mb-4",children:N.title}),e.jsxs("p",{className:"text-gray-300 mb-6 italic",children:['"',N.description,'"']}),e.jsx("h4",{className:"font-bold text-white mb-3",children:"任务目标"}),e.jsx("ul",{className:"space-y-2 mb-6",children:N.objectives.map(k=>e.jsxs("li",{className:"flex items-center",children:[e.jsx("i",{className:`fa-solid ${k.isCompleted?"fa-check-square text-green-500":"fa-square text-gray-500"} mr-3`}),e.jsxs("span",{className:`${k.isCompleted?"line-through text-gray-500":"text-gray-300"}`,children:[k.description," ",k.targetCount?`(${k.currentCount}/${k.targetCount})`:""]})]},k.id))}),e.jsx("h4",{className:"font-bold text-white mb-3",children:"任务奖励"}),e.jsxs("div",{className:"space-y-2 mb-6",children:[N.rewards.spiritStones&&e.jsxs("div",{className:"flex items-center text-amber-300",children:[e.jsx("i",{className:"fa-solid fa-coins mr-2"}),e.jsxs("span",{children:["灵石 x ",N.rewards.spiritStones]})]}),N.rewards.reputation&&e.jsxs("div",{className:"flex items-center text-purple-300",children:[e.jsx("i",{className:"fa-solid fa-star mr-2"}),e.jsxs("span",{children:["声望 +",N.rewards.reputation]})]}),(j=N.rewards.items)==null?void 0:j.map((k,_)=>e.jsxs("div",{className:"flex items-center text-green-300",children:[e.jsx("i",{className:"fa-solid fa-box mr-2"}),e.jsx("span",{children:k.name})]},_))]}),N.status==="Claimable"&&e.jsxs("button",{onClick:()=>c(N.id),className:"w-full py-3 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-bold rounded-lg shadow-lg transition-all duration-200 transform hover:scale-105 flex items-center justify-center space-x-2",children:[e.jsx("i",{className:"fa-solid fa-gift"}),e.jsx("span",{children:"领取奖励"})]}),N.status==="Completed"&&e.jsxs("div",{className:"w-full py-3 bg-gray-600 text-gray-400 font-bold rounded-lg text-center",children:[e.jsx("i",{className:"fa-solid fa-check mr-2"}),e.jsx("span",{children:"已领取"})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:e.jsx("p",{children:"从左侧选择一个任务以查看详情"})})},w=({tab:N,label:j})=>e.jsx("button",{onClick:()=>m(N),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 ${d===N?"bg-stone-700/80 text-amber-400 border-b-2 border-amber-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:j});return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-5xl h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:N=>N.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:"任务日志"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-shrink-0 px-4 flex space-x-2 border-b border-stone-700",children:[e.jsx(w,{tab:"Main",label:"主线任务"}),e.jsx(w,{tab:"Side",label:"支线任务"}),e.jsx(w,{tab:"Sect",label:"宗门任务"}),e.jsx(w,{tab:"Completed",label:"已完成"})]}),e.jsxs("div",{className:"flex-grow flex p-6 space-x-6 overflow-hidden",children:[e.jsx("div",{className:"w-1/3 flex-shrink-0 bg-black/20 rounded-lg p-4 overflow-y-auto",children:e.jsx("ul",{className:"space-y-2",children:p.length>0?p.map(N=>e.jsx(b,{quest:N},N.id)):e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"此分类下暂无任务。"})})}),e.jsx(g,{quest:f})]})]})})},O5=({event:n,onChoice:a,resultText:r})=>e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"ornate-border bg-stone-800/90 backdrop-blur-lg w-full max-w-lg shadow-2xl flex flex-col",children:[e.jsx("div",{className:"p-4 text-center bg-black/20",children:e.jsx("h2",{className:"text-xl font-bold text-amber-300 font-serif",children:n.title})}),e.jsx("div",{className:"p-6 font-serif min-h-[15rem] flex flex-col justify-center",children:r?e.jsx("div",{className:"text-center animate-fade-in",children:e.jsx("p",{className:"text-amber-300 text-lg leading-relaxed",children:r})}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-300 whitespace-pre-wrap mb-6 text-center leading-relaxed",children:n.story}),e.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:n.choices.map((o,c)=>e.jsx("button",{onClick:()=>a(o),className:"w-full sm:w-auto bg-stone-700/80 px-5 py-3 rounded-md hover:bg-stone-600/80 hover:border-amber-400/50 border border-transparent transition-all duration-200 font-serif shadow-md",children:o.text},c))})]})})]})}),R5=({favorability:n})=>{const a=(n+100)/200*100,r=n>50?"bg-green-500":n>-50?"bg-yellow-500":"bg-red-500";return e.jsx("div",{className:"w-full bg-stone-700 rounded-full h-2.5",children:e.jsx("div",{className:`${r} h-2.5 rounded-full`,style:{width:`${a}%`}})})},I5=({isOpen:n,onClose:a,playerProfile:r})=>{const[o,c]=v.useState("熟人");if(!n)return null;const d=r.relationships.filter(m=>m.relationshipStatus===o);return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border border-xianxia-gold-600 bg-gradient-to-br from-stone-800 via-stone-900 to-stone-950 w-full max-w-2xl h-auto max-h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20 border-b border-stone-700/50",children:[e.jsx("h2",{className:"text-2xl font-bold text-gradient-gold text-shadow-glow font-serif",children:"人际关系"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-shrink-0 px-4 flex space-x-2 border-b border-stone-700",children:[e.jsx("button",{onClick:()=>c("熟人"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 ${o==="熟人"?"bg-stone-700/80 text-amber-400 border-b-2 border-amber-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:"熟人"}),e.jsx("button",{onClick:()=>c("陌生人"),className:`px-4 py-2 text-sm font-semibold rounded-t-lg transition-colors duration-200 ${o==="陌生人"?"bg-stone-700/80 text-amber-400 border-b-2 border-amber-400":"bg-transparent text-gray-400 hover:bg-stone-700/50"}`,children:"陌生人"})]}),e.jsx("div",{className:"flex-grow overflow-y-auto scrollbar-xianxia p-6 space-y-4",children:d.length>0?d.map(m=>e.jsxs("div",{className:"glass-morphism p-4 rounded-lg border border-stone-700/50 hover:border-xianxia-gold-500/50 transition-all duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white font-serif",children:m.name}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:m.relationshipTags.map(f=>e.jsx("span",{className:"px-2 py-1 bg-stone-700 text-xs text-gray-300 rounded-full",children:f},f))})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"好感度"}),e.jsx("p",{className:"font-mono text-lg text-white",children:m.favorability})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(R5,{favorability:m.favorability})}),e.jsxs("p",{className:"text-sm text-gray-300 mt-3 italic",children:['"',m.description,'"']})]},m.id)):e.jsxs("div",{className:"text-center text-gray-500 pt-10",children:[e.jsx("p",{className:"text-4xl mb-4",children:"🌪️"}),e.jsx("p",{children:"此分类下暂无人物。"})]})})]})})},L5=({isOpen:n,onClose:a,reputation:r,isLoading:o,onRefresh:c})=>{const[d,m]=v.useState("summary");if(!n)return null;const f=b=>{switch(b){case"名垂青史":return"text-yellow-300 animate-glow";case"威震一方":return"text-red-400";case"声名远扬":return"text-sky-400";case"小有名气":return"text-green-400";default:return"text-gray-400"}},h=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:`text-4xl font-bold font-serif ${f(r.level)}`,children:r.level}),e.jsxs("p",{className:"text-lg text-gray-400 font-mono",children:[r.score," 声望"]})]}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-3 text-lg",children:"江湖称号"}),r.title?e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx("span",{className:"px-3 py-1 bg-rose-800/50 text-rose-300 rounded-full border border-rose-700",children:r.title})}):e.jsx("p",{className:"text-gray-500 italic",children:"尚未获得任何称号。"})]}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h4",{className:"font-semibold text-green-400 mb-3 text-lg",children:"侠义之举"}),r.goodDeeds&&r.goodDeeds.length>0?e.jsx("ul",{className:"space-y-2 list-disc list-inside text-gray-300",children:r.goodDeeds.map((b,g)=>e.jsx("li",{children:b},g))}):e.jsx("p",{className:"text-gray-500 italic",children:"尚未有侠义之举流传。"})]}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h4",{className:"font-semibold text-red-400 mb-3 text-lg",children:"恶行昭彰"}),r.badDeeds&&r.badDeeds.length>0?e.jsx("ul",{className:"space-y-2 list-disc list-inside text-gray-300",children:r.badDeeds.map((b,g)=>e.jsx("li",{children:b},g))}):e.jsx("p",{className:"text-gray-500 italic",children:"你似乎还未犯下什么大错。"})]}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-lg border border-stone-700/50",children:[e.jsx("h4",{className:"font-semibold text-pink-400 mb-3 text-lg",children:"风流韵事"}),r.lewdDeeds&&r.lewdDeeds.length>0?e.jsx("ul",{className:"space-y-2 list-disc list-inside text-gray-300",children:r.lewdDeeds.map((b,g)=>e.jsx("li",{children:b},g))}):e.jsx("p",{className:"text-gray-500 italic",children:"江湖上还没有关于你的风流传说。"})]})]}),p=()=>e.jsx("div",{className:"space-y-4",children:r.history&&r.history.length>0?r.history.map(b=>e.jsxs("div",{className:"bg-black/20 p-3 rounded-lg border border-stone-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-300",children:b.description}),e.jsx("span",{className:`font-mono text-lg ${b.scoreChange>=0?"text-green-400":"text-red-400"}`,children:b.scoreChange>=0?`+${b.scoreChange}`:b.scoreChange})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:b.timestamp})]},b.id)):e.jsx("p",{className:"text-gray-500 italic text-center pt-8",children:"声望历史一片空白。"})});return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-2xl h-auto max-h-[80vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:"声望"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:c,disabled:o,className:"px-4 py-2 text-sm font-semibold bg-amber-600 text-white rounded-lg hover:bg-amber-500 transition-colors disabled:bg-stone-600 disabled:cursor-not-allowed",children:o?"刷新中...":"刷新情报"}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]})]}),e.jsx("div",{className:"border-b border-stone-700 px-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>m("summary"),className:`py-2 px-4 text-sm font-semibold transition-colors ${d==="summary"?"text-amber-400 border-b-2 border-amber-400":"text-gray-400 hover:text-white"}`,children:"声望总览"}),e.jsx("button",{onClick:()=>m("history"),className:`py-2 px-4 text-sm font-semibold transition-colors ${d==="history"?"text-amber-400 border-b-2 border-amber-400":"text-gray-400 hover:text-white"}`,children:"声望历史"})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-6 space-y-6",children:o&&d==="summary"?e.jsx("div",{className:"text-center text-amber-300 animate-glow p-8",children:"正在获取天机阁的最新情报..."}):d==="summary"?h():p()})]})})},B5=({isOpen:n,onClose:a,onSave:r,onLoad:o,onExport:c,onImport:d,onDelete:m,getSaves:f})=>{const[h,p]=v.useState({}),[b,g]=v.useState("save"),[w,N]=v.useState(null),[j,k]=v.useState(null),[_,C]=v.useState(""),S=La.useRef(null),D=M=>{var Z;const R=(Z=M.target.files)==null?void 0:Z[0];if(!R)return;const Q=new FileReader;Q.onload=G=>{var H;try{const O=(H=G.target)==null?void 0:H.result;if(typeof O!="string")throw new Error("文件不是有效的文本文件。");const U=JSON.parse(O);U.name&&U.timestamp&&U.gameState?(d(U),E()):alert("无效的存档文件格式。")}catch(O){console.error("导入存档失败:",O),alert("导入失败，文件可能已损坏或格式不正确。")}},Q.readAsText(R),S.current&&(S.current.value="")},E=v.useCallback(async()=>{const M=await f();p(M)},[f]);if(v.useEffect(()=>{n&&E()},[n,E]),!n)return null;const A=M=>{const R=h[M],Q=(R==null?void 0:R.name)||`存档 ${M}`;k(M),C(Q)},z=async M=>{_.trim()&&(r(M,_.trim()),k(null),C(""),setTimeout(()=>E(),200))},I=async M=>{await m(M),N(null),E()},L=M=>{const R=new Date(M),Q=R.getFullYear(),Z=String(R.getMonth()+1).padStart(2,"0"),G=String(R.getDate()).padStart(2,"0"),H=String(R.getHours()).padStart(2,"0"),O=String(R.getMinutes()).padStart(2,"0"),U=String(R.getSeconds()).padStart(2,"0");return`${Q}-${Z}-${G} ${H}:${O}:${U}`},T=M=>{if(!M)return"";const{playerProfile:R,exploration:Q}=M.gameState;return`${R.name} | ${Q.location} | 灵石: ${R.spiritStones}`},P=M=>{const R=h[M],Q=!R,Z=j===M;return e.jsxs("div",{className:`relative group bg-gradient-to-br ${Q?"from-stone-800/40 to-stone-900/40":"from-stone-800/80 to-stone-900/80"} rounded-xl p-5 border-2 transition-all duration-300 ${Q?"border-stone-700/30 hover:border-stone-600/50":"border-amber-900/50 hover:border-amber-700/70 hover:shadow-xl hover:shadow-amber-900/20"}`,children:[e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-amber-600 to-amber-800 flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-sm",children:M})})}),e.jsx("div",{className:"ml-10 mb-3",children:Z?e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"text",value:_,onChange:G=>C(G.target.value),onKeyPress:G=>{G.key==="Enter"&&z(M),G.key==="Escape"&&(k(null),C(""))},className:"flex-1 px-3 py-2 bg-stone-900/80 border border-amber-700/50 rounded-lg text-white font-serif focus:outline-none focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20",placeholder:"输入存档名称...",autoFocus:!0}),e.jsx("button",{onClick:()=>z(M),className:"px-4 py-2 bg-green-600 hover:bg-green-500 rounded-lg text-white font-semibold transition-colors",children:"确定"}),e.jsx("button",{onClick:()=>{k(null),C("")},className:"px-4 py-2 bg-stone-600 hover:bg-stone-500 rounded-lg text-white font-semibold transition-colors",children:"取消"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"text-lg font-bold text-amber-200 font-serif mb-1 flex items-center gap-2",children:[R?R.name:`空存档位 ${M}`,!Q&&b==="save"&&e.jsxs("button",{onClick:()=>A(M),className:"text-xs px-2 py-1 bg-amber-700/50 hover:bg-amber-600/50 rounded text-amber-200 transition-colors",title:"重命名",children:[e.jsx("i",{className:"fa-solid fa-pen-to-square mr-1"}),"改名"]})]}),R?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-amber-300/80 font-mono mb-1",children:[e.jsx("i",{className:"fa-solid fa-clock mr-1"}),L(R.timestamp)]}),e.jsxs("p",{className:"text-xs text-stone-400 line-clamp-1",children:[e.jsx("i",{className:"fa-solid fa-gamepad mr-1"}),T(R)]})]}):e.jsx("p",{className:"text-sm text-stone-500 italic",children:'点击"存档"按钮创建新存档'})]})}),!Z&&e.jsxs("div",{className:"flex items-center justify-end gap-2 mt-2",children:[b==="save"?e.jsxs("button",{onClick:()=>A(M),className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-sky-600 to-sky-700 hover:from-sky-500 hover:to-sky-600 rounded-lg font-bold text-white transition-all duration-200 shadow-lg hover:shadow-sky-500/30 transform hover:scale-105",children:[e.jsx("i",{className:"fa-solid fa-floppy-disk mr-2"}),Q?"新建存档":"覆盖存档"]}):e.jsxs("button",{onClick:()=>o(M),disabled:Q,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-600 rounded-lg font-bold text-white transition-all duration-200 shadow-lg hover:shadow-green-500/30 transform hover:scale-105 disabled:from-stone-700 disabled:to-stone-800 disabled:text-stone-500 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none",children:[e.jsx("i",{className:"fa-solid fa-folder-open mr-2"}),"读取存档"]}),e.jsx("button",{onClick:()=>c(M),disabled:Q,className:"w-11 h-11 rounded-lg font-semibold text-white bg-purple-700 hover:bg-purple-600 transition-all duration-200 flex items-center justify-center shadow-lg hover:shadow-purple-500/30 disabled:bg-stone-700 disabled:text-stone-500 disabled:cursor-not-allowed disabled:shadow-none",title:"导出存档",children:e.jsx("i",{className:"fa-solid fa-download"})}),e.jsx("button",{onClick:()=>N(M),disabled:Q,className:"w-11 h-11 rounded-lg font-semibold text-white bg-red-800 hover:bg-red-700 transition-all duration-200 flex items-center justify-center shadow-lg hover:shadow-red-500/30 disabled:bg-stone-700 disabled:text-stone-500 disabled:cursor-not-allowed disabled:shadow-none",title:"删除存档",children:e.jsx("i",{className:"fa-solid fa-trash-can"})})]}),w===M&&R&&e.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:()=>N(null),children:e.jsxs("div",{className:"bg-gradient-to-br from-stone-800 to-stone-900 border-2 border-red-600/50 rounded-xl w-full max-w-md shadow-2xl p-6 text-center font-serif",onClick:G=>G.stopPropagation(),children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-600/20 flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-triangle-exclamation text-red-500 text-3xl"})}),e.jsx("h3",{className:"text-2xl font-bold text-red-400 mb-3",children:"确认删除"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"你确定要永久删除存档"}),e.jsxs("p",{className:"text-xl font-bold text-amber-300 mb-1",children:['"',R.name,'"']}),e.jsx("p",{className:"text-sm text-stone-400 mb-6",children:"此操作无法撤销！"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs("button",{onClick:()=>N(null),className:"px-6 py-2.5 bg-stone-600 hover:bg-stone-500 rounded-lg font-semibold text-white transition-colors shadow-lg",children:[e.jsx("i",{className:"fa-solid fa-xmark mr-2"}),"取消"]}),e.jsxs("button",{onClick:()=>I(M),className:"px-6 py-2.5 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 rounded-lg font-bold text-white transition-all shadow-lg hover:shadow-red-500/30",children:[e.jsx("i",{className:"fa-solid fa-trash-can mr-2"}),"确认删除"]})]})]})})]},M)};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-gradient-to-br from-stone-900 to-black w-full max-w-4xl h-auto max-h-[85vh] rounded-2xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col border-2 border-amber-900/50",onClick:M=>M.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-5 flex-shrink-0 bg-gradient-to-r from-amber-900/40 to-stone-900/40 border-b-2 border-amber-900/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-amber-600 to-amber-800 flex items-center justify-center shadow-lg",children:e.jsx("i",{className:"fa-solid fa-floppy-disk text-white text-lg"})}),e.jsx("h2",{className:"text-3xl font-bold text-amber-300 font-serif",children:"存档管理"})]}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-stone-700 hover:bg-stone-600 transition-colors flex items-center justify-center text-amber-300 hover:text-white",children:e.jsx("i",{className:"fa-solid fa-times text-xl"})})]}),e.jsxs("div",{className:"flex-shrink-0 px-6 pt-4 flex space-x-2",children:[e.jsxs("button",{onClick:()=>g("save"),className:`flex-1 px-6 py-3 text-base font-bold rounded-t-xl transition-all duration-200 ${b==="save"?"bg-gradient-to-b from-amber-700 to-amber-800 text-white shadow-lg border-2 border-amber-600 border-b-0":"bg-stone-800/50 text-stone-400 hover:bg-stone-700/70 hover:text-stone-200 border-2 border-stone-700 border-b-0"}`,children:[e.jsx("i",{className:"fa-solid fa-floppy-disk mr-2"}),"保存游戏"]}),e.jsxs("button",{onClick:()=>g("load"),className:`flex-1 px-6 py-3 text-base font-bold rounded-t-xl transition-all duration-200 ${b==="load"?"bg-gradient-to-b from-green-700 to-green-800 text-white shadow-lg border-2 border-green-600 border-b-0":"bg-stone-800/50 text-stone-400 hover:bg-stone-700/70 hover:text-stone-200 border-2 border-stone-700 border-b-0"}`,children:[e.jsx("i",{className:"fa-solid fa-folder-open mr-2"}),"读取存档"]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-6 space-y-4 custom-scrollbar",children:[1,2,3,4,5].map(M=>P(M))}),e.jsxs("div",{className:"p-5 bg-gradient-to-r from-stone-900/60 to-black/60 border-t-2 border-stone-700/50 flex-shrink-0",children:[e.jsx("input",{type:"file",ref:S,onChange:D,className:"hidden",accept:"application/json"}),e.jsxs("button",{onClick:()=>{var M;return(M=S.current)==null?void 0:M.click()},className:"w-full px-6 py-3 rounded-xl font-bold text-white bg-gradient-to-r from-purple-700 to-purple-800 hover:from-purple-600 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-purple-500/30 transform hover:scale-[1.02]",children:[e.jsx("i",{className:"fa-solid fa-file-import mr-2"}),"从文件导入存档"]}),e.jsxs("p",{className:"text-center text-xs text-stone-500 mt-3 font-mono",children:[e.jsx("i",{className:"fa-solid fa-info-circle mr-1"}),"纯手动存档系统 - 不会自动保存游戏进度"]})]})]})})},bi=({className:n,style:a})=>e.jsxs("svg",{className:`absolute w-16 h-16 text-xianxia-gold-500/40 pointer-events-none ${n}`,style:a,viewBox:"0 0 100 100",fill:"currentColor",children:[e.jsx("path",{d:"M0,0 L30,0 L30,5 L5,5 L5,30 L0,30 Z"}),e.jsx("path",{d:"M10,10 L35,10 L35,12 L12,12 L12,35 L10,35 Z",opacity:"0.6"}),e.jsx("circle",{cx:"8",cy:"8",r:"2"})]}),U5=({story:n,storyEndRef:a})=>e.jsxs("div",{className:"relative w-full max-w-6xl h-full flex flex-col group",children:[e.jsx("div",{className:"absolute inset-0 bg-stone-950/90 rounded-xl border-2 border-xianxia-gold-700/30 shadow-2xl backdrop-blur-md overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-stone-900/50 via-transparent to-stone-900/30 pointer-events-none"})}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none z-20 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"absolute inset-1 border border-xianxia-gold-500/20 rounded-lg"}),e.jsx(bi,{className:"top-0 left-0"}),e.jsx(bi,{className:"top-0 right-0",style:{transform:"scaleX(-1)"}}),e.jsx(bi,{className:"bottom-0 right-0",style:{transform:"scale(-1, -1)"}}),e.jsx(bi,{className:"bottom-0 left-0",style:{transform:"scaleY(-1)"}}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-3/4 h-1 bg-xianxia-gold-500/30 blur-sm"}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 animate-bounce opacity-50",children:e.jsx("svg",{className:"w-6 h-6 text-xianxia-gold-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 13l-7 7-7-7m14-8l-7 7-7-7"})})})]}),e.jsxs("div",{className:"relative z-10 w-full h-full overflow-y-auto scrollbar-xianxia p-4 sm:p-8",children:[e.jsx("div",{className:"prose max-w-none prose-p:text-stone-100 prose-p:leading-loose prose-p:tracking-widest prose-headings:text-amber-300 prose-headings:font-xianxia prose-strong:text-amber-200 whitespace-pre-wrap animate-fade-in text-sm sm:text-base md:text-lg text-stone-100 selection:bg-amber-900/50 selection:text-amber-100 font-xianxia text-shadow-sm",children:n}),e.jsx("div",{ref:a})]})]}),H5=({isOpen:n,onClose:a,shop:r,cardCollection:o})=>{const[c,d]=v.useState(null),[m,f]=v.useState(""),[h,p]=v.useState(!1),[b,g]=v.useState(!1),[w,N]=v.useState(""),[j,k]=v.useState([]),[_,C]=v.useState(!1);if(!n)return null;const S=()=>{g(!0),k([]),N("")},D=async()=>{if(!c||!w.trim())return;const z=[...j,{role:"user",content:w}];k(z),C(!0);try{const I=z.slice(-6).map(M=>`${M.role==="user"?"玩家":c.name}: ${M.content}`).join(`
`),L=Object.entries(Yl).find(([M])=>{const R=r.staff.find(Q=>Q.positionId===M);return(R==null?void 0:R.characterId)===c.id}),T=L?L[1].name:"未知岗位",P=await Z1(c,T,w,I);k([...z,{role:"ai",content:P}]),N(""),Ke.setCurrentScene("surveillance"),Ke.captureMessage(P,"surveillance")}catch(I){console.error("互动生成失败:",I),alert("互动失败，请重试")}finally{C(!1)}},E=()=>{g(!1),k([]),N("")},A=async(z,I)=>{d(z),p(!0),f("");try{const L=await q1(z,I);f(L)}catch(L){console.error("Failed to generate surveillance report:",L),f("监视水晶似乎被一股神秘的力量干扰了...")}finally{p(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[60] flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border bg-stone-900 w-full max-w-3xl h-[70vh] rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg flex flex-col",onClick:z=>z.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 flex-shrink-0 bg-black/20",children:[e.jsxs("h2",{className:"text-2xl font-bold text-amber-300 font-serif",children:["监视 ",r.type]}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-2xl"})})]}),e.jsxs("div",{className:"flex-grow p-6 flex gap-6 overflow-hidden",children:[e.jsx("div",{className:"w-1/3 flex-shrink-0 space-y-3 overflow-y-auto",children:Object.entries(Yl).filter(([,z])=>z.shop===r.type).map(([z,I])=>{const L=r.staff.find(P=>P.positionId===z),T=L?o.find(P=>P.id===L.characterId):null;return e.jsxs("div",{children:[e.jsx("h4",{className:"text-amber-400 font-semibold mb-1",children:I.name}),T?e.jsx("button",{onClick:()=>A(T,I.name),className:`w-full text-left p-2 rounded-md transition-colors ${(c==null?void 0:c.id)===T.id?"bg-amber-600/50":"bg-stone-800/70 hover:bg-stone-700/90"}`,children:T.name}):e.jsx("div",{className:"p-2 text-gray-500 italic text-sm",children:"空缺"})]},z)})}),e.jsx("div",{className:"w-2/3 bg-black/30 rounded-lg p-4 overflow-y-auto border border-stone-700",children:b?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3 pb-2 border-b border-stone-600",children:[e.jsxs("h3",{className:"text-amber-400 font-semibold",children:["与 ",c==null?void 0:c.name," 互动"]}),e.jsx("button",{onClick:E,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto mb-3 space-y-2",children:[j.length===0?e.jsxs("p",{className:"text-center text-gray-500 italic",children:["开始与",c==null?void 0:c.name,"交流..."]}):j.map((z,I)=>e.jsxs("div",{className:`p-2 rounded ${z.role==="user"?"bg-blue-900/30 ml-8":"bg-amber-900/20 mr-8"}`,children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:z.role==="user"?"你":c==null?void 0:c.name}),e.jsx("div",{className:"text-gray-200 text-sm whitespace-pre-wrap",children:z.content})]},I)),_&&e.jsxs("div",{className:"text-center text-amber-300 animate-pulse",children:[c==null?void 0:c.name," 正在回应..."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,onChange:z=>N(z.target.value),onKeyPress:z=>z.key==="Enter"&&!_&&D(),disabled:_,placeholder:"输入你想说的话...",className:"flex-1 bg-stone-800 text-gray-200 px-3 py-2 rounded border border-stone-600 focus:border-amber-500 focus:outline-none disabled:opacity-50"}),e.jsx("button",{onClick:D,disabled:!w.trim()||_,className:"px-4 py-2 bg-amber-600 hover:bg-amber-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded transition-colors",children:_?"生成中...":"发送"})]})]}):e.jsx(e.Fragment,{children:h?e.jsx("div",{className:"text-center text-amber-300 animate-pulse",children:"正在通过水晶窥探..."}):m?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-300 whitespace-pre-wrap font-serif leading-relaxed mb-4",children:m}),c&&e.jsxs("button",{onClick:S,className:"w-full mt-4 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-comments"}),e.jsx("span",{children:"参与互动"})]})]}):e.jsx("div",{className:"text-center text-gray-500 h-full flex items-center justify-center",children:e.jsx("p",{children:"选择一名员工进行监视。"})})})})]})]})})},P5=({isOpen:n,onClose:a,playerProfile:r})=>{const[o,c]=v.useState([]),[d,m]=v.useState(null),[f,h]=v.useState([]),[p,b]=v.useState(""),[g,w]=v.useState(!1);if(v.useEffect(()=>{if(n){const j=r.relationships.filter(k=>k.relationshipStatus==="熟人");c(j),j.length>0?m(j[0]):m(null),h([]),b("")}},[n,r.relationships]),!n)return null;const N=async()=>{if(p.trim()&&!g&&d){const j={sender:"user",text:p},k=[...f,j];h(k),b(""),w(!0);try{const _=await K1(r,d,k);h(C=>[...C,{sender:"ai",text:_}])}catch(_){console.error("传音失败:",_),h(C=>[...C,{sender:"ai",text:"...信号中断..."}])}finally{w(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in",onClick:a,children:e.jsxs("div",{className:"ornate-border-dialog bg-stone-900/90 backdrop-blur-lg w-full max-w-4xl h-[80vh] rounded-xl shadow-2xl flex",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"w-1/3 border-r-2 border-amber-500/10 flex flex-col bg-black/20",children:[e.jsx("h3",{className:"text-xl font-bold text-amber-200 p-4 border-b-2 border-amber-500/10 text-center font-serif tracking-widest",children:"传音玉简"}),e.jsx("ul",{className:"flex-grow overflow-y-auto scrollbar-thin scrollbar-thumb-amber-700/50 scrollbar-track-transparent",children:o.length>0?o.map(j=>e.jsxs("li",{className:`p-4 flex items-center cursor-pointer hover:bg-amber-500/10 transition-colors duration-200 border-b border-amber-500/5 ${(d==null?void 0:d.id)===j.id?"bg-amber-500/20":""}`,onClick:()=>m(j),children:[e.jsx("i",{className:"fa-solid fa-user-circle text-2xl mr-4 text-amber-300/70"}),e.jsx("span",{className:"text-lg text-gray-200 font-serif",children:j.name})]},j.id)):e.jsx("li",{className:"p-4 text-center text-gray-500",children:"暂无熟人"})})]}),e.jsx("div",{className:"w-2/3 flex flex-col bg-stone-800/30",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b-2 border-amber-500/10 flex justify-between items-center bg-black/20",children:[e.jsx("h3",{className:"text-xl font-bold text-amber-200 font-serif tracking-wider",children:d.name}),e.jsx("button",{onClick:a,className:"text-amber-300 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-times text-xl"})})]}),e.jsx("div",{className:"flex-grow p-4 overflow-y-auto space-y-4 scrollbar-thin scrollbar-thumb-amber-700/50 scrollbar-track-transparent",children:f.map((j,k)=>e.jsxs("div",{className:`flex items-start gap-3 animate-fade-in-up ${j.sender==="user"?"justify-end":"justify-start"}`,children:[j.sender==="ai"&&e.jsx("i",{className:"fa-solid fa-user-circle text-2xl text-amber-300/70 mt-1"}),e.jsx("div",{className:`max-w-xs lg:max-w-md p-3 rounded-lg font-serif shadow-md ${j.sender==="user"?"bg-blue-900/60 text-white rounded-br-none":"bg-stone-700/60 text-gray-200 rounded-bl-none"}`,children:j.text}),j.sender==="user"&&e.jsx("i",{className:"fa-solid fa-user-circle text-2xl text-blue-300/70 mt-1"})]},k))}),e.jsx("div",{className:"p-4 border-t-2 border-amber-500/10 bg-black/20",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"text",value:p,onChange:j=>b(j.target.value),onKeyPress:j=>j.key==="Enter"&&N(),className:"w-full bg-stone-800/80 border border-amber-500/30 rounded-l-md p-3 text-gray-200 focus:outline-none focus:ring-1 focus:ring-amber-400 font-serif",placeholder:g?"对方正在输入...":"输入传音内容...",disabled:g}),e.jsx("button",{onClick:N,disabled:g||!p.trim(),className:"bg-amber-600 text-white px-5 py-3 rounded-r-md hover:bg-amber-500 transition-colors font-semibold disabled:bg-stone-600 disabled:cursor-not-allowed flex items-center justify-center w-20",children:g?e.jsx("i",{className:"fas fa-spinner fa-pulse"}):e.jsx("i",{className:"fa-solid fa-paper-plane"})})]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx("i",{className:"fa-solid fa-comments text-4xl mb-4"}),e.jsx("p",{children:"请先从左侧选择一位熟人开始传音"})]})})]})})},q5=()=>{const[n,a]=v.useState({isCompact:!1,isMiniMode:!1,isMobile:!1,availableHeight:window.innerHeight,availableWidth:window.innerWidth,contentHeight:window.innerHeight,shouldHideTopBar:!1});return v.useEffect(()=>{const r=()=>{const c=window.innerHeight,d=window.innerWidth,m=c<500,f=c<600,h=d<768,p=m?0:f?48:64,b=f?80:112,g=c-p-b;a({isCompact:f,isMiniMode:m,isMobile:h,availableHeight:c,availableWidth:d,contentHeight:Math.max(g,200),shouldHideTopBar:m})};r(),window.addEventListener("resize",r);const o=new ResizeObserver(r);return o.observe(document.body),()=>{window.removeEventListener("resize",r),o.disconnect()}},[]),n},Z5=()=>{const[n,a]=v.useState(!1),[r,o]=v.useState(0);return v.useEffect(()=>{const c=()=>{const d=window.scrollY;d>r&&d>50?a(!0):a(!1),o(d)};return window.addEventListener("scroll",c,{passive:!0}),()=>window.removeEventListener("scroll",c)},[r]),n},xh=()=>{const n=document;return n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement},G5=n=>{const a=n;a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen&&a.msRequestFullscreen()},V5=()=>{const n=document;n.exitFullscreen?n.exitFullscreen():n.webkitExitFullscreen?n.webkitExitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.msExitFullscreen&&n.msExitFullscreen()},Q5=n=>{const[a,r]=v.useState(!!xh()),o=v.useCallback(()=>{r(!!xh())},[]);v.useLayoutEffect(()=>(document.addEventListener("fullscreenchange",o),document.addEventListener("webkitfullscreenchange",o),document.addEventListener("mozfullscreenchange",o),document.addEventListener("MSFullscreenChange",o),()=>{document.removeEventListener("fullscreenchange",o),document.removeEventListener("webkitfullscreenchange",o),document.removeEventListener("mozfullscreenchange",o),document.removeEventListener("MSFullscreenChange",o)}),[o]);const c=v.useCallback(()=>{a?V5():n.current&&G5(n.current)},[a,n]);return{isFullscreen:a,toggleFullscreen:c}},Y5=({playerProfile:n,location:a,onProfileClick:r,appRef:o})=>{const c=q5(),d=Z5(),{isFullscreen:m,toggleFullscreen:f}=Q5(o);return c.shouldHideTopBar&&!m?null:c.isCompact?e.jsxs("header",{className:`fixed top-0 left-0 right-0 h-14 bg-gradient-to-b from-[var(--onmyoji-bg-primary)] via-[var(--onmyoji-bg-secondary)]/95 to-transparent backdrop-blur-md px-3 flex justify-between items-center z-30 font-serif text-xs transition-transform duration-300 ${d?"-translate-y-full":"translate-y-0"}`,children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-[2px] bg-gradient-to-r from-transparent via-[var(--onmyoji-gold)] to-transparent opacity-60"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-[var(--onmyoji-gold-dark)] to-transparent opacity-40"}),e.jsxs("button",{onClick:r,className:"flex items-center gap-2 bg-[var(--onmyoji-bg-tertiary)]/80 px-2 py-1.5 rounded-lg border border-[var(--onmyoji-border-subtle)] hover:border-[var(--onmyoji-gold-dark)] transition-all active:scale-95 shadow-onmyoji group",children:[e.jsxs("div",{className:"relative w-7 h-7",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-[var(--onmyoji-gold-dark)] group-hover:border-[var(--onmyoji-gold)] transition-colors"}),e.jsx("div",{className:"absolute inset-0.5 rounded-full bg-gradient-to-br from-[var(--onmyoji-bg-secondary)] to-[var(--onmyoji-bg-primary)] flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-user text-[var(--onmyoji-gold)] text-xs"})}),e.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-[var(--onmyoji-gold)] rounded-full opacity-60 group-hover:opacity-100 transition-opacity shadow-[0_0_4px_var(--onmyoji-gold-glow)]"})]}),e.jsx("span",{className:"text-[var(--onmyoji-text-primary)] font-semibold text-xs tracking-wide group-hover:text-[var(--onmyoji-gold)] transition-colors",children:n.name})]}),e.jsxs("div",{className:"relative bg-[var(--onmyoji-bg-tertiary)]/60 px-4 py-1.5 rounded-lg border border-[var(--onmyoji-border-subtle)]",children:[e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-1/2 text-[var(--onmyoji-gold)] text-[8px] opacity-40",children:"◆"}),e.jsx("p",{className:"text-[var(--onmyoji-text-primary)] font-semibold text-xs tracking-wider",children:a}),e.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-[var(--onmyoji-gold)] text-[8px] opacity-40",children:"◆"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 bg-[var(--onmyoji-bg-tertiary)]/80 px-3 py-1.5 rounded-lg border border-[var(--onmyoji-border-subtle)]",children:[e.jsx("i",{className:"fa-solid fa-gem text-[var(--onmyoji-gold)] text-sm drop-shadow-[0_0_6px_var(--onmyoji-gold-glow)]"}),e.jsx("span",{className:"text-[var(--onmyoji-gold-light)] font-bold text-xs",children:n.spiritStones})]}),e.jsx("button",{onClick:f,className:"w-8 h-8 flex items-center justify-center bg-[var(--onmyoji-bg-tertiary)]/80 rounded-lg border border-[var(--onmyoji-border-subtle)] hover:border-[var(--onmyoji-gold-dark)] transition-all active:scale-95",children:e.jsx("i",{className:`fa-solid ${m?"fa-compress":"fa-expand"} text-[var(--onmyoji-gold)] text-sm`})})]})]}):e.jsxs("header",{className:`fixed top-0 left-0 right-0 h-16 bg-gradient-to-b from-[var(--onmyoji-bg-primary)] via-[var(--onmyoji-bg-secondary)]/95 to-transparent backdrop-blur-md px-4 flex justify-between items-center z-30 font-serif text-sm transition-transform duration-300 ${d?"-translate-y-full":"translate-y-0"}`,children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-[2px] bg-gradient-to-r from-transparent via-[var(--onmyoji-gold)] to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-[var(--onmyoji-gold-dark)] to-transparent opacity-50"}),e.jsx("div",{className:"absolute top-2 left-4 text-[var(--onmyoji-gold)] text-xs opacity-30",children:"❖"}),e.jsx("div",{className:"absolute top-2 right-4 text-[var(--onmyoji-gold)] text-xs opacity-30",children:"❖"}),e.jsx("div",{className:"flex items-center gap-4 pointer-events-auto z-10",children:e.jsxs("button",{onClick:r,className:"group flex items-center gap-3 bg-[var(--onmyoji-bg-tertiary)]/90 p-1.5 pr-4 rounded-xl border border-[var(--onmyoji-border-subtle)] hover:border-[var(--onmyoji-gold-dark)] transition-all duration-300 active:scale-95 shadow-onmyoji backdrop-blur-sm",children:[e.jsxs("div",{className:"relative w-10 h-10",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-[var(--onmyoji-gold-dark)] group-hover:border-[var(--onmyoji-gold)] transition-colors opacity-80"}),e.jsx("div",{className:"absolute inset-1 rounded-full border border-[var(--onmyoji-border-subtle)]"}),e.jsx("div",{className:"absolute inset-1.5 rounded-full bg-gradient-to-br from-[var(--onmyoji-bg-secondary)] to-[var(--onmyoji-bg-primary)] flex items-center justify-center overflow-hidden",children:n.avatar?e.jsx("img",{src:n.avatar,alt:"Avatar",className:"w-full h-full rounded-full object-cover opacity-90 group-hover:opacity-100 transition-opacity"}):e.jsx("i",{className:"fa-solid fa-user-ninja text-lg text-[var(--onmyoji-gold)]"})}),e.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-[var(--onmyoji-gold)] rounded-full opacity-60 group-hover:opacity-100 transition-opacity shadow-[0_0_8px_var(--onmyoji-gold-glow)] animate-pulse"}),e.jsx("div",{className:"absolute -bottom-0.5 -left-0.5 w-1.5 h-1.5 bg-[var(--onmyoji-purple)] rounded-full opacity-40 group-hover:opacity-80 transition-opacity shadow-[0_0_6px_var(--onmyoji-purple-glow)]"})]}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("h2",{className:"font-bold text-[var(--onmyoji-text-primary)] group-hover:text-[var(--onmyoji-gold)] transition-colors tracking-wider leading-tight drop-shadow-sm",children:n.name}),e.jsxs("p",{className:"text-[10px] text-[var(--onmyoji-gold-dark)] font-medium tracking-widest flex items-center gap-1",children:[e.jsx("span",{className:"text-[8px] opacity-60",children:"✦"}),n.title,e.jsx("span",{className:"text-[8px] opacity-60",children:"✦"})]})]})]})}),e.jsxs("div",{className:"flex items-center gap-3 pointer-events-auto z-10",children:[e.jsxs("div",{className:"flex items-center gap-0 bg-[var(--onmyoji-bg-tertiary)]/80 rounded-xl border border-[var(--onmyoji-border-subtle)] shadow-onmyoji backdrop-blur-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-r border-[var(--onmyoji-border-subtle)]",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa-solid fa-gem text-[var(--onmyoji-gold)] text-sm drop-shadow-[0_0_8px_var(--onmyoji-gold-glow)]"}),e.jsx("div",{className:"absolute inset-0 animate-mystic-pulse opacity-50",children:e.jsx("i",{className:"fa-solid fa-gem text-[var(--onmyoji-gold)] text-sm"})})]}),e.jsx("span",{className:"text-[var(--onmyoji-gold-light)] font-bold font-mono text-sm tracking-wide",children:n.spiritStones})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2",children:[e.jsx("i",{className:"fa-solid fa-location-dot text-[10px] text-[var(--onmyoji-ghost)] drop-shadow-[0_0_4px_var(--onmyoji-ghost-glow)]"}),e.jsx("span",{className:"text-xs text-[var(--onmyoji-text-secondary)] font-serif tracking-wider",children:a})]})]}),e.jsxs("button",{onClick:f,className:"group relative w-10 h-10 flex items-center justify-center bg-[var(--onmyoji-bg-tertiary)]/80 rounded-xl border border-[var(--onmyoji-border-subtle)] hover:border-[var(--onmyoji-gold-dark)] transition-all active:scale-95 shadow-onmyoji backdrop-blur-sm",children:[e.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-[var(--onmyoji-gold-glow)] to-transparent opacity-0 group-hover:opacity-30 transition-opacity"}),e.jsx("i",{className:`fa-solid ${m?"fa-compress":"fa-expand"} text-[var(--onmyoji-gold)] text-xs group-hover:text-[var(--onmyoji-gold-light)] transition-colors relative z-10`})]})]})]})},J5=(n,a)=>{let r=null;return(...o)=>{r&&clearTimeout(r),r=setTimeout(()=>{n(...o)},a)}},F5=150,X5=10;function K5(){const n=v.useRef(0);v.useEffect(()=>{if(window.self===window.top){console.log("[IframeHeightSync] Not in an iframe, skipping activation.");return}const a=()=>{const m=document.documentElement.scrollHeight,f=Math.abs(m-n.current);m>0&&f>=X5&&(window.parent.postMessage({type:"set-frame-height",height:m},"*"),n.current=m,console.log(`[IframeHeightSync] Sent height update: ${m}px`))},r=J5(a,F5),o=new ResizeObserver(r),c=document.documentElement;o.observe(c),console.log("[IframeHeightSync] Activated. Observing document element.");const d=setTimeout(a,300);return()=>{o.disconnect(),clearTimeout(d),console.log("[IframeHeightSync] Deactivated.")}},[])}function W5(){const[n,a]=v.useState(null),[r,o]=v.useState(!1),[c,d]=v.useState(!1),[m,f]=v.useState(!1),[h,p]=v.useState(!1),[b,g]=v.useState(!1),[w,N]=v.useState(!1),[j,k]=v.useState(!1),[_,C]=v.useState(!1),[S,D]=v.useState(!1),[E,A]=v.useState(!1),[z,I]=v.useState(!1),[L,T]=v.useState(!1),[P,M]=v.useState(!1),[R,Q]=v.useState(!1),[Z,G]=v.useState(!1),[H,O]=v.useState(!1),[U,te]=v.useState(!1),[ie,B]=v.useState(!1),[W,ne]=v.useState(!1),[X,J]=v.useState(!1),[re,pe]=v.useState(!1),[me,ae]=v.useState(!1),[xe,he]=v.useState(!1),[Se,et]=v.useState(!1),[Re,kt]=v.useState(!1),[Dt,hs]=v.useState(!1),[ut,ns]=v.useState(!1),[Qs,ps]=v.useState(!1),qa=v.useCallback(Ce=>a(Ce),[]),la=v.useCallback(()=>a(null),[]),vt=v.useCallback(()=>o(!0),[]),Za=v.useCallback(()=>o(!1),[]),oa=v.useCallback(()=>d(!0),[]),ia=v.useCallback(()=>d(!1),[]),Ys=v.useCallback(()=>f(!0),[]),_s=v.useCallback(()=>f(!1),[]),Ga=v.useCallback(()=>p(!0),[]),Yr=v.useCallback(()=>p(!1),[]),Jr=v.useCallback(()=>g(!0),[]),Js=v.useCallback(()=>g(!1),[]),St=v.useCallback(()=>N(!0),[]),as=v.useCallback(()=>N(!1),[]),Ye=v.useCallback(()=>k(!0),[]),Fr=v.useCallback(()=>k(!1),[]),Xr=v.useCallback(()=>C(!0),[]),Kr=v.useCallback(()=>C(!1),[]),yn=v.useCallback(()=>D(!0),[]),vn=v.useCallback(()=>D(!1),[]),jn=v.useCallback(()=>A(!0),[]),bs=v.useCallback(()=>A(!1),[]),Nn=v.useCallback(()=>I(!0),[]),$s=v.useCallback(()=>I(!1),[]),Fs=v.useCallback(()=>T(!0),[]),Es=v.useCallback(()=>T(!1),[]),ca=v.useCallback(()=>M(!0),[]),As=v.useCallback(()=>M(!1),[]),Wr=v.useCallback(()=>Q(!0),[]),Va=v.useCallback(()=>Q(!1),[]),da=v.useCallback(()=>G(!0),[]),Qa=v.useCallback(()=>G(!1),[]),ua=v.useCallback(()=>O(!0),[]),ma=v.useCallback(()=>O(!1),[]),Ya=v.useCallback(()=>te(!0),[]),Ja=v.useCallback(()=>te(!1),[]),Jt=v.useCallback(()=>B(!0),[]),ot=v.useCallback(()=>B(!1),[]),jt=v.useCallback(()=>ne(!0),[]),Ts=v.useCallback(()=>ne(!1),[]),xa=v.useCallback(()=>J(!0),[]),el=v.useCallback(()=>J(!1),[]),fa=v.useCallback(()=>pe(!0),[]),Fa=v.useCallback(()=>pe(!1),[]),Xs=v.useCallback(()=>ae(!0),[]),Ks=v.useCallback(()=>ae(!1),[]),Ms=v.useCallback(()=>he(!0),[]),zs=v.useCallback(()=>he(!1),[]),Ws=v.useCallback(()=>et(!0),[]),Ds=v.useCallback(()=>et(!1),[]),at=v.useCallback(()=>kt(!0),[]),Xa=v.useCallback(()=>kt(!1),[]),Ka=v.useCallback(()=>hs(!0),[]),gs=v.useCallback(()=>hs(!1),[]),Os=v.useCallback(()=>ns(!0),[]),tl=v.useCallback(()=>ns(!1),[]),Wa=v.useCallback(()=>ps(Ce=>!Ce),[]),er=v.useCallback(()=>ps(!1),[]),sl=v.useCallback(()=>{a(null),o(!1),d(!1),f(!1),p(!1),g(!1),N(!1),k(!1),C(!1),D(!1),A(!1),I(!1),T(!1),M(!1),Q(!1),G(!1),O(!1),te(!1),B(!1),ne(!1),J(!1),pe(!1),ae(!1),he(!1),et(!1),kt(!1),hs(!1),ns(!1),ps(!1)},[]),wn=v.useMemo(()=>!!(n||r||c||m||h||b||w||j||_||S||E||z||L||P||R||Z||H||U||ie||W||X||re||me||xe||Se||Re||Dt||ut),[n,r,c,m,h,b,w,j,_,S,E,z,L,P,R,Z,H,U,ie,W,X,re,me,xe,Se,Re,Dt,ut]),kn=v.useMemo(()=>{let Ce=0;return n&&Ce++,r&&Ce++,c&&Ce++,m&&Ce++,h&&Ce++,b&&Ce++,w&&Ce++,j&&Ce++,_&&Ce++,S&&Ce++,E&&Ce++,z&&Ce++,L&&Ce++,P&&Ce++,R&&Ce++,Z&&Ce++,H&&Ce++,U&&Ce++,ie&&Ce++,W&&Ce++,X&&Ce++,re&&Ce++,me&&Ce++,xe&&Ce++,Se&&Ce++,Re&&Ce++,Dt&&Ce++,ut&&Ce++,Ce},[n,r,c,m,h,b,w,j,_,S,E,z,L,P,R,Z,H,U,ie,W,X,re,me,xe,Se,Re,Dt,ut]);return{activeModal:n,isPreBattleModalOpen:r,isChallengeModalOpen:c,isMapOpen:m,isPersonalInfoOpen:h,isRelationshipModalOpen:b,isReputationModalOpen:w,isCharacterStatusModalOpen:j,isInteractionModalOpen:_,isTelepathyModalOpen:S,isSaveLoadModalOpen:E,isAnnouncementModalOpen:z,isQuestLogModalOpen:L,isMemoryModalOpen:P,isBusinessModalOpen:R,isHospitalModalOpen:Z,isMedicalRecordOpen:H,isBountyBoardOpen:U,isCultivationModalOpen:ie,isVectorSettingsOpen:W,isSemanticSearchOpen:X,isPrisonModalOpen:re,isInterrogationModalOpen:me,isEtiquetteHallOpen:xe,isGauntletHallOpen:Se,isGauntletAnnouncementOpen:Re,isGauntletRegistrationOpen:Dt,isGauntletLiveOpen:ut,isFABOpen:Qs,openModal:qa,closeModal:la,openPreBattleModal:vt,closePreBattleModal:Za,openChallengeModal:oa,closeChallengeModal:ia,openMap:Ys,closeMap:_s,openPersonalInfo:Ga,closePersonalInfo:Yr,openRelationshipModal:Jr,closeRelationshipModal:Js,openReputationModal:St,closeReputationModal:as,openCharacterStatusModal:Ye,closeCharacterStatusModal:Fr,openInteractionModal:Xr,closeInteractionModal:Kr,openTelepathyModal:yn,closeTelepathyModal:vn,openSaveLoadModal:jn,closeSaveLoadModal:bs,openAnnouncementModal:Nn,closeAnnouncementModal:$s,openQuestLogModal:Fs,closeQuestLogModal:Es,openMemoryModal:ca,closeMemoryModal:As,openBusinessModal:Wr,closeBusinessModal:Va,openHospitalModal:da,closeHospitalModal:Qa,openMedicalRecordModal:ua,closeMedicalRecordModal:ma,openBountyBoard:Ya,closeBountyBoard:Ja,openCultivationModal:Jt,closeCultivationModal:ot,openVectorSettings:jt,closeVectorSettings:Ts,openSemanticSearch:xa,closeSemanticSearch:el,openPrisonModal:fa,closePrisonModal:Fa,openInterrogationModal:Xs,closeInterrogationModal:Ks,openEtiquetteHall:Ms,closeEtiquetteHall:zs,openGauntletHall:Ws,closeGauntletHall:Ds,openGauntletAnnouncement:at,closeGauntletAnnouncement:Xa,openGauntletRegistration:Ka,closeGauntletRegistration:gs,openGauntletLive:Os,closeGauntletLive:tl,toggleFAB:Wa,closeFAB:er,closeAllModals:sl,setActiveModal:a,setIsPreBattleModalOpen:o,setIsChallengeModalOpen:d,setIsMapOpen:f,setIsPersonalInfoOpen:p,setIsRelationshipModalOpen:g,setIsReputationModalOpen:N,setIsCharacterStatusModalOpen:k,setIsInteractionModalOpen:C,setIsTelepathyModalOpen:D,setIsSaveLoadModalOpen:A,setIsAnnouncementModalOpen:I,setIsQuestLogModalOpen:T,setIsMemoryModalOpen:M,setIsBusinessModalOpen:Q,setIsHospitalModalOpen:G,setIsMedicalRecordOpen:O,setIsBountyBoardOpen:te,setIsCultivationModalOpen:B,setIsVectorSettingsOpen:ne,setIsSemanticSearchOpen:J,setIsPrisonModalOpen:pe,setIsInterrogationModalOpen:ae,setIsEtiquetteHallOpen:he,setIsGauntletHallOpen:et,setIsGauntletAnnouncementOpen:kt,setIsGauntletRegistrationOpen:hs,setIsGauntletLiveOpen:ns,setIsFABOpen:ps,hasAnyModalOpen:wn,openModalCount:kn}}function e4(n){const{gameState:a,setGameState:r,closeSaveLoadModal:o,setShowStartScreen:c,setIsGameReady:d}=n,m=v.useCallback(async(N,j)=>{const k={name:j,timestamp:Date.now(),gameState:a};await Zs.saveToSlot(N,k)},[a]),f=v.useCallback(async N=>{const k=(await Zs.getAllSaves())[N];if(!k){alert("没有可导出的存档！");return}const _=JSON.stringify(k,null,2),C=new Blob([_],{type:"application/json"}),S=URL.createObjectURL(C),D=document.createElement("a");D.href=S,D.download=`${k.name.replace(/\s/g,"_")}_${new Date(k.timestamp).toISOString()}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(S)},[]),h=v.useCallback(async N=>{const j=prompt("请选择要导入到的存档槽位 (1-5):");if(!j)return;const k=parseInt(j,10);if(isNaN(k)||k<1||k>5){alert("无效的槽位！请输入1到5之间的数字。");return}try{await Zs.saveToSlot(k,N),alert(`存档 "${N.name}" 已成功导入到槽位 ${k}！请重新打开菜单查看。`),o==null||o()}catch(_){console.error("导入存档时保存失败:",_),alert("保存导入的存档时发生错误。")}},[o]),p=v.useCallback(async N=>{const j=await Zs.loadFromSlot(N);j&&r(j),o==null||o()},[r,o]),b=v.useCallback(async N=>{await Zs.deleteSlot(N)},[]),g=v.useCallback(async N=>{const j=await Zs.loadFromSlot(N);j?(r(j),c==null||c(!1),d==null||d(!0)):alert("加载存档失败，存档可能已损坏。")},[r,c,d]),w=v.useCallback(async()=>Zs.getAllSaves(),[]);return{handleSave:m,handleLoad:p,handleExport:f,handleImport:h,handleDelete:b,handleLoadFromStartScreen:g,getAllSaves:w,storageService:Zs}}const fh={凡品:3600*1e3,良品:7200*1e3,优品:14400*1e3,珍品:480*60*1e3,绝品:720*60*1e3,仙品:1080*60*1e3,圣品:1440*60*1e3,神品:2880*60*1e3};function t4(n){const{gameState:a,setGameState:r,setError:o,setIsLoading:c,addMemory:d}=n;v.useEffect(()=>{const h=()=>{r(b=>{const g=Date.now();let w=!1;const N=b.cultivationPavilion.map(j=>j.status==="Breeding"&&j.endTime>0&&g>=j.endTime?(w=!0,console.log(`[育灵仓] 培育仓 #${j.slotId} 已完成，状态更新为 Ready`),{...j,status:"Ready",monitoringLog:[{timestamp:"培育完成",message:"灵胎已成熟，可以开启查看结果。"},...j.monitoringLog]}):j);return w?(console.log("[育灵仓] 状态已更新，触发重渲染"),{...b,cultivationPavilion:N}):b})},p=setInterval(h,1e3);return h(),()=>clearInterval(p)},[r]);const m=v.useCallback((h,p,b)=>{const{cardCollection:g,petCollection:w}=a.playerProfile,N=[...g,...w],j=N.find(A=>A.id===p),k=N.find(A=>A.id===b);if(!j||!k){o("选择的父母卡牌无效。");return}const _=fh[j.rarity],C=fh[k.rarity],S=(_+C)/2,D=Date.now(),E=D+S;r(A=>{const z=A.cultivationPavilion.map(I=>I.slotId===h?{...I,parentA:j,parentB:k,startTime:D,endTime:E,status:"Breeding",monitoringLog:[{timestamp:"培育开始",message:`能量已注入，${j.name} 与 ${k.name} 的生命精华开始融合。`}]}:I);return{...A,cultivationPavilion:z}})},[a.playerProfile,r,o]),f=v.useCallback(async h=>{const p=a.cultivationPavilion.find(b=>b.slotId===h);if(!p||p.status!=="Ready"||!p.parentA||!p.parentB){o("无法领取，培育尚未完成或数据异常。");return}c(!0);try{const b=await F1(p.parentA,p.parentB);r(g=>{const w={...g.playerProfile};"skills"in b?w.cardCollection.push(b):w.petCollection.push(b);const N=g.cultivationPavilion.map(j=>j.slotId===h?{...j,parentA:null,parentB:null,startTime:0,endTime:0,status:"Empty",monitoringLog:[]}:j);return{...g,playerProfile:w,cultivationPavilion:N}}),alert(`恭喜！你获得了新的卡牌：【${b.name}】！`),p.parentA&&p.parentB&&d("培育","育灵轩培育成功",`【${p.parentA.name}】与【${p.parentB.name}】的灵胎已成熟，诞生了新的生命：【${b.name}】！`,[p.parentA.name,p.parentB.name,b.name])}catch(b){console.error("生成后代失败:",b),o("开启灵胎失败，似乎有一股神秘力量阻止了新生命的诞生。")}finally{c(!1)}},[a.cultivationPavilion,r,o,c,d]);return{cultivationSlots:a.cultivationPavilion,handleStartCultivation:m,handleClaimCultivation:f}}function s4({gameState:n,setGameState:a}){return{addMemory:v.useCallback((o,c,d,m)=>{const f={id:`memory-${Date.now()}-${Math.random()}`,category:o,title:c,content:d,timestamp:n.exploration.time,realTimestamp:Date.now(),location:n.exploration.location,involvedCharacters:m};a(h=>{const p=[f,...h.memories[o]].slice(0,100),b={...h,memories:{...h.memories,[o]:p}};if(h.summarySettings.autoSummaryEnabled){const{smallSummaryInterval:g,largeSummaryInterval:w}=h.summarySettings,N=p.length,j=h.memorySummaries[o].small.length;if(N>0&&N%g===0){const k=Math.max(0,N-g),_=N-1,C=p.slice(k,_+1);iu(C,"small",o,h.summarySettings.summaryPrompts.small).then(S=>{a(D=>{const E=[S,...D.memorySummaries[o].small].slice(0,50);return{...D,memorySummaries:{...D.memorySummaries,[o]:{...D.memorySummaries[o],small:E}}}})}).catch(S=>console.error("自动生成小总结失败:",S))}if(j>0&&j%w===0){const _=h.memorySummaries[o].small.slice(0,w).map(C=>({id:C.id,category:C.category,title:C.title,content:C.content,timestamp:C.timestamp,realTimestamp:C.realTimestamp,location:void 0,involvedCharacters:void 0}));iu(_,"large",o,h.summarySettings.summaryPrompts.large).then(C=>{a(S=>{const D=[C,...S.memorySummaries[o].large].slice(0,50);return{...S,memorySummaries:{...S.memorySummaries,[o]:{...S.memorySummaries[o],large:D}}}})}).catch(C=>console.error("自动生成大总结失败:",C))}}return b})},[n.exploration.time,n.exploration.location,a])}}function n4(n){const{gameState:a,setGameState:r,setError:o,setIsLoading:c}=n,d=v.useCallback(b=>{r(g=>({...g,memories:{...g.memories,[b]:[]}}))},[r]),m=v.useCallback((b,g)=>{r(w=>({...w,memories:{...w.memories,[b]:w.memories[b].filter(N=>N.id!==g)}}))},[r]),f=v.useCallback((b,g,w)=>{r(N=>({...N,memorySummaries:{...N.memorySummaries,[b]:{...N.memorySummaries[b],[w]:N.memorySummaries[b][w].filter(j=>j.id!==g)}}}))},[r]),h=v.useCallback(async(b,g,w,N)=>{const k=a.memories[b].slice(g,w+1);if(k.length===0){o("没有选择任何记忆进行总结。");return}c(!0);try{const _=N==="small"?a.summarySettings.summaryPrompts.small:a.summarySettings.summaryPrompts.large,C=await iu(k,N,b,_);r(S=>{const D=[C,...S.memorySummaries[b][N]].slice(0,50);return{...S,memorySummaries:{...S.memorySummaries,[b]:{...S.memorySummaries[b],[N]:D}}}})}catch(_){console.error("生成总结失败:",_),o("AI生成总结失败，请稍后再试。")}finally{c(!1)}},[a.memories,a.summarySettings.summaryPrompts,r,o,c]),p=v.useCallback(b=>{r(g=>({...g,summarySettings:b}))},[r]);return{handleClearMemoryCategory:d,handleDeleteMemoryEntry:m,handleDeleteSummary:f,handleManualSummary:h,handleUpdateSummarySettings:p}}function a4(n){var P,M;const{gameState:a,setGameState:r,setIsLoading:o,setError:c,addMemory:d,setIsPreBattleModalOpen:m,pendingBattle:f,setPendingBattle:h}=n,[p,b]=v.useState([]),[g,w]=v.useState(null),[N,j]=v.useState(null),[k,_]=v.useState(null),C=R=>R.includes("剑")||R.includes("斩")?"slash":R.includes("火")||R.includes("焰")?"fire":R.includes("疗")||R.includes("愈")?"heal":R.includes("盾")||R.includes("御")?"shield":"default",S=R=>new Promise(Q=>setTimeout(Q,R)),D=R=>R>=5e3?{tier:"王者",division:"",points:R,tierIcon:"👑"}:R>=4e3?{tier:"钻石",division:String(5-Math.floor((R-4e3)/200)),points:R,tierIcon:"💎"}:R>=3e3?{tier:"白金",division:String(5-Math.floor((R-3e3)/200)),points:R,tierIcon:"🛡️"}:R>=2e3?{tier:"黄金",division:String(5-Math.floor((R-2e3)/200)),points:R,tierIcon:"🌟"}:R>=1e3?{tier:"白银",division:String(5-Math.floor((R-1e3)/200)),points:R,tierIcon:"🥈"}:{tier:"黄铜",division:String(5-Math.floor(R/200)),points:R,tierIcon:"🥉"},E=v.useCallback(async R=>{var H,O;if(!a.battle||a.battle.isBattleOver){console.warn("[战斗] 战斗已结束或不存在，无法执行行动");return}o(!0),c(null),b([]);const Q=a.battle;if(!Q.playerParty||!Q.opponentParty||Q.activePlayerCardIndex>=Q.playerParty.length||Q.activeOpponentCardIndex>=Q.opponentParty.length){console.error("[战斗] 战斗数据无效，索引越界"),c("战斗数据异常，请重新开始战斗"),o(!1);return}const Z=Q.playerParty[Q.activePlayerCardIndex],G=Q.opponentParty[Q.activeOpponentCardIndex];try{console.log("[战斗] 开始处理AI回合，玩家行动:",R);const U=await z1(Z,G,R,a);if(!U||typeof U!="object")throw new Error("AI返回结果无效");(!U.playerStatusEffects||!Array.isArray(U.playerStatusEffects))&&(console.warn("[战斗] AI未返回playerStatusEffects，使用空数组"),U.playerStatusEffects=[]),(!U.opponentStatusEffects||!Array.isArray(U.opponentStatusEffects))&&(console.warn("[战斗] AI未返回opponentStatusEffects，使用空数组"),U.opponentStatusEffects=[]),U.playerHpChange=typeof U.playerHpChange=="number"?U.playerHpChange:0,U.opponentHpChange=typeof U.opponentHpChange=="number"?U.opponentHpChange:0,U.playerMpChange=typeof U.playerMpChange=="number"?U.playerMpChange:0,U.opponentMpChange=typeof U.opponentMpChange=="number"?U.opponentMpChange:0,U.playerActionDescription=U.playerActionDescription||"玩家使用了技能进行攻击。",U.opponentActionDescription=U.opponentActionDescription||"对手进行了反击。",U.playerTurnSummary=U.playerTurnSummary||`【${R.split("_")[0]}】对对手造成了伤害`,U.opponentTurnSummary=U.opponentTurnSummary||"【反击】对玩家造成了伤害",console.log("[战斗] AI回合处理完成",U),b([U.playerActionDescription,U.opponentActionDescription]),w({key:Date.now(),effect:C(R),attacker:"player"}),U.opponentHpChange<0&&j("opponent"),await S(2e3);const te=((O=(H=U.opponentTurnSummary)==null?void 0:H.match(/\[(.*?)\]/))==null?void 0:O[1])||"default";w({key:Date.now()+1,effect:C(te),attacker:"opponent"}),j(null),U.playerHpChange<0&&j("player"),await S(1500);const ie=Z.currentHp+U.playerHpChange,B=G.currentHp+U.opponentHpChange,W=Z.currentMp+U.playerMpChange,ne=G.currentMp+U.opponentMpChange,X=[...Q.combatLog,`> ${U.playerTurnSummary}`,`> ${U.opponentTurnSummary}`],J=ie<=0,re=B<=0;let pe=Q.activePlayerCardIndex,me=Q.activeOpponentCardIndex,ae=!1,xe=null;if(re&&(X.push(`${G.card.name} 已被击败！`),Q.activeOpponentCardIndex+1>=Q.opponentParty.length?(ae=!0,xe=!0,X.push("你获得了胜利！")):(me++,X.push(`对手派出了 ${Q.opponentParty[me].card.name}！`))),J&&(X.push(`${Z.card.name} 已被击败！`),Q.activePlayerCardIndex+1>=Q.playerParty.length?(ae=!0,xe=!1,X.push("你被击败了！")):(pe++,X.push(`你派出了 ${Q.playerParty[pe].card.name}！`))),r(he=>{if(!he.battle)return he;const Se=[...he.battle.playerParty],et=Se[he.battle.activePlayerCardIndex],Re=[...et.statusEffects.map(ut=>({...ut,duration:ut.duration-1})).filter(ut=>ut.duration>0),...U.playerStatusEffects];Se[he.battle.activePlayerCardIndex]={...et,currentHp:Math.max(0,ie),currentMp:Math.max(0,W),statusEffects:Re};const kt=[...he.battle.opponentParty],Dt=kt[he.battle.activeOpponentCardIndex],hs=[...Dt.statusEffects.map(ut=>({...ut,duration:ut.duration-1})).filter(ut=>ut.duration>0),...U.opponentStatusEffects];return kt[he.battle.activeOpponentCardIndex]={...Dt,currentHp:Math.max(0,B),currentMp:Math.max(0,ne),statusEffects:hs},{...he,battle:{...he.battle,playerParty:Se,opponentParty:kt,combatLog:X,activePlayerCardIndex:pe,activeOpponentCardIndex:me,isBattleOver:ae,victory:xe}}}),ae)try{const he=X.slice(-10).join(`
`);d("战斗",xe?"战斗胜利":"战斗失败",he,[Z.card.name,G.card.name]),console.log("[战斗] 战斗记忆已保存")}catch(he){console.error("[战斗] 保存战斗记忆失败:",he)}j(null)}catch(U){console.error("[战斗] 处理战斗回合时出错:",U),c("一股神秘的力量扰乱了战场。请稍后重试。"),U instanceof Error&&console.error("[战斗] 错误详情:",U.message,U.stack);try{Ke.captureMessage(`战斗出错: ${U instanceof Error?U.message:"未知错误"}`,"battle")}catch(te){console.error("[战斗] 捕获错误消息失败:",te)}}finally{o(!1)}},[a.battle,(P=a.exploration)==null?void 0:P.time,(M=a.exploration)==null?void 0:M.location,r,o,c,d]),A=v.useCallback(R=>{var O;const Q=a.playerProfile.arenaRank,Z=R?25:-15,G=Math.max(0,Q.points+Z),H=D(G);if(_({oldRank:Q,newRank:H,pointsChange:Z,victory:R}),r(U=>{const te={...U.playerProfile,arenaRank:H},ie={...U.leaderboards},B=ie.宗门排行榜.总榜,W=B.findIndex(ne=>ne.name===te.name);return W!==-1?B[W].points=H.points:(B.length<20||H.points>B[B.length-1].points)&&B.push({rank:0,name:te.name,faction:"青蛇宗",points:H.points,characterId:"player"}),B.sort((ne,X)=>X.points-ne.points).forEach((ne,X)=>{ne.rank=X+1}),ie.宗门排行榜.总榜=B.slice(0,20),{...U,playerProfile:te,leaderboards:ie,mode:"exploration",battle:void 0}}),a.battle){const U=(O=a.battle.opponentParty[0])==null?void 0:O.card;U&&d("战斗",`竞技场对战：${R?"胜利":"失败"}`,`在竞技场与【${U.name}】展开了激烈的战斗，最终${R?"取得了胜利":"遗憾落败"}。段位积分${Z>=0?"增加":"减少"}了${Math.abs(Z)}点。`,[U.name])}},[a.playerProfile.arenaRank,a.battle,r,d]),z=v.useCallback(()=>{var H;if((H=a.battle)!=null&&H.isArenaBattle){A(a.battle.victory??!1);return}const R=a.battle;if(!R){r(O=>({...O,mode:"exploration",battle:void 0}));return}let Q=`

 战斗的尘埃落定。`,Z=[...a.bountyBoard],G=[...a.playerProfile.cardCollection];if(R.victory&&R.opponentParty.length>0){const O=R.opponentParty[0].card,U=Z.findIndex(te=>te.character.name===O.name&&te.status==="悬赏中");if(U!==-1){const te=Z[U];Z[U]={...te,status:"已完成"},G.some(ie=>ie.name===te.character.name)||G.push(te.character),Q+=`

**[红尘录]** 目标【${te.name}】已被你成功狩猎！请前往红尘录查看结果。`}}r(O=>({...O,mode:"exploration",battle:void 0,bountyBoard:Z,playerProfile:{...O.playerProfile,cardCollection:G},exploration:{...O.exploration,story:O.exploration.story+Q,choices:["继续你的旅程。","调息疗伤。","搜查四周。"]}}))},[a.battle,a.bountyBoard,a.playerProfile.cardCollection,A,r]),I=v.useCallback(()=>{var R;if(a.battle&&(r(Q=>Q.battle?{...Q,battle:{...Q.battle,isBattleOver:!0,victory:!1,isFled:!0}}:Q),a.battle)){const Q=(R=a.battle.opponentParty[0])==null?void 0:R.card;Q&&d("战斗","逃离战斗",`面对【${Q.name}】，你选择了避其锋芒，成功逃离了战斗。`,[Q.name])}},[a.battle,r,d]),L=v.useCallback(()=>{_(null)},[]),T=v.useCallback((R,Q)=>{var W;const G=(R==="Male"?a.playerProfile.maleParty:a.playerProfile.femaleParty).map(ne=>a.playerProfile.cardCollection.find(X=>X.id===ne.id)||ne),H=Ss.filter(ne=>ne.gender===Q),O=G.length,U=[];for(let ne=0;ne<O;ne++)if(H.length>0){const X=H[Math.floor(Math.random()*H.length)];U.push(X)}else U.push(Q==="Male"?vi:xu);const te=f?((W=f.combatLog[0].match(/与 (.*) 的战斗/))==null?void 0:W[1])||"挑战者":U[0].name,ie=f?f.opponentParty:U.map(ne=>{const X=Vs(ne);return{card:ne,currentHp:X.maxHp,currentMp:X.maxMp,statusEffects:[],calculatedStats:X,pet:ne.pet}}),B={playerParty:G.map(ne=>{const X=Vs(ne);return{card:ne,currentHp:X.maxHp,currentMp:X.maxMp,statusEffects:[],calculatedStats:X,pet:ne.pet}}),opponentParty:ie,activePlayerCardIndex:0,activeOpponentCardIndex:0,turn:"player",combatLog:[`与 ${te} 的战斗即将开始！`],isBattleOver:!1,victory:null};r(ne=>({...ne,mode:"battle",battle:B,exploration:{...ne.exploration,pendingChallenge:null}})),h(null),m(!1)},[a.playerProfile.maleParty,a.playerProfile.femaleParty,a.playerProfile.cardCollection,f,r,h,m]);return{currentTurnDescriptions:p,combatAnimation:g,lastHit:N,arenaResult:k,setCurrentTurnDescriptions:b,setCombatAnimation:w,setLastHit:j,setArenaResult:_,handleCombatAction:E,handleArenaBattleEnd:A,returnToExploration:z,handleFlee:I,clearArenaResult:L,startFinalBattle:T}}const r4=(n,a)=>n.quests.some(o=>o.id===a.id)?n:{...n,quests:[...n.quests,a]},mp=(n,a,r)=>({...n,quests:n.quests.map(o=>o.id===a?{...o,status:r}:o)}),l4=(n,a,r,o)=>({...n,quests:n.quests.map(c=>{if(c.id===a){const d=c.objectives.map(m=>{if(m.id===r){const f=m.targetCount?o>=m.targetCount:!0;return{...m,currentCount:o,isCompleted:f}}return m});return{...c,objectives:d}}return c})}),xp=n=>n.objectives.every(a=>a.isCompleted),o4=(n,a)=>{const r=n.quests.find(o=>o.id===a);return!r||!xp(r)?n:mp(n,a,"Claimable")},i4=(n,a)=>{const r=n.quests.find(c=>c.id===a);if(!r||r.status!=="Claimable")return n;let o={...n};return r.rewards.spiritStones&&(o.spiritStones+=r.rewards.spiritStones),r.rewards.reputation&&(o.reputation.score+=r.rewards.reputation),r.rewards.items&&r.rewards.items.length>0&&r.rewards.items.forEach(c=>{"stats"in c?o.equipmentInventory.push({...c,id:`${c.id}_${Date.now()}_${Math.random()}`}):"cost"in c&&o.universalSkills.push(c)}),o=mp(o,a,"Completed"),o};function c4(n){const{gameState:a,setGameState:r,setIsLoading:o,setError:c,addMemory:d,setPendingBattle:m,setCurrentTurnDescriptions:f,setIsPreBattleModalOpen:h,setIsMapOpen:p,setIsInteractionModalOpen:b}=n,[g,w]=v.useState(null),[N,j]=v.useState(null),k=v.useCallback(async D=>{var A;o(!0),c(null);const E=a.exploration.story;try{const z=await dp(E,D,a.playerProfile,a);let I=`${a.exploration.story}

> ${D}

${z.story}`,L=!1,T=null;const P=a.bountyBoard.filter(R=>R.status==="悬赏中");for(const R of P)if(R.locationHint.includes(z.location)&&Math.random()<.25){I+=`

**[红尘录]** 你似乎在【${z.location}】感受到了特殊的气息... 一个名号为【${R.name}】的悬赏目标出现了！`;const Q=Vs(R.character),Z={playerParty:[],opponentParty:[{card:R.character,currentHp:Q.maxHp,currentMp:Q.maxMp,statusEffects:[],calculatedStats:Q,pet:R.character.pet}],activePlayerCardIndex:0,activeOpponentCardIndex:0,turn:"pre-battle",combatLog:[`遭遇了红尘录目标：${R.name}！`],isBattleOver:!1,victory:null};m(Z),L=!0;break}if(((A=z.event)==null?void 0:A.type)==="battle"&&z.opponentParty){const R={playerParty:[],opponentParty:z.opponentParty.map(Q=>({...Q,statusEffects:[],pet:Q.card.pet})),activePlayerCardIndex:0,activeOpponentCardIndex:0,turn:"pre-battle",combatLog:[`与 ${z.event.opponentName} 的战斗即将开始！`],isBattleOver:!1,victory:null};m(R),L=!0}if(z.pendingChallenge&&z.pendingChallenge.challengerName&&(T=z.pendingChallenge,I+=`

[你收到了来自 ${T.challengerName} 的挑战！]`),r(R=>{let Q={...R.playerProfile};if(z.relationshipUpdate&&(Q=B1(Q,z.relationshipUpdate)),z.newQuest){const Z=Date.now(),G=Q.lastQuestGenerationTime||0,H=300*1e3;Z-G>=H&&Math.random()<.2?(Q=r4(Q,z.newQuest),Q.lastQuestGenerationTime=Z,console.log("[任务系统] 生成新任务:",z.newQuest.title)):console.log("[任务系统] 任务生成被限制 (冷却中或概率未命中)")}if(z.questUpdate){const{questId:Z,objectiveId:G,progress:H}=z.questUpdate,O=Q.quests.find(te=>te.id===Z),U=O==null?void 0:O.objectives.find(te=>te.id===G);if(U){const te=(U.currentCount||0)+H;Q=l4(Q,Z,G,te);const ie=Q.quests.find(B=>B.id===Z);ie&&xp(ie)&&ie.status==="In Progress"&&(Q=o4(Q,Z),console.log("[任务系统] 任务可领取:",ie.title))}}return z.reputationUpdate&&(Q.reputation={...Q.reputation,score:Q.reputation.score+z.reputationUpdate.scoreChange,history:[...Q.reputation.history,{id:`rep-${Date.now()}`,timestamp:z.time||R.exploration.time,description:z.reputationUpdate.description,scoreChange:z.reputationUpdate.scoreChange}].slice(-20)}),{...R,playerProfile:Q,exploration:{...R.exploration,story:I,location:z.location||R.exploration.location,time:z.time||R.exploration.time,choices:z.choices||[],pendingChallenge:T}}}),L&&!T){f([]),h(!0),o(!1);return}if(Math.random()<.25&&!T&&!L)try{const R=await D1(z.location,a.playerProfile,a);w(R)}catch(R){console.error("Failed to generate random event:",R)}o(!1)}catch(z){console.error(z),c("仙界似乎有些不稳定，灵气无法正确响应你的请求。"),o(!1)}},[a.playerProfile,a.exploration.story,a.bountyBoard,r,o,c,m,f,h]),_=v.useCallback(D=>{p(!1),k(`前往 ${D}。`)},[k,p]),C=v.useCallback(D=>{b(!1),k(D)},[k,b]),S=v.useCallback(D=>{const{outcome:E}=D;j(E.description),setTimeout(()=>{r(z=>{const I=JSON.parse(JSON.stringify(z.playerProfile));let L=`

[奇遇] ${E.description}`;switch(E.type){case"reward_stones":I.spiritStones+=E.amount;break;case"lose_stones":I.spiritStones=Math.max(0,I.spiritStones-E.amount);break;case"battle":const T=Ss.filter(G=>G.rarity==="优品"||G.rarity==="珍品"),M={...T[Math.floor(Math.random()*T.length)],id:`rand-${Date.now()}`,name:E.opponentName||"神秘对手",origin:E.opponentDescription||"一个神秘的敌人"},R=Vs(M),Q={playerParty:[],opponentParty:[{card:M,currentHp:R.maxHp,currentMp:R.maxMp,statusEffects:[],calculatedStats:R,pet:M.pet}],activePlayerCardIndex:0,activeOpponentCardIndex:0,turn:"pre-battle",combatLog:[`遭遇了 ${E.opponentName||"神秘对手"}！`],isBattleOver:!1,victory:null};m(Q),L+=`

你遭遇了 ${E.opponentName||"神秘对手"}！`;break;case"reward_item":const Z=Th.find(G=>G.name===E.itemName);if(Z){const G={...Z,id:`${Z.id}_${Date.now()}_${Math.random()}`};I.equipmentInventory.push(G)}else L+=`
但它似乎只是个普通的物件，你随手丢弃了。`;break}return{...z,playerProfile:I,exploration:{...z.exploration,story:z.exploration.story+L}}}),w(null),j(null),E.type==="battle"&&h(!0),g&&d("其他",g.title,`${g.story}

选择：${D.text}

${E.description}`)},2e3)},[g,r,m,h,d]);return{randomEvent:g,eventResultText:N,setRandomEvent:w,setEventResultText:j,handleExplorationAction:k,handleTravel:_,handleInitiateInteraction:C,handleRandomEventChoice:S}}function d4(n){const{gameState:a,setGameState:r,setIsLoading:o,setError:c,addMemory:d}=n,[m,f]=v.useState(null),[h,p]=v.useState(""),[b,g]=v.useState([]),[w,N]=v.useState(null),j=v.useCallback(async()=>{o(!0);try{const z=(await Promise.all([Zl("Female"),Zl("Female"),Zl("Male"),Zl("Male")])).map(I=>({id:I.patientId,medicalRecord:I,status:"待诊"}));r(I=>{const L=I.hospitalPatients.filter(T=>T.status==="治疗中");return{...I,hospitalPatients:[...L,...z]}})}catch(A){console.error("Failed to refresh patients:",A),c("刷新病人列表失败。")}finally{o(!1)}},[r,o,c]),k=v.useCallback(async A=>{o(!0);try{const z=await Zl(A);r(I=>({...I,hospitalPatients:[...I.hospitalPatients,{id:z.patientId,medicalRecord:z,status:"待诊"}].slice(-10)}))}catch(z){console.error("Failed to add patient:",z),c("添加病人失败。")}finally{o(!1)}},[r,o,c]),_=v.useCallback(A=>{const z=a.hospitalPatients.find(I=>I.id===A);if(z)if(f(z),z.consultationStory&&z.consultationChoices)p(z.consultationStory),g(z.consultationChoices);else{const I=`你坐在问诊室内，面前的病人是【${z.medicalRecord.name}】。

${z.medicalRecord.background}

你清了清嗓子，准备开始今天的问诊。`;p(I),g(["询问病症详情","进行身体检查","安抚病患情绪","开具诊疗方案"]),r(L=>({...L,hospitalPatients:L.hospitalPatients.map(T=>T.id===A?{...T,status:"治疗中",consultationStory:I,consultationChoices:["询问病症详情","进行身体检查","安抚病患情绪","开具诊疗方案"]}:T)}))}},[a.hospitalPatients,r]),C=v.useCallback(async A=>{if(!m)return;o(!0);const z=`${h}

> ${A}`,I=`你正在为【${m.medicalRecord.name}】诊断【${m.medicalRecord.illnessDescription}】。`;try{const L=await dp(`${I}
${z}`,A,a.playerProfile,a),T=`${z}

${L.story}`,P=L.choices&&Array.isArray(L.choices)&&L.choices.length>0?L.choices:["继续问诊","检查病情","开具处方","结束诊疗"];p(T),g(P),r(M=>({...M,hospitalPatients:M.hospitalPatients.map(R=>R.id===m.id?{...R,consultationStory:T,consultationChoices:P}:R)}))}catch(L){console.error(L),c("AI响应错误，请稍后再试。"),g(["继续问诊","检查病情","开具处方","结束诊疗"])}finally{o(!1)}},[m,h,a.playerProfile,a,r,o,c]),S=v.useCallback(()=>{m&&(d("医馆",`为${m.medicalRecord.name}问诊`,h,[m.medicalRecord.name]),r(A=>({...A,hospitalPatients:A.hospitalPatients.map(z=>z.id===m.id?{...z,status:"已治愈",consultationStory:void 0,consultationChoices:void 0}:z)}))),f(null),p(""),g([])},[m,h,d,r]),D=v.useCallback(()=>{f(null),p(""),g([])},[]),E=v.useCallback(A=>{N(A)},[]);return{consultationPatient:m,consultationStory:h,consultationChoices:b,viewingPatientRecord:w,setConsultationPatient:f,setConsultationStory:p,setConsultationChoices:g,setViewingPatientRecord:N,handleRefreshPatients:j,handleAddPatient:k,handleStartConsultation:_,handleConsultationAction:C,handleEndConsultation:S,handleReturnToHospitalList:D,handleViewPatientRecord:E}}const Fd=(n,a)=>{const r={威胁:{low:["哼，你以为这样就能让我屈服吗？","我不会说的，你们这些人迟早会遭报应！","有本事就杀了我！"],mid:["我...我不会说的...","你想怎样...","别...别过来..."],high:["求求你...不要...","我说，我什么都说...","饶命啊..."]},劝说:{low:["少来这套！","你的花言巧语骗不了我！","哼，虚伪！"],mid:["你说的...或许有些道理...","我需要时间考虑...","你真的能保证吗？"],high:["好...我听你的...","你说得对...","我愿意配合..."]},交易:{low:["你以为我会为了这点好处出卖自己？","免谈！","你太小看我了！"],mid:["这个条件...让我想想...","你能给我什么保证？","也许我们可以谈谈..."],high:["成交...","我接受...","只要你说话算数..."]},套话:{low:["你想套我的话？做梦！","我什么都不知道！","别费心思了！"],mid:["你想知道什么？","我不太清楚...","这个...我不能说..."],high:["其实...我知道一些事...","我告诉你...","你想知道的是..."]},闲聊:{low:["我没兴趣和你说话！","滚！","别烦我！"],mid:["难得有人愿意和我说话...","外面的世界...还好吗？","你为什么要来这里？"],high:["谢谢你愿意和我聊天...","能和你说说话真好...","你是个好人..."]},恩惠:{low:["我不需要你的施舍！","你想收买我？","别以为这样我就会感激你！"],mid:["你...为什么要帮我？","谢谢你...","我不知道该说什么..."],high:["太感谢了...","你真是太好了...","我会记住你的恩情..."]},羞辱:{low:["你！你会后悔的！","我不会忘记这一切的！","总有一天我会报仇！"],mid:["...","为什么...","够了..."],high:["是...我错了...","请原谅我...","我不敢了..."]}},o=r[n]||r.闲聊;let c;return a>=70?c=o.high:a>=40?c=o.mid:c=o.low,c[Math.floor(Math.random()*c.length)]};function u4(n){const{gameState:a,setGameState:r,setIsLoading:o,setError:c,addMemory:d}=n,m=v.useCallback((N,j,k)=>{const _=a.prisonSystem.prisoners.find(E=>E.character.id===N),C=a.prisonSystem.laborSites.find(E=>E.id===j);if(!_||!C){c("找不到囚犯或劳役地点");return}if(C.workers.length>=C.maxWorkers){c(`${C.name}的工位已满（${C.maxWorkers}/${C.maxWorkers}）`);return}if(_.status.includes("劳役中")){c(`${_.character.name}已经在劳役中`);return}const S=Date.now(),D=S+k*36e5;r(E=>{const A={prisonerId:_.character.id,prisonerName:_.character.name,startTime:S,endTime:D,duration:k,status:"working"};return{...E,prisonSystem:{...E.prisonSystem,laborSites:E.prisonSystem.laborSites.map(z=>z.id===j?{...z,workers:[...z.workers,A]}:z),prisoners:E.prisonSystem.prisoners.map(z=>z.character.id===N?{...z,status:[...z.status.filter(I=>I!=="劳役中"),"劳役中"],location:"劳役区"}:z)}}}),d("大牢",`劳役分配：${_.character.name}`,`将囚犯【${_.character.name}】分配到${C.name}进行${k}小时的劳役。`,[_.character.name])},[a.prisonSystem,r,c,d]),f=v.useCallback(async(N,j)=>{const k=a.prisonSystem.laborSites.find(S=>S.id===N),_=k==null?void 0:k.workers.find(S=>S.prisonerId===j),C=a.prisonSystem.prisoners.find(S=>S.character.id===j);if(!k||!_||!C){c("找不到劳役信息");return}if(Date.now()<_.endTime){c("劳役尚未完成");return}o(!0);try{const S=await W1(C,k.type,_.duration,a);r(E=>{const A=E.prisonSystem.laborSites.find(T=>T.id===N),z=(A==null?void 0:A.workers.filter(T=>T.prisonerId!==j))||[],I=[...E.prisonSystem.materialInventory,...S.materials],L=E.prisonSystem.prisoners.map(T=>T.character.id===j?{...T,status:T.status.filter(P=>P!=="劳役中"),health:Math.max(0,T.health-S.healthCost),location:"居住区"}:T);return{...E,prisonSystem:{...E.prisonSystem,laborSites:E.prisonSystem.laborSites.map(T=>T.id===N?{...T,workers:z}:T),materialInventory:I,prisoners:L}}});const D=S.materials.map(E=>`${E.material.name}(${E.material.rarity}) x${E.quantity}`).join("、");d("大牢",`劳役完成：${C.character.name}`,`${C.character.name}完成了在${k.name}的劳役。

${S.story}

获得材料：${D}
经验+${S.experience}，健康-${S.healthCost}`,[C.character.name]),alert(`劳役完成！

${S.story}

获得材料：${D}`)}catch(S){console.error("生成劳役结果失败:",S),c("生成劳役结果失败，请稍后重试")}finally{o(!1)}},[a,r,o,c,d]),h=v.useCallback((N,j)=>{r(k=>({...k,prisonSystem:{...k.prisonSystem,prisoners:k.prisonSystem.prisoners.map(_=>_.character.id===N.character.id?{..._,location:j}:_)}})),d("大牢",`囚犯转移：${N.character.name}`,`将囚犯【${N.character.name}】从${N.location}转移到${j}。`,[N.character.name])},[r,d]),p=v.useCallback(N=>{r(j=>({...j,prisonSystem:{...j.prisonSystem,prisoners:j.prisonSystem.prisoners.filter(k=>k.character.id!==N.character.id)}})),d("大牢",`释放囚犯：${N.character.name}`,`释放了囚犯【${N.character.name}】。罪行：${N.crime}`,[N.character.name])},[r,d]),b=v.useCallback(N=>{if(N.loyaltyLevel<80||N.submissionLevel<60){alert(`招募失败：【${N.character.name}】的归顺度或屈服度不足！

当前归顺度：${N.loyaltyLevel}% (需要≥80%)
当前屈服度：${N.submissionLevel}% (需要≥60%)`);return}r(j=>({...j,playerProfile:{...j.playerProfile,cardCollection:[...j.playerProfile.cardCollection,N.character]},prisonSystem:{...j.prisonSystem,prisoners:j.prisonSystem.prisoners.filter(k=>k.character.id!==N.character.id)}})),d("大牢",`成功招募：${N.character.name}`,`成功招募了囚犯【${N.character.name}】加入队伍。归顺度：${N.loyaltyLevel}%，屈服度：${N.submissionLevel}%`,[N.character.name]),alert(`成功招募【${N.character.name}】！

该角色已加入你的卡牌收藏。`)},[r,d]),g=v.useCallback((N,j)=>{var k,_,C;r(S=>{var D;return{...S,prisonSystem:{...S.prisonSystem,prisoners:S.prisonSystem.prisoners.map(E=>{var A;return E.character.id===N.character.id?{...E,submissionLevel:Math.max(0,Math.min(100,E.submissionLevel+j.stateChanges.submission)),loyaltyLevel:Math.max(0,Math.min(100,E.loyaltyLevel+j.stateChanges.loyalty)),health:Math.max(0,Math.min(100,E.health+j.stateChanges.health)),sanity:Math.max(0,Math.min(100,E.sanity+j.stateChanges.sanity)),knownInformation:(A=j.rewards)!=null&&A.information?[...E.knownInformation||[],j.rewards.information]:E.knownInformation}:E}),stats:{...S.prisonSystem.stats,avgSubmission:S.prisonSystem.prisoners.length>0?S.prisonSystem.prisoners.reduce((E,A)=>E+A.submissionLevel,0)/S.prisonSystem.prisoners.length:0,avgLoyalty:S.prisonSystem.prisoners.length>0?S.prisonSystem.prisoners.reduce((E,A)=>E+A.loyaltyLevel,0)/S.prisonSystem.prisoners.length:0}},playerProfile:(D=j.rewards)!=null&&D.spiritStones?{...S.playerProfile,spiritStones:S.playerProfile.spiritStones-(j.rewards.spiritStones||0)}:S.playerProfile}}),d("大牢",`与囚犯对话：${N.character.name}`,`与囚犯【${N.character.name}】进行了${j.dialogueRecord.dialogueType}对话。
选择：${j.dialogueRecord.playerChoice}
囚犯回应："${j.dialogueRecord.prisonerResponse}"
效果：屈服度${j.stateChanges.submission>=0?"+":""}${j.stateChanges.submission}，归顺度${j.stateChanges.loyalty>=0?"+":""}${j.stateChanges.loyalty}`+((k=j.rewards)!=null&&k.information?`
获得情报：${j.rewards.information}`:"")+((_=j.consequences)!=null&&_.eventTriggered?`
触发事件：${j.consequences.eventTriggered}`:""),[N.character.name]),(C=j.consequences)!=null&&C.eventTriggered&&setTimeout(()=>{var S;alert(`⚠️ 特殊事件：${(S=j.consequences)==null?void 0:S.eventTriggered}`)},500)},[r,d]),w=v.useCallback(async(N,j)=>{var k;try{const _=`你是一个修仙世界的囚犯，名叫${N.character.name}，${N.character.gender==="Male"?"男性":"女性"}，修为${N.character.realm}。
你因为"${N.crime}"被关押在大牢中。
当前状态：
- 屈服度：${N.submissionLevel}%（${N.submissionLevel>=80?"完全屈服":N.submissionLevel>=60?"意志动摇":N.submissionLevel>=40?"勉强配合":"顽固抵抗"}）
- 归顺度：${N.loyaltyLevel}%
- 健康：${N.health}%
- 神智：${N.sanity}%

狱卒对你使用了"${j.type}"的方式：${j.text}（${j.description}）

请以囚犯的身份，用第一人称回应这个对话。回应要符合你当前的屈服度和心理状态：
- 如果屈服度低，应该表现出抗拒、愤怒或不屑
- 如果屈服度高，应该表现出顺从、恐惧或配合
- 回应要简短有力，1-3句话即可
- 要符合修仙世界的语言风格`;return typeof window<"u"&&((k=window.SillyTavern)!=null&&k.generateText)&&await window.SillyTavern.generateText(_)||Fd(j.type,N.submissionLevel)}catch(_){return console.error("生成对话响应失败:",_),Fd(j.type,N.submissionLevel)}},[]);return{handleAssignLabor:m,handleClaimLaborResult:f,handleTransferPrisoner:h,handleReleasePrisoner:p,handleRecruitPrisoner:b,handleDialogueComplete:g,handleGenerateDialogueResponse:w}}function m4(n){const{gameState:a,setGameState:r,setIsLoading:o}=n,c=v.useCallback(async()=>{console.log("[大闯关] 生成全部草稿");const b=a.gauntletSystem.currentEvent;if(!b){alert("当前没有进行中的赛事");return}if(b.challengesGenerated){alert("关卡草稿已生成，无需重复生成");return}try{alert("开始生成6轮关卡草稿，请稍候...");const g=await sa.generateAllChallengeDrafts(a),w=K2(b,g);r(N=>({...N,gauntletSystem:{...N.gauntletSystem,currentEvent:w}})),console.log("[大闯关] 关卡草稿生成完成"),alert(`关卡草稿生成成功！

已生成${g.length}轮关卡`)}catch(g){console.error("[大闯关] 生成关卡草稿失败:",g),alert("生成关卡草稿失败，请重试")}},[a,r]),d=v.useCallback(async()=>{var g;console.log("[大闯关] 开始全部优化");const b=a.gauntletSystem.currentEvent;if(!b){alert("当前没有进行中的赛事");return}if(!b.challengesGenerated){alert("请先生成关卡草稿");return}if(b.allOptimizationsComplete){alert("所有关卡已完成优化");return}try{alert("开始优化所有关卡（共18次优化），这可能需要一些时间...");let w={...b};const N=18;let j=0;for(let k=1;k<=6;k++){const _=(g=w.rounds[k-1])==null?void 0:g.challenge;if(!_)continue;let C={..._};for(let S=1;S<=3;S++){if(C.optimizationProgress>=S){j++;continue}console.log(`[大闯关] 优化第${k}轮关卡 (${S}/3)`);const D=await sa.optimizeChallenge(C,S,a);C={...C,[`optimization${S}`]:D,optimizationProgress:S},S===3&&(C.finalVersion=D.optimizedDesign),j++,await new Promise(E=>setTimeout(E,300))}w=Vf(w,k,C)}r(k=>({...k,gauntletSystem:{...k.gauntletSystem,currentEvent:w}})),console.log("[大闯关] 全部优化完成"),alert("所有关卡优化完成！")}catch(w){console.error("[大闯关] 优化失败:",w),alert("优化过程中出错，请重试")}},[a,r]),m=v.useCallback(async(b,g)=>{var j;console.log(`[大闯关] 优化第${b}轮关卡，第${g}次优化`);const w=a.gauntletSystem.currentEvent;if(!w){alert("当前没有进行中的赛事");return}const N=(j=w.rounds[b-1])==null?void 0:j.challenge;if(!N){alert(`第${b}轮关卡不存在`);return}if(N.optimizationProgress>=g){alert(`第${b}轮关卡的第${g}次优化已完成`);return}try{alert(`正在优化第${b}轮关卡（第${g}次）...`);const k=await sa.optimizeChallenge(N,g,a);let _={...N,[`optimization${g}`]:k,optimizationProgress:g};g===3&&(_.finalVersion=k.optimizedDesign);const C=Vf(w,b,_);r(S=>({...S,gauntletSystem:{...S.gauntletSystem,currentEvent:C}})),console.log(`[大闯关] 第${b}轮关卡第${g}次优化完成`),alert(`优化完成！

第${b}轮关卡已完成第${g}次优化`)}catch(k){console.error("[大闯关] 优化失败:",k),alert("优化失败，请重试")}},[a,r]),f=v.useCallback(async b=>{console.log("[大闯关] 报名参赛者:",b.name);let g=a.gauntletSystem.currentEvent,w=a.gauntletSystem;if(g||(g=rp(a.gauntletSystem),w={...a.gauntletSystem,currentEvent:g,totalEditions:g.edition}),g=Y2(g),g.status!=="registration"){alert(`当前不在报名阶段

赛事状态: ${g.status}`);return}const N=J2(g,{name:b.name,realm:b.realm,appearance:b.appearance,charm:b.charm,skillfulness:b.skillfulness,characterCardId:b.id});r(j=>({...j,gauntletSystem:{...w,currentEvent:N}})),console.log("[大闯关] 报名成功:",b.name),alert(`报名成功！

参赛者: ${b.name}
当前已报名人数: ${N.contestants.length}/64`)},[a,r]),h=v.useCallback(async()=>{console.log("[大闯关] 取消报名");const b=a.gauntletSystem.currentEvent;if(!b){alert("当前没有进行中的赛事");return}if(b.status!=="registration"){alert("当前不在报名阶段，无法取消报名");return}if(!b.playerContestantId){alert("您尚未报名");return}const g=F2(b);r(w=>({...w,gauntletSystem:{...w.gauntletSystem,currentEvent:g}})),console.log("[大闯关] 取消报名成功"),alert("已成功取消报名")},[a,r]),p=v.useCallback(async b=>{const g=a.gauntletSystem.currentEvent;if(!g){console.error("[大闯关] 当前没有活跃赛事"),alert("当前没有进行中的赛事");return}try{o(!0),console.log(`[大闯关] 开始生成${b}名AI参赛者...`);const w=await sa.generateContestants(b,a);console.log(`[大闯关] 成功生成${w.length}名参赛者`);const N={...g,contestants:[...g.contestants,...w]};r(j=>({...j,gauntletSystem:{...j.gauntletSystem,currentEvent:N}})),console.log(`[大闯关] 参赛者已添加到赛事，当前人数：${N.contestants.length}`),alert(`成功生成${w.length}名参赛者！

当前报名人数：${N.contestants.length}/64`)}catch(w){console.error("[大闯关] 生成参赛者失败:",w),alert("生成参赛者失败，请稍后重试。")}finally{o(!1)}},[a,r,o]);return{handleGenerateAllDrafts:c,handleStartAllOptimization:d,handleOptimizeChallenge:m,handleRegister:f,handleCancelRegistration:h,handleGenerateContestants:p}}function x4({gameState:n,setGameState:a}){const[r,o]=v.useState(!1),[c,d]=v.useState(!1),m=v.useCallback(async(f="all")=>{o(!0);try{const h=f==="all"?["sect","adventure","world"]:[f],p={...n.announcements};for(const b of h){const g=b,w=await L1(g,5,n),N={sect:"宗门",adventure:"奇遇",world:"世界"},j=w.map((k,_)=>({...k,id:`${g}-${Date.now()}-${_}`,category:N[g]}));p[g]=j}a(b=>({...b,announcements:p})),d(!0)}catch(h){console.error("Failed to fetch announcements:",h)}finally{o(!1)}},[n.announcements,n,a]);return{isAnnouncementsLoading:r,announcementsLoaded:c,fetchAnnouncements:m}}function f4({gameState:n,setGameState:a,setIsLoading:r,setError:o,addMemory:c}){const[d,m]=v.useState(null),[f,h]=v.useState(null),p=v.useCallback(async()=>{r(!0);try{const j=await Promise.all([Vl(),Vl(),Vl()]);a(k=>({...k,bountyBoard:j.map(_=>({..._,id:`bounty-${Date.now()}-${Math.random()}`,status:"悬赏中"})).slice(-10)}))}catch(j){console.error("Failed to refresh bounty board:",j),o("刷新悬赏榜失败。")}finally{r(!1)}},[a,r,o]),b=v.useCallback(async j=>{r(!0);try{const k=await Vl(j);a(_=>({..._,bountyBoard:[..._.bountyBoard,{...k,id:`bounty-${Date.now()}`,status:"悬赏中"}].slice(-10)}))}catch(k){console.error("Failed to add bounty target:",k),o("添加悬赏目标失败。")}finally{r(!1)}},[a,r,o]),g=v.useCallback((j,k)=>{const _=n.bountyBoard.find(A=>A.id===j);if(!_)return;const C={凡品:.5*60*60*1e3,良品:3600*1e3,优品:7200*1e3,珍品:14400*1e3,绝品:480*60*1e3,仙品:720*60*1e3,圣品:1440*60*1e3,神品:2880*60*1e3},S=C[_.character.rarity]||C.凡品,D=Date.now(),E=D+S;a(A=>({...A,bountyBoard:A.bountyBoard.map(z=>z.id===j?{...z,status:"追踪中",trackerId:k,startTime:D,endTime:E}:z)}))},[n.bountyBoard,a]),w=v.useCallback(async j=>{const k=n.bountyBoard.find(C=>C.id===j),_=n.playerProfile.cardCollection.find(C=>C.id===(k==null?void 0:k.trackerId));if(!k||!_){o("无法找到悬赏或追踪者信息。");return}r(!0);try{const C=await X1(_,k.character,n),S={...k,trackingLog:C};a(D=>({...D,bountyBoard:D.bountyBoard.map(E=>E.id===j?S:E)})),h(S)}catch(C){console.error("生成悬赏日志失败:",C),o("天机阁传讯失败，无法获取任务报告。")}finally{r(!1)}},[n.bountyBoard,n.playerProfile.cardCollection,n,a,r,o]),N=v.useCallback((j,k)=>{a(C=>{var z;const S=C.bountyBoard.find(I=>I.id===j);if(!S)return C;const D=Oa[S.character.rarity]*10,E=k==="imprisoned"?20:5;let A=C.prisonSystem;if(k==="imprisoned"){const I={character:S.character,crime:`红尘录悬赏目标 - ${S.specialTrait}`,sentence:365,remainingDays:365,submissionLevel:0,loyaltyLevel:0,health:70,sanity:80,location:"居住区",cellType:"重犯牢房",value:{ransom:Oa[S.character.rarity]*5,labor:Oa[S.character.rarity]*2,intelligence:Oa[S.character.rarity]*3},status:["受伤"],history:[{id:`interrogation-${Date.now()}`,date:C.exploration.time,realTimestamp:Date.now(),method:{id:"captured",name:"被捕",category:"basic",description:"从红尘录悬赏任务中被捕获",damage:30,intimidation:50,successRate:100,submissionIncrease:0,risks:{death:0,permanentInjury:0,insanity:0}},duration:0,result:{success:!0,informationGained:`身份：${S.character.name}，罪行：${S.specialTrait}`,submissionIncrease:0,healthDecrease:30},interrogator:S.trackerId&&((z=C.playerProfile.cardCollection.find(L=>L.id===S.trackerId))==null?void 0:z.name)||"追踪者"}],knownInformation:[`真实姓名：${S.character.name}`,`境界：${S.character.realm}`,`悬赏特征：${S.specialTrait}`],potentialInformation:["背景势力","隐藏身份","同伙信息","藏匿地点"],imprisonedDate:C.exploration.time,realImprisonedTime:Date.now()};A={...C.prisonSystem,prisoners:[...C.prisonSystem.prisoners,I],stats:{...C.prisonSystem.stats,totalPrisoners:C.prisonSystem.stats.totalPrisoners+1,byArea:{...C.prisonSystem.stats.byArea,居住区:C.prisonSystem.stats.byArea.居住区+1},byCellType:{...C.prisonSystem.stats.byCellType,重犯牢房:C.prisonSystem.stats.byCellType.重犯牢房+1}}}}return{...C,playerProfile:{...C.playerProfile,spiritStones:C.playerProfile.spiritStones+D,reputation:{...C.playerProfile.reputation,score:C.playerProfile.reputation.score+E}},bountyBoard:C.bountyBoard.map(I=>I.id===j?{...I,status:"已结束",finalOutcome:k}:I),prisonSystem:A}});const _=n.bountyBoard.find(C=>C.id===j);if(_){const C=k==="imprisoned"?`成功捕获【${_.name}】并押入大牢，可前往大牢进行审讯和管理。`:`成功完成对【${_.name}】的悬赏任务。`;c(k==="imprisoned"?"大牢":"悬赏",`完成悬赏：${_.name}`,_.trackingLog?`${_.trackingLog}

${C}`:C,[_.name])}h(null)},[n.bountyBoard,a,c]);return{viewingBountyTarget:d,setViewingBountyTarget:m,claimingBounty:f,setClaimingBounty:h,handleRefreshBountyBoard:p,handleAddBountyTarget:b,handleAcceptBounty:g,handleClaimBounty:w,handleBountyOutcome:N}}function h4({gameState:n,setGameState:a,setIsGameReady:r}){v.useEffect(()=>{r(!0),n.playerProfile.businessDistrict||a(o=>({...o,playerProfile:{...o.playerProfile,businessDistrict:{name:"七情六欲坊",level:1,shops:[{id:"shop_brothel_1",type:"青楼",level:1,staff:[]}],log:[{timestamp:"初始",message:'你获得了"七情六欲坊"的初始地契，并开设了第一家青楼。'}]}}})),n.prisonSystem||a(o=>({...o,prisonSystem:{prisoners:[],guards:[],facilities:[],laborSites:[{id:"mine-01",type:"矿山",name:"青蛇矿脉",description:"宗门后山的灵石矿脉",maxWorkers:2,workers:[]},{id:"herb-01",type:"采药",name:"灵药园",description:"宗门的药材种植园",maxWorkers:2,workers:[]}],materialInventory:[],laborTasks:[],laborRecords:[],events:[],ransomOffers:[],stats:{totalPrisoners:0,byArea:{居住区:0,审讯区:0,娱乐区:0,劳役区:0,管理区:0,医疗区:0},byCellType:{普通牢房:0,重犯牢房:0,单独囚室:0},avgSubmission:0,avgLoyalty:0,avgHealth:0,totalGuards:5,escapeAttempts:0,successfulEscapes:0,totalRevenue:0,totalExpenses:0,netProfit:0},config:{maxPrisoners:50,dailyFoodCost:10,securityLevel:5,enableAutoInterrogation:!1,enableAutoLabor:!1}}})),n.hospitalSystem||a(o=>({...o,hospitalSystem:Si()})),n.memories.大牢||a(o=>({...o,memories:{...o.memories,大牢:[]},memorySummaries:{...o.memorySummaries,大牢:{small:[],large:[]}}})),n.memories.医馆人员||a(o=>({...o,memories:{...o.memories,医馆人员:[]},memorySummaries:{...o.memorySummaries,医馆人员:{small:[],large:[]}}}))},[]),v.useEffect(()=>{n.hospitalPatients.length===0&&a(o=>({...o,hospitalPatients:[{id:bf.patientId,medicalRecord:bf,status:"待诊"}]})),n.bountyBoard.length===0&&a(o=>({...o,bountyBoard:[{...Ry,id:"bounty-example-01",status:"悬赏中"}]}))},[])}const p4=()=>{var mr;K5();const n=v.useRef(null),[a,r]=v.useState(Oy),[o,c]=v.useState(xs.HOME),[d,m]=v.useState(!1),[f,h]=v.useState(!0),[p,b]=v.useState(!1),[g,w]=v.useState(null),{activeModal:N,isPreBattleModalOpen:j,isMapOpen:k,isPersonalInfoOpen:_,isInteractionModalOpen:C,isChallengeModalOpen:S,isRelationshipModalOpen:D,isAnnouncementModalOpen:E,isTelepathyModalOpen:A,isReputationModalOpen:z,isSaveLoadModalOpen:I,isQuestLogModalOpen:L,isBusinessModalOpen:T,isHospitalModalOpen:P,isBountyBoardOpen:M,isCultivationModalOpen:R,isMemoryModalOpen:Q,isCharacterStatusModalOpen:Z,isPrisonModalOpen:G,isInterrogationModalOpen:H,isEtiquetteHallOpen:O,isGauntletHallOpen:U,isGauntletAnnouncementOpen:te,isGauntletRegistrationOpen:ie,isGauntletLiveOpen:B,isFABOpen:W,setActiveModal:ne,closeSaveLoadModal:X,setIsPreBattleModalOpen:J,setIsMapOpen:re,setIsPersonalInfoOpen:pe,setIsInteractionModalOpen:me,setIsChallengeModalOpen:ae,setIsRelationshipModalOpen:xe,setIsAnnouncementModalOpen:he,setIsTelepathyModalOpen:Se,setIsReputationModalOpen:et,setIsSaveLoadModalOpen:Re,setIsQuestLogModalOpen:kt,setIsBusinessModalOpen:Dt,setIsHospitalModalOpen:hs,setIsBountyBoardOpen:ut,setIsCultivationModalOpen:ns,setIsMemoryModalOpen:Qs,setIsCharacterStatusModalOpen:ps,setIsPrisonModalOpen:qa,setIsInterrogationModalOpen:la,setIsEtiquetteHallOpen:vt,setIsGauntletHallOpen:Za,setIsGauntletAnnouncementOpen:oa,setIsGauntletRegistrationOpen:ia,setIsGauntletLiveOpen:Ys,setIsFABOpen:_s}=W5(),{handleSave:Ga,handleLoad:Yr,handleExport:Jr,handleImport:Js,handleDelete:St,handleLoadFromStartScreen:as}=e4({gameState:a,setGameState:r,closeSaveLoadModal:X,setShowStartScreen:h,setIsGameReady:m}),{addMemory:Ye}=s4({gameState:a,setGameState:r}),{handleStartCultivation:Fr,handleClaimCultivation:Xr}=t4({gameState:a,setGameState:r,setError:w,setIsLoading:b,addMemory:Ye}),{handleClearMemoryCategory:Kr,handleDeleteMemoryEntry:yn,handleDeleteSummary:vn,handleManualSummary:jn,handleUpdateSummarySettings:bs}=n4({gameState:a,setGameState:r,setError:w,setIsLoading:b}),[Nn,$s]=v.useState(!1),[Fs,Es]=v.useState(null),{currentTurnDescriptions:ca,setCurrentTurnDescriptions:As,combatAnimation:Wr,lastHit:Va,arenaResult:da,handleCombatAction:Qa,returnToExploration:ua,handleFlee:ma,clearArenaResult:Ya,startFinalBattle:Ja}=a4({gameState:a,setGameState:r,setIsLoading:b,setError:w,addMemory:Ye,setIsPreBattleModalOpen:J,pendingBattle:Fs,setPendingBattle:Es}),{randomEvent:Jt,eventResultText:ot,handleExplorationAction:jt,handleTravel:Ts,handleInitiateInteraction:xa,handleRandomEventChoice:el}=c4({gameState:a,setGameState:r,setIsLoading:b,setError:w,addMemory:Ye,setPendingBattle:Es,setCurrentTurnDescriptions:As,setIsPreBattleModalOpen:J,setIsMapOpen:re,setIsInteractionModalOpen:me}),{consultationPatient:fa,consultationStory:Fa,consultationChoices:Xs,viewingPatientRecord:Ks,setViewingPatientRecord:Ms,handleRefreshPatients:zs,handleAddPatient:Ws,handleStartConsultation:Ds,handleConsultationAction:at,handleEndConsultation:Xa,handleReturnToHospitalList:Ka,handleViewPatientRecord:gs}=d4({gameState:a,setGameState:r,setIsLoading:b,setError:w,addMemory:Ye}),{handleAssignLabor:Os,handleClaimLaborResult:tl,handleTransferPrisoner:Wa,handleReleasePrisoner:er,handleRecruitPrisoner:sl,handleDialogueComplete:wn,handleGenerateDialogueResponse:kn}=u4({gameState:a,setGameState:r,setIsLoading:b,setError:w,addMemory:Ye}),{handleGenerateAllDrafts:Ce,handleStartAllOptimization:Bt,handleOptimizeChallenge:Wl,handleRegister:Oi,handleCancelRegistration:nl,handleGenerateContestants:eo}=m4({gameState:a,setGameState:r,setIsLoading:b}),{isAnnouncementsLoading:tr,announcementsLoaded:Ri,fetchAnnouncements:Ut}=x4({gameState:a,setGameState:r}),{viewingBountyTarget:sr,setViewingBountyTarget:al,claimingBounty:Sn,setClaimingBounty:Cn,handleRefreshBountyBoard:to,handleAddBountyTarget:so,handleAcceptBounty:_n,handleClaimBounty:Ii,handleBountyOutcome:no}=f4({gameState:a,setGameState:r,setIsLoading:b,setError:w,addMemory:Ye}),[ao,nr]=v.useState(!1),[ar,ro]=v.useState(null),[ha,Ot]=v.useState(null),[rr,lr]=v.useState(null),[$n,Rs]=v.useState(""),[pa,Is]=v.useState({isOpen:!1,title:"",list:[],onSelect:()=>{}}),or=v.useRef(null);v.useEffect(()=>{console.log("[App] 初始化AI消息捕获服务..."),Ke.setMessageCallback((ue,fe)=>{console.log(`[App] 捕获到AI消息，类别: ${fe}`,ue);const ge=ue.content.length>30?ue.content.substring(0,30)+"...":ue.content;Ye(fe,`AI生成: ${ge}`,ue.content,[])});try{Ke.registerEventListeners(),console.log("[App] AI消息捕获服务初始化成功")}catch(ue){console.warn("[App] AI消息捕获服务初始化失败（可能不在SillyTavern环境中）:",ue)}return()=>{Ke.cleanup()}},[]),h4({gameState:a,setGameState:r,setIsGameReady:m});const ba=async()=>{if(a.playerProfile.businessDistrict){const ue=zh(a.playerProfile);let fe="",ge=0;const Ct=a.exploration.time.match(/第(\d+)天/),Bs=`第${(Ct?parseInt(Ct[1],10):1)+1}天，清晨`;if(Math.random()<.3)try{const _t=await P1(a.playerProfile.businessDistrict,a.playerProfile.cardCollection);fe=_t.message,ge=_t.incomeChange}catch(_t){console.error("Failed to generate business event:",_t),fe="今天风平浪静，无事发生。"}else fe="今天风平浪静，无事发生。";const js=ue+ge;r(_t=>{if(!_t.playerProfile.businessDistrict)return _t;const Bi=[{timestamp:Bs,message:`结算日：总收入 ${js} 灵石。${fe}`},..._t.playerProfile.businessDistrict.log].slice(0,50);return{..._t,exploration:{..._t.exploration,time:Bs},playerProfile:{..._t.playerProfile,spiritStones:_t.playerProfile.spiritStones+js,businessDistrict:{..._t.playerProfile.businessDistrict,log:Bi}}}}),a.playerProfile.businessDistrict&&(fe||js>0)&&Ye("商业",`${Bs}的经营日报`,`总收入：${js} 灵石
${fe}`)}if(Math.random()<.5)try{const ue=await Vl();r(fe=>({...fe,bountyBoard:[...fe.bountyBoard,{...ue,id:`bounty-${Date.now()}`,status:"悬赏中"}].slice(-10)}))}catch(ue){console.error("Failed to generate bounty target:",ue)}};v.useEffect(()=>{var ue;a.mode==="exploration"?(Ke.setCurrentScene("exploration"),(ue=or.current)==null||ue.scrollIntoView({behavior:"smooth",block:"end"})):a.mode==="battle"&&Ke.setCurrentScene("battle")},[a.mode]),v.useEffect(()=>{fa?Ke.setCurrentScene("consultation"):P?Ke.setCurrentScene("hospital"):ar?Ke.setCurrentScene("surveillance"):T?Ke.setCurrentScene("business"):M?Ke.setCurrentScene("bounty"):R?Ke.setCurrentScene("cultivation"):k?Ke.setCurrentScene("map"):C?Ke.setCurrentScene("interaction"):A?Ke.setCurrentScene("telepathy"):z?Ke.setCurrentScene("reputation"):E?Ke.setCurrentScene("announcement"):N==="竞技场"?Ke.setCurrentScene("arena"):N==="商城"?Ke.setCurrentScene("shop"):a.mode==="exploration"&&Ke.setCurrentScene("exploration")},[fa,P,T,M,R,k,C,N,a.mode]),v.useEffect(()=>{var ue;a.mode==="exploration"&&((ue=or.current)==null||ue.scrollIntoView({behavior:"smooth",block:"end"}))},[a.exploration.story,a.mode]),v.useEffect(()=>{a.exploration.pendingChallenge&&ae(!0)},[a.exploration.pendingChallenge]),v.useEffect(()=>{a.mode==="battle"&&a.battle&&r(ue=>{if(!ue.battle)return ue;const fe=ue.battle.playerParty.map(ge=>{const $e=ue.playerProfile.cardCollection.find(Ct=>Ct.id===ge.card.id);if($e){const Ct=Vs($e),tn=ge.calculatedStats.maxHp,Bs=tn>0?Math.min(1,ge.currentHp/tn):1,js=ge.calculatedStats.maxMp,_t=js>0?Math.min(1,ge.currentMp/js):1;return{...ge,card:$e,calculatedStats:Ct,currentHp:Math.max(1,Math.round(Ct.maxHp*Bs)),currentMp:Math.round(Ct.maxMp*_t)}}return ge});return JSON.stringify(ue.battle.playerParty)===JSON.stringify(fe)?ue:{...ue,battle:{...ue.battle,playerParty:fe}}})},[a.playerProfile.cardCollection,a.mode]);const ys=v.useCallback(()=>{if(ae(!1),a.playerProfile.maleParty.length===0&&a.playerProfile.femaleParty.length===0){w("队伍中至少需要一名角色才能进入战斗！"),setTimeout(()=>w(null),3e3);return}Fs?(As([]),J(!0)):(w("战斗信息丢失，无法开始。"),r(ue=>({...ue,exploration:{...ue.exploration,pendingChallenge:null}})))},[a.playerProfile,Fs]),ir=v.useCallback(()=>{var fe;ae(!1);const ue=((fe=a.exploration.pendingChallenge)==null?void 0:fe.challengerName)||"对方";r(ge=>({...ge,exploration:{...ge.exploration,story:ge.exploration.story+`

你思虑再三，决定拒绝 ${ue} 的挑战。`,choices:["继续你的旅程。","检查你的状态。","寻找一个安全的地方休息。"],pendingChallenge:null}})),Es(null)},[a.exploration.pendingChallenge,a.exploration.story]),ga=ue=>ne(ue),Ls=()=>ne(null),En=ue=>{r(fe=>({...fe,playerProfile:ue}))},cr=()=>{et(!0)},lo=async()=>{nr(!0);try{const ue=await U1(a.playerProfile,a);r(fe=>({...fe,playerProfile:{...fe.playerProfile,reputation:{...fe.playerProfile.reputation,title:ue.title,goodDeeds:ue.goodDeeds,badDeeds:ue.badDeeds,lewdDeeds:ue.lewdDeeds}}}))}catch(ue){console.error("Failed to generate reputation details:",ue)}finally{nr(!1)}},dr=ue=>{const fe=Vs(ue),ge={playerParty:[],opponentParty:[{card:ue,currentHp:fe.maxHp,currentMp:fe.maxMp,statusEffects:[],calculatedStats:fe,pet:ue.pet}],activePlayerCardIndex:0,activeOpponentCardIndex:0,turn:"pre-battle",combatLog:[`与 ${ue.name} 的竞技场对决即将开始！`],isBattleOver:!1,victory:null,isArenaBattle:!0};Es(ge),ne(null),J(!0)},ur=v.useCallback(ue=>{r(fe=>({...fe,vectorConfig:ue})),Vt.updateConfig(ue),gh.updateConfig(ue),console.log("[App] 向量配置已更新，Reranker状态:",ue.rerankerEnabled?"启用":"禁用")},[]),oo=v.useCallback(ue=>{r(fe=>({...fe,hospitalSystem:ue}))},[]),Mt=()=>{var ue,fe;if(a.mode==="exploration")return e.jsx(U5,{story:a.exploration.story,storyEndRef:or});if(a.mode==="battle"&&a.battle){const ge=a.battle;if(!ge.playerParty||!ge.opponentParty||ge.playerParty.length===0||ge.opponentParty.length===0||ge.activePlayerCardIndex>=ge.playerParty.length||ge.activeOpponentCardIndex>=ge.opponentParty.length)return console.error("[渲染] 战斗数据无效，返回空视图",{playerPartyLength:(ue=ge.playerParty)==null?void 0:ue.length,opponentPartyLength:(fe=ge.opponentParty)==null?void 0:fe.length,activePlayerIndex:ge.activePlayerCardIndex,activeOpponentIndex:ge.activeOpponentCardIndex}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-red-400 bg-black/60 p-8 rounded-lg",children:[e.jsx("p",{className:"text-2xl mb-4",children:"⚠️ 战斗数据异常"}),e.jsx("p",{className:"mb-4",children:"战斗状态出现错误，请返回探索模式"}),e.jsx("button",{onClick:()=>{r(tn=>({...tn,mode:"exploration",battle:void 0}))},className:"bg-amber-600 px-6 py-2 rounded hover:bg-amber-500",children:"返回探索"})]})});const $e=ge.playerParty[ge.activePlayerCardIndex],Ct=ge.opponentParty[ge.activeOpponentCardIndex];return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("div",{className:"flex-grow",children:e.jsx(Wy,{player:$e,opponent:Ct,animation:Wr,lastHit:Va})}),e.jsx("div",{className:"flex-shrink-0 h-48 p-4",children:e.jsx(Py,{descriptions:ca,isLoading:p,isPlayerTurn:ge.turn==="player"})})]})}return null},vs=v.useMemo(()=>{var fe,ge;const ue=new Map;return a.bountyBoard.forEach($e=>{$e.status==="追踪中"&&$e.trackerId&&ue.set($e.trackerId,`红尘录: ${$e.name}`)}),a.cultivationPavilion.forEach($e=>{$e.status==="Breeding"&&($e.parentA&&ue.set($e.parentA.id,"育灵轩: 培育中"),$e.parentB&&ue.set($e.parentB.id,"育灵轩: 培育中"))}),(fe=a.playerProfile.businessDistrict)==null||fe.shops.forEach($e=>{$e.staff.forEach(Ct=>{var Bs;const tn=((Bs=Yl[Ct.positionId])==null?void 0:Bs.name)||"工作";ue.set(Ct.characterId,`${$e.type}: ${tn}`)})}),(ge=a.etiquetteSystem)!=null&&ge.designer&&ue.set(a.etiquetteSystem.designer.characterId,"礼仪设计馆: 设计师"),ue},[a.bountyBoard,a.cultivationPavilion,a.playerProfile.businessDistrict,a.etiquetteSystem]),en=v.useMemo(()=>new Set(vs.keys()),[vs]),ya=()=>{h(!1),m(!0)},Li=as;return f?e.jsx(Hy,{onStartNewGame:ya,onLoadGame:Li}):e.jsxs("div",{ref:n,className:"flex flex-col font-serif relative w-full h-full max-w-lg mx-auto shadow-2xl overflow-hidden",style:{backgroundImage:"url('https://github.com/zzq0219/sillytavern/blob/main/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E4%BA%91%E9%9B%BE-%E4%BB%99%E4%BE%A0.png?raw=true')",backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"scroll"},children:[e.jsx(Y5,{playerProfile:a.playerProfile,location:a.exploration.location,onProfileClick:()=>pe(!0),appRef:n}),Ri&&e.jsx(Vy,{announcements:[...a.announcements.world,...a.announcements.adventure,...a.announcements.sect],onClick:()=>he(!0)}),e.jsxs("main",{className:"flex-grow flex flex-col w-full overflow-hidden relative",children:[e.jsx("div",{className:`absolute inset-0 pt-16 flex flex-col transition-opacity duration-300 ${o===xs.HOME?"opacity-100 z-20 pointer-events-auto":"opacity-0 z-0 pointer-events-none"}`,children:e.jsx(lv,{isVisible:o===xs.HOME,gameState:a,onNavClick:ga,onQuestClick:()=>kt(!0),onBusinessClick:()=>Dt(!0),onCultivationClick:()=>ns(!0),onMemoryClick:()=>Qs(!0),onCharacterStatusClick:()=>ps(!0),onPrisonClick:()=>qa(!0),onEtiquetteHallClick:()=>vt(!0),onGauntletClick:()=>Za(!0),onAnnouncementsClick:()=>he(!0),onSystemClick:()=>Re(!0),onHospitalClick:()=>hs(!0)})}),e.jsx("div",{className:`absolute inset-0 pt-16 flex flex-col transition-opacity duration-300 ${o===xs.ADVENTURE?"opacity-100 z-20 pointer-events-auto":"opacity-0 z-0 pointer-events-none"}`,children:e.jsx("div",{className:"flex-grow overflow-hidden px-2 sm:px-4 pb-2",children:e.jsx("div",{className:"w-full max-w-6xl mx-auto h-full flex flex-col",children:Mt()})})}),e.jsx("div",{className:`absolute inset-0 pt-16 flex flex-col transition-opacity duration-300 ${o===xs.INVENTORY?"opacity-100 z-20 pointer-events-auto":"opacity-0 z-0 pointer-events-none"}`,children:e.jsx("div",{className:"h-full overflow-y-auto px-2 pt-2 pb-32",children:e.jsx(Dh,{playerProfile:a.playerProfile,setPlayerProfile:ue=>r(fe=>({...fe,playerProfile:ue})),onViewPet:Ot})})})]}),a.mode==="battle"&&((mr=a.battle)==null?void 0:mr.isBattleOver)&&o===xs.ADVENTURE&&e.jsx(ev,{victory:a.battle.victory,isFled:a.battle.isFled,onClose:ua}),e.jsx(rv,{viewMode:o,gameState:a,isLoading:p,error:g,onExplorationAction:jt,onMapOpen:()=>re(!0),onNextDay:ba,onCombatAction:Qa,onFlee:ma,onOpenCombatLog:()=>$s(!0),onChangeView:c}),e.jsx(E5,{isOpen:_,onClose:()=>pe(!1),playerProfile:a.playerProfile,hasPendingChallenge:!!a.exploration.pendingChallenge,onBattleClick:()=>{a.exploration.pendingChallenge&&(pe(!1),ae(!0))},onRelationshipsClick:()=>xe(!0),onReputationClick:()=>cr()}),N&&e.jsx(C5,{activeModal:N,onClose:Ls,playerProfile:a.playerProfile,setPlayerProfile:En,leaderboards:a.leaderboards,onMatchFound:dr,onViewPet:Ot,gameState:a,onLeaderboardsUpdate:ue=>{r(fe=>({...fe,leaderboards:ue}))}}),Nn&&a.battle&&e.jsx(wv,{log:a.battle.combatLog,onClose:()=>$s(!1)}),j&&Fs&&e.jsx(T5,{playerProfile:a.playerProfile,opponentName:Fs.opponentParty[0].card.name,onBattleStart:Ja,onClose:()=>{J(!1),Es(null),r(ue=>({...ue,exploration:{...ue.exploration,pendingChallenge:null}}))}}),k&&e.jsx(T1,{currentLocationName:a.exploration.location,onClose:()=>re(!1),onTravel:Ts}),C&&e.jsx(S1,{isOpen:C,onClose:()=>me(!1),onInteract:xa,storyContext:a.exploration.story}),Jt&&e.jsx(O5,{event:Jt,onChoice:el,resultText:ot}),a.exploration.pendingChallenge&&e.jsx(Nv,{isOpen:S,onClose:ir,challenge:a.exploration.pendingChallenge,onAccept:ys,onDecline:ir}),D&&e.jsx(I5,{isOpen:D,onClose:()=>xe(!1),playerProfile:a.playerProfile}),e.jsx(Gy,{isOpen:E,onClose:()=>he(!1),announcements:a.announcements,onRefresh:()=>Ut("all"),isLoading:tr}),e.jsx(P5,{isOpen:A,onClose:()=>Se(!1),playerProfile:a.playerProfile}),e.jsx(L5,{isOpen:z,onClose:()=>et(!1),reputation:a.playerProfile.reputation,isLoading:ao,onRefresh:lo}),e.jsx(B5,{isOpen:I,onClose:()=>Re(!1),onSave:Ga,onLoad:Yr,onExport:Jr,onImport:Js,onDelete:St,getSaves:Zs.getAllSaves}),e.jsx(D5,{isOpen:L,onClose:()=>kt(!1),quests:a.playerProfile.quests,playerProfile:a.playerProfile,onClaimReward:ue=>{var ge;const fe=a.playerProfile.quests.find($e=>$e.id===ue);if(fe&&fe.status==="Claimable"){if(r($e=>({...$e,playerProfile:i4($e.playerProfile,ue)})),fe){const $e=[fe.rewards.spiritStones?`灵石 +${fe.rewards.spiritStones}`:"",fe.rewards.reputation?`声望 +${fe.rewards.reputation}`:"",((ge=fe.rewards.items)==null?void 0:ge.map(Ct=>Ct.name).join("、"))||""].filter(Boolean).join("，");Ye("其他",`完成任务：${fe.title}`,`${fe.description}

获得奖励：${$e}`,[])}console.log("[任务系统] 领取奖励:",fe.title)}}}),da&&e.jsx(Qy,{...da,onClose:Ya}),e.jsx(jv,{isOpen:T,onClose:()=>Dt(!1),playerProfile:a.playerProfile,onUpdateProfile:En,onOpenSurveillance:ue=>ro(ue),busyCharacterIds:en,onOpenSelector:(ue,fe,ge)=>Is({isOpen:!0,title:ue,list:fe,onSelect:ge}),etiquetteSystem:a.etiquetteSystem}),ar&&e.jsx(H5,{isOpen:!!ar,onClose:()=>ro(null),shop:ar,cardCollection:a.playerProfile.cardCollection}),e.jsx(k1,{isOpen:P,onClose:()=>hs(!1),patients:a.hospitalPatients,onStartConsultation:Ds,onRefresh:zs,onAddPatient:Ws,isLoading:p,onViewRecord:gs,consultationPatient:fa,consultationStory:Fa,consultationChoices:Xs,onConsultationAction:at,onEndConsultation:Xa,onReturnToList:Ka,gameState:a,hospitalSystem:a.hospitalSystem,onUpdateHospitalSystem:oo}),Ks&&e.jsx(M1,{isOpen:!!Ks,onClose:()=>Ms(null),record:Ks}),e.jsx(yv,{isOpen:M,onClose:()=>ut(!1),bountyBoard:a.bountyBoard,onViewTarget:ue=>al(ue.character),onAccept:ue=>{const fe=a.bountyBoard.find($e=>$e.id===ue);if(!fe)return;const ge=a.playerProfile.cardCollection.filter($e=>!en.has($e.id));Is({isOpen:!0,title:`为悬赏【${fe.name}】派遣角色`,list:ge,onSelect:$e=>{_n(fe.id,$e.id)}})},onClaim:Ii,onRefresh:to,onAddTarget:so,isLoading:p}),sr&&e.jsx(Ei,{card:sr,onClose:()=>al(null),playerProfile:a.playerProfile,setPlayerProfile:En,onViewPet:Ot}),ha&&e.jsx(A5,{pet:ha,onClose:()=>Ot(null)}),Sn&&e.jsx(vv,{isOpen:!!Sn,onClose:()=>Cn(null),bounty:Sn,onOutcome:ue=>no(Sn.id,ue)}),e.jsx(Cv,{isOpen:R,onClose:()=>ns(!1),playerProfile:a.playerProfile,cultivationSlots:a.cultivationPavilion,onStartCultivation:Fr,onClaimCultivation:Xr,busyCharacterIds:en,onOpenSelector:(ue,fe,ge)=>Is({isOpen:!0,title:ue,list:fe,onSelect:ge}),onGetLiveMonitoring:async ue=>{const fe=a.cultivationPavilion.find(ge=>ge.slotId===ue);if(!fe||!fe.parentA||!fe.parentB)return"监视目标丢失...";try{return await J1(fe.parentA,fe.parentB)}catch(ge){return console.error("生成监视报告失败:",ge),"监视水晶受到干扰，无法看清内部情况..."}}}),e.jsx(l5,{isOpen:Q,onClose:()=>Qs(!1),memories:a.memories,memorySummaries:a.memorySummaries,summarySettings:a.summarySettings,onClearCategory:Kr,onDeleteEntry:yn,onDeleteSummary:vn,onManualSummary:jn,onUpdateSettings:bs,gameState:a,onVectorConfigSave:ur}),e.jsx(kg,{isOpen:Z,onClose:()=>ps(!1),cardCollection:a.playerProfile.cardCollection,petCollection:a.playerProfile.petCollection,busyCharacterDetails:vs}),e.jsx(Ng,{isOpen:pa.isOpen,onClose:()=>Is(ue=>({...ue,isOpen:!1})),onSelect:pa.onSelect,characterList:pa.list,title:pa.title}),e.jsx(z5,{isOpen:G,onClose:()=>qa(!1),prisonSystem:a.prisonSystem,playerProfile:a.playerProfile,setPlayerProfile:En,onViewPet:Ot,onInterrogatePrisoner:ue=>{lr(ue),la(!0),Rs("")},onViewPrisonerDetail:ue=>{alert(`查看囚犯详情：${ue.character.name}

罪行：${ue.crime}
屈服度：${ue.submissionLevel}%
归顺度：${ue.loyaltyLevel}%
健康度：${ue.health}%
神智：${ue.sanity}%`)},onTransferPrisoner:Wa,onReleasePrisoner:er,onRecruitPrisoner:sl,onAssignLabor:Os,onClaimLaborResult:tl,onGenerateEvent:()=>{alert("随机事件功能开发中")},onDialogueComplete:wn,onGenerateDialogueResponse:kn,isLoading:p}),e.jsx(Qg,{isOpen:O,onClose:()=>vt(!1),etiquetteSystem:a.etiquetteSystem,onUpdateEtiquetteSystem:ue=>{r(fe=>({...fe,etiquetteSystem:ue}))},cardCollection:a.playerProfile.cardCollection,gameState:a,onOpenDesignerSelection:()=>{const ue=a.playerProfile.cardCollection.filter(fe=>!en.has(fe.id));Is({isOpen:!0,title:"选择礼仪设计师",list:ue,onSelect:fe=>{const ge={characterId:fe.id,assignedAt:Date.now(),designCount:0,designStyle:["极致服从","羞耻强化"],qualityScore:80};r($e=>({...$e,etiquetteSystem:{...$e.etiquetteSystem,designer:ge,logs:[{id:`log-${Date.now()}`,timestamp:Date.now(),action:"designer_assign",details:`指派了新设计师：${fe.name}`,designerId:fe.id},...$e.etiquetteSystem.logs].slice(0,100)}})),Is($e=>({...$e,isOpen:!1}))}})}}),e.jsx(l1,{isOpen:U,onClose:()=>Za(!1),gameState:a,setGameState:r,onOpenAnnouncement:()=>{oa(!0)},onOpenRegistration:()=>{ia(!0)},onOpenLive:()=>{Ys(!0)}}),e.jsx(o1,{isOpen:B,onClose:()=>Ys(!1),gameState:a,setGameState:r}),e.jsx(_v,{isOpen:te,onClose:()=>oa(!1),gameState:a,onGenerateAllDrafts:Ce,onStartAllOptimization:Bt,onOptimizeChallenge:Wl}),e.jsx(i1,{isOpen:ie,onClose:()=>ia(!1),gameState:a,onRegister:Oi,onCancelRegistration:nl,onGenerateContestants:eo}),H&&rr&&e.jsx(C1,{isOpen:H,onClose:()=>la(!1),prisoner:rr,availableTortureMethods:[{id:"whipping",name:"鞭刑",category:"basic",description:"用鞭子抽打囚犯，造成皮肉之苦",damage:20,intimidation:40,successRate:30,submissionIncrease:10,risks:{death:2,permanentInjury:5,insanity:3}},{id:"caning",name:"杖刑",category:"basic",description:"用木杖击打囚犯",damage:30,intimidation:50,successRate:40,submissionIncrease:15,risks:{death:5,permanentInjury:10,insanity:5}}],onExecuteTorture:(ue,fe,ge)=>{alert(`执行刑罚：囚犯 ${ue}, 方法 ${fe}, 时长 ${ge}分钟

此功能需要AI集成才能生成审讯结果。`),Rs(`正在执行刑罚...
持续时间：${ge}分钟

[此处将显示AI生成的审讯过程]`)},onEndInterrogation:()=>{la(!1),lr(null),Rs("")},interrogationLog:$n,isLoading:p}),e.jsx(Yg,{isOpen:W,onToggle:()=>_s(!W),subButtons:[{id:"save",icon:"fa-solid fa-save",label:"存档",color:"border-emerald-500/60 text-emerald-400",onClick:()=>{Re(!0),_s(!1)}},{id:"load",icon:"fa-solid fa-folder-open",label:"读档",color:"border-blue-500/60 text-blue-400",onClick:()=>{Re(!0),_s(!1)}},{id:"memory",icon:"fa-solid fa-brain",label:"识海",color:"border-pink-500/60 text-pink-400",onClick:()=>{Qs(!0),_s(!1)}},{id:"map",icon:"fa-solid fa-map-location-dot",label:"地图",color:"border-amber-500/60 text-amber-400",onClick:()=>{re(!0),_s(!1)}},{id:"cultivation",icon:"fa-solid fa-dna",label:"育灵",color:"border-purple-500/60 text-purple-400",onClick:()=>{ns(!0),_s(!1)}}]})]})},fp=document.getElementById("root");if(!fp)throw new Error("Could not find root element to mount to");const b4=vg.createRoot(fp);b4.render(e.jsx(La.StrictMode,{children:e.jsx(p4,{})}));</script>
  <style rel="stylesheet" crossorigin>.mobile-container{width:100%;max-width:100vw;padding:.5rem}@media(min-width:768px){.mobile-container{max-width:768px;margin:0 auto;padding:1rem}}.responsive-padding{padding:1rem}@media(max-width:640px){.responsive-padding{padding:.5rem}}.responsive-padding-sm{padding:.5rem}@media(min-width:768px){.responsive-padding-sm{padding:1rem}}.stack-mobile{display:flex;flex-direction:column;gap:.5rem}@media(min-width:768px){.stack-mobile{flex-direction:row;gap:1rem}}.modal-responsive{position:fixed;width:100%;max-width:100vw;height:90vh;max-height:90vh;margin:0;border-radius:1rem 1rem 0 0;bottom:0;top:auto;left:0;right:0}@media(min-width:768px){.modal-responsive{position:relative;width:auto;max-width:42rem;height:auto;max-height:85vh;border-radius:.75rem;bottom:auto;top:auto;left:auto;right:auto}}.modal-responsive-lg{position:fixed;width:100%;max-width:100vw;height:95vh;max-height:95vh;margin:0;border-radius:1rem 1rem 0 0;bottom:0;left:0;right:0}@media(min-width:768px){.modal-responsive-lg{position:relative;width:auto;max-width:56rem;height:auto;max-height:90vh;border-radius:.75rem;bottom:auto;left:auto;right:auto}}@media(min-width:1024px){.modal-responsive-lg{max-width:72rem}}.modal-drag-indicator{display:block;width:3rem;height:.25rem;background-color:#78716c80;border-radius:9999px;margin:.5rem auto}@media(min-width:768px){.modal-drag-indicator{display:none}}@keyframes slideUpMobile{0%{transform:translateY(100%);opacity:.8}to{transform:translateY(0);opacity:1}}.animate-slide-up-mobile{animation:slideUpMobile .3s cubic-bezier(.16,1,.3,1)}@media(min-width:768px){.animate-slide-up-mobile{animation:none}}.touch-target{min-width:44px;min-height:44px;display:inline-flex;align-items:center;justify-content:center;padding:.5rem}.touch-feedback{transition:all .2s ease;-webkit-tap-highlight-color:transparent}.touch-feedback:active{transform:scale(.95);opacity:.8}.btn-responsive{width:100%;padding:.75rem 1rem;font-size:1rem;min-height:44px}@media(min-width:640px){.btn-responsive{width:auto;min-width:120px;padding:.5rem 1.5rem}}.btn-group-mobile{display:flex;flex-direction:column;gap:.5rem;width:100%}@media(min-width:640px){.btn-group-mobile{flex-direction:row;width:auto;gap:1rem}}.responsive-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:.75rem}@media(min-width:640px){.responsive-grid{grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem}}@media(min-width:1024px){.responsive-grid{grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.5rem}}.card-grid-mobile{display:grid;grid-template-columns:repeat(2,1fr);gap:.5rem}@media(min-width:480px){.card-grid-mobile{grid-template-columns:repeat(3,1fr);gap:.75rem}}@media(min-width:768px){.card-grid-mobile{grid-template-columns:repeat(4,1fr);gap:1rem}}@media(min-width:1024px){.card-grid-mobile{grid-template-columns:repeat(5,1fr);gap:1rem}}.text-responsive-title{font-size:clamp(1.25rem,4vw,2rem);line-height:1.2}.text-responsive-subtitle{font-size:clamp(1rem,3vw,1.5rem);line-height:1.3}.text-responsive-body{font-size:clamp(.875rem,2vw,1rem);line-height:1.6}.text-responsive-small{font-size:clamp(.75rem,1.5vw,.875rem);line-height:1.4}.card-responsive{width:100%;max-width:100%;padding:.75rem}@media(min-width:640px){.card-responsive{max-width:20rem;padding:1rem}}.character-card-responsive{width:100%;aspect-ratio:2/3;min-width:120px}@media(min-width:480px){.character-card-responsive{min-width:150px}}@media(min-width:768px){.character-card-responsive{min-width:180px}}.show-mobile{display:block}@media(min-width:768px){.show-mobile{display:none!important}}.hide-mobile{display:none}@media(min-width:768px){.hide-mobile{display:block}}.show-tablet{display:none}@media(min-width:640px){.show-tablet{display:block}}.topbar-responsive{height:3rem;padding:.5rem}@media(min-width:768px){.topbar-responsive{height:4rem;padding:1rem}}.bottombar-responsive{height:5rem;padding:.5rem}@media(min-width:768px){.bottombar-responsive{height:7rem;padding:1rem}}.input-responsive{width:100%;padding:.75rem;font-size:1rem;min-height:44px}@media(min-width:640px){.input-responsive{padding:.5rem .75rem}}.select-responsive{width:100%;padding:.75rem;font-size:1rem;min-height:44px}@media(min-width:640px){.select-responsive{width:auto;min-width:200px}}.gap-responsive{gap:.5rem}@media(min-width:768px){.gap-responsive{gap:1rem}}.gap-responsive-lg{gap:.75rem}@media(min-width:768px){.gap-responsive-lg{gap:1.5rem}}.scroll-mobile{overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}.scroll-horizontal-mobile{display:flex;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;scroll-snap-type:x mandatory;gap:.5rem;padding:.5rem}.scroll-horizontal-mobile>*{flex-shrink:0;scroll-snap-align:start}.scrollbar-hide{-ms-overflow-style:none;scrollbar-width:none}.scrollbar-hide::-webkit-scrollbar{display:none}.img-responsive{width:100%;height:auto;-o-object-fit:cover;object-fit:cover}.avatar-responsive{width:2.5rem;height:2.5rem}@media(min-width:768px){.avatar-responsive{width:3rem;height:3rem}}.safe-area-inset-top{padding-top:env(safe-area-inset-top)}.safe-area-inset-bottom{padding-bottom:env(safe-area-inset-bottom)}.safe-area-inset-left{padding-left:env(safe-area-inset-left)}.safe-area-inset-right{padding-right:env(safe-area-inset-right)}.gpu-accelerated{transform:translateZ(0);will-change:transform;backface-visibility:hidden}@media(prefers-reduced-motion:reduce){*,*:before,*:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}#root *{box-sizing:border-box}.fixed-container-topbar{height:48px!important;min-height:48px!important;max-height:48px!important;padding:.5rem!important;font-size:.875rem!important}.fixed-container-topbar .text-xl{font-size:1rem!important}.fixed-container-topbar .text-lg{font-size:.875rem!important}.fixed-container-bottombar{height:100px!important;min-height:100px!important;max-height:100px!important;padding:.5rem!important}.fixed-container-bottombar button{padding:.375rem .75rem!important;font-size:.75rem!important;min-height:32px!important}.fixed-container-bottombar .text-xs{font-size:.625rem!important}.fixed-container-main{height:812px!important;max-height:812px!important;overflow-y:auto!important;overflow-x:hidden!important;-webkit-overflow-scrolling:touch}.fixed-container-story{padding:1rem!important;font-size:.875rem!important;line-height:1.6!important}.fixed-container-modal{width:500px!important;max-width:500px!important;max-height:880px!important;margin:40px auto!important}.fixed-container-modal-header{padding:.75rem!important;font-size:1rem!important}.fixed-container-modal-content{max-height:700px!important;overflow-y:auto!important;padding:1rem!important;font-size:.875rem!important}.fixed-container-card-grid{display:grid!important;grid-template-columns:repeat(3,1fr)!important;gap:.5rem!important;padding:.5rem!important}.fixed-container-character-card{width:100%!important;min-width:0!important;aspect-ratio:2/3!important}.fixed-container-character-card .text-sm{font-size:.75rem!important}.fixed-container-character-card .text-xs{font-size:.625rem!important}.fixed-container-battlefield{height:400px!important;max-height:400px!important}.fixed-container-battle-character{max-width:200px!important;max-height:300px!important}.fixed-container-battle-actions{height:200px!important;max-height:200px!important}.fixed-container-battle-narrator{height:180px!important;max-height:180px!important;overflow-y:auto!important;font-size:.875rem!important}.fixed-container-btn-group{display:flex!important;flex-wrap:wrap!important;gap:.375rem!important;justify-content:center!important}.fixed-container-btn{padding:.5rem 1rem!important;font-size:.875rem!important;min-height:36px!important;white-space:nowrap!important}.fixed-container-btn-sm{padding:.375rem .75rem!important;font-size:.75rem!important;min-height:32px!important}.fixed-container-list{max-height:600px!important;overflow-y:auto!important}.fixed-container-list-item{padding:.75rem!important;font-size:.875rem!important}.fixed-container-input,.fixed-container-select{width:100%!important;padding:.5rem!important;font-size:.875rem!important}.fixed-container-scroll::-webkit-scrollbar{width:6px!important;height:6px!important}.fixed-container-scroll::-webkit-scrollbar-track{background:#1c191780!important}.fixed-container-scroll::-webkit-scrollbar-thumb{background:#57534e!important;border-radius:3px!important}.fixed-container-scroll::-webkit-scrollbar-thumb:hover{background:#78716c!important}.fixed-container-text-xs{font-size:.625rem!important;line-height:1.4!important}.fixed-container-text-sm{font-size:.75rem!important;line-height:1.5!important}.fixed-container-text-base{font-size:.875rem!important;line-height:1.6!important}.fixed-container-text-lg{font-size:1rem!important;line-height:1.5!important}.fixed-container-text-xl{font-size:1.125rem!important;line-height:1.4!important}.fixed-container-p-tight{padding:.5rem!important}.fixed-container-m-tight{margin:.5rem!important}.fixed-container-gap-tight{gap:.5rem!important}.fixed-container-announcement{height:28px!important;font-size:.75rem!important;padding:.25rem .5rem!important}.fixed-container-avatar{width:2rem!important;height:2rem!important}.fixed-container-avatar-lg{width:3rem!important;height:3rem!important}.fixed-container-icon{width:1rem!important;height:1rem!important}.fixed-container-icon-lg{width:1.5rem!important;height:1.5rem!important}.fixed-container-progress{height:.5rem!important}.fixed-container-progress-lg{height:.75rem!important}.fixed-container-badge{padding:.125rem .375rem!important;font-size:.625rem!important}.fixed-container-start-screen{width:540px!important;height:960px!important}.fixed-container-map{width:100%!important;height:100%!important;max-width:540px!important;max-height:960px!important}@media(min-width:640px),(min-width:768px),(min-width:1024px),(min-width:1280px){.fixed-container-no-responsive *{font-size:inherit!important;padding:inherit!important;margin:inherit!important}}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-top:1.2em;margin-bottom:1.2em}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);text-decoration:underline;font-weight:500}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal;margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:disc;margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{font-weight:400;color:var(--tw-prose-counters)}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.25em}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-top:3em;margin-bottom:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:500;font-style:italic;color:var(--tw-prose-quotes);border-inline-start-width:.25rem;border-inline-start-color:var(--tw-prose-quote-borders);quotes:"“""”""‘""’";margin-top:1.6em;margin-bottom:1.6em;padding-inline-start:1em}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:900;color:inherit}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:800;color:inherit}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.5em;margin-bottom:.5em;line-height:1.5}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){display:block;margin-top:2em;margin-bottom:2em}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:500;font-family:inherit;color:var(--tw-prose-kbd);box-shadow:0 0 0 1px var(--tw-prose-kbd-shadows),0 3px 0 var(--tw-prose-kbd-shadows);font-size:.875em;border-radius:.3125rem;padding-top:.1875em;padding-inline-end:.375em;padding-bottom:.1875em;padding-inline-start:.375em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-weight:600;font-size:.875em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-pre-code);background-color:var(--tw-prose-pre-bg);overflow-x:auto;font-weight:400;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding-top:.8571429em;padding-inline-end:1.1428571em;padding-bottom:.8571429em;padding-inline-start:1.1428571em}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:inherit;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){width:100%;table-layout:auto;margin-top:2em;margin-bottom:2em;font-size:.875em;line-height:1.7142857}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-th-borders)}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;vertical-align:bottom;padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-inline-start:.5714286em}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-td-borders)}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:baseline}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-width:1px;border-top-color:var(--tw-prose-th-borders)}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(th,td):not(:where([class~=not-prose],[class~=not-prose] *)){text-align:start}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose{--tw-prose-body: #374151;--tw-prose-headings: #111827;--tw-prose-lead: #4b5563;--tw-prose-links: #111827;--tw-prose-bold: #111827;--tw-prose-counters: #6b7280;--tw-prose-bullets: #d1d5db;--tw-prose-hr: #e5e7eb;--tw-prose-quotes: #111827;--tw-prose-quote-borders: #e5e7eb;--tw-prose-captions: #6b7280;--tw-prose-kbd: #111827;--tw-prose-kbd-shadows: rgb(17 24 39 / 10%);--tw-prose-code: #111827;--tw-prose-pre-code: #e5e7eb;--tw-prose-pre-bg: #1f2937;--tw-prose-th-borders: #d1d5db;--tw-prose-td-borders: #e5e7eb;--tw-prose-invert-body: #d1d5db;--tw-prose-invert-headings: #fff;--tw-prose-invert-lead: #9ca3af;--tw-prose-invert-links: #fff;--tw-prose-invert-bold: #fff;--tw-prose-invert-counters: #9ca3af;--tw-prose-invert-bullets: #4b5563;--tw-prose-invert-hr: #374151;--tw-prose-invert-quotes: #f3f4f6;--tw-prose-invert-quote-borders: #374151;--tw-prose-invert-captions: #9ca3af;--tw-prose-invert-kbd: #fff;--tw-prose-invert-kbd-shadows: rgb(255 255 255 / 10%);--tw-prose-invert-code: #fff;--tw-prose-invert-pre-code: #d1d5db;--tw-prose-invert-pre-bg: rgb(0 0 0 / 50%);--tw-prose-invert-th-borders: #4b5563;--tw-prose-invert-td-borders: #374151;font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;margin-bottom:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(.prose>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-inline-start:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.5714286em;padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-inline-start:.5714286em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.prose-invert{--tw-prose-body: var(--tw-prose-invert-body);--tw-prose-headings: var(--tw-prose-invert-headings);--tw-prose-lead: var(--tw-prose-invert-lead);--tw-prose-links: var(--tw-prose-invert-links);--tw-prose-bold: var(--tw-prose-invert-bold);--tw-prose-counters: var(--tw-prose-invert-counters);--tw-prose-bullets: var(--tw-prose-invert-bullets);--tw-prose-hr: var(--tw-prose-invert-hr);--tw-prose-quotes: var(--tw-prose-invert-quotes);--tw-prose-quote-borders: var(--tw-prose-invert-quote-borders);--tw-prose-captions: var(--tw-prose-invert-captions);--tw-prose-kbd: var(--tw-prose-invert-kbd);--tw-prose-kbd-shadows: var(--tw-prose-invert-kbd-shadows);--tw-prose-code: var(--tw-prose-invert-code);--tw-prose-pre-code: var(--tw-prose-invert-pre-code);--tw-prose-pre-bg: var(--tw-prose-invert-pre-bg);--tw-prose-th-borders: var(--tw-prose-invert-th-borders);--tw-prose-td-borders: var(--tw-prose-invert-td-borders)}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.-inset-6{top:-1.5rem;right:-1.5rem;bottom:-1.5rem;left:-1.5rem}.inset-0{top:0;right:0;bottom:0;left:0}.inset-0\.5{top:.125rem;right:.125rem;bottom:.125rem;left:.125rem}.inset-1{top:.25rem;right:.25rem;bottom:.25rem;left:.25rem}.inset-1\.5{top:.375rem;right:.375rem;bottom:.375rem;left:.375rem}.inset-2{top:.5rem;right:.5rem;bottom:.5rem;left:.5rem}.inset-\[-6px\]{top:-6px;right:-6px;bottom:-6px;left:-6px}.inset-\[-8px\]{top:-8px;right:-8px;bottom:-8px;left:-8px}.-bottom-0\.5{bottom:-.125rem}.-bottom-1{bottom:-.25rem}.-bottom-10{bottom:-2.5rem}.-bottom-2{bottom:-.5rem}.-bottom-20{bottom:-5rem}.-bottom-3{bottom:-.75rem}.-bottom-6{bottom:-1.5rem}.-bottom-7{bottom:-1.75rem}.-bottom-8{bottom:-2rem}.-left-0\.5{left:-.125rem}.-left-1{left:-.25rem}.-left-10{left:-2.5rem}.-left-20{left:-5rem}.-left-4{left:-1rem}.-right-0\.5{right:-.125rem}.-right-1{right:-.25rem}.-right-1\.5{right:-.375rem}.-right-10{right:-2.5rem}.-right-2{right:-.5rem}.-right-20{right:-5rem}.-right-4{right:-1rem}.-top-0\.5{top:-.125rem}.-top-1{top:-.25rem}.-top-1\.5{top:-.375rem}.-top-10{top:-2.5rem}.-top-2{top:-.5rem}.-top-20{top:-5rem}.-top-\[1px\]{top:-1px}.bottom-0{bottom:0}.bottom-1{bottom:.25rem}.bottom-1\/4{bottom:25%}.bottom-24{bottom:6rem}.bottom-4{bottom:1rem}.bottom-40{bottom:10rem}.bottom-6{bottom:1.5rem}.bottom-full{bottom:100%}.left-0{left:0}.left-0\.5{left:.125rem}.left-1{left:.25rem}.left-1\/2{left:50%}.left-1\/4{left:25%}.left-12{left:3rem}.left-2{left:.5rem}.left-3{left:.75rem}.left-4{left:1rem}.left-6{left:1.5rem}.left-8{left:2rem}.right-0{right:0}.right-1{right:.25rem}.right-1\/3{right:33.333333%}.right-10{right:2.5rem}.right-12{right:3rem}.right-2{right:.5rem}.right-20{right:5rem}.right-3{right:.75rem}.right-4{right:1rem}.right-6{right:1.5rem}.top-0{top:0}.top-0\.5{top:.125rem}.top-1{top:.25rem}.top-1\/2{top:50%}.top-1\/3{top:33.333333%}.top-1\/4{top:25%}.top-16{top:4rem}.top-2{top:.5rem}.top-20{top:5rem}.top-3{top:.75rem}.top-3\/4{top:75%}.top-4{top:1rem}.top-full{top:100%}.-z-10{z-index:-10}.z-0{z-index:0}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.z-\[100\]{z-index:100}.z-\[110\]{z-index:110}.z-\[60\]{z-index:60}.z-\[70\]{z-index:70}.z-\[80\]{z-index:80}.order-1{order:1}.order-2{order:2}.col-span-1{grid-column:span 1 / span 1}.col-span-2{grid-column:span 2 / span 2}.col-span-full{grid-column:1 / -1}.-m-2{margin:-.5rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-4{margin-top:1rem;margin-bottom:1rem}.my-6{margin-top:1.5rem;margin-bottom:1.5rem}.my-8{margin-top:2rem;margin-bottom:2rem}.-mt-8{margin-top:-2rem}.mb-0{margin-bottom:0}.mb-0\.5{margin-bottom:.125rem}.mb-1{margin-bottom:.25rem}.mb-10{margin-bottom:2.5rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-5{margin-bottom:1.25rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:.25rem}.ml-10{margin-left:2.5rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.ml-8{margin-left:2rem}.ml-auto{margin-left:auto}.mr-1{margin-right:.25rem}.mr-1\.5{margin-right:.375rem}.mr-2{margin-right:.5rem}.mr-3{margin-right:.75rem}.mr-4{margin-right:1rem}.mr-8{margin-right:2rem}.mt-0\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-5{margin-top:1.25rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.mt-auto{margin-top:auto}.line-clamp-1{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.aspect-\[3\/4\]{aspect-ratio:3/4}.h-0\.5{height:.125rem}.h-1{height:.25rem}.h-1\.5{height:.375rem}.h-10{height:2.5rem}.h-11{height:2.75rem}.h-12{height:3rem}.h-14{height:3.5rem}.h-16{height:4rem}.h-2{height:.5rem}.h-2\.5{height:.625rem}.h-20{height:5rem}.h-24{height:6rem}.h-3{height:.75rem}.h-32{height:8rem}.h-4{height:1rem}.h-4\/5{height:80%}.h-40{height:10rem}.h-48{height:12rem}.h-5{height:1.25rem}.h-52{height:13rem}.h-56{height:14rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-9{height:2.25rem}.h-96{height:24rem}.h-\[1px\]{height:1px}.h-\[2px\]{height:2px}.h-\[60vh\]{height:60vh}.h-\[70vh\]{height:70vh}.h-\[80vh\]{height:80vh}.h-\[85vh\]{height:85vh}.h-\[90vh\]{height:90vh}.h-\[calc\(100\%-65px\)\]{height:calc(100% - 65px)}.h-auto{height:auto}.h-full{height:100%}.h-px{height:1px}.max-h-24{max-height:6rem}.max-h-32{max-height:8rem}.max-h-48{max-height:12rem}.max-h-56{max-height:14rem}.max-h-64{max-height:16rem}.max-h-96{max-height:24rem}.max-h-\[16rem\]{max-height:16rem}.max-h-\[200px\]{max-height:200px}.max-h-\[300px\]{max-height:300px}.max-h-\[400px\]{max-height:400px}.max-h-\[500px\]{max-height:500px}.max-h-\[60vh\]{max-height:60vh}.max-h-\[70vh\]{max-height:70vh}.max-h-\[80vh\]{max-height:80vh}.max-h-\[85vh\]{max-height:85vh}.max-h-\[90vh\]{max-height:90vh}.max-h-\[95vh\]{max-height:95vh}.max-h-\[calc\(60vh-3rem\)\]{max-height:calc(60vh - 3rem)}.max-h-\[calc\(90vh-120px\)\]{max-height:calc(90vh - 120px)}.max-h-full{max-height:100%}.min-h-\[10rem\]{min-height:10rem}.min-h-\[120px\]{min-height:120px}.min-h-\[15rem\]{min-height:15rem}.min-h-\[200px\]{min-height:200px}.min-h-\[20rem\]{min-height:20rem}.min-h-\[44px\]{min-height:44px}.min-h-screen{min-height:100vh}.w-1{width:.25rem}.w-1\.5{width:.375rem}.w-1\/3{width:33.333333%}.w-1\/4{width:25%}.w-1\/5{width:20%}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-14{width:3.5rem}.w-16{width:4rem}.w-2{width:.5rem}.w-2\/3{width:66.666667%}.w-2\/5{width:40%}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-3\/4{width:75%}.w-3\/5{width:60%}.w-32{width:8rem}.w-36{width:9rem}.w-4{width:1rem}.w-4\/5{width:80%}.w-40{width:10rem}.w-48{width:12rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-64{width:16rem}.w-7{width:1.75rem}.w-72{width:18rem}.w-8{width:2rem}.w-80{width:20rem}.w-9{width:2.25rem}.w-96{width:24rem}.w-\[2px\]{width:2px}.w-\[90vw\]{width:90vw}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.w-px{width:1px}.min-w-0{min-width:0px}.min-w-\[100px\]{min-width:100px}.min-w-\[120px\]{min-width:120px}.min-w-min{min-width:-moz-min-content;min-width:min-content}.max-w-2xl{max-width:42rem}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-5xl{max-width:64rem}.max-w-6xl{max-width:72rem}.max-w-7xl{max-width:80rem}.max-w-\[150px\]{max-width:150px}.max-w-\[200px\]{max-width:200px}.max-w-\[280px\]{max-width:280px}.max-w-\[45\%\]{max-width:45%}.max-w-\[95vw\]{max-width:95vw}.max-w-lg{max-width:32rem}.max-w-md{max-width:28rem}.max-w-none{max-width:none}.max-w-screen-lg{max-width:1024px}.max-w-sm{max-width:24rem}.max-w-xl{max-width:36rem}.max-w-xs{max-width:20rem}.flex-1{flex:1 1 0%}.flex-shrink-0,.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.basis-40{flex-basis:10rem}.table-fixed{table-layout:fixed}.origin-bottom{transform-origin:bottom}.-translate-x-1\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-2{--tw-translate-x: -.5rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-2{--tw-translate-y: -.5rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-6{--tw-translate-y: -1.5rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-full{--tw-translate-y: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-1{--tw-translate-x: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-1\/2{--tw-translate-x: 50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-6{--tw-translate-x: 1.5rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-8{--tw-translate-x: 2rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\[-100\%\]{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-0{--tw-translate-y: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-1\/2{--tw-translate-y: 50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-full{--tw-translate-y: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-rotate-12{--tw-rotate: -12deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-rotate-90{--tw-rotate: -90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-0{--tw-rotate: 0deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-12{--tw-rotate: 12deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-100{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-105{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-150{--tw-scale-x: 1.5;--tw-scale-y: 1.5;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-90{--tw-scale-x: .9;--tw-scale-y: .9;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-x-0{--tw-scale-x: 0;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-x-100{--tw-scale-x: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.animate-bounce{animation:bounce 1s infinite}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.animate-fade-in{animation:fadeIn .3s ease-out}@keyframes fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in-up{animation:fadeInUp .5s ease-out}@keyframes ghostFire{0%,to{transform:translateY(0) scale(1);opacity:.6}50%{transform:translateY(-8px) scale(1.1);opacity:1}}.animate-ghost-fire{animation:ghostFire 3s ease-in-out infinite}@keyframes mysticPulse{0%,to{opacity:.4;transform:scale(1)}50%{opacity:.8;transform:scale(1.05)}}.animate-mystic-pulse{animation:mysticPulse 2s ease-in-out infinite}@keyframes ping{75%,to{transform:scale(2);opacity:0}}.animate-ping{animation:ping 1s cubic-bezier(0,0,.2,1) infinite}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes pulse{50%{opacity:.5}}.animate-pulse-fast{animation:pulse 1s cubic-bezier(.4,0,.6,1) infinite}@keyframes pulseGlow{0%,to{box-shadow:0 0 10px #fcd34d80;transform:scale(1)}50%{box-shadow:0 0 30px #fcd34dcc;transform:scale(1.05)}}@keyframes shake{0%,to{transform:translate(0)}10%,30%,50%,70%,90%{transform:translate(-5px)}20%,40%,60%,80%{transform:translate(5px)}}.animate-shake{animation:shake .5s}.animate-shimmer{animation:shimmer 2s infinite}@keyframes slideIn{0%{opacity:0;transform:translateY(-50px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}.animate-slide-in{animation:slideIn .4s cubic-bezier(.16,1,.3,1)}@keyframes slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.animate-slide-up{animation:slideUp .5s ease-out}.animate-spin{animation:spin 1s linear infinite}@keyframes spinReverse{0%{transform:rotate(360deg)}to{transform:rotate(0)}}.animate-spin-reverse{animation:spinReverse 3s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.cursor-default{cursor:default}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.touch-none{touch-action:none}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.resize-none{resize:none}.resize{resize:both}.snap-x{scroll-snap-type:x var(--tw-scroll-snap-strictness)}.snap-mandatory{--tw-scroll-snap-strictness: mandatory}.snap-center{scroll-snap-align:center}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-baseline{align-items:baseline}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.gap-0{gap:0px}.gap-0\.5{gap:.125rem}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-2\.5{gap:.625rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-5{gap:1.25rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.gap-x-3{-moz-column-gap:.75rem;column-gap:.75rem}.gap-x-4{-moz-column-gap:1rem;column-gap:1rem}.gap-y-3{row-gap:.75rem}.gap-y-5{row-gap:1.25rem}.space-x-1>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.25rem * var(--tw-space-x-reverse));margin-left:calc(.25rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-6>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1.5rem * var(--tw-space-x-reverse));margin-left:calc(1.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-12>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(3rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(3rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-2\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.625rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.625rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.25rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.self-start{align-self:flex-start}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.overflow-y-visible{overflow-y:visible}.scroll-smooth{scroll-behavior:smooth}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-normal{white-space:normal}.whitespace-nowrap{white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-\[100\%\]{border-radius:100%}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-xl{border-radius:.75rem}.rounded-b-lg{border-bottom-right-radius:.5rem;border-bottom-left-radius:.5rem}.rounded-l-md{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.rounded-l-sm{border-top-left-radius:.125rem;border-bottom-left-radius:.125rem}.rounded-r-lg{border-top-right-radius:.5rem;border-bottom-right-radius:.5rem}.rounded-r-md{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.rounded-t-2xl{border-top-left-radius:1rem;border-top-right-radius:1rem}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.rounded-t-xl{border-top-left-radius:.75rem;border-top-right-radius:.75rem}.rounded-bl-full{border-bottom-left-radius:9999px}.rounded-bl-none{border-bottom-left-radius:0}.rounded-bl-xl{border-bottom-left-radius:.75rem}.rounded-br{border-bottom-right-radius:.25rem}.rounded-br-none{border-bottom-right-radius:0}.rounded-br-xl{border-bottom-right-radius:.75rem}.rounded-tl{border-top-left-radius:.25rem}.rounded-tl-xl{border-top-left-radius:.75rem}.rounded-tr-xl{border-top-right-radius:.75rem}.border{border-width:1px}.border-2{border-width:2px}.border-4{border-width:4px}.border-y{border-top-width:1px;border-bottom-width:1px}.border-y-2{border-top-width:2px;border-bottom-width:2px}.border-b{border-bottom-width:1px}.border-b-0{border-bottom-width:0px}.border-b-2{border-bottom-width:2px}.border-b-4{border-bottom-width:4px}.border-l{border-left-width:1px}.border-l-2{border-left-width:2px}.border-l-4{border-left-width:4px}.border-r{border-right-width:1px}.border-r-2{border-right-width:2px}.border-r-4{border-right-width:4px}.border-t{border-top-width:1px}.border-t-2{border-top-width:2px}.border-t-4{border-top-width:4px}.border-dashed{border-style:dashed}.border-\[var\(--onmyoji-border-subtle\)\]{border-color:var(--onmyoji-border-subtle)}.border-\[var\(--onmyoji-gold\)\]{border-color:var(--onmyoji-gold)}.border-\[var\(--onmyoji-gold-dark\)\]{border-color:var(--onmyoji-gold-dark)}.border-\[var\(--onmyoji-red-light\)\]{border-color:var(--onmyoji-red-light)}.border-amber-400{--tw-border-opacity: 1;border-color:rgb(251 191 36 / var(--tw-border-opacity, 1))}.border-amber-400\/20{border-color:#fbbf2433}.border-amber-400\/30{border-color:#fbbf244d}.border-amber-400\/50{border-color:#fbbf2480}.border-amber-400\/70{border-color:#fbbf24b3}.border-amber-400\/80{border-color:#fbbf24cc}.border-amber-500{--tw-border-opacity: 1;border-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.border-amber-500\/0{border-color:#f59e0b00}.border-amber-500\/10{border-color:#f59e0b1a}.border-amber-500\/20{border-color:#f59e0b33}.border-amber-500\/30{border-color:#f59e0b4d}.border-amber-500\/40{border-color:#f59e0b66}.border-amber-500\/5{border-color:#f59e0b0d}.border-amber-500\/50{border-color:#f59e0b80}.border-amber-500\/60{border-color:#f59e0b99}.border-amber-500\/70{border-color:#f59e0bb3}.border-amber-600{--tw-border-opacity: 1;border-color:rgb(217 119 6 / var(--tw-border-opacity, 1))}.border-amber-600\/30{border-color:#d977064d}.border-amber-600\/50{border-color:#d9770680}.border-amber-700\/20{border-color:#b4530933}.border-amber-700\/30{border-color:#b453094d}.border-amber-700\/50{border-color:#b4530980}.border-amber-900\/30{border-color:#78350f4d}.border-amber-900\/50{border-color:#78350f80}.border-blood-500{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-blood-600{--tw-border-opacity: 1;border-color:rgb(220 38 38 / var(--tw-border-opacity, 1))}.border-blue-400{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.border-blue-400\/50{border-color:#60a5fa80}.border-blue-500{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.border-blue-500\/30{border-color:#3b82f64d}.border-blue-500\/50{border-color:#3b82f680}.border-blue-500\/60{border-color:#3b82f699}.border-blue-600{--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.border-blue-700\/50{border-color:#1d4ed880}.border-blue-800{--tw-border-opacity: 1;border-color:rgb(30 64 175 / var(--tw-border-opacity, 1))}.border-blue-900\/50{border-color:#1e3a8a80}.border-cyan-500{--tw-border-opacity: 1;border-color:rgb(6 182 212 / var(--tw-border-opacity, 1))}.border-cyan-500\/30{border-color:#06b6d44d}.border-cyan-500\/50{border-color:#06b6d480}.border-cyan-700\/30{border-color:#0e74904d}.border-cyan-700\/50{border-color:#0e749080}.border-emerald-500{--tw-border-opacity: 1;border-color:rgb(16 185 129 / var(--tw-border-opacity, 1))}.border-emerald-500\/60{border-color:#10b98199}.border-fuchsia-400{--tw-border-opacity: 1;border-color:rgb(232 121 249 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-gray-400{--tw-border-opacity: 1;border-color:rgb(156 163 175 / var(--tw-border-opacity, 1))}.border-gray-500{--tw-border-opacity: 1;border-color:rgb(107 114 128 / var(--tw-border-opacity, 1))}.border-gray-500\/30{border-color:#6b72804d}.border-gray-600\/30{border-color:#4b55634d}.border-gray-600\/50{border-color:#4b556380}.border-gray-700\/30{border-color:#3741514d}.border-green-400{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.border-green-400\/50{border-color:#4ade8080}.border-green-500{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-green-500\/30{border-color:#22c55e4d}.border-green-500\/50{border-color:#22c55e80}.border-green-500\/60{border-color:#22c55e99}.border-green-600{--tw-border-opacity: 1;border-color:rgb(22 163 74 / var(--tw-border-opacity, 1))}.border-green-600\/30{border-color:#16a34a4d}.border-green-700\/30{border-color:#15803d4d}.border-green-700\/50{border-color:#15803d80}.border-indigo-400\/30{border-color:#818cf84d}.border-indigo-400\/40{border-color:#818cf866}.border-indigo-400\/50{border-color:#818cf880}.border-indigo-500{--tw-border-opacity: 1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.border-indigo-500\/50{border-color:#6366f180}.border-indigo-600\/30{border-color:#4f46e54d}.border-orange-500\/30{border-color:#f973164d}.border-pink-500{--tw-border-opacity: 1;border-color:rgb(236 72 153 / var(--tw-border-opacity, 1))}.border-pink-500\/20{border-color:#ec489933}.border-pink-500\/30{border-color:#ec48994d}.border-pink-500\/50{border-color:#ec489980}.border-pink-500\/60{border-color:#ec489999}.border-pink-700\/30{border-color:#be185d4d}.border-pink-800{--tw-border-opacity: 1;border-color:rgb(157 23 77 / var(--tw-border-opacity, 1))}.border-pink-800\/50{border-color:#9d174d80}.border-pink-900\/50{border-color:#83184380}.border-purple-400{--tw-border-opacity: 1;border-color:rgb(192 132 252 / var(--tw-border-opacity, 1))}.border-purple-400\/30{border-color:#c084fc4d}.border-purple-400\/50{border-color:#c084fc80}.border-purple-500{--tw-border-opacity: 1;border-color:rgb(168 85 247 / var(--tw-border-opacity, 1))}.border-purple-500\/20{border-color:#a855f733}.border-purple-500\/30{border-color:#a855f74d}.border-purple-500\/50{border-color:#a855f780}.border-purple-500\/60{border-color:#a855f799}.border-purple-600\/30{border-color:#9333ea4d}.border-purple-700\/30{border-color:#7e22ce4d}.border-purple-700\/50{border-color:#7e22ce80}.border-red-400\/30{border-color:#f871714d}.border-red-400\/50{border-color:#f8717180}.border-red-500{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-red-500\/30{border-color:#ef44444d}.border-red-500\/50{border-color:#ef444480}.border-red-500\/70{border-color:#ef4444b3}.border-red-600\/50{border-color:#dc262680}.border-red-700{--tw-border-opacity: 1;border-color:rgb(185 28 28 / var(--tw-border-opacity, 1))}.border-red-700\/30{border-color:#b91c1c4d}.border-red-700\/50{border-color:#b91c1c80}.border-red-900\/30{border-color:#7f1d1d4d}.border-red-900\/50{border-color:#7f1d1d80}.border-rose-500{--tw-border-opacity: 1;border-color:rgb(244 63 94 / var(--tw-border-opacity, 1))}.border-rose-700{--tw-border-opacity: 1;border-color:rgb(190 18 60 / var(--tw-border-opacity, 1))}.border-sky-400\/60{border-color:#38bdf899}.border-sky-500{--tw-border-opacity: 1;border-color:rgb(14 165 233 / var(--tw-border-opacity, 1))}.border-sky-500\/50{border-color:#0ea5e980}.border-sky-500\/70{border-color:#0ea5e9b3}.border-sky-700\/30{border-color:#0369a14d}.border-slate-500{--tw-border-opacity: 1;border-color:rgb(100 116 139 / var(--tw-border-opacity, 1))}.border-slate-700{--tw-border-opacity: 1;border-color:rgb(51 65 85 / var(--tw-border-opacity, 1))}.border-slate-700\/50{border-color:#33415580}.border-spiritual-500{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.border-spiritual-600\/30{border-color:#2563eb4d}.border-stone-500{--tw-border-opacity: 1;border-color:rgb(120 113 108 / var(--tw-border-opacity, 1))}.border-stone-500\/50{border-color:#78716c80}.border-stone-600{--tw-border-opacity: 1;border-color:rgb(87 83 78 / var(--tw-border-opacity, 1))}.border-stone-600\/50{border-color:#57534e80}.border-stone-700{--tw-border-opacity: 1;border-color:rgb(68 64 60 / var(--tw-border-opacity, 1))}.border-stone-700\/30{border-color:#44403c4d}.border-stone-700\/50{border-color:#44403c80}.border-stone-800{--tw-border-opacity: 1;border-color:rgb(41 37 36 / var(--tw-border-opacity, 1))}.border-stone-800\/50{border-color:#29252480}.border-teal-500{--tw-border-opacity: 1;border-color:rgb(20 184 166 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-violet-500{--tw-border-opacity: 1;border-color:rgb(139 92 246 / var(--tw-border-opacity, 1))}.border-white\/10{border-color:#ffffff1a}.border-white\/20{border-color:#fff3}.border-white\/5{border-color:#ffffff0d}.border-xianxia-gold-300{--tw-border-opacity: 1;border-color:rgb(252 211 77 / var(--tw-border-opacity, 1))}.border-xianxia-gold-400{--tw-border-opacity: 1;border-color:rgb(251 191 36 / var(--tw-border-opacity, 1))}.border-xianxia-gold-400\/20{border-color:#fbbf2433}.border-xianxia-gold-400\/30{border-color:#fbbf244d}.border-xianxia-gold-500{--tw-border-opacity: 1;border-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.border-xianxia-gold-500\/20{border-color:#f59e0b33}.border-xianxia-gold-500\/50{border-color:#f59e0b80}.border-xianxia-gold-500\/70{border-color:#f59e0bb3}.border-xianxia-gold-600{--tw-border-opacity: 1;border-color:rgb(217 119 6 / var(--tw-border-opacity, 1))}.border-xianxia-gold-600\/30{border-color:#d977064d}.border-xianxia-gold-600\/50{border-color:#d9770680}.border-xianxia-gold-700\/20{border-color:#b4530933}.border-xianxia-gold-700\/30{border-color:#b453094d}.border-xianxia-gold-700\/40{border-color:#b4530966}.border-yellow-300\/80{border-color:#fde047cc}.border-yellow-400\/20{border-color:#facc1533}.border-yellow-500{--tw-border-opacity: 1;border-color:rgb(234 179 8 / var(--tw-border-opacity, 1))}.border-yellow-500\/50{border-color:#eab30880}.border-yellow-700\/50{border-color:#a1620780}.border-l-stone-600{--tw-border-opacity: 1;border-left-color:rgb(87 83 78 / var(--tw-border-opacity, 1))}.border-opacity-60{--tw-border-opacity: .6}.bg-\[\#050505\]{--tw-bg-opacity: 1;background-color:rgb(5 5 5 / var(--tw-bg-opacity, 1))}.bg-\[\#080808\]{--tw-bg-opacity: 1;background-color:rgb(8 8 8 / var(--tw-bg-opacity, 1))}.bg-\[\#0a0a0a\]{--tw-bg-opacity: 1;background-color:rgb(10 10 10 / var(--tw-bg-opacity, 1))}.bg-\[\#0c0c0c\]{--tw-bg-opacity: 1;background-color:rgb(12 12 12 / var(--tw-bg-opacity, 1))}.bg-\[var\(--onmyoji-bg-primary\)\]{background-color:var(--onmyoji-bg-primary)}.bg-\[var\(--onmyoji-ghost\)\]{background-color:var(--onmyoji-ghost)}.bg-\[var\(--onmyoji-gold\)\]{background-color:var(--onmyoji-gold)}.bg-\[var\(--onmyoji-purple\)\]{background-color:var(--onmyoji-purple)}.bg-amber-100\/20{background-color:#fef3c733}.bg-amber-400{--tw-bg-opacity: 1;background-color:rgb(251 191 36 / var(--tw-bg-opacity, 1))}.bg-amber-400\/10{background-color:#fbbf241a}.bg-amber-400\/30{background-color:#fbbf244d}.bg-amber-400\/60{background-color:#fbbf2499}.bg-amber-500{--tw-bg-opacity: 1;background-color:rgb(245 158 11 / var(--tw-bg-opacity, 1))}.bg-amber-500\/10{background-color:#f59e0b1a}.bg-amber-500\/20{background-color:#f59e0b33}.bg-amber-500\/30{background-color:#f59e0b4d}.bg-amber-500\/50{background-color:#f59e0b80}.bg-amber-500\/60{background-color:#f59e0b99}.bg-amber-600{--tw-bg-opacity: 1;background-color:rgb(217 119 6 / var(--tw-bg-opacity, 1))}.bg-amber-600\/10{background-color:#d977061a}.bg-amber-600\/20{background-color:#d9770633}.bg-amber-600\/30{background-color:#d977064d}.bg-amber-600\/50{background-color:#d9770680}.bg-amber-600\/80{background-color:#d97706cc}.bg-amber-600\/90{background-color:#d97706e6}.bg-amber-700{--tw-bg-opacity: 1;background-color:rgb(180 83 9 / var(--tw-bg-opacity, 1))}.bg-amber-700\/30{background-color:#b453094d}.bg-amber-700\/50{background-color:#b4530980}.bg-amber-900\/20{background-color:#78350f33}.bg-amber-900\/30{background-color:#78350f4d}.bg-amber-900\/40{background-color:#78350f66}.bg-amber-900\/50{background-color:#78350f80}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-black\/10{background-color:#0000001a}.bg-black\/20{background-color:#0003}.bg-black\/30{background-color:#0000004d}.bg-black\/40{background-color:#0006}.bg-black\/50{background-color:#00000080}.bg-black\/60{background-color:#0009}.bg-black\/70{background-color:#000000b3}.bg-black\/80{background-color:#000c}.bg-black\/85{background-color:#000000d9}.bg-black\/90{background-color:#000000e6}.bg-blood-600\/50{background-color:#dc262680}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-500\/10{background-color:#3b82f61a}.bg-blue-500\/20{background-color:#3b82f633}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-600\/80{background-color:#2563ebcc}.bg-blue-700{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.bg-blue-700\/50{background-color:#1d4ed880}.bg-blue-900\/10{background-color:#1e3a8a1a}.bg-blue-900\/20{background-color:#1e3a8a33}.bg-blue-900\/30{background-color:#1e3a8a4d}.bg-blue-900\/60{background-color:#1e3a8a99}.bg-cyan-500\/20{background-color:#06b6d433}.bg-cyan-600\/20{background-color:#0891b233}.bg-cyan-600\/30{background-color:#0891b24d}.bg-cyan-600\/80{background-color:#0891b2cc}.bg-cyan-900\/20{background-color:#164e6333}.bg-cyan-900\/30{background-color:#164e634d}.bg-emerald-600\/10{background-color:#0596691a}.bg-emerald-600\/5{background-color:#0596690d}.bg-gray-500\/10{background-color:#6b72801a}.bg-gray-500\/20{background-color:#6b728033}.bg-gray-600{--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-gray-600\/20{background-color:#4b556333}.bg-gray-600\/30{background-color:#4b55634d}.bg-gray-600\/80{background-color:#4b5563cc}.bg-gray-700{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-gray-700\/30{background-color:#3741514d}.bg-gray-700\/50{background-color:#37415180}.bg-gray-800\/30{background-color:#1f29374d}.bg-green-400{--tw-bg-opacity: 1;background-color:rgb(74 222 128 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-500\/10{background-color:#22c55e1a}.bg-green-500\/20{background-color:#22c55e33}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-600\/30{background-color:#16a34a4d}.bg-green-600\/50{background-color:#16a34a80}.bg-green-600\/80{background-color:#16a34acc}.bg-green-700{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.bg-green-700\/50{background-color:#15803d80}.bg-green-900\/20{background-color:#14532d33}.bg-green-900\/30{background-color:#14532d4d}.bg-green-900\/50{background-color:#14532d80}.bg-indigo-600{--tw-bg-opacity: 1;background-color:rgb(79 70 229 / var(--tw-bg-opacity, 1))}.bg-indigo-600\/20{background-color:#4f46e533}.bg-indigo-600\/50{background-color:#4f46e580}.bg-orange-500{--tw-bg-opacity: 1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-orange-500\/20{background-color:#f9731633}.bg-orange-600\/10{background-color:#ea580c1a}.bg-orange-600\/30{background-color:#ea580c4d}.bg-orange-900\/20{background-color:#7c2d1233}.bg-orange-900\/30{background-color:#7c2d124d}.bg-pink-500\/20{background-color:#ec489933}.bg-pink-600{--tw-bg-opacity: 1;background-color:rgb(219 39 119 / var(--tw-bg-opacity, 1))}.bg-pink-600\/30{background-color:#db27774d}.bg-pink-600\/50{background-color:#db277780}.bg-pink-900\/20{background-color:#83184333}.bg-purple-500\/20{background-color:#a855f733}.bg-purple-600{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-purple-600\/20{background-color:#9333ea33}.bg-purple-600\/30{background-color:#9333ea4d}.bg-purple-600\/50{background-color:#9333ea80}.bg-purple-600\/80{background-color:#9333eacc}.bg-purple-700{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.bg-purple-700\/30{background-color:#7e22ce4d}.bg-purple-700\/50{background-color:#7e22ce80}.bg-purple-800\/30{background-color:#6b21a84d}.bg-purple-800\/50{background-color:#6b21a880}.bg-purple-900\/10{background-color:#581c871a}.bg-purple-900\/20{background-color:#581c8733}.bg-purple-900\/30{background-color:#581c874d}.bg-purple-900\/40{background-color:#581c8766}.bg-purple-900\/50{background-color:#581c8780}.bg-purple-900\/80{background-color:#581c87cc}.bg-red-400{--tw-bg-opacity: 1;background-color:rgb(248 113 113 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-500\/10{background-color:#ef44441a}.bg-red-500\/20{background-color:#ef444433}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-red-600\/10{background-color:#dc26261a}.bg-red-600\/20{background-color:#dc262633}.bg-red-600\/80{background-color:#dc2626cc}.bg-red-700{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.bg-red-700\/50{background-color:#b91c1c80}.bg-red-800{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.bg-red-800\/80{background-color:#991b1bcc}.bg-red-900{--tw-bg-opacity: 1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.bg-red-900\/10{background-color:#7f1d1d1a}.bg-red-900\/20{background-color:#7f1d1d33}.bg-red-900\/30{background-color:#7f1d1d4d}.bg-red-900\/50{background-color:#7f1d1d80}.bg-red-900\/80{background-color:#7f1d1dcc}.bg-red-950\/10{background-color:#450a0a1a}.bg-rose-800\/50{background-color:#9f123980}.bg-sky-500\/10{background-color:#0ea5e91a}.bg-sky-500\/20{background-color:#0ea5e933}.bg-sky-600{--tw-bg-opacity: 1;background-color:rgb(2 132 199 / var(--tw-bg-opacity, 1))}.bg-sky-900{--tw-bg-opacity: 1;background-color:rgb(12 74 110 / var(--tw-bg-opacity, 1))}.bg-sky-900\/20{background-color:#0c4a6e33}.bg-slate-600{--tw-bg-opacity: 1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.bg-slate-700{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.bg-slate-700\/50{background-color:#33415580}.bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.bg-slate-800\/50{background-color:#1e293b80}.bg-slate-800\/70{background-color:#1e293bb3}.bg-slate-800\/80{background-color:#1e293bcc}.bg-slate-900{--tw-bg-opacity: 1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.bg-slate-900\/50{background-color:#0f172a80}.bg-slate-900\/70{background-color:#0f172ab3}.bg-slate-900\/90{background-color:#0f172ae6}.bg-stone-600{--tw-bg-opacity: 1;background-color:rgb(87 83 78 / var(--tw-bg-opacity, 1))}.bg-stone-600\/50{background-color:#57534e80}.bg-stone-700{--tw-bg-opacity: 1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.bg-stone-700\/30{background-color:#44403c4d}.bg-stone-700\/50{background-color:#44403c80}.bg-stone-700\/60{background-color:#44403c99}.bg-stone-700\/80{background-color:#44403ccc}.bg-stone-800{--tw-bg-opacity: 1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.bg-stone-800\/20{background-color:#29252433}.bg-stone-800\/30{background-color:#2925244d}.bg-stone-800\/40{background-color:#29252466}.bg-stone-800\/50{background-color:#29252480}.bg-stone-800\/60{background-color:#29252499}.bg-stone-800\/70{background-color:#292524b3}.bg-stone-800\/80{background-color:#292524cc}.bg-stone-800\/90{background-color:#292524e6}.bg-stone-900{--tw-bg-opacity: 1;background-color:rgb(28 25 23 / var(--tw-bg-opacity, 1))}.bg-stone-900\/30{background-color:#1c19174d}.bg-stone-900\/50{background-color:#1c191780}.bg-stone-900\/60{background-color:#1c191799}.bg-stone-900\/70{background-color:#1c1917b3}.bg-stone-900\/80{background-color:#1c1917cc}.bg-stone-900\/90{background-color:#1c1917e6}.bg-stone-950{--tw-bg-opacity: 1;background-color:rgb(12 10 9 / var(--tw-bg-opacity, 1))}.bg-stone-950\/30{background-color:#0c0a094d}.bg-stone-950\/50{background-color:#0c0a0980}.bg-stone-950\/80{background-color:#0c0a09cc}.bg-stone-950\/90{background-color:#0c0a09e6}.bg-stone-950\/95{background-color:#0c0a09f2}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/20{background-color:#fff3}.bg-xianxia-gold-500\/30{background-color:#f59e0b4d}.bg-xianxia-gold-600{--tw-bg-opacity: 1;background-color:rgb(217 119 6 / var(--tw-bg-opacity, 1))}.bg-xianxia-gold-600\/50{background-color:#d9770680}.bg-xianxia-gold-900\/20{background-color:#78350f33}.bg-yellow-500{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-yellow-500\/20{background-color:#eab30833}.bg-yellow-500\/80{background-color:#eab308cc}.bg-yellow-700\/50{background-color:#a1620780}.bg-yellow-900\/10{background-color:#713f121a}.bg-yellow-900\/30{background-color:#713f124d}.bg-yellow-900\/50{background-color:#713f1280}.bg-\[radial-gradient\(circle_at_30\%_70\%\,var\(--onmyoji-gold-glow\)\,transparent_50\%\)\]{background-image:radial-gradient(circle at 30% 70%,var(--onmyoji-gold-glow),transparent 50%)}.bg-\[radial-gradient\(circle_at_center\,_var\(--tw-gradient-stops\)\)\]{background-image:radial-gradient(circle at center,var(--tw-gradient-stops))}.bg-\[url\(\'\/assets\/bg\/pattern-dark\.png\'\)\]{background-image:url(/assets/bg/pattern-dark.png)}.bg-\[url\(\'\/patterns\/subtle-dark\.png\'\)\]{background-image:url(/patterns/subtle-dark.png)}.bg-\[url\(\'https\:\/\/www\.transparenttextures\.com\/patterns\/black-scales\.png\'\)\]{background-image:url(https://www.transparenttextures.com/patterns/black-scales.png)}.bg-\[url\(\'https\:\/\/www\.transparenttextures\.com\/patterns\/dark-wood\.png\'\)\]{background-image:url(https://www.transparenttextures.com/patterns/dark-wood.png)}.bg-\[url\(\'https\:\/\/www\.transparenttextures\.com\/patterns\/stardust\.png\'\)\]{background-image:url(https://www.transparenttextures.com/patterns/stardust.png)}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.bg-gradient-to-bl{background-image:linear-gradient(to bottom left,var(--tw-gradient-stops))}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.bg-gradient-to-t{background-image:linear-gradient(to top,var(--tw-gradient-stops))}.from-\[\#0a0a0a\]{--tw-gradient-from: #0a0a0a var(--tw-gradient-from-position);--tw-gradient-to: rgb(10 10 10 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[\#1c1c1c\]{--tw-gradient-from: #1c1c1c var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 28 28 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-bg-primary\)\]{--tw-gradient-from: var(--onmyoji-bg-primary) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-bg-secondary\)\]{--tw-gradient-from: var(--onmyoji-bg-secondary) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-bg-tertiary\)\]{--tw-gradient-from: var(--onmyoji-bg-tertiary) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-ghost\)\]{--tw-gradient-from: var(--onmyoji-ghost) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-gold\)\]{--tw-gradient-from: var(--onmyoji-gold) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-gold-dark\)\]{--tw-gradient-from: var(--onmyoji-gold-dark) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-gold-glow\)\]{--tw-gradient-from: var(--onmyoji-gold-glow) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-gold-light\)\]{--tw-gradient-from: var(--onmyoji-gold-light) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-purple\)\]{--tw-gradient-from: var(--onmyoji-purple) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-\[var\(--onmyoji-red-light\)\]{--tw-gradient-from: var(--onmyoji-red-light) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-100{--tw-gradient-from: #fef3c7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 243 199 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-200{--tw-gradient-from: #fde68a var(--tw-gradient-from-position);--tw-gradient-to: rgb(253 230 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-500{--tw-gradient-from: #f59e0b var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-500\/0{--tw-gradient-from: rgb(245 158 11 / 0) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-500\/10{--tw-gradient-from: rgb(245 158 11 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-500\/20{--tw-gradient-from: rgb(245 158 11 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-500\/40{--tw-gradient-from: rgb(245 158 11 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-500\/60{--tw-gradient-from: rgb(245 158 11 / .6) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-600{--tw-gradient-from: #d97706 var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-600\/20{--tw-gradient-from: rgb(217 119 6 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-600\/30{--tw-gradient-from: rgb(217 119 6 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-600\/40{--tw-gradient-from: rgb(217 119 6 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-700{--tw-gradient-from: #b45309 var(--tw-gradient-from-position);--tw-gradient-to: rgb(180 83 9 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-900\/20{--tw-gradient-from: rgb(120 53 15 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-900\/40{--tw-gradient-from: rgb(120 53 15 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-900\/5{--tw-gradient-from: rgb(120 53 15 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-900\/50{--tw-gradient-from: rgb(120 53 15 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-900\/80{--tw-gradient-from: rgb(120 53 15 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black{--tw-gradient-from: #000 var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\/40{--tw-gradient-from: rgb(0 0 0 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\/50{--tw-gradient-from: rgb(0 0 0 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\/60{--tw-gradient-from: rgb(0 0 0 / .6) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\/70{--tw-gradient-from: rgb(0 0 0 / .7) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\/80{--tw-gradient-from: rgb(0 0 0 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\/95{--tw-gradient-from: rgb(0 0 0 / .95) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blood-700{--tw-gradient-from: #b91c1c var(--tw-gradient-from-position);--tw-gradient-to: rgb(185 28 28 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-500{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-600{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-600\/80{--tw-gradient-from: rgb(37 99 235 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-700{--tw-gradient-from: #1d4ed8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(29 78 216 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-900\/50{--tw-gradient-from: rgb(30 58 138 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-cyan-900\/50{--tw-gradient-from: rgb(22 78 99 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 78 99 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-500{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-600{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-700{--tw-gradient-from: #15803d var(--tw-gradient-from-position);--tw-gradient-to: rgb(21 128 61 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-900\/30{--tw-gradient-from: rgb(20 83 45 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-900\/50{--tw-gradient-from: rgb(20 83 45 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-600{--tw-gradient-from: #4f46e5 var(--tw-gradient-from-position);--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-600\/20{--tw-gradient-from: rgb(79 70 229 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-600\/40{--tw-gradient-from: rgb(79 70 229 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-600\/80{--tw-gradient-from: rgb(79 70 229 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-900\/95{--tw-gradient-from: rgb(49 46 129 / .95) var(--tw-gradient-from-position);--tw-gradient-to: rgb(49 46 129 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-500\/20{--tw-gradient-from: rgb(236 72 153 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(236 72 153 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-600{--tw-gradient-from: #db2777 var(--tw-gradient-from-position);--tw-gradient-to: rgb(219 39 119 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-900\/40{--tw-gradient-from: rgb(131 24 67 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(131 24 67 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-500{--tw-gradient-from: #a855f7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600\/20{--tw-gradient-from: rgb(147 51 234 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600\/40{--tw-gradient-from: rgb(147 51 234 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600\/80{--tw-gradient-from: rgb(147 51 234 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-700{--tw-gradient-from: #7e22ce var(--tw-gradient-from-position);--tw-gradient-to: rgb(126 34 206 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-900\/20{--tw-gradient-from: rgb(88 28 135 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-900\/30{--tw-gradient-from: rgb(88 28 135 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-900\/50{--tw-gradient-from: rgb(88 28 135 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-900\/95{--tw-gradient-from: rgb(88 28 135 / .95) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-500{--tw-gradient-from: #ef4444 var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 68 68 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-600{--tw-gradient-from: #dc2626 var(--tw-gradient-from-position);--tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-600\/80{--tw-gradient-from: rgb(220 38 38 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-700{--tw-gradient-from: #b91c1c var(--tw-gradient-from-position);--tw-gradient-to: rgb(185 28 28 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-900\/30{--tw-gradient-from: rgb(127 29 29 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-900\/50{--tw-gradient-from: rgb(127 29 29 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-sky-600{--tw-gradient-from: #0284c7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(2 132 199 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-sky-900{--tw-gradient-from: #0c4a6e var(--tw-gradient-from-position);--tw-gradient-to: rgb(12 74 110 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-sky-900\/40{--tw-gradient-from: rgb(12 74 110 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(12 74 110 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-600{--tw-gradient-from: #57534e var(--tw-gradient-from-position);--tw-gradient-to: rgb(87 83 78 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-700{--tw-gradient-from: #44403c var(--tw-gradient-from-position);--tw-gradient-to: rgb(68 64 60 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-700\/90{--tw-gradient-from: rgb(68 64 60 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(68 64 60 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-800{--tw-gradient-from: #292524 var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-800\/40{--tw-gradient-from: rgb(41 37 36 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-800\/50{--tw-gradient-from: rgb(41 37 36 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-800\/70{--tw-gradient-from: rgb(41 37 36 / .7) var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-800\/80{--tw-gradient-from: rgb(41 37 36 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-800\/90{--tw-gradient-from: rgb(41 37 36 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-800\/95{--tw-gradient-from: rgb(41 37 36 / .95) var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-900{--tw-gradient-from: #1c1917 var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-900\/50{--tw-gradient-from: rgb(28 25 23 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-900\/60{--tw-gradient-from: rgb(28 25 23 / .6) var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-900\/70{--tw-gradient-from: rgb(28 25 23 / .7) var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-900\/90{--tw-gradient-from: rgb(28 25 23 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-900\/95{--tw-gradient-from: rgb(28 25 23 / .95) var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-950{--tw-gradient-from: #0c0a09 var(--tw-gradient-from-position);--tw-gradient-to: rgb(12 10 9 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-transparent{--tw-gradient-from: transparent var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white\/20{--tw-gradient-from: rgb(255 255 255 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white\/5{--tw-gradient-from: rgb(255 255 255 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-xianxia-gold-400{--tw-gradient-from: #fbbf24 var(--tw-gradient-from-position);--tw-gradient-to: rgb(251 191 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-xianxia-gold-500{--tw-gradient-from: #f59e0b var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-xianxia-gold-600{--tw-gradient-from: #d97706 var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-xianxia-gold-600\/80{--tw-gradient-from: rgb(217 119 6 / .8) var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-700\/50{--tw-gradient-from: rgb(161 98 7 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(161 98 7 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.via-\[var\(--onmyoji-bg-secondary\)\]{--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--onmyoji-bg-secondary) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-\[var\(--onmyoji-gold\)\]{--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--onmyoji-gold) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-\[var\(--onmyoji-gold-dark\)\]{--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--onmyoji-gold-dark) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-amber-200{--tw-gradient-to: rgb(253 230 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #fde68a var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-amber-400{--tw-gradient-to: rgb(251 191 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #fbbf24 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-amber-500\/5{--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(245 158 11 / .05) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-amber-500\/50{--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(245 158 11 / .5) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-amber-700{--tw-gradient-to: rgb(180 83 9 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #b45309 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-amber-800\/30{--tw-gradient-to: rgb(146 64 14 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(146 64 14 / .3) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-black{--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #000 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-black\/30{--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(0 0 0 / .3) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-black\/40{--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(0 0 0 / .4) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-blood-600{--tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #dc2626 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-blue-500{--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #3b82f6 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-blue-600{--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #2563eb var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-blue-900\/20{--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(30 58 138 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-cyan-400{--tw-gradient-to: rgb(34 211 238 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #22d3ee var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-cyan-500{--tw-gradient-to: rgb(6 182 212 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #06b6d4 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-cyan-800{--tw-gradient-to: rgb(21 94 117 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #155e75 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-indigo-900\/95{--tw-gradient-to: rgb(49 46 129 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(49 46 129 / .95) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-pink-400{--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #f472b6 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-purple-900\/20{--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(88 28 135 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-red-500{--tw-gradient-to: rgb(239 68 68 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #ef4444 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-red-600{--tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #dc2626 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-700\/50{--tw-gradient-to: rgb(68 64 60 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(68 64 60 / .5) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-800\/50{--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(41 37 36 / .5) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-900{--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #1c1917 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-900\/60{--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(28 25 23 / .6) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-900\/70{--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(28 25 23 / .7) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-900\/80{--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(28 25 23 / .8) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-900\/85{--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(28 25 23 / .85) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-900\/90{--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(28 25 23 / .9) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-900\/95{--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(28 25 23 / .95) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-950{--tw-gradient-to: rgb(12 10 9 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #0c0a09 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-stone-950\/90{--tw-gradient-to: rgb(12 10 9 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(12 10 9 / .9) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-transparent{--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), transparent var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-white\/20{--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(255 255 255 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-white\/30{--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(255 255 255 / .3) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-xianxia-gold-400{--tw-gradient-to: rgb(251 191 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #fbbf24 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-xianxia-gold-500{--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #f59e0b var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-xianxia-gold-500\/10{--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(245 158 11 / .1) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-yellow-500{--tw-gradient-to: rgb(234 179 8 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #eab308 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-yellow-600\/80{--tw-gradient-to: rgb(202 138 4 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(202 138 4 / .8) var(--tw-gradient-via-position), var(--tw-gradient-to)}.to-\[\#050505\]{--tw-gradient-to: #050505 var(--tw-gradient-to-position)}.to-\[\#151515\]{--tw-gradient-to: #151515 var(--tw-gradient-to-position)}.to-\[var\(--onmyoji-bg-primary\)\]{--tw-gradient-to: var(--onmyoji-bg-primary) var(--tw-gradient-to-position)}.to-\[var\(--onmyoji-gold\)\]{--tw-gradient-to: var(--onmyoji-gold) var(--tw-gradient-to-position)}.to-\[var\(--onmyoji-gold-dark\)\]{--tw-gradient-to: var(--onmyoji-gold-dark) var(--tw-gradient-to-position)}.to-\[var\(--onmyoji-red\)\]{--tw-gradient-to: var(--onmyoji-red) var(--tw-gradient-to-position)}.to-amber-200{--tw-gradient-to: #fde68a var(--tw-gradient-to-position)}.to-amber-400{--tw-gradient-to: #fbbf24 var(--tw-gradient-to-position)}.to-amber-500{--tw-gradient-to: #f59e0b var(--tw-gradient-to-position)}.to-amber-500\/0{--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position)}.to-amber-600{--tw-gradient-to: #d97706 var(--tw-gradient-to-position)}.to-amber-700{--tw-gradient-to: #b45309 var(--tw-gradient-to-position)}.to-amber-700\/20{--tw-gradient-to: rgb(180 83 9 / .2) var(--tw-gradient-to-position)}.to-amber-700\/30{--tw-gradient-to: rgb(180 83 9 / .3) var(--tw-gradient-to-position)}.to-amber-700\/40{--tw-gradient-to: rgb(180 83 9 / .4) var(--tw-gradient-to-position)}.to-amber-700\/50{--tw-gradient-to: rgb(180 83 9 / .5) var(--tw-gradient-to-position)}.to-amber-800{--tw-gradient-to: #92400e var(--tw-gradient-to-position)}.to-amber-800\/50{--tw-gradient-to: rgb(146 64 14 / .5) var(--tw-gradient-to-position)}.to-amber-900\/40{--tw-gradient-to: rgb(120 53 15 / .4) var(--tw-gradient-to-position)}.to-amber-900\/80{--tw-gradient-to: rgb(120 53 15 / .8) var(--tw-gradient-to-position)}.to-black{--tw-gradient-to: #000 var(--tw-gradient-to-position)}.to-black\/20{--tw-gradient-to: rgb(0 0 0 / .2) var(--tw-gradient-to-position)}.to-black\/50{--tw-gradient-to: rgb(0 0 0 / .5) var(--tw-gradient-to-position)}.to-black\/60{--tw-gradient-to: rgb(0 0 0 / .6) var(--tw-gradient-to-position)}.to-black\/70{--tw-gradient-to: rgb(0 0 0 / .7) var(--tw-gradient-to-position)}.to-black\/80{--tw-gradient-to: rgb(0 0 0 / .8) var(--tw-gradient-to-position)}.to-black\/90{--tw-gradient-to: rgb(0 0 0 / .9) var(--tw-gradient-to-position)}.to-black\/95{--tw-gradient-to: rgb(0 0 0 / .95) var(--tw-gradient-to-position)}.to-blood-500{--tw-gradient-to: #ef4444 var(--tw-gradient-to-position)}.to-blue-400{--tw-gradient-to: #60a5fa var(--tw-gradient-to-position)}.to-blue-500{--tw-gradient-to: #3b82f6 var(--tw-gradient-to-position)}.to-blue-600{--tw-gradient-to: #2563eb var(--tw-gradient-to-position)}.to-blue-700\/80{--tw-gradient-to: rgb(29 78 216 / .8) var(--tw-gradient-to-position)}.to-blue-800\/50{--tw-gradient-to: rgb(30 64 175 / .5) var(--tw-gradient-to-position)}.to-blue-900{--tw-gradient-to: #1e3a8a var(--tw-gradient-to-position)}.to-blue-900\/50{--tw-gradient-to: rgb(30 58 138 / .5) var(--tw-gradient-to-position)}.to-cyan-600{--tw-gradient-to: #0891b2 var(--tw-gradient-to-position)}.to-cyan-800\/50{--tw-gradient-to: rgb(21 94 117 / .5) var(--tw-gradient-to-position)}.to-emerald-600{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.to-emerald-900\/30{--tw-gradient-to: rgb(6 78 59 / .3) var(--tw-gradient-to-position)}.to-green-400{--tw-gradient-to: #4ade80 var(--tw-gradient-to-position)}.to-green-500{--tw-gradient-to: #22c55e var(--tw-gradient-to-position)}.to-green-700{--tw-gradient-to: #15803d var(--tw-gradient-to-position)}.to-green-800{--tw-gradient-to: #166534 var(--tw-gradient-to-position)}.to-green-800\/50{--tw-gradient-to: rgb(22 101 52 / .5) var(--tw-gradient-to-position)}.to-indigo-600{--tw-gradient-to: #4f46e5 var(--tw-gradient-to-position)}.to-indigo-700{--tw-gradient-to: #4338ca var(--tw-gradient-to-position)}.to-indigo-700\/20{--tw-gradient-to: rgb(67 56 202 / .2) var(--tw-gradient-to-position)}.to-indigo-700\/40{--tw-gradient-to: rgb(67 56 202 / .4) var(--tw-gradient-to-position)}.to-indigo-700\/80{--tw-gradient-to: rgb(67 56 202 / .8) var(--tw-gradient-to-position)}.to-indigo-900\/20{--tw-gradient-to: rgb(49 46 129 / .2) var(--tw-gradient-to-position)}.to-orange-600{--tw-gradient-to: #ea580c var(--tw-gradient-to-position)}.to-orange-700{--tw-gradient-to: #c2410c var(--tw-gradient-to-position)}.to-pink-400{--tw-gradient-to: #f472b6 var(--tw-gradient-to-position)}.to-pink-500{--tw-gradient-to: #ec4899 var(--tw-gradient-to-position)}.to-pink-600{--tw-gradient-to: #db2777 var(--tw-gradient-to-position)}.to-pink-900\/30{--tw-gradient-to: rgb(131 24 67 / .3) var(--tw-gradient-to-position)}.to-pink-900\/95{--tw-gradient-to: rgb(131 24 67 / .95) var(--tw-gradient-to-position)}.to-purple-500\/20{--tw-gradient-to: rgb(168 85 247 / .2) var(--tw-gradient-to-position)}.to-purple-600{--tw-gradient-to: #9333ea var(--tw-gradient-to-position)}.to-purple-700\/20{--tw-gradient-to: rgb(126 34 206 / .2) var(--tw-gradient-to-position)}.to-purple-700\/40{--tw-gradient-to: rgb(126 34 206 / .4) var(--tw-gradient-to-position)}.to-purple-700\/80{--tw-gradient-to: rgb(126 34 206 / .8) var(--tw-gradient-to-position)}.to-purple-800{--tw-gradient-to: #6b21a8 var(--tw-gradient-to-position)}.to-purple-800\/50{--tw-gradient-to: rgb(107 33 168 / .5) var(--tw-gradient-to-position)}.to-purple-900\/20{--tw-gradient-to: rgb(88 28 135 / .2) var(--tw-gradient-to-position)}.to-purple-900\/5{--tw-gradient-to: rgb(88 28 135 / .05) var(--tw-gradient-to-position)}.to-purple-900\/95{--tw-gradient-to: rgb(88 28 135 / .95) var(--tw-gradient-to-position)}.to-red-400{--tw-gradient-to: #f87171 var(--tw-gradient-to-position)}.to-red-500{--tw-gradient-to: #ef4444 var(--tw-gradient-to-position)}.to-red-600{--tw-gradient-to: #dc2626 var(--tw-gradient-to-position)}.to-red-700{--tw-gradient-to: #b91c1c var(--tw-gradient-to-position)}.to-red-700\/80{--tw-gradient-to: rgb(185 28 28 / .8) var(--tw-gradient-to-position)}.to-red-800\/30{--tw-gradient-to: rgb(153 27 27 / .3) var(--tw-gradient-to-position)}.to-red-800\/50{--tw-gradient-to: rgb(153 27 27 / .5) var(--tw-gradient-to-position)}.to-rose-600{--tw-gradient-to: #e11d48 var(--tw-gradient-to-position)}.to-rose-700{--tw-gradient-to: #be123c var(--tw-gradient-to-position)}.to-sky-700{--tw-gradient-to: #0369a1 var(--tw-gradient-to-position)}.to-stone-500{--tw-gradient-to: #78716c var(--tw-gradient-to-position)}.to-stone-800{--tw-gradient-to: #292524 var(--tw-gradient-to-position)}.to-stone-800\/50{--tw-gradient-to: rgb(41 37 36 / .5) var(--tw-gradient-to-position)}.to-stone-800\/90{--tw-gradient-to: rgb(41 37 36 / .9) var(--tw-gradient-to-position)}.to-stone-900{--tw-gradient-to: #1c1917 var(--tw-gradient-to-position)}.to-stone-900\/30{--tw-gradient-to: rgb(28 25 23 / .3) var(--tw-gradient-to-position)}.to-stone-900\/40{--tw-gradient-to: rgb(28 25 23 / .4) var(--tw-gradient-to-position)}.to-stone-900\/50{--tw-gradient-to: rgb(28 25 23 / .5) var(--tw-gradient-to-position)}.to-stone-900\/60{--tw-gradient-to: rgb(28 25 23 / .6) var(--tw-gradient-to-position)}.to-stone-900\/80{--tw-gradient-to: rgb(28 25 23 / .8) var(--tw-gradient-to-position)}.to-stone-900\/90{--tw-gradient-to: rgb(28 25 23 / .9) var(--tw-gradient-to-position)}.to-stone-900\/95{--tw-gradient-to: rgb(28 25 23 / .95) var(--tw-gradient-to-position)}.to-stone-950{--tw-gradient-to: #0c0a09 var(--tw-gradient-to-position)}.to-stone-950\/90{--tw-gradient-to: rgb(12 10 9 / .9) var(--tw-gradient-to-position)}.to-stone-950\/95{--tw-gradient-to: rgb(12 10 9 / .95) var(--tw-gradient-to-position)}.to-teal-600{--tw-gradient-to: #0d9488 var(--tw-gradient-to-position)}.to-transparent{--tw-gradient-to: transparent var(--tw-gradient-to-position)}.to-violet-600{--tw-gradient-to: #7c3aed var(--tw-gradient-to-position)}.to-xianxia-gold-400{--tw-gradient-to: #fbbf24 var(--tw-gradient-to-position)}.to-xianxia-gold-600{--tw-gradient-to: #d97706 var(--tw-gradient-to-position)}.to-xianxia-gold-700{--tw-gradient-to: #b45309 var(--tw-gradient-to-position)}.to-xianxia-gold-700\/80{--tw-gradient-to: rgb(180 83 9 / .8) var(--tw-gradient-to-position)}.to-yellow-400{--tw-gradient-to: #facc15 var(--tw-gradient-to-position)}.to-yellow-500{--tw-gradient-to: #eab308 var(--tw-gradient-to-position)}.bg-clip-text{-webkit-background-clip:text;background-clip:text}.bg-repeat{background-repeat:repeat}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-1{padding:.25rem}.p-1\.5{padding:.375rem}.p-2{padding:.5rem}.p-2\.5{padding:.625rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0{padding-top:0;padding-bottom:0}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.py-10{padding-top:2.5rem;padding-bottom:2.5rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\.5{padding-top:.625rem;padding-bottom:.625rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-3\.5{padding-top:.875rem;padding-bottom:.875rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-1{padding-bottom:.25rem}.pb-2{padding-bottom:.5rem}.pb-24{padding-bottom:6rem}.pb-3{padding-bottom:.75rem}.pb-32{padding-bottom:8rem}.pb-4{padding-bottom:1rem}.pl-10{padding-left:2.5rem}.pl-2{padding-left:.5rem}.pl-4{padding-left:1rem}.pl-\[35vw\]{padding-left:35vw}.pr-10{padding-right:2.5rem}.pr-12{padding-right:3rem}.pr-2{padding-right:.5rem}.pr-4{padding-right:1rem}.pr-6{padding-right:1.5rem}.pr-\[35vw\]{padding-right:35vw}.pt-1{padding-top:.25rem}.pt-10{padding-top:2.5rem}.pt-16{padding-top:4rem}.pt-2{padding-top:.5rem}.pt-3{padding-top:.75rem}.pt-4{padding-top:1rem}.pt-8{padding-top:2rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.font-serif{font-family:"Noto Serif SC",Songti SC,SimSun,Times New Roman,serif}.font-xianxia{font-family:ZCOOL XiaoWei,Ma Shan Zheng,KaiTi,STKaiti,"Noto Serif SC",serif}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-6xl{font-size:3.75rem;line-height:1}.text-7xl{font-size:4.5rem;line-height:1}.text-8xl{font-size:6rem;line-height:1}.text-\[10px\]{font-size:10px}.text-\[8px\]{font-size:8px}.text-\[9px\]{font-size:9px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-none{line-height:1}.leading-relaxed{line-height:1.625}.leading-tight{line-height:1.25}.tracking-\[0\.2em\]{letter-spacing:.2em}.tracking-\[0\.3em\]{letter-spacing:.3em}.tracking-wide{letter-spacing:.025em}.tracking-wider{letter-spacing:.05em}.tracking-widest{letter-spacing:.1em}.text-\[var\(--onmyoji-bg-primary\)\]{color:var(--onmyoji-bg-primary)}.text-\[var\(--onmyoji-ghost\)\]{color:var(--onmyoji-ghost)}.text-\[var\(--onmyoji-gold\)\]{color:var(--onmyoji-gold)}.text-\[var\(--onmyoji-gold-dark\)\]{color:var(--onmyoji-gold-dark)}.text-\[var\(--onmyoji-gold-light\)\]{color:var(--onmyoji-gold-light)}.text-\[var\(--onmyoji-text-primary\)\]{color:var(--onmyoji-text-primary)}.text-\[var\(--onmyoji-text-secondary\)\]{color:var(--onmyoji-text-secondary)}.text-amber-100{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.text-amber-200{--tw-text-opacity: 1;color:rgb(253 230 138 / var(--tw-text-opacity, 1))}.text-amber-200\/60{color:#fde68a99}.text-amber-200\/70{color:#fde68ab3}.text-amber-200\/80{color:#fde68acc}.text-amber-200\/90{color:#fde68ae6}.text-amber-300{--tw-text-opacity: 1;color:rgb(252 211 77 / var(--tw-text-opacity, 1))}.text-amber-300\/50{color:#fcd34d80}.text-amber-300\/60{color:#fcd34d99}.text-amber-300\/70{color:#fcd34db3}.text-amber-300\/80{color:#fcd34dcc}.text-amber-400{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.text-amber-400\/70{color:#fbbf24b3}.text-amber-400\/80{color:#fbbf24cc}.text-amber-400\/90{color:#fbbf24e6}.text-amber-500{--tw-text-opacity: 1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.text-amber-500\/30{color:#f59e0b4d}.text-amber-500\/50{color:#f59e0b80}.text-amber-500\/80{color:#f59e0bcc}.text-amber-500\/90{color:#f59e0be6}.text-amber-700\/50{color:#b4530980}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blood-100{--tw-text-opacity: 1;color:rgb(254 226 226 / var(--tw-text-opacity, 1))}.text-blood-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-300\/70{color:#93c5fdb3}.text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-cyan-100{--tw-text-opacity: 1;color:rgb(207 250 254 / var(--tw-text-opacity, 1))}.text-cyan-300{--tw-text-opacity: 1;color:rgb(103 232 249 / var(--tw-text-opacity, 1))}.text-cyan-400{--tw-text-opacity: 1;color:rgb(34 211 238 / var(--tw-text-opacity, 1))}.text-cyan-500{--tw-text-opacity: 1;color:rgb(6 182 212 / var(--tw-text-opacity, 1))}.text-cyan-500\/80{color:#06b6d4cc}.text-emerald-300{--tw-text-opacity: 1;color:rgb(110 231 183 / var(--tw-text-opacity, 1))}.text-emerald-400{--tw-text-opacity: 1;color:rgb(52 211 153 / var(--tw-text-opacity, 1))}.text-gray-200{--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-400\/70{color:#9ca3afb3}.text-gray-500{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-green-200{--tw-text-opacity: 1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.text-green-300{--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.text-green-400{--tw-text-opacity: 1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-indigo-100{--tw-text-opacity: 1;color:rgb(224 231 255 / var(--tw-text-opacity, 1))}.text-indigo-200{--tw-text-opacity: 1;color:rgb(199 210 254 / var(--tw-text-opacity, 1))}.text-indigo-300{--tw-text-opacity: 1;color:rgb(165 180 252 / var(--tw-text-opacity, 1))}.text-indigo-400{--tw-text-opacity: 1;color:rgb(129 140 248 / var(--tw-text-opacity, 1))}.text-orange-300{--tw-text-opacity: 1;color:rgb(253 186 116 / var(--tw-text-opacity, 1))}.text-orange-400{--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-pink-200{--tw-text-opacity: 1;color:rgb(251 207 232 / var(--tw-text-opacity, 1))}.text-pink-300{--tw-text-opacity: 1;color:rgb(249 168 212 / var(--tw-text-opacity, 1))}.text-pink-400{--tw-text-opacity: 1;color:rgb(244 114 182 / var(--tw-text-opacity, 1))}.text-pink-400\/90{color:#f472b6e6}.text-pink-500{--tw-text-opacity: 1;color:rgb(236 72 153 / var(--tw-text-opacity, 1))}.text-purple-100{--tw-text-opacity: 1;color:rgb(243 232 255 / var(--tw-text-opacity, 1))}.text-purple-200{--tw-text-opacity: 1;color:rgb(233 213 255 / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-red-200{--tw-text-opacity: 1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}.text-red-200\/90{color:#fecacae6}.text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-red-400\/80{color:#f87171cc}.text-red-400\/90{color:#f87171e6}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-500\/70{color:#ef4444b3}.text-red-900\/20{color:#7f1d1d33}.text-rose-300{--tw-text-opacity: 1;color:rgb(253 164 175 / var(--tw-text-opacity, 1))}.text-rose-400{--tw-text-opacity: 1;color:rgb(251 113 133 / var(--tw-text-opacity, 1))}.text-sky-300{--tw-text-opacity: 1;color:rgb(125 211 252 / var(--tw-text-opacity, 1))}.text-sky-400{--tw-text-opacity: 1;color:rgb(56 189 248 / var(--tw-text-opacity, 1))}.text-spiritual-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-stone-100{--tw-text-opacity: 1;color:rgb(245 245 244 / var(--tw-text-opacity, 1))}.text-stone-200{--tw-text-opacity: 1;color:rgb(231 229 228 / var(--tw-text-opacity, 1))}.text-stone-300{--tw-text-opacity: 1;color:rgb(214 211 209 / var(--tw-text-opacity, 1))}.text-stone-400{--tw-text-opacity: 1;color:rgb(168 162 158 / var(--tw-text-opacity, 1))}.text-stone-500{--tw-text-opacity: 1;color:rgb(120 113 108 / var(--tw-text-opacity, 1))}.text-stone-500\/50{color:#78716c80}.text-stone-600{--tw-text-opacity: 1;color:rgb(87 83 78 / var(--tw-text-opacity, 1))}.text-stone-700{--tw-text-opacity: 1;color:rgb(68 64 60 / var(--tw-text-opacity, 1))}.text-stone-800{--tw-text-opacity: 1;color:rgb(41 37 36 / var(--tw-text-opacity, 1))}.text-stone-900{--tw-text-opacity: 1;color:rgb(28 25 23 / var(--tw-text-opacity, 1))}.text-teal-300{--tw-text-opacity: 1;color:rgb(94 234 212 / var(--tw-text-opacity, 1))}.text-teal-400{--tw-text-opacity: 1;color:rgb(45 212 191 / var(--tw-text-opacity, 1))}.text-transparent{color:transparent}.text-violet-300{--tw-text-opacity: 1;color:rgb(196 181 253 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-xianxia-gold-100{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.text-xianxia-gold-300{--tw-text-opacity: 1;color:rgb(252 211 77 / var(--tw-text-opacity, 1))}.text-xianxia-gold-400{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.text-xianxia-gold-500{--tw-text-opacity: 1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.text-xianxia-gold-500\/40{color:#f59e0b66}.text-yellow-100{--tw-text-opacity: 1;color:rgb(254 249 195 / var(--tw-text-opacity, 1))}.text-yellow-300{--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.text-yellow-400{--tw-text-opacity: 1;color:rgb(250 204 21 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity: 1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.line-through{text-decoration-line:line-through}.placeholder-amber-300\/60::-moz-placeholder{color:#fcd34d99}.placeholder-amber-300\/60::placeholder{color:#fcd34d99}.placeholder-gray-400::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(156 163 175 / var(--tw-placeholder-opacity, 1))}.placeholder-gray-400::placeholder{--tw-placeholder-opacity: 1;color:rgb(156 163 175 / var(--tw-placeholder-opacity, 1))}.placeholder-gray-500::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(107 114 128 / var(--tw-placeholder-opacity, 1))}.placeholder-gray-500::placeholder{--tw-placeholder-opacity: 1;color:rgb(107 114 128 / var(--tw-placeholder-opacity, 1))}.placeholder-indigo-400\/50::-moz-placeholder{color:#818cf880}.placeholder-indigo-400\/50::placeholder{color:#818cf880}.placeholder-stone-500::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(120 113 108 / var(--tw-placeholder-opacity, 1))}.placeholder-stone-500::placeholder{--tw-placeholder-opacity: 1;color:rgb(120 113 108 / var(--tw-placeholder-opacity, 1))}.placeholder-stone-600::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(87 83 78 / var(--tw-placeholder-opacity, 1))}.placeholder-stone-600::placeholder{--tw-placeholder-opacity: 1;color:rgb(87 83 78 / var(--tw-placeholder-opacity, 1))}.accent-amber-500{accent-color:#f59e0b}.accent-pink-500{accent-color:#ec4899}.accent-purple-500{accent-color:#a855f7}.accent-red-500{accent-color:#ef4444}.opacity-0{opacity:0}.opacity-10{opacity:.1}.opacity-100{opacity:1}.opacity-20{opacity:.2}.opacity-30{opacity:.3}.opacity-40{opacity:.4}.opacity-5{opacity:.05}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-75{opacity:.75}.opacity-80{opacity:.8}.opacity-90{opacity:.9}.mix-blend-overlay{mix-blend-mode:overlay}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_-5px_20px_rgba\(0\,0\,0\,0\.5\)\]{--tw-shadow: 0 -5px 20px rgba(0,0,0,.5);--tw-shadow-colored: 0 -5px 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_-3px_rgba\(245\,158\,11\,0\.3\)\]{--tw-shadow: 0 0 10px -3px rgba(245,158,11,.3);--tw-shadow-colored: 0 0 10px -3px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(0\,0\,0\,0\.3\)\]{--tw-shadow: 0 0 10px rgba(0,0,0,.3);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(34\,197\,94\,0\.5\)\]{--tw-shadow: 0 0 10px rgba(34,197,94,.5);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(6\,182\,212\,0\.2\)\]{--tw-shadow: 0 0 10px rgba(6,182,212,.2);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_var\(--onmyoji-gold-glow\)\]{--tw-shadow: 0 0 10px var(--onmyoji-gold-glow);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_var\(--onmyoji-red-glow\)\]{--tw-shadow: 0 0 10px var(--onmyoji-red-glow);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_12px_2px_rgba\(168\,85\,247\,0\.5\)\]{--tw-shadow: 0 0 12px 2px rgba(168,85,247,.5);--tw-shadow-colored: 0 0 12px 2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_12px_2px_rgba\(34\,197\,94\,0\.4\)\]{--tw-shadow: 0 0 12px 2px rgba(34,197,94,.4);--tw-shadow-colored: 0 0 12px 2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_12px_2px_rgba\(59\,130\,246\,0\.5\)\]{--tw-shadow: 0 0 12px 2px rgba(59,130,246,.5);--tw-shadow-colored: 0 0 12px 2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_15px_3px_rgba\(251\,191\,36\,0\.6\)\]{--tw-shadow: 0 0 15px 3px rgba(251,191,36,.6);--tw-shadow-colored: 0 0 15px 3px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_15px_rgba\(0\,0\,0\,0\.2\)\]{--tw-shadow: 0 0 15px rgba(0,0,0,.2);--tw-shadow-colored: 0 0 15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_15px_rgba\(0\,0\,0\,0\.3\)\]{--tw-shadow: 0 0 15px rgba(0,0,0,.3);--tw-shadow-colored: 0 0 15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_15px_rgba\(245\,158\,11\,0\.3\)\]{--tw-shadow: 0 0 15px rgba(245,158,11,.3);--tw-shadow-colored: 0 0 15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_15px_var\(--onmyoji-gold-glow\)\]{--tw-shadow: 0 0 15px var(--onmyoji-gold-glow);--tw-shadow-colored: 0 0 15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_18px_4px_rgba\(239\,68\,68\,0\.6\)\]{--tw-shadow: 0 0 18px 4px rgba(239,68,68,.6);--tw-shadow-colored: 0 0 18px 4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_20px_currentColor\]{--tw-shadow: 0 0 20px currentColor;--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_20px_rgba\(56\,189\,248\,0\.4\)\]{--tw-shadow: 0 0 20px rgba(56,189,248,.4);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_22px_5px_rgba\(253\,224\,71\,0\.7\)\]{--tw-shadow: 0 0 22px 5px rgba(253,224,71,.7);--tw-shadow-colored: 0 0 22px 5px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_25px_rgba\(0\,0\,0\,0\.6\)\]{--tw-shadow: 0 0 25px rgba(0,0,0,.6);--tw-shadow-colored: 0 0 25px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_30px_6px_rgba\(236\,72\,153\,0\.7\)\]{--tw-shadow: 0 0 30px 6px rgba(236,72,153,.7);--tw-shadow-colored: 0 0 30px 6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_30px_rgba\(239\,68\,68\,0\.3\)\]{--tw-shadow: 0 0 30px rgba(239,68,68,.3);--tw-shadow-colored: 0 0 30px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_30px_rgba\(245\,158\,11\,0\.4\)\,inset_0_0_20px_rgba\(245\,158\,11\,0\.1\)\]{--tw-shadow: 0 0 30px rgba(245,158,11,.4),inset 0 0 20px rgba(245,158,11,.1);--tw-shadow-colored: 0 0 30px var(--tw-shadow-color), inset 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_30px_rgba\(251\,191\,36\,0\.3\)\]{--tw-shadow: 0 0 30px rgba(251,191,36,.3);--tw-shadow-colored: 0 0 30px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_4px_rgba\(245\,158\,11\,0\.8\)\]{--tw-shadow: 0 0 4px rgba(245,158,11,.8);--tw-shadow-colored: 0 0 4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_4px_var\(--onmyoji-gold-glow\)\]{--tw-shadow: 0 0 4px var(--onmyoji-gold-glow);--tw-shadow-colored: 0 0 4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_50px_rgba\(220\,38\,38\,0\.3\)\]{--tw-shadow: 0 0 50px rgba(220,38,38,.3);--tw-shadow-colored: 0 0 50px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_6px_var\(--onmyoji-purple-glow\)\]{--tw-shadow: 0 0 6px var(--onmyoji-purple-glow);--tw-shadow-colored: 0 0 6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(245\,158\,11\,0\.8\)\]{--tw-shadow: 0 0 8px rgba(245,158,11,.8);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_var\(--onmyoji-ghost-glow\)\]{--tw-shadow: 0 0 8px var(--onmyoji-ghost-glow);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_var\(--onmyoji-gold-glow\)\]{--tw-shadow: 0 0 8px var(--onmyoji-gold-glow);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[inset_0_0_10px_rgba\(251\,191\,36\,0\.1\)\]{--tw-shadow: inset 0 0 10px rgba(251,191,36,.1);--tw-shadow-colored: inset 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[inset_0_0_10px_rgba\(251\,191\,36\,0\.2\)\]{--tw-shadow: inset 0 0 10px rgba(251,191,36,.2);--tw-shadow-colored: inset 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-glow-blue{--tw-shadow: 0 0 20px rgba(37, 99, 235, .5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-glow-gold{--tw-shadow: 0 0 20px rgba(252, 211, 77, .5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-glow-gold-lg{--tw-shadow: 0 0 40px rgba(252, 211, 77, .8);--tw-shadow-colored: 0 0 40px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-glow-purple{--tw-shadow: 0 0 20px rgba(147, 51, 234, .5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-glow-red{--tw-shadow: 0 0 20px rgba(220, 38, 38, .5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-onmyoji{--tw-shadow: 0 4px 20px rgba(0, 0, 0, .5), 0 0 40px rgba(212, 168, 83, .1);--tw-shadow-colored: 0 4px 20px var(--tw-shadow-color), 0 0 40px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-amber-500\/20{--tw-shadow-color: rgb(245 158 11 / .2);--tw-shadow: var(--tw-shadow-colored)}.shadow-amber-500\/50{--tw-shadow-color: rgb(245 158 11 / .5);--tw-shadow: var(--tw-shadow-colored)}.shadow-amber-600\/30{--tw-shadow-color: rgb(217 119 6 / .3);--tw-shadow: var(--tw-shadow-colored)}.shadow-amber-900\/30{--tw-shadow-color: rgb(120 53 15 / .3);--tw-shadow: var(--tw-shadow-colored)}.shadow-amber-900\/50{--tw-shadow-color: rgb(120 53 15 / .5);--tw-shadow: var(--tw-shadow-colored)}.shadow-black{--tw-shadow-color: #000;--tw-shadow: var(--tw-shadow-colored)}.shadow-black\/50{--tw-shadow-color: rgb(0 0 0 / .5);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-900\/50{--tw-shadow-color: rgb(30 58 138 / .5);--tw-shadow: var(--tw-shadow-colored)}.shadow-pink-900\/50{--tw-shadow-color: rgb(131 24 67 / .5);--tw-shadow: var(--tw-shadow-colored)}.shadow-red-500\/50{--tw-shadow-color: rgb(239 68 68 / .5);--tw-shadow: var(--tw-shadow-colored)}.shadow-red-900\/10{--tw-shadow-color: rgb(127 29 29 / .1);--tw-shadow: var(--tw-shadow-colored)}.shadow-red-900\/50{--tw-shadow-color: rgb(127 29 29 / .5);--tw-shadow: var(--tw-shadow-colored)}.shadow-xianxia-gold-500\/10{--tw-shadow-color: rgb(245 158 11 / .1);--tw-shadow: var(--tw-shadow-colored)}.outline{outline-style:solid}.ring-1{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-4{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-amber-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(245 158 11 / var(--tw-ring-opacity, 1))}.ring-amber-500\/50{--tw-ring-color: rgb(245 158 11 / .5)}.ring-green-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(34 197 94 / var(--tw-ring-opacity, 1))}.ring-white\/5{--tw-ring-color: rgb(255 255 255 / .05)}.ring-xianxia-gold-400{--tw-ring-opacity: 1;--tw-ring-color: rgb(251 191 36 / var(--tw-ring-opacity, 1))}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-2xl{--tw-blur: blur(40px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-3xl{--tw-blur: blur(64px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-\[100px\]{--tw-blur: blur(100px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-md{--tw-blur: blur(12px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-sm{--tw-blur: blur(4px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-xl{--tw-blur: blur(24px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow{--tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / .1)) drop-shadow(0 1px 1px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_10px_rgba\(251\,191\,36\,0\.5\)\]{--tw-drop-shadow: drop-shadow(0 0 10px rgba(251,191,36,.5));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_10px_var\(--onmyoji-gold-glow\)\]{--tw-drop-shadow: drop-shadow(0 0 10px var(--onmyoji-gold-glow));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_15px_rgba\(252\,211\,77\,0\.7\)\]{--tw-drop-shadow: drop-shadow(0 0 15px rgba(252,211,77,.7));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_15px_rgba\(56\,189\,248\,0\.7\)\]{--tw-drop-shadow: drop-shadow(0 0 15px rgba(56,189,248,.7));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_15px_rgba\(74\,222\,128\,0\.7\)\]{--tw-drop-shadow: drop-shadow(0 0 15px rgba(74,222,128,.7));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_15px_var\(--onmyoji-gold-glow\)\]{--tw-drop-shadow: drop-shadow(0 0 15px var(--onmyoji-gold-glow));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_3px_rgba\(251\,191\,36\,0\.5\)\]{--tw-drop-shadow: drop-shadow(0 0 3px rgba(251,191,36,.5));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_4px_rgba\(251\,191\,36\,0\.5\)\]{--tw-drop-shadow: drop-shadow(0 0 4px rgba(251,191,36,.5));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_4px_var\(--onmyoji-ghost-glow\)\]{--tw-drop-shadow: drop-shadow(0 0 4px var(--onmyoji-ghost-glow));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_6px_currentColor\]{--tw-drop-shadow: drop-shadow(0 0 6px currentColor);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_6px_rgba\(251\,191\,36\,0\.5\)\]{--tw-drop-shadow: drop-shadow(0 0 6px rgba(251,191,36,.5));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_6px_rgba\(251\,191\,36\,0\.6\)\]{--tw-drop-shadow: drop-shadow(0 0 6px rgba(251,191,36,.6));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_6px_var\(--onmyoji-gold-glow\)\]{--tw-drop-shadow: drop-shadow(0 0 6px var(--onmyoji-gold-glow));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_8px_currentColor\]{--tw-drop-shadow: drop-shadow(0 0 8px currentColor);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_8px_rgba\(245\,158\,11\,0\.8\)\]{--tw-drop-shadow: drop-shadow(0 0 8px rgba(245,158,11,.8));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_0_8px_var\(--onmyoji-gold-glow\)\]{--tw-drop-shadow: drop-shadow(0 0 8px var(--onmyoji-gold-glow));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-\[0_2px_2px_rgba\(0\,0\,0\,0\.8\)\]{--tw-drop-shadow: drop-shadow(0 2px 2px rgba(0,0,0,.8));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-lg{--tw-drop-shadow: drop-shadow(0 10px 8px rgb(0 0 0 / .04)) drop-shadow(0 4px 3px rgb(0 0 0 / .1));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-sm{--tw-drop-shadow: drop-shadow(0 1px 1px rgb(0 0 0 / .05));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.grayscale{--tw-grayscale: grayscale(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur{--tw-backdrop-blur: blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-lg{--tw-backdrop-blur: blur(16px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-xl{--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-filter{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.delay-100{transition-delay:.1s}.duration-1000{transition-duration:1s}.duration-150{transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.duration-700{transition-duration:.7s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}.scrollbar-xianxia::-webkit-scrollbar{width:8px;height:8px}.scrollbar-xianxia::-webkit-scrollbar-track{background:#29252480;border-radius:4px}.scrollbar-xianxia::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#fcd34d99,#f59e0b99);border-radius:4px;border:2px solid rgba(41,37,36,.5)}.scrollbar-xianxia::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#fcd34dcc,#f59e0bcc)}.scrollbar-onmyoji::-webkit-scrollbar{width:6px;height:6px}.scrollbar-onmyoji::-webkit-scrollbar-track{background:#0a0a0f80;border-radius:3px}.scrollbar-onmyoji::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#d4a85366,#b8942e66);border-radius:3px}.scrollbar-onmyoji::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#d4a85399,#b8942e99)}.text-shadow-glow{text-shadow:0 0 10px rgba(252,211,77,.5),0 0 20px rgba(252,211,77,.3)}.text-shadow-strong{text-shadow:0 2px 4px rgba(0,0,0,.5)}.text-shadow-onmyoji{text-shadow:0 0 10px rgba(212,168,83,.5),0 0 20px rgba(212,168,83,.2)}.border-onmyoji{border-color:#d4a8534d}.bg-onmyoji-gradient{background:linear-gradient(135deg,#0a0a0f,#12121a,#1a1a25)}.\[backface-visibility\:hidden\]{backface-visibility:hidden}.\[perspective\:1000px\]{perspective:1000px}.\[transform-style\:preserve-3d\]{transform-style:preserve-3d}.\[transform\:rotateY\(180deg\)\]{transform:rotateY(180deg)}:root{--primary-gold: #fcd34d;--primary-gold-light: #fde68a;--primary-gold-dark: #f59e0b;--bg-primary: #1c1917;--bg-secondary: #292524;--bg-overlay: rgba(0, 0, 0, .8);--accent-red: #dc2626;--accent-blue: #2563eb;--accent-purple: #9333ea;--accent-green: #10b981;--accent-pink: #ec4899;--accent-cyan: #06b6d4;--rarity-common: #9ca3af;--rarity-uncommon: #10b981;--rarity-rare: #3b82f6;--rarity-epic: #a855f7;--rarity-legendary: #f59e0b;--rarity-mythic: #ec4899;--rarity-divine: #8b5cf6;--glow-gold: 0 0 20px rgba(252, 211, 77, .4);--glow-red: 0 0 20px rgba(220, 38, 38, .4);--glow-blue: 0 0 20px rgba(37, 99, 235, .4);--glow-purple: 0 0 20px rgba(147, 51, 234, .4);--transition-fast: .2s ease-in-out;--transition-normal: .3s ease-in-out;--transition-slow: .5s ease-in-out}.ornate-border{position:relative;border:2px solid rgba(252,211,77,.6)!important;box-shadow:0 0 30px #fcd34d33,inset 0 0 20px #fcd34d1a!important}.ornate-border:before{content:"";position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;border-radius:inherit;padding:2px;background:linear-gradient(135deg,#fcd34dcc,#dc262680,#9333ea99,#fcd34dcc)!important;-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask-composite:exclude;pointer-events:none;animation:rotateBorder 8s linear infinite}@keyframes rotateBorder{0%,to{filter:hue-rotate(0deg)}50%{filter:hue-rotate(60deg)}}.ornate-border-dialog{border:2px solid rgba(252,211,77,.2);box-shadow:0 10px 50px #00000080,inset 0 0 30px #fcd34d0d}.card-3d-hover{transition:transform .3s ease,box-shadow .3s ease;transform-style:preserve-3d}.card-3d-hover:hover{transform:translateY(-8px) rotateX(5deg) rotateY(5deg) scale(1.02);box-shadow:0 20px 40px #0006,0 0 30px #fcd34d33}.card-legendary-glow{position:relative;animation:legendaryPulse 2s ease-in-out infinite}.card-legendary-glow:before{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;border-radius:inherit;background:linear-gradient(45deg,#f59e0b,#fbbf24,#f59e0b);opacity:.6;filter:blur(8px);z-index:-1;animation:rotateGradient 3s linear infinite}@keyframes legendaryPulse{0%,to{box-shadow:0 0 20px #f59e0b99}50%{box-shadow:0 0 40px #f59e0be6}}@keyframes rotateGradient{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.card-shine{position:relative;overflow:hidden}.card-shine:after{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent 30%,rgba(255,255,255,.3) 50%,transparent 70%);transform:translate(-100%);transition:transform .8s}.card-shine:hover:after{transform:translate(100%)}.btn-primary-enhanced{position:relative;background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff;font-weight:700;padding:.75rem 1.5rem;border-radius:.5rem;border:2px solid rgba(252,211,77,.5);box-shadow:0 4px 15px #f59e0b4d,inset 0 1px #fff3;transition:all .3s ease;overflow:hidden;cursor:pointer}.btn-primary-enhanced:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background:linear-gradient(135deg,transparent 0%,rgba(255,255,255,.2) 100%);transform:translateY(-100%);transition:transform .3s}.btn-primary-enhanced:hover:before{transform:translateY(0)}.btn-primary-enhanced:hover{transform:translateY(-2px);box-shadow:0 8px 25px #f59e0b80,inset 0 1px #ffffff4d}.btn-primary-enhanced:active{transform:translateY(0)}.hp-bar-enhanced{position:relative;height:12px;background:#1c1917cc;border-radius:999px;overflow:hidden;box-shadow:inset 0 2px 4px #00000080}.hp-bar-fill-enhanced{height:100%;background:linear-gradient(90deg,#dc2626,#ef4444,#f87171);border-radius:999px;box-shadow:0 0 10px #dc262680,inset 0 1px #ffffff4d;transition:width .5s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.hp-bar-fill-enhanced:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.3) 50%,transparent 100%);animation:shimmer 2s infinite}@keyframes shimmer{0%{transform:translate(-100%)}to{transform:translate(200%)}}@keyframes modalSlideIn{0%{opacity:0;transform:translateY(-50px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-slide-in{animation:modalSlideIn .4s cubic-bezier(.16,1,.3,1)}.scrollbar-enhanced::-webkit-scrollbar{width:8px;height:8px}.scrollbar-enhanced::-webkit-scrollbar-track{background:#29252480;border-radius:4px}.scrollbar-enhanced::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#fcd34d99,#f59e0b99);border-radius:4px;border:2px solid rgba(41,37,36,.5)}.scrollbar-enhanced::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#fcd34dcc,#f59e0bcc)}.custom-scrollbar::-webkit-scrollbar{width:12px}.custom-scrollbar::-webkit-scrollbar-track{background:linear-gradient(to right,#1c191780,#29252480,#1c191780);border-radius:6px;border:1px solid rgba(120,113,108,.2)}.custom-scrollbar::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#fbbf24b3,#f59e0bcc,#d97706b3);border-radius:6px;border:2px solid rgba(28,25,23,.8);box-shadow:0 0 10px #fbbf244d,inset 0 1px #fff3;-webkit-transition:all .3s ease;transition:all .3s ease}.custom-scrollbar::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#fbbf24e6,#f59e0b,#d97706e6);box-shadow:0 0 15px #fbbf2480,inset 0 1px #ffffff4d}.custom-scrollbar::-webkit-scrollbar-thumb:active{background:linear-gradient(180deg,#d97706e6,#f59e0b,#fbbf24e6)}@keyframes pulsGlow{0%,to{box-shadow:0 0 10px #fcd34d80}50%{box-shadow:0 0 30px #fcd34dcc}}.animate-pulse-glow{animation:pulseGlow 2s ease-in-out infinite}@keyframes float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.animate-float{animation:float 3s ease-in-out infinite}@keyframes fadeIn{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}.animate-fade-in{animation:fadeIn .3s cubic-bezier(.16,1,.3,1) forwards}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin-slow{animation:spin 3s linear infinite}.glass-morphism{background:#1c1917b3;-webkit-backdrop-filter:blur(10px) saturate(150%);backdrop-filter:blur(10px) saturate(150%);border:1px solid rgba(252,211,77,.1)}.glass-morphism-light{background:#29252480;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.particle-bg{position:fixed;top:0;right:0;bottom:0;left:0;background:radial-gradient(2px 2px at 20% 30%,white,transparent),radial-gradient(2px 2px at 60% 70%,white,transparent),radial-gradient(1px 1px at 50% 50%,white,transparent),radial-gradient(1px 1px at 80% 10%,white,transparent),radial-gradient(2px 2px at 90% 60%,white,transparent),radial-gradient(1px 1px at 33% 80%,white,transparent);background-size:200% 200%;animation:starTwinkle 4s ease-in-out infinite;pointer-events:none;opacity:.3}@keyframes starTwinkle{0%,to{opacity:.2}50%{opacity:.4}}.text-gradient-gold{background:linear-gradient(180deg,#fffbeb,#fbbf24 40%,#d97706)!important;-webkit-background-clip:text!important;background-clip:text!important;color:transparent!important;-webkit-text-fill-color:transparent!important;font-weight:800!important;filter:drop-shadow(0 2px 4px rgba(0,0,0,.8))}.text-gold-solid{color:#fbbf24!important;text-shadow:0 2px 4px rgba(0,0,0,.9);font-weight:700}.text-glow{text-shadow:0 0 10px rgba(252,211,77,.5),0 0 20px rgba(252,211,77,.3),0 0 30px rgba(252,211,77,.1)}.text-stroke{-webkit-text-stroke:1px rgba(0,0,0,.5);paint-order:stroke fill}.center-container{display:flex;align-items:center;justify-content:center}.full-cover{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9999}.no-select{-moz-user-select:none;user-select:none;-webkit-user-select:none}.gpu-accelerated{transform:translateZ(0);will-change:transform}.selection\:bg-amber-900\/50 *::-moz-selection{background-color:#78350f80}.selection\:bg-amber-900\/50 *::selection{background-color:#78350f80}.selection\:text-amber-100 *::-moz-selection{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.selection\:text-amber-100 *::selection{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.selection\:bg-amber-900\/50::-moz-selection{background-color:#78350f80}.selection\:bg-amber-900\/50::selection{background-color:#78350f80}.selection\:text-amber-100::-moz-selection{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.selection\:text-amber-100::selection{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.last\:mb-0:last-child{margin-bottom:0}.last\:border-0:last-child{border-width:0px}.last\:border-r-0:last-child{border-right-width:0px}.hover\:-translate-y-0\.5:hover{--tw-translate-y: -.125rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:-translate-y-1:hover{--tw-translate-y: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:-translate-y-4:hover{--tw-translate-y: -1rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:rotate-0:hover{--tw-rotate: 0deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:rotate-3:hover{--tw-rotate: 3deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:rotate-90:hover{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-105:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-110:hover{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-125:hover{--tw-scale-x: 1.25;--tw-scale-y: 1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-\[1\.02\]:hover{--tw-scale-x: 1.02;--tw-scale-y: 1.02;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-\[var\(--onmyoji-gold-dark\)\]:hover{border-color:var(--onmyoji-gold-dark)}.hover\:border-amber-300:hover{--tw-border-opacity: 1;border-color:rgb(252 211 77 / var(--tw-border-opacity, 1))}.hover\:border-amber-400\/50:hover{border-color:#fbbf2480}.hover\:border-amber-400\/60:hover{border-color:#fbbf2499}.hover\:border-amber-500:hover{--tw-border-opacity: 1;border-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.hover\:border-amber-500\/30:hover{border-color:#f59e0b4d}.hover\:border-amber-500\/50:hover{border-color:#f59e0b80}.hover\:border-amber-500\/60:hover{border-color:#f59e0b99}.hover\:border-amber-700\/50:hover{border-color:#b4530980}.hover\:border-amber-700\/70:hover{border-color:#b45309b3}.hover\:border-blood-400:hover{--tw-border-opacity: 1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.hover\:border-blue-300:hover{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.hover\:border-blue-500\/50:hover{border-color:#3b82f680}.hover\:border-blue-500\/60:hover{border-color:#3b82f699}.hover\:border-blue-600:hover{--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.hover\:border-blue-700\/50:hover{border-color:#1d4ed880}.hover\:border-cyan-500\/50:hover{border-color:#06b6d480}.hover\:border-cyan-500\/60:hover{border-color:#06b6d499}.hover\:border-cyan-700\/50:hover{border-color:#0e749080}.hover\:border-green-500\/60:hover{border-color:#22c55e99}.hover\:border-green-600:hover{--tw-border-opacity: 1;border-color:rgb(22 163 74 / var(--tw-border-opacity, 1))}.hover\:border-green-700\/50:hover{border-color:#15803d80}.hover\:border-indigo-400\/60:hover{border-color:#818cf899}.hover\:border-orange-500\/60:hover{border-color:#f9731699}.hover\:border-pink-500\/30:hover{border-color:#ec48994d}.hover\:border-pink-500\/50:hover{border-color:#ec489980}.hover\:border-purple-500\/50:hover{border-color:#a855f780}.hover\:border-purple-500\/60:hover{border-color:#a855f799}.hover\:border-purple-600:hover{--tw-border-opacity: 1;border-color:rgb(147 51 234 / var(--tw-border-opacity, 1))}.hover\:border-purple-600\/50:hover{border-color:#9333ea80}.hover\:border-red-500:hover{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.hover\:border-red-500\/30:hover{border-color:#ef44444d}.hover\:border-red-500\/50:hover{border-color:#ef444480}.hover\:border-red-500\/60:hover{border-color:#ef444499}.hover\:border-red-600:hover{--tw-border-opacity: 1;border-color:rgb(220 38 38 / var(--tw-border-opacity, 1))}.hover\:border-stone-400:hover{--tw-border-opacity: 1;border-color:rgb(168 162 158 / var(--tw-border-opacity, 1))}.hover\:border-stone-500:hover{--tw-border-opacity: 1;border-color:rgb(120 113 108 / var(--tw-border-opacity, 1))}.hover\:border-stone-600:hover{--tw-border-opacity: 1;border-color:rgb(87 83 78 / var(--tw-border-opacity, 1))}.hover\:border-stone-600\/50:hover{border-color:#57534e80}.hover\:border-xianxia-gold-400:hover{--tw-border-opacity: 1;border-color:rgb(251 191 36 / var(--tw-border-opacity, 1))}.hover\:border-xianxia-gold-500:hover{--tw-border-opacity: 1;border-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.hover\:border-xianxia-gold-500\/50:hover{border-color:#f59e0b80}.hover\:border-xianxia-gold-500\/60:hover{border-color:#f59e0b99}.hover\:border-l-amber-500:hover{--tw-border-opacity: 1;border-left-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.hover\:border-opacity-100:hover{--tw-border-opacity: 1}.hover\:bg-\[var\(--onmyoji-bg-tertiary\)\]:hover{background-color:var(--onmyoji-bg-tertiary)}.hover\:bg-amber-500:hover{--tw-bg-opacity: 1;background-color:rgb(245 158 11 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-500\/10:hover{background-color:#f59e0b1a}.hover\:bg-amber-500\/80:hover{background-color:#f59e0bcc}.hover\:bg-amber-600:hover{--tw-bg-opacity: 1;background-color:rgb(217 119 6 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-600\/30:hover{background-color:#d977064d}.hover\:bg-amber-600\/50:hover{background-color:#d9770680}.hover\:bg-amber-900\/20:hover{background-color:#78350f33}.hover\:bg-amber-900\/30:hover{background-color:#78350f4d}.hover\:bg-amber-900\/50:hover{background-color:#78350f80}.hover\:bg-black\/50:hover{background-color:#00000080}.hover\:bg-black\/80:hover{background-color:#000c}.hover\:bg-blood-500\/50:hover{background-color:#ef444480}.hover\:bg-blue-500\/40:hover{background-color:#3b82f666}.hover\:bg-blue-500\/80:hover{background-color:#3b82f6cc}.hover\:bg-blue-500\/90:hover{background-color:#3b82f6e6}.hover\:bg-blue-600:hover{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-600\/50:hover{background-color:#2563eb80}.hover\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-900\/30:hover{background-color:#1e3a8a4d}.hover\:bg-cyan-500\/40:hover{background-color:#06b6d466}.hover\:bg-cyan-500\/80:hover{background-color:#06b6d4cc}.hover\:bg-cyan-600\/40:hover{background-color:#0891b266}.hover\:bg-cyan-800\/40:hover{background-color:#155e7566}.hover\:bg-gray-500\/80:hover{background-color:#6b7280cc}.hover\:bg-gray-600:hover{--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700:hover{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\:bg-green-500:hover{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\:bg-green-500\/40:hover{background-color:#22c55e66}.hover\:bg-green-500\/80:hover{background-color:#22c55ecc}.hover\:bg-green-600:hover{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.hover\:bg-green-600\/50:hover{background-color:#16a34a80}.hover\:bg-green-700:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-green-900\/30:hover{background-color:#14532d4d}.hover\:bg-indigo-700:hover{--tw-bg-opacity: 1;background-color:rgb(67 56 202 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-500\/40:hover{background-color:#f9731666}.hover\:bg-pink-500:hover{--tw-bg-opacity: 1;background-color:rgb(236 72 153 / var(--tw-bg-opacity, 1))}.hover\:bg-pink-500\/40:hover{background-color:#ec489966}.hover\:bg-pink-600\/30:hover{background-color:#db27774d}.hover\:bg-purple-500\/40:hover{background-color:#a855f766}.hover\:bg-purple-500\/80:hover{background-color:#a855f7cc}.hover\:bg-purple-600:hover{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-600\/50:hover{background-color:#9333ea80}.hover\:bg-purple-600\/80:hover{background-color:#9333eacc}.hover\:bg-purple-700:hover{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700\/50:hover{background-color:#7e22ce80}.hover\:bg-purple-900\/30:hover{background-color:#581c874d}.hover\:bg-purple-900\/50:hover{background-color:#581c8780}.hover\:bg-red-500:hover{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500\/20:hover{background-color:#ef444433}.hover\:bg-red-500\/80:hover{background-color:#ef4444cc}.hover\:bg-red-600:hover{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:bg-red-600\/50:hover{background-color:#dc262680}.hover\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\:bg-red-800\/40:hover{background-color:#991b1b66}.hover\:bg-red-800\/50:hover{background-color:#991b1b80}.hover\:bg-red-900\/20:hover{background-color:#7f1d1d33}.hover\:bg-red-900\/30:hover{background-color:#7f1d1d4d}.hover\:bg-red-900\/40:hover{background-color:#7f1d1d66}.hover\:bg-red-900\/50:hover{background-color:#7f1d1d80}.hover\:bg-sky-500:hover{--tw-bg-opacity: 1;background-color:rgb(14 165 233 / var(--tw-bg-opacity, 1))}.hover\:bg-sky-600:hover{--tw-bg-opacity: 1;background-color:rgb(2 132 199 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-500:hover{--tw-bg-opacity: 1;background-color:rgb(100 116 139 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-700\/80:hover{background-color:#334155cc}.hover\:bg-slate-800\/40:hover{background-color:#1e293b66}.hover\:bg-slate-800\/60:hover{background-color:#1e293b99}.hover\:bg-slate-800\/90:hover{background-color:#1e293be6}.hover\:bg-stone-500:hover{--tw-bg-opacity: 1;background-color:rgb(120 113 108 / var(--tw-bg-opacity, 1))}.hover\:bg-stone-600:hover{--tw-bg-opacity: 1;background-color:rgb(87 83 78 / var(--tw-bg-opacity, 1))}.hover\:bg-stone-600\/30:hover{background-color:#57534e4d}.hover\:bg-stone-600\/50:hover{background-color:#57534e80}.hover\:bg-stone-600\/70:hover{background-color:#57534eb3}.hover\:bg-stone-600\/80:hover{background-color:#57534ecc}.hover\:bg-stone-700:hover{--tw-bg-opacity: 1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.hover\:bg-stone-700\/50:hover{background-color:#44403c80}.hover\:bg-stone-700\/60:hover{background-color:#44403c99}.hover\:bg-stone-700\/70:hover{background-color:#44403cb3}.hover\:bg-stone-700\/80:hover{background-color:#44403ccc}.hover\:bg-stone-700\/90:hover{background-color:#44403ce6}.hover\:bg-stone-800:hover{--tw-bg-opacity: 1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.hover\:bg-stone-800\/50:hover{background-color:#29252480}.hover\:bg-stone-800\/60:hover{background-color:#29252499}.hover\:bg-stone-900\/50:hover{background-color:#1c191780}.hover\:bg-white\/5:hover{background-color:#ffffff0d}.hover\:bg-xianxia-gold-500\/50:hover{background-color:#f59e0b80}.hover\:bg-yellow-400\/80:hover{background-color:#facc15cc}.hover\:bg-yellow-500\/40:hover{background-color:#eab30866}.hover\:bg-yellow-600\/50:hover{background-color:#ca8a0480}.hover\:bg-yellow-800\/50:hover{background-color:#854d0e80}.hover\:bg-yellow-900\/40:hover{background-color:#713f1266}.hover\:bg-gradient-to-br:hover{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.hover\:bg-gradient-to-r:hover{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.hover\:from-amber-500:hover{--tw-gradient-from: #f59e0b var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-amber-600:hover{--tw-gradient-from: #d97706 var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-amber-900\/30:hover{--tw-gradient-from: rgb(120 53 15 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-amber-900\/50:hover{--tw-gradient-from: rgb(120 53 15 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-blue-500:hover{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-blue-500\/90:hover{--tw-gradient-from: rgb(59 130 246 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-cyan-800\/50:hover{--tw-gradient-from: rgb(21 94 117 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(21 94 117 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-green-500:hover{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-indigo-500:hover{--tw-gradient-from: #6366f1 var(--tw-gradient-from-position);--tw-gradient-to: rgb(99 102 241 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-indigo-500\/90:hover{--tw-gradient-from: rgb(99 102 241 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(99 102 241 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-pink-500:hover{--tw-gradient-from: #ec4899 var(--tw-gradient-from-position);--tw-gradient-to: rgb(236 72 153 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-purple-500:hover{--tw-gradient-from: #a855f7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-purple-500\/90:hover{--tw-gradient-from: rgb(168 85 247 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-purple-600:hover{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-red-500:hover{--tw-gradient-from: #ef4444 var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 68 68 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-red-500\/90:hover{--tw-gradient-from: rgb(239 68 68 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 68 68 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-red-600:hover{--tw-gradient-from: #dc2626 var(--tw-gradient-from-position);--tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-sky-500:hover{--tw-gradient-from: #0ea5e9 var(--tw-gradient-from-position);--tw-gradient-to: rgb(14 165 233 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-stone-600:hover{--tw-gradient-from: #57534e var(--tw-gradient-from-position);--tw-gradient-to: rgb(87 83 78 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-stone-700\/90:hover{--tw-gradient-from: rgb(68 64 60 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(68 64 60 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-stone-800\/90:hover{--tw-gradient-from: rgb(41 37 36 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(41 37 36 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-xianxia-gold-500:hover{--tw-gradient-from: #f59e0b var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-xianxia-gold-500\/90:hover{--tw-gradient-from: rgb(245 158 11 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:via-amber-600:hover{--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #d97706 var(--tw-gradient-via-position), var(--tw-gradient-to)}.hover\:via-amber-800\/20:hover{--tw-gradient-to: rgb(146 64 14 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(146 64 14 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.hover\:to-amber-400:hover{--tw-gradient-to: #fbbf24 var(--tw-gradient-to-position)}.hover\:to-amber-500:hover{--tw-gradient-to: #f59e0b var(--tw-gradient-to-position)}.hover\:to-amber-600:hover{--tw-gradient-to: #d97706 var(--tw-gradient-to-position)}.hover\:to-amber-700:hover{--tw-gradient-to: #b45309 var(--tw-gradient-to-position)}.hover\:to-amber-700\/50:hover{--tw-gradient-to: rgb(180 83 9 / .5) var(--tw-gradient-to-position)}.hover\:to-amber-900\/30:hover{--tw-gradient-to: rgb(120 53 15 / .3) var(--tw-gradient-to-position)}.hover\:to-blue-600\/90:hover{--tw-gradient-to: rgb(37 99 235 / .9) var(--tw-gradient-to-position)}.hover\:to-blue-800\/50:hover{--tw-gradient-to: rgb(30 64 175 / .5) var(--tw-gradient-to-position)}.hover\:to-cyan-500:hover{--tw-gradient-to: #06b6d4 var(--tw-gradient-to-position)}.hover\:to-emerald-500:hover{--tw-gradient-to: #10b981 var(--tw-gradient-to-position)}.hover\:to-green-600:hover{--tw-gradient-to: #16a34a var(--tw-gradient-to-position)}.hover\:to-indigo-500:hover{--tw-gradient-to: #6366f1 var(--tw-gradient-to-position)}.hover\:to-indigo-600:hover{--tw-gradient-to: #4f46e5 var(--tw-gradient-to-position)}.hover\:to-indigo-600\/90:hover{--tw-gradient-to: rgb(79 70 229 / .9) var(--tw-gradient-to-position)}.hover\:to-orange-500:hover{--tw-gradient-to: #f97316 var(--tw-gradient-to-position)}.hover\:to-pink-500:hover{--tw-gradient-to: #ec4899 var(--tw-gradient-to-position)}.hover\:to-purple-500:hover{--tw-gradient-to: #a855f7 var(--tw-gradient-to-position)}.hover\:to-purple-600\/90:hover{--tw-gradient-to: rgb(147 51 234 / .9) var(--tw-gradient-to-position)}.hover\:to-purple-700:hover{--tw-gradient-to: #7e22ce var(--tw-gradient-to-position)}.hover\:to-red-500:hover{--tw-gradient-to: #ef4444 var(--tw-gradient-to-position)}.hover\:to-red-600:hover{--tw-gradient-to: #dc2626 var(--tw-gradient-to-position)}.hover\:to-red-600\/90:hover{--tw-gradient-to: rgb(220 38 38 / .9) var(--tw-gradient-to-position)}.hover\:to-rose-500:hover{--tw-gradient-to: #f43f5e var(--tw-gradient-to-position)}.hover\:to-sky-600:hover{--tw-gradient-to: #0284c7 var(--tw-gradient-to-position)}.hover\:to-stone-700:hover{--tw-gradient-to: #44403c var(--tw-gradient-to-position)}.hover\:to-stone-800\/90:hover{--tw-gradient-to: rgb(41 37 36 / .9) var(--tw-gradient-to-position)}.hover\:to-stone-900\/90:hover{--tw-gradient-to: rgb(28 25 23 / .9) var(--tw-gradient-to-position)}.hover\:to-violet-500:hover{--tw-gradient-to: #8b5cf6 var(--tw-gradient-to-position)}.hover\:to-xianxia-gold-600:hover{--tw-gradient-to: #d97706 var(--tw-gradient-to-position)}.hover\:to-xianxia-gold-600\/90:hover{--tw-gradient-to: rgb(217 119 6 / .9) var(--tw-gradient-to-position)}.hover\:to-yellow-400:hover{--tw-gradient-to: #facc15 var(--tw-gradient-to-position)}.hover\:text-amber-100:hover{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.hover\:text-amber-200:hover{--tw-text-opacity: 1;color:rgb(253 230 138 / var(--tw-text-opacity, 1))}.hover\:text-amber-300:hover{--tw-text-opacity: 1;color:rgb(252 211 77 / var(--tw-text-opacity, 1))}.hover\:text-amber-400:hover{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.hover\:text-amber-500:hover{--tw-text-opacity: 1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.hover\:text-blue-300:hover{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.hover\:text-cyan-300:hover{--tw-text-opacity: 1;color:rgb(103 232 249 / var(--tw-text-opacity, 1))}.hover\:text-gray-200:hover{--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.hover\:text-gray-300:hover{--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.hover\:text-green-200:hover{--tw-text-opacity: 1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.hover\:text-indigo-200:hover{--tw-text-opacity: 1;color:rgb(199 210 254 / var(--tw-text-opacity, 1))}.hover\:text-indigo-300:hover{--tw-text-opacity: 1;color:rgb(165 180 252 / var(--tw-text-opacity, 1))}.hover\:text-orange-200:hover{--tw-text-opacity: 1;color:rgb(254 215 170 / var(--tw-text-opacity, 1))}.hover\:text-pink-200:hover{--tw-text-opacity: 1;color:rgb(251 207 232 / var(--tw-text-opacity, 1))}.hover\:text-pink-300:hover{--tw-text-opacity: 1;color:rgb(249 168 212 / var(--tw-text-opacity, 1))}.hover\:text-purple-200:hover{--tw-text-opacity: 1;color:rgb(233 213 255 / var(--tw-text-opacity, 1))}.hover\:text-purple-300:hover{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.hover\:text-red-200:hover{--tw-text-opacity: 1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}.hover\:text-red-300:hover{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.hover\:text-stone-200:hover{--tw-text-opacity: 1;color:rgb(231 229 228 / var(--tw-text-opacity, 1))}.hover\:text-stone-300:hover{--tw-text-opacity: 1;color:rgb(214 211 209 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:text-xianxia-gold-400:hover{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.hover\:opacity-100:hover{opacity:1}.hover\:shadow-2xl:hover{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-\[0_0_10px_rgba\(251\,191\,36\,0\.3\)\]:hover{--tw-shadow: 0 0 10px rgba(251,191,36,.3);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-\[0_0_20px_rgba\(245\,158\,11\,0\.5\)\]:hover{--tw-shadow: 0 0 20px rgba(245,158,11,.5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-\[0_0_30px_currentColor\]:hover{--tw-shadow: 0 0 30px currentColor;--tw-shadow-colored: 0 0 30px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-\[0_0_30px_rgba\(56\,189\,248\,0\.6\)\]:hover{--tw-shadow: 0 0 30px rgba(56,189,248,.6);--tw-shadow-colored: 0 0 30px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-\[0_0_40px_rgba\(245\,158\,11\,0\.6\)\,inset_0_0_30px_rgba\(245\,158\,11\,0\.2\)\]:hover{--tw-shadow: 0 0 40px rgba(245,158,11,.6),inset 0 0 30px rgba(245,158,11,.2);--tw-shadow-colored: 0 0 40px var(--tw-shadow-color), inset 0 0 30px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-glow-blue:hover{--tw-shadow: 0 0 20px rgba(37, 99, 235, .5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-glow-gold:hover{--tw-shadow: 0 0 20px rgba(252, 211, 77, .5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-glow-purple:hover{--tw-shadow: 0 0 20px rgba(147, 51, 234, .5);--tw-shadow-colored: 0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-lg:hover{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-xl:hover{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-amber-500\/20:hover{--tw-shadow-color: rgb(245 158 11 / .2);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-amber-500\/30:hover{--tw-shadow-color: rgb(245 158 11 / .3);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-amber-500\/50:hover{--tw-shadow-color: rgb(245 158 11 / .5);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-amber-900\/20:hover{--tw-shadow-color: rgb(120 53 15 / .2);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-blue-500\/30:hover{--tw-shadow-color: rgb(59 130 246 / .3);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-blue-500\/50:hover{--tw-shadow-color: rgb(59 130 246 / .5);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-green-500\/30:hover{--tw-shadow-color: rgb(34 197 94 / .3);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-purple-500\/30:hover{--tw-shadow-color: rgb(168 85 247 / .3);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-red-500\/30:hover{--tw-shadow-color: rgb(239 68 68 / .3);--tw-shadow: var(--tw-shadow-colored)}.hover\:shadow-sky-500\/30:hover{--tw-shadow-color: rgb(14 165 233 / .3);--tw-shadow: var(--tw-shadow-colored)}.hover\:ring-4:hover{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.hover\:ring-green-500:hover{--tw-ring-opacity: 1;--tw-ring-color: rgb(34 197 94 / var(--tw-ring-opacity, 1))}.focus\:border-amber-500:focus{--tw-border-opacity: 1;border-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.focus\:border-amber-500\/50:focus{border-color:#f59e0b80}.focus\:border-amber-500\/70:focus{border-color:#f59e0bb3}.focus\:border-amber-600:focus{--tw-border-opacity: 1;border-color:rgb(217 119 6 / var(--tw-border-opacity, 1))}.focus\:border-cyan-500\/50:focus{border-color:#06b6d480}.focus\:border-indigo-500:focus{--tw-border-opacity: 1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.focus\:border-pink-500:focus{--tw-border-opacity: 1;border-color:rgb(236 72 153 / var(--tw-border-opacity, 1))}.focus\:border-pink-500\/50:focus{border-color:#ec489980}.focus\:border-purple-500:focus{--tw-border-opacity: 1;border-color:rgb(168 85 247 / var(--tw-border-opacity, 1))}.focus\:border-xianxia-gold-500:focus{--tw-border-opacity: 1;border-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.focus\:bg-stone-900\/80:focus{background-color:#1c1917cc}.focus\:shadow-\[0_0_15px_rgba\(251\,191\,36\,0\.3\)\]:focus{--tw-shadow: 0 0 15px rgba(251,191,36,.3);--tw-shadow-colored: 0 0 15px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-1:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-amber-400:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(251 191 36 / var(--tw-ring-opacity, 1))}.focus\:ring-amber-500:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(245 158 11 / var(--tw-ring-opacity, 1))}.focus\:ring-amber-500\/20:focus{--tw-ring-color: rgb(245 158 11 / .2)}.focus\:ring-amber-500\/30:focus{--tw-ring-color: rgb(245 158 11 / .3)}.focus\:ring-amber-500\/50:focus{--tw-ring-color: rgb(245 158 11 / .5)}.focus\:ring-cyan-500\/50:focus{--tw-ring-color: rgb(6 182 212 / .5)}.focus\:ring-pink-500\/50:focus{--tw-ring-color: rgb(236 72 153 / .5)}.focus\:ring-purple-500\/50:focus{--tw-ring-color: rgb(168 85 247 / .5)}.focus\:ring-xianxia-gold-500:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(245 158 11 / var(--tw-ring-opacity, 1))}.focus\:ring-xianxia-gold-500\/60:focus{--tw-ring-color: rgb(245 158 11 / .6)}.active\:scale-95:active{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.disabled\:transform-none:disabled{transform:none}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:cursor-wait:disabled{cursor:wait}.disabled\:bg-gray-500:disabled{--tw-bg-opacity: 1;background-color:rgb(107 114 128 / var(--tw-bg-opacity, 1))}.disabled\:bg-gray-600:disabled{--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.disabled\:bg-gray-700:disabled{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.disabled\:bg-red-800:disabled{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.disabled\:bg-stone-600:disabled{--tw-bg-opacity: 1;background-color:rgb(87 83 78 / var(--tw-bg-opacity, 1))}.disabled\:bg-stone-700:disabled{--tw-bg-opacity: 1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.disabled\:from-stone-700:disabled{--tw-gradient-from: #44403c var(--tw-gradient-from-position);--tw-gradient-to: rgb(68 64 60 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.disabled\:to-stone-800:disabled{--tw-gradient-to: #292524 var(--tw-gradient-to-position)}.disabled\:text-gray-600:disabled{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.disabled\:text-stone-500:disabled{--tw-text-opacity: 1;color:rgb(120 113 108 / var(--tw-text-opacity, 1))}.disabled\:opacity-30:disabled{opacity:.3}.disabled\:opacity-40:disabled{opacity:.4}.disabled\:opacity-50:disabled{opacity:.5}.disabled\:shadow-none:disabled{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group:focus-within .group-focus-within\:text-amber-500{--tw-text-opacity: 1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:block{display:block}.group:hover .group-hover\:-translate-y-2{--tw-translate-y: -.5rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:translate-x-\[100\%\]{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group\/sub:hover .group-hover\/sub\:scale-110,.group:hover .group-hover\:scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:scale-150{--tw-scale-x: 1.5;--tw-scale-y: 1.5;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:scale-x-50{--tw-scale-x: .5;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:border-\[var\(--onmyoji-gold\)\]{border-color:var(--onmyoji-gold)}.group:hover .group-hover\:border-\[var\(--onmyoji-gold-dark\)\]{border-color:var(--onmyoji-gold-dark)}.group:hover .group-hover\:border-amber-500\/30{border-color:#f59e0b4d}.group:hover .group-hover\:border-amber-500\/50{border-color:#f59e0b80}.group:hover .group-hover\:border-emerald-500\/50{border-color:#10b98180}.group:hover .group-hover\:border-pink-500\/30{border-color:#ec48994d}.group:hover .group-hover\:border-red-500\/30{border-color:#ef44444d}.group:hover .group-hover\:border-red-500\/50{border-color:#ef444480}.group:hover .group-hover\:bg-amber-500\/40{background-color:#f59e0b66}.group:hover .group-hover\:bg-red-500\/20{background-color:#ef444433}.group:hover .group-hover\:bg-sky-500\/20{background-color:#0ea5e933}.group:hover .group-hover\:from-amber-500\/5{--tw-gradient-from: rgb(245 158 11 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.group:hover .group-hover\:to-transparent{--tw-gradient-to: transparent var(--tw-gradient-to-position)}.group:hover .group-hover\:text-\[var\(--onmyoji-gold\)\]{color:var(--onmyoji-gold)}.group:hover .group-hover\:text-\[var\(--onmyoji-gold-dark\)\]{color:var(--onmyoji-gold-dark)}.group:hover .group-hover\:text-\[var\(--onmyoji-gold-light\)\]{color:var(--onmyoji-gold-light)}.group:hover .group-hover\:text-amber-100{--tw-text-opacity: 1;color:rgb(254 243 199 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-amber-200{--tw-text-opacity: 1;color:rgb(253 230 138 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-amber-400{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-amber-400\/80{color:#fbbf24cc}.group:hover .group-hover\:text-amber-500{--tw-text-opacity: 1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-amber-500\/50{color:#f59e0b80}.group:hover .group-hover\:text-amber-500\/80{color:#f59e0bcc}.group:hover .group-hover\:text-emerald-100{--tw-text-opacity: 1;color:rgb(209 250 229 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-emerald-500\/50{color:#10b98180}.group:hover .group-hover\:text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-stone-200{--tw-text-opacity: 1;color:rgb(231 229 228 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-stone-300{--tw-text-opacity: 1;color:rgb(214 211 209 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.group\/sub:hover .group-hover\/sub\:opacity-100,.group:hover .group-hover\:opacity-100{opacity:1}.group:hover .group-hover\:opacity-30{opacity:.3}.group:hover .group-hover\:opacity-60{opacity:.6}.group:hover .group-hover\:opacity-80{opacity:.8}.group:hover .group-hover\:shadow-\[0_0_25px_var\(--onmyoji-gold-glow\)\]{--tw-shadow: 0 0 25px var(--onmyoji-gold-glow);--tw-shadow-colored: 0 0 25px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group:hover .group-hover\:drop-shadow-\[0_0_8px_currentColor\]{--tw-drop-shadow: drop-shadow(0 0 8px currentColor);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.group:hover .group-hover\:drop-shadow-\[0_0_8px_rgba\(255\,255\,255\,0\.4\)\]{--tw-drop-shadow: drop-shadow(0 0 8px rgba(255,255,255,.4));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.prose-headings\:font-xianxia :is(:where(h1,h2,h3,h4,h5,h6,th):not(:where([class~=not-prose],[class~=not-prose] *))){font-family:ZCOOL XiaoWei,Ma Shan Zheng,KaiTi,STKaiti,"Noto Serif SC",serif}.prose-headings\:text-amber-300 :is(:where(h1,h2,h3,h4,h5,h6,th):not(:where([class~=not-prose],[class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(252 211 77 / var(--tw-text-opacity, 1))}.prose-p\:my-2 :is(:where(p):not(:where([class~=not-prose],[class~=not-prose] *))){margin-top:.5rem;margin-bottom:.5rem}.prose-p\:leading-loose :is(:where(p):not(:where([class~=not-prose],[class~=not-prose] *))){line-height:2}.prose-p\:tracking-widest :is(:where(p):not(:where([class~=not-prose],[class~=not-prose] *))){letter-spacing:.1em}.prose-p\:text-gray-300 :is(:where(p):not(:where([class~=not-prose],[class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.prose-p\:text-stone-100 :is(:where(p):not(:where([class~=not-prose],[class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(245 245 244 / var(--tw-text-opacity, 1))}.prose-strong\:text-amber-200 :is(:where(strong):not(:where([class~=not-prose],[class~=not-prose] *))){--tw-text-opacity: 1;color:rgb(253 230 138 / var(--tw-text-opacity, 1))}@media(min-width:640px){.sm\:mb-2{margin-bottom:.5rem}.sm\:mb-3{margin-bottom:.75rem}.sm\:mt-3{margin-top:.75rem}.sm\:mt-4{margin-top:1rem}.sm\:block{display:block}.sm\:inline-block{display:inline-block}.sm\:inline{display:inline}.sm\:h-12{height:3rem}.sm\:h-16{height:4rem}.sm\:h-\[90vh\]{height:90vh}.sm\:max-h-none{max-height:none}.sm\:min-h-0{min-height:0px}.sm\:w-12{width:3rem}.sm\:w-16{width:4rem}.sm\:w-72{width:18rem}.sm\:w-auto{width:auto}.sm\:max-w-6xl{max-width:72rem}.sm\:flex-none{flex:none}.sm\:grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.sm\:flex-row{flex-direction:row}.sm\:items-center{align-items:center}.sm\:gap-2{gap:.5rem}.sm\:gap-3{gap:.75rem}.sm\:gap-4{gap:1rem}.sm\:gap-y-6{row-gap:1.5rem}.sm\:space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.sm\:space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.sm\:overflow-y-visible{overflow-y:visible}.sm\:rounded-xl{border-radius:.75rem}.sm\:border-b-0{border-bottom-width:0px}.sm\:border-r{border-right-width:1px}.sm\:p-2{padding:.5rem}.sm\:p-3{padding:.75rem}.sm\:p-4{padding:1rem}.sm\:p-6{padding:1.5rem}.sm\:p-8{padding:2rem}.sm\:px-2{padding-left:.5rem;padding-right:.5rem}.sm\:px-3{padding-left:.75rem;padding-right:.75rem}.sm\:px-4{padding-left:1rem;padding-right:1rem}.sm\:py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.sm\:py-2{padding-top:.5rem;padding-bottom:.5rem}.sm\:text-2xl{font-size:1.5rem;line-height:2rem}.sm\:text-3xl{font-size:1.875rem;line-height:2.25rem}.sm\:text-4xl{font-size:2.25rem;line-height:2.5rem}.sm\:text-base{font-size:1rem;line-height:1.5rem}.sm\:text-lg{font-size:1.125rem;line-height:1.75rem}.sm\:text-sm{font-size:.875rem;line-height:1.25rem}}@media(min-width:768px){.md\:-left-24{left:-6rem}.md\:-right-24{right:-6rem}.md\:bottom-0{bottom:0}.md\:bottom-8{bottom:2rem}.md\:top-auto{top:auto}.md\:col-span-1{grid-column:span 1 / span 1}.md\:col-span-2{grid-column:span 2 / span 2}.md\:m-4{margin:1rem}.md\:block{display:block}.md\:hidden{display:none}.md\:h-40{height:10rem}.md\:h-60{height:15rem}.md\:h-64{height:16rem}.md\:h-auto{height:auto}.md\:max-h-\[85vh\]{max-height:85vh}.md\:w-1\/3{width:33.333333%}.md\:w-24{width:6rem}.md\:w-40{width:10rem}.md\:w-48{width:12rem}.md\:w-auto{width:auto}.md\:max-w-2xl{max-width:42rem}.md\:max-w-4xl{max-width:56rem}.md\:max-w-6xl{max-width:72rem}.md\:max-w-full{max-width:100%}.md\:max-w-md{max-width:28rem}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.md\:grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.md\:flex-row{flex-direction:row}.md\:items-start{align-items:flex-start}.md\:items-end{align-items:flex-end}.md\:items-center{align-items:center}.md\:justify-between{justify-content:space-between}.md\:gap-16{gap:4rem}.md\:gap-4{gap:1rem}.md\:gap-8{gap:2rem}.md\:rounded-xl{border-radius:.75rem}.md\:p-4{padding:1rem}.md\:p-5{padding:1.25rem}.md\:p-6{padding:1.5rem}.md\:px-12{padding-left:3rem;padding-right:3rem}.md\:px-4{padding-left:1rem;padding-right:1rem}.md\:pb-40{padding-bottom:10rem}.md\:pl-12{padding-left:3rem}.md\:pr-12{padding-right:3rem}.md\:text-2xl{font-size:1.5rem;line-height:2rem}.md\:text-3xl{font-size:1.875rem;line-height:2.25rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}.md\:text-7xl{font-size:4.5rem;line-height:1}.md\:text-8xl{font-size:6rem;line-height:1}.md\:text-base{font-size:1rem;line-height:1.5rem}.md\:text-lg{font-size:1.125rem;line-height:1.75rem}.md\:text-sm{font-size:.875rem;line-height:1.25rem}.md\:text-xl{font-size:1.25rem;line-height:1.75rem}}@media(min-width:1024px){.lg\:col-span-3{grid-column:span 3 / span 3}.lg\:col-span-4{grid-column:span 4 / span 4}.lg\:col-span-5{grid-column:span 5 / span 5}.lg\:max-w-md{max-width:28rem}.lg\:grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.lg\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.lg\:grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.lg\:pl-24{padding-left:6rem}.lg\:pr-24{padding-right:6rem}}@media(min-width:1280px){.xl\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.xl\:grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.xl\:grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}}</style>
</head>
  <body class="bg-stone-950 text-stone-300 font-sans">
    <div id="root" class="w-full"></div>
  </body>
</html>